{
  "year": 2011,
  "total": 15,
  "reference": "docs.microsoft.com",
  "reports": {
    "CVE-2011-1253": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-078",
        "title": "Vulnerability in .NET Framework and Microsoft Silverlight Could Allow Remote Code Execution (2604930)",
        "body": "This security update resolves a privately reported vulnerability in Microsoft .NET Framework and Microsoft Silverlight. The vulnerability could allow remote code execution on a client system if a user views a specially crafted Web page using a Web browser that can run XAML Browser Applications (XBAPs) or Silverlight applications. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. The vulnerability could also allow remote code execution on a server system running IIS, if that server allows processing ASP.NET pages and an attacker succeeds in uploading a specially crafted ASP.NET page to that server and then executes the page, as could be the case in a Web hosting scenario. This vulnerability could also be used by Windows .NET applications to bypass Code Access Security (CAS) restrictions. This security update is rated Critical for Microsoft .NET Framework 1.0 Service Pack 3, Microsoft .NET Framework 1.1 Service Pack 1, Microsoft .NET Framework 2.0 Service Pack 2, Microsoft .NET Framework 3.5.1, and Microsoft .NET Framework 4 on all supported editions of Microsoft Windows; and Microsoft Silverlight 4. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerability by correcting the manner in which the .NET Framework restricts inheritance within classes. For more information about the vulnerability, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. The majority of customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see Microsoft Knowledge Base Article 294871. For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers apply the update immediately using update management software, or by checking for updates using the Microsoft Update service. See also the section, Detection and Deployment Tools and Guidance, later in this bulletin. Known Issues. Microsoft Knowledge Base Article 2604930 documents the currently known issues that customers may experience when installing this security update. The article also documents recommended solutions for these issues. Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Windows Operating System and Components Operating SystemComponentMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XPWindows XP Service Pack 3[Microsoft .NET Framework 1.0 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=a54a7ad5-0504-4cc6-9eca-ba9f31c35a17) (KB2572066) (Media Center Edition 2005 and Tablet PC Edition 2005 only) [Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=719b3da5-52ca-4d56-a2c5-69711039e59d) (KB2572073) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB953295 in [MS09-061](http://go.microsoft.com/fwlink/?linkid=160527) replaced by KB2572066 KB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983583 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572073 No bulletin replaced by KB2572078Windows XP Professional x64 Edition Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=719b3da5-52ca-4d56-a2c5-69711039e59d) (KB2572073) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983583 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572073 No bulletin replaced by KB2572078Windows Server 2003Windows Server 2003 Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=b968b0bd-577b-4ea2-a192-a80fe7c20791) (KB2572069) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=719b3da5-52ca-4d56-a2c5-69711039e59d) (KB2572073) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB953298 in [MS09-061](http://go.microsoft.com/fwlink/?linkid=?????) replaced by KB2572069 KB983583 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572073 No bulletin replaced by KB2572078Windows Server 2003 x64 Edition Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=719b3da5-52ca-4d56-a2c5-69711039e59d) (KB2572073) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983583 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572073 No bulletin replaced by KB2572078Windows Server 2003 with SP2 for Itanium-based Systems[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=719b3da5-52ca-4d56-a2c5-69711039e59d) (KB2572073) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983583 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572073 No bulletin replaced by KB2572078Windows VistaWindows Vista Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=7c27128d-eaf9-4416-b8b1-9edab9102feb) (KB2572075) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983589 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572075 No bulletin replaced by KB2572078Windows Vista x64 Edition Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=7c27128d-eaf9-4416-b8b1-9edab9102feb) (KB2572075) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983589 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572075 No bulletin replaced by KB2572078Windows Server 2008Windows Server 2008 for 32-bit Systems Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507)\\*\\* (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=7c27128d-eaf9-4416-b8b1-9edab9102feb)\\*\\* (KB2572075) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)\\*\\*[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983589 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572075 No bulletin replaced by KB2572078Windows Server 2008 for x64-based Systems Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507)\\*\\* (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=7c27128d-eaf9-4416-b8b1-9edab9102feb)\\*\\* (KB2572075) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)\\*\\*[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983589 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572075 No bulletin replaced by KB2572078Windows Server 2008 for Itanium-based Systems Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=7c27128d-eaf9-4416-b8b1-9edab9102feb) (KB2572075) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983589 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572075 No bulletin replaced by KB2572078Windows 7Windows 7 for 32-bit Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=81be7ff1-3ba2-430c-9edf-619cc246daf2) (KB2572076) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572076 No bulletin replaced by KB2572078Windows 7 for 32-bit Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=98403988-7438-4260-95b5-a4796dbe0618) (KB2572077) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572077 No bulletin replaced by KB2572078Windows 7 for x64-based Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=81be7ff1-3ba2-430c-9edf-619cc246daf2) (KB2572076) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572076 No bulletin replaced by KB2572078Windows 7 for x64-based Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=98403988-7438-4260-95b5-a4796dbe0618) (KB2572077) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572077 No bulletin replaced by KB2572078Windows Server 2008 R2Windows Server 2008 R2 for x64-based Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=81be7ff1-3ba2-430c-9edf-619cc246daf2)\\* (KB2572076) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572076 No bulletin replaced by KB2572078Windows Server 2008 R2 for x64-based Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=98403988-7438-4260-95b5-a4796dbe0618)\\* (KB2572077) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)\\*[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572077 No bulletin replaced by KB2572078Windows Server 2008 R2 for Itanium-based Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=81be7ff1-3ba2-430c-9edf-619cc246daf2) (KB2572076) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572076 No bulletin replaced by KB2572078Windows Server 2008 R2 for Itanium-based Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=98403988-7438-4260-95b5-a4796dbe0618) (KB2572077) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572077 No bulletin replaced by KB2572078 **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). **Server Core installation not affected. The vulnerabilities addressed by this update do not affect supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, when installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. [1].NET Framework 4 and .NET Framework 4 Client Profile affected. The .NET Framework version 4 redistributable packages are available in two profiles: .NET Framework 4 and .NET Framework 4 Client Profile. .NET Framework 4 Client Profile is a subset of .NET Framework 4. The vulnerability addressed in this update affects both .NET Framework 4 and .NET Framework 4 Client Profile. For more information, see the MSDN article, Installing the .NET Framework. Microsoft Developer Tools and Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Silverlight 4[Microsoft Silverlight 4](https://www.microsoft.com/download/details.aspx?familyid=8bde4992-bdf7-4345-835a-4e1fbfcd8c5f) when installed on Mac (KB2617986)Remote Code ExecutionCriticalNone[Microsoft Silverlight 4](https://www.microsoft.com/download/details.aspx?familyid=8bde4992-bdf7-4345-835a-4e1fbfcd8c5f) when installed on all supported releases of Microsoft Windows clients (KB2617986)Remote Code ExecutionCriticalNone[Microsoft Silverlight 4](https://www.microsoft.com/download/details.aspx?familyid=8bde4992-bdf7-4345-835a-4e1fbfcd8c5f) when installed on all supported releases of Microsoft Windows servers\\*\\* (KB2617986)Remote Code ExecutionCriticalNone **\\*\\*Server Core installation not affected.** The vulnerabilities addressed by this update do not affect supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, when installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). Non-Affected Software Operating SystemMicrosoft .NET Framework 3.5 Service Pack 1 Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. How do I determine which version of the Microsoft .NET Framework is installed?You can install and run multiple versions of the .NET Framework on a system, and you can install the versions in any order. There are several ways to determine which versions of the .NET Framework are currently installed. For more information, please see Microsoft Knowledge Base Article 318785. What is the difference between .NET Framework 4 and .NET Framework 4 Client Profile?The .NET Framework version 4 redistributable packages are available in two profiles: .NET Framework 4 and .NET Framework 4 Client Profile. The .NET Framework 4 Client Profile is a subset of the .NET Framework 4 profile that is optimized for client applications. It provides functionality for most client applications, including Windows Presentation Foundation (WPF), Windows Forms, Windows Communication Foundation (WCF), and ClickOnce features. This enables faster deployment and a smaller install package for applications that target the .NET Framework 4 Client Profile. For more information, see the MSDN article, .NET Framework Client Profile. Which Web browsers support Microsoft Silverlight applications?In order to run Microsoft Silverlight applications, most Web browsers, including Microsoft Internet Explorer, require Microsoft Silverlight to be installed and the corresponding plug-in to be enabled. For more information about Microsoft Silverlight, see the official site, Microsoft Silverlight. Please refer to the documentation of your browser to learn more about how to disable or remove plug-ins. What versions of Microsoft Silverlight 4 are affected by the vulnerability?Microsoft Silverlight build 4.0.60831, which is the current build of Microsoft Silverlight as of when this bulletin was first released, addresses the vulnerability and is not affected. Builds of Microsoft Silverlight previous to 4.0.60831 are affected. How do I know which version and build of Microsoft Silverlight is currently installed?If Microsoft Silverlight is already installed on your computer, you can visit the Get Microsoft Silverlight page, which will indicate which version and build of Microsoft Silverlight are currently installed on your system. Alternatively, you can use the Manage Add-Ons feature of current versions of Microsoft Internet Explorer to determine the version and build information that is currently installed. You can also manually check the version number of sllauncher.exe located in the \"%ProgramFiles%\\Microsoft Silverlight\" directory (on x86 Microsoft Windows systems) or in the \"%ProgramFiles(x86)%\\Microsoft Silverlight\" directory (on x64 Microsoft Windows systems). In addition, on Microsoft Windows, the version and build information of the currently installed version of Microsoft Silverlight can be found in the registry at [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Silverlight]:Version on x86 Microsoft Windows systems, or [HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Silverlight]:Version on x64 Microsoft Windows systems. On Apple Mac OS, the version and build information of the currently installed version of Microsoft Silverlight can be found as follows: Open the Finder.Select the system drive and go to the folder Internet Plug-ins - Library.Right-click the file Silverlight.Plugin (if your mouse has only one button, press the Ctrl key while clicking on the file) to bring up the context menu, then click Show Package Contents.Inside the contents folder, locate the file info.plist and open it with an editor. It will contain an entry like this, which shows you the version number:SilverlightVersion4.0.60831 The version installed with this security update is 4.0.60831. If your version number is higher than or equal to this version number, your system is not vulnerable. How do I upgrade my version of Microsoft Silverlight?The Microsoft Silverlight auto-update feature helps makes sure that your Microsoft Silverlight installation is kept up to date with the latest version of Microsoft Silverlight, Microsoft Silverlight functionality, and security features. For more information about the Microsoft Silverlight auto-update feature, see the Microsoft Silverlight Updater. Customers who have disabled the Microsoft Silverlight auto-update feature can enroll in Microsoft Update to obtain the latest version of Microsoft Silverlight, or download the latest version of Microsoft Silverlight manually using the download link in the Affected Software table in the earlier section, Affected and Non-Affected Software. For information about deploying Microsoft Silverlight in an enterprise environment, see the Silverlight Enterprise Deployment Guide. Are the Silverlight 5 Beta or Release Candidate (RC) versions affected by this vulnerability?No, all versions of Silverlight 5 are unaffected by this issue. I have .NET Framework 3.0 Service Pack 2 installed; this version is not listed among the affected software in this bulletin. Do I need to install an update?This bulletin describes a vulnerability in the .NET Framework 1.1, .NET Framework 2.0 and the .NET Framework 4 feature layers. The .NET Framework 3.0 Service Pack 2 installer chains in the .NET Framework 2.0 Service Pack 2 setup, so installing the former also installs the latter. Therefore, customers who have .NET Framework 3.0 Service Pack 2 installed need to install security updates for .NET Framework 2.0 Service Pack 2. I have .NET Framework 3.5 Service Pack 1 installed. Do I need to install any updates?This bulletin describes a vulnerability in the .NET Framework 1.1, .NET Framework 2.0 feature layer and.NET Framework 4. The .NET Framework 3.5 Service Pack 1 installer chains in both the .NET Framework 2.0 Service Pack 2 setup and the .NET Framework 3.0 Service Pack 2 setup. Therefore, customers who have .NET Framework 3.5 Service Pack 1 installed need to install security updates for .NET Framework 2.0 Service Pack 2. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Lifecycle Supported Service Packs. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the October bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected Software.NET Framework Class Inheritance Vulnerability - CVE-2011-1253Aggregate Severity RatingMicrosoft .NET Framework 1.0 Service Pack 3Microsoft .NET Framework 1.0 Service Pack 3 on Windows XP Tablet Edition 2005 Service Pack 3 and Windows XP Media Center Edition 2005 Service Pack 3**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Service Pack 3**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Professional x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 Itanium-based Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Vista Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Vista x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2\\***Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for x64-based Systems Service Pack 2\\***Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows XP Service Pack 3**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows XP Professional x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 with SP2 for Itanium-based Systems**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for 32-bit Systems Service Pack 2\\***Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for x64-based Systems Service Pack 2\\***Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for Itanium-based Systems Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1\\***Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4Microsoft .NET Framework 4 when installed on Windows XP Service Pack 3[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2003 with SP2 for Itanium-based Systems[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2\\*\\*[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2\\*\\*[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems Service Pack 1\\*[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1[1]**Critical** Remote Code Execution**Critical**Microsoft Silverlight 4Microsoft Silverlight 4 when installed on Mac**Critical** Remote Code Execution**Critical**Microsoft Silverlight 4 when installed on all releases of Microsoft Windows clients**Critical** Remote Code Execution**Critical**Microsoft Silverlight 4 when installed on all releases of Microsoft Windows servers\\*\\***Critical** Remote Code Execution**Critical** **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). **Server Core installation not affected. The vulnerabilities addressed by this update do not affect supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, when installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. [1].NET Framework 4 and .NET Framework 4 Client Profile affected. The .NET Framework version 4 redistributable packages are available in two profiles: .NET Framework 4 and .NET Framework 4 Client Profile. .NET Framework 4 Client Profile is a subset of .NET Framework 4. The vulnerability addressed in this update affects both .NET Framework 4 and .NET Framework 4 Client Profile. For more information, see the MSDN article, Installing the .NET Framework. .NET Framework Class Inheritance Vulnerability - CVE-2011-1253 A remote code execution vulnerability exists in the way that the Microsoft .NET Framework and Silverlight framework restrict inheritance within classes. An attacker who successfully exploited this vulnerability could run arbitrary code in the security context of the logged-on user. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-1253. Mitigating Factors for .NET Framework Class Inheritance Vulnerability - CVE-2011-1253 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a Web browsing attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site.By default, Internet Explorer on Windows Server 2003, Windows Server 2008, and Windows Server 2008 R2 runs in a restricted mode that is known as Enhanced Security Configuration. This mode mitigates this vulnerability only on Windows Server 2008 and Windows Server 2008 R2, and only in a Web browsing attack scenario. See the FAQ section of this vulnerability for more information about Internet Explorer Enhanced Security Configuration.An attacker who successfully exploited this vulnerability could gain the same user rights as the local user or the user account of ASP.NET. Users or accounts that are configured to have fewer user rights on the system could be less impacted than users or accounts that operate with administrative user rights.In a Web-hosting scenario, an attacker must have permission to upload arbitrary ASP.NET pages to a Web site and ASP.NET must be installed on that Web server. In default configuration, an anonymous user cannot upload and run Microsoft .NET code on an Internet Information Server (IIS). Workarounds for .NET Framework Class Inheritance Vulnerability - CVE-2011-1253 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Disable XAML browser applications in Internet ExplorerTo help protect against this vulnerability, change your settings to prompt before running XAML browser applications (XBAPs) or to disable XBAPs in the Internet and Local intranet security zones as follows:In Internet Explorer, click the Tools menu and then select Internet Options.Click the Security tab, click Internet, and then click Custom level. Under Settings, for Loose XAML, click Prompt or Disable, and then click OK.Click the Security tab, click Internet, and then click Custom level. Under Settings, for XAML browser applications, click Prompt or Disable, and then click OK.Click the Security tab, click Internet, and then click Custom level. Under Settings, for XPS documents, click Prompt or Disable, and then click OK.On the Security tab, click Custom level. Under .NET Framework-reliant components, set Run components not signed with Authenticode to either Prompt or Disable, and then click OK. Repeat this step for Run components signed with Authenticode, and then click OK.Click Local intranet, and then click Custom Level. Repeat steps 3 and 4. If you are prompted to confirm that you want to change these settings, click Yes. Click OK to return to Internet Explorer.Impact of workaround. Microsoft .NET code will not run in Internet Explorer or will not run without prompting. Disabling Microsoft .NET applications and components in the Internet and Local intranet security zones may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.Add sites that you trust to the Internet Explorer Trusted sites zoneAfter you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.To do this, perform the following steps:In Internet Explorer, click Tools, click Internet Options, and then click the Security tab.In the Select a Web content zone to specify its current security settings box, click Trusted Sites, and then click Sites.If you want to add sites that do not require an encrypted channel, click to clear the Require server verification (https:) for all sites in this zone check box.In the Add this Web site to the zone box, type the URL of a site that you trust, and then click Add.Repeat these steps for each site that you want to add to the zone.Click OK two times to accept the changes and return to Internet Explorer.Note Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are *.windowsupdate.microsoft.com and *.update.microsoft.com. These are the sites that will host the update, and it requires an ActiveX Control to install the update.How to undo the workaround. Perform the following steps:In Internet Explorer, click the Tools menu, and then select Internet Options.Click the Security tab, click Reset all zones to default level, and then click OK.Temporarily prevent the Microsoft Silverlight ActiveX control from running in Internet Explorer (Method 1)You can help protect against these vulnerabilities by temporarily preventing attempts to instantiate the Silverlight ActiveX control in Internet Explorer by setting the kill bit for the control.Warning If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.We recommend that you back up the registry before you edit it.Use the following text to create a .reg file that temporarily prevents attempts to instantiate the Silverlight ActiveX control in Internet Explorer. You can copy the following text, paste it into a text editor such as Notepad, and then save the file with the .reg file name extension. Run the .reg file on the vulnerable client.Windows Registry Editor Version 5.00[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{DFEAF541-F3E1-4C24-ACAC-99C30715084A}]\"Compatibility Flags\"=dword:00000400Close Internet Explorer and reopen it for the changes to take effect.For detailed steps about stopping a control from running in Internet Explorer, see Microsoft Knowledge Base Article 240797. Follow these steps and create a Compatibility Flags value in the registry to prevent the Silverlight ActiveX control from running in Internet Explorer.Impact of workaround. Applications and Web sites that require the Microsoft Silverlight ActiveX control may no longer function correctly. If you implement this workaround it would affect any Silverlight ActiveX control you have installed on your system.How to undo the workaround. Remove the registry keys added to temporarily prevent attempts to instantiate the Silverlight ActiveX control in Internet Explorer.Temporarily prevent the Microsoft Silverlight ActiveX control from running in Firefox or ChromeTo modify the registry key to disable Microsoft Silverlight, follow these steps:Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the \"Changing Keys And Values\" Help topic in Registry Editor (Regedit.exe) or view the \"Add and Delete Information in the Registry\" and \"Edit Registry Data\" Help topics in Regedt32.exe.Using the Interactive MethodClick Start, click Run, type Regedit in the Open box, and then click OK.Locate and then click the following registry subkey:HKEY_LOCAL_MACHINE\\SOFTWARE\\MozillaPlugins\\@Microsoft.com/NpCtrl,version=1.0Right click on @Microsoft.com/NpCtrl,version=1.0 and select Export. Save the file to disk.Delete the entire @Microsoft.com/NpCtrl,version=1.0 key.Quit the registry editor.Using a registry fileCreate a backup copy of the registry keys. A backup copy can be made using a managed deployment script with the following command:Regedit.exe /e SL_backup.reg HKEY_LOCAL_MACHINE\\SOFTWARE\\MozillaPlugins\\@Microsoft.com/NpCtrl,version=1.0Save the following to a file with a .REG extension (e.g. Disable_Silverlight.reg):Windows Registry Editor Version 5.00[-HKEY_LOCAL_MACHINE\\SOFTWARE\\MozillaPlugins\\@Microsoft.com/NpCtrl,version=1.0]Run the above registry script created in step 2 on the target system with the following command:Regedit /s Disable_Silverlight.regHow to undo the workaround.Using the Interactive MethodClick Start, click Run, type Regedit in the Open box, and then click OK.On the File menu, click Import.In Look in, select the drive, folder, or network computer and folder where the file you previously exported is located.Select the correct file name and then click Open.Using a Managed Deployment ScriptRestore the file backed up in Using a registry file Step 1, above, with the following command:Regedit /s SL_backup.reg FAQ for .NET Framework Class Inheritance Vulnerability - CVE-2011-1253 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability is the result of .NET Framework improperly restricting inheritance within classes. What is Microsoft Silverlight?Microsoft Silverlight is a cross-browser, cross-platform implementation of the Microsoft .NET Framework for building media experiences and rich interactive applications for the Web. For more information, see the official site of Microsoft Silverlight. What might an attacker use the vulnerability to do?In the Web browsing scenario, an attacker who successfully exploited this vulnerability could obtain the same permissions as the currently logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. In the Web hosting scenario, an attacker who successfully exploits this vulnerability could obtain the same permissions as the service account associated with the application pool identity of the application pool in which a Microsoft .NET application is running. Depending on application pool isolation configuration and permissions granted to the service account, an attacker might be able to take control over other application pools on the Web server or be able to take complete control of the affected system. For more information about application pool identities and configuration, see the TechNet article, Configure Application Pool Identity. How could an attacker exploit the vulnerability?There are three attack scenarios possible for exploiting this vulnerability: a Web browsing scenario, a Web hosting scenario, and a Windows .NET application bypass of Code Access Security (CAS) restrictions. These scenarios are described as follows: Web browsing attack scenarioAn attacker could host a specially crafted Web site that contains a specially crafted XBAP (XAML browser application) that could exploit this vulnerability and then convince a user to view the Web site. The attacker could also take advantage of compromised Web sites and Web sites that accept or host user-provided content or advertisements. These Web sites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or in an Instant Messenger message that takes users to the attacker's Web site. It could also be possible to display specially crafted Web content by using banner advertisements or by using other methods to deliver Web content to affected systems.Web hosting attack scenarioIf a Web hosting environment allows users to upload custom ASP.NET applications, an attacker could upload a malicious ASP.NET application that uses this vulnerability to break out of the sandbox used to prevent ASP.NET code from performing harmful actions on the server system.Windows .NET applications attack scenarioThis vulnerability could also be used by Windows .NET applications to bypass Code Access Security (CAS) restrictions. What is an XAML Browser Application (XBAP)?An XAML browser application (XBAP) combines features of both a Web application and a rich-client application. Like Web applications, XBAPs can be published to a Web server and launched from Internet Explorer. Like rich-client applications, XBAPs can take advantage of the capabilities of Windows Presentation Foundation (WPF). For more information about XBAPs, see MSDN article, Windows Presentation Foundation XAML Browser Applications Overview. What are .NET Framework Code Access Security (CAS) Restrictions?The .NET Framework provides a security mechanism called code access security to help protect computer systems from malicious mobile code, to allow code from unknown origins to run with protection, and to help prevent trusted code from intentionally or accidentally compromising security. Code access security (CAS) enables code to be trusted to varying degrees depending on where the code originates and on other aspects of the code's identity. Code access security also enforces the varying levels of trust on code, which minimizes the amount of code that must be fully trusted in order to run. Using code access security can reduce the likelihood that your code will be misused by malicious or error-filled code. For more information on CAS, see the MSDN article, Code Access Security. What systems are primarily at risk from the vulnerability?There are three types of systems at risk from this vulnerability, described as follows: systems that are using the Web browsing scenario, systems that are using the Web hosting scenario, and systems that are using the Windows .NET applications scenario. Web browsing scenarioSuccessful exploitation of this vulnerability requires that a user is logged on and is visiting Web sites using a Web browser capable of instantiating XBAPs. Therefore, any systems where a Web browser is used frequently, such as workstations or terminal servers, are at the most risk from this vulnerability. Servers could be at more risk if administrators allow users to browse and read e-mail on servers. However, best practices strongly discourage allowing this.Web hosting scenarioWeb hosting sites that allow users to upload custom ASP.NET applications are at increased risk.Windows .NET applicationsWorkstations and server that run untrusted Windows .NET applications are also at risk from this vulnerability. I am running Internet Explorer for Windows Server 2003,Windows Server 2008, or Windows Server 2008 R2. Does this mitigate this vulnerability?Yes. By default, Internet Explorer on Windows Server 2003, Windows Server 2008, and Windows Server 2008 R2 runs in a restricted mode that is known as Enhanced Security Configuration. Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted Web content on a server. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. For CVE-2011-1253, Enhanced Security Configuration mitigates this vulnerability only on Windows Server 2008 and Windows Server 2008 R2, and only in a Web browsing attack scenario. What does the update do?The update addresses the vulnerability by correcting the manner in which the .NET Framework restricts inheritance within classes. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Security Central Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from Microsoft Update and Windows Update. Security updates are also available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the Microsoft Update Catalog. The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the Microsoft Update Catalog FAQ. Detection and Deployment Guidance Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see Microsoft Knowledge Base Article 961747. Microsoft Baseline Security Analyzer Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit Microsoft Baseline Security Analyzer. The following table provides the MBSA detection summary for this security update. SoftwareMBSAWindows XP Service Pack 3YesWindows XP Professional x64 Edition Service Pack 2YesWindows Server 2003 Service Pack 2YesWindows Server 2003 x64 Edition Service Pack 2YesWindows Server 2003 with SP2 for Itanium-based SystemsYesWindows Vista Service Pack 2YesWindows Vista x64 Edition Service Pack 2YesWindows Server 2008 for 32-bit Systems Service Pack 2YesWindows Server 2008 for x64-based Systems Service Pack 2YesWindows Server 2008 for Itanium-based Systems Service Pack 2YesWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1YesWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1YesWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1YesWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1YesMicrosoft Silverlight 4 when installed on MacNoMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows clientsYesMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows serversYes Note For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit Microsoft Baseline Security Analyzer and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. Windows Server Update Services Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, Windows Server Update Services. Systems Management Server The following table provides the SMS detection and deployment summary for this security update. SoftwareSMS 2003 with ITMUConfiguration Manager 2007Windows XP Service Pack 3YesYesWindows XP Professional x64 Edition Service Pack 2YesYesWindows Server 2003 Service Pack 2YesYesWindows Server 2003 x64 Edition Service Pack 2YesYesWindows Server 2003 with SP2 for Itanium-based SystemsYesYesWindows Vista Service Pack 2YesYesWindows Vista x64 Edition Service Pack 2YesYesWindows Server 2008 for 32-bit Systems Service Pack 2YesYesWindows Server 2008 for x64-based Systems Service Pack 2YesYesWindows Server 2008 for Itanium-based Systems Service Pack 2YesYesWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1YesYesWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1YesYesWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1YesYesWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1YesYesMicrosoft Silverlight 4 when installed on MacNoNoMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows clientsYesYesMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows serversYesYes Note Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to System Center Configuration Manager 2007. For customers remaining on SMS 2003 Service Pack 3, the Inventory Tool for Microsoft Updates (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by Microsoft Update and that are supported by Windows Server Update Services. For more information about the SMS 2003 ITMU, see SMS 2003 Inventory Tool for Microsoft Updates. For more information about SMS scanning tools, see SMS 2003 Software Update Scanning Tools. See also Downloads for Systems Management Server 2003. System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit System Center Configuration Manager 2007. For more information about SMS, visit the SMS Web site. For more detailed information, see Microsoft Knowledge Base Article 910723: Summary list of monthly detection and deployment guidance articles. Update Compatibility Evaluator and Application Compatibility Toolkit Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the Update Compatibility Evaluator components included with Application Compatibility Toolkit. The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Windows XP (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 1.0 Service Pack 3 on Windows XP Tablet Edition 2005 Service Pack 3 and Windows XP Media Center Edition 2005 Service Pack 3:NDP1.0SP3-KB2572066-X86-OCM-ENU.exe /quietFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Service Pack 3:NDP1.1SP1-KB2572067-x86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Service Pack 3:NDP20SP2-KB2572073-x86.exe /qFor Microsoft .NET Framework 4 when installed on Windows XP Service Pack 3:NDP40-KB2572078-x86.exe /qFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Professional x64 Edition Service Pack 2:NDP1.1SP1-KB2572067-x86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Professional Edition x64 Edition Service Pack 2:NDP20SP2-KB2572073-x64.exe /qFor Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2:NDP40-KB2572078-x64.exe /qInstalling without restartingFor Microsoft .NET Framework 1.0 Service Pack 3 on Windows XP Tablet Edition 2005 Service Pack 3 and Windows XP Media Center Edition 2005 Service Pack 3:NDP1.0SP3-KB2572066-X86-OCM-ENU.exe /norestartFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Service Pack 3:NDP1.1SP1-KB2572067-x86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Service Pack 3:NDP20SP2-KB2572073-x86.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows XP Service Pack 3:NDP40-KB2572078-x86.exe /norestartFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Professional x64 Edition Service Pack 2:NDP1.1SP1-KB2572067-x86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Professional Edition x64 Edition Service Pack 2:NDP20SP2-KB2572073-x64.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2:NDP40-KB2572078-x64.exe /norestartUpdate log fileFor Microsoft .NET Framework 1.0 Service Pack 3:KB2572066.logFor Microsoft .NET Framework 1.1 Service Pack 1:NDP1.1SP1-KB2572067-x86-msi.0.logNDP1.1SP1-KB2572067-x86-wrapper.logFor Microsoft .NET Framework 2.0 Service Pack 2:Microsoft .NET Framework 2.0-KB2572073_*-msi0.txtMicrosoft .NET Framework 2.0-KB2572073_*.htmlFor Microsoft .NET Framework 4:KB2572078_*_*-Microsoft .NET Framework 4 Client Profile-MSP0.txtKB2572078_*_*.htmlFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012HotPatchingNot applicableRemoval InformationFor all supported versions of Microsoft .NET Framework, use the Add or Remove Programs tool in Control Panel.File InformationSee Microsoft Knowledge Base Article 2604930Registry Key VerificationFor Microsoft .NET Framework 1.0 Service Pack 3 on Windows XP Tablet Edition 2005 Service Pack 3 and Windows XP Media Center Edition 2005 Service Pack 3:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.0\\M2572066\\For Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Service Pack 3:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.1\\M2572067\"Installed\" = dword:1For Microsoft .NET Framework 2.0 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Microsoft .NET Framework 2.0 Service Pack 2\\SP2\\KB2572073\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 on Windows XP Service Pack 3:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Professional x64 Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.1\\M2572067\"Installed\" = dword:1For Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\" Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 1.0 Service Pack 3 (KB2572066) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Install** **Options****/forceappsclose**Forces other programs to close when the computer shuts down.**/nobackup**Do not back up files for uninstall.**/overwriteoem**Overwrite OEM files without prompting.**/integrate:***path*Integrates the software updates into the Windows installation source files located at the path specified. Note that *:path* refers to the folder that contains the i386 folder.**/ER**Enable extended error reporting.**/d:***path*Specifies a backup directory for Windows Service Pack installation. *:path* indicates the destination folder for the backup files. The default backup location is *%Systemdrive%*\\\\$ntservicepackuninstall$.**/extract\\[:***path***\\]**Extracts files without starting Setup. If \"*:path*\" is not included, you are prompted for the path of a destination folder to extract the files. If \"*:path*\" is used, the files are extracted to the specified destination folder.**/hotpatch:disable**Disables hotpatching functionality, and installs the cold patch only.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Logging** **Options****/log:***path*Allows the redirection of installation log files.**/verbose**Enables verbose logging. During installation, creates *%Windir%*\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Installing the Update for Microsoft .NET Framework 1.1 Service Pack 1 (KB2572067) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/?**Displays the command-line options.Setup Modes**/q**Quiet installation.Install Options**/I**Install (default action)**/U**Uninstall**/Xp\\[:path\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.Logging Options**/l<LogFile>**Generate Log File**/l\\[d | p | f \\] <LogFile>**d – Log package detailsp – Log affected productsf – Log included files For more information about the installer, visit the [MSDN Web site](http://msdn.microsoft.com/en-us/library/aa367988(vs.85).aspx). For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 2.0 Service Pack 2(KB2572073)and Microsoft .NET Framework 4(KB2572078) This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h** **/help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Removing the Update** Removing the Update for Microsoft .NET Framework 1.0 Service Pack 3 (KB2572066) This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Removing the Update for Microsoft .NET Framework 1.1 Service Pack 1 (KB2572067)** This security update supports the following setup switches. Supported SwitchesSwitchDescription**/?**Displays the command-line options.Setup Modes**/q**Quiet installation.Install Options**/I**Install (default action)**/U**Uninstall**/Xp\\[:path\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.Logging Options**/l<LogFile>**Generate Log File**/l\\[d | p | f \\] <LogFile>**d – Log package detailsp – Log affected productsf – Log included files **Removing the Update for Microsoft .NET Framework 2.0 Service Pack 2 (KB2572073** **and Microsoft .NET Framework 4.0 (KB2572078)** This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2:WindowsServer2003-KB2572069-x86-enu.exe /quietFor Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 Service Pack 2:NDP20SP2-KB2572073-x86.exe /qFor Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2:NDP40-KB2572078-x86.exe /q For Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /q For Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP20SP2-KB2572073-x64.exe /q For Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP40-KB2572078-x64.exe /qFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 Itanium-based Edition Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 with SP2 for Itanium-based Systems:NDP20SP2-KB2572073-ia64.exe /qFor Microsoft .NET Framework 4 when installed on Windows Server 2003 with SP2 for Itanium-based Systems:NDP40-KB2572078-ia64.exe /qInstalling without restartingFor Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2:WindowsServer2003-KB2572069-x86-enu.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 Service Pack 2:NDP20SP2-KB2572073-x86.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2:NDP40-KB2572078-x86.exe /norestart For Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestart For Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP20SP2-KB2572073-x64.exe /norestart For Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP40-KB2572078-x64.exe /norestartFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 Itanium-based Edition Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 with SP2 for Itanium-based Systems:NDP20SP2-KB2572073-ia64.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2003 with SP2 for Itanium-based Systems:NDP40-KB2572078-ia64.exe /norestartUpdate log fileFor Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2:KB2572069.logFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 x64 Edition Service Pack 2 and Windows Server 2003 Itanium-based Edition Service Pack 2:NDP1.1SP1-KB2572067-x86-msi.0.logNDP1.1SP1-KB2572067-x86-wrapper.logFor Microsoft .NET Framework 2.0 Service Pack 2:Microsoft .NET Framework 2.0-KB2572073_*-msi0.txtMicrosoft .NET Framework 2.0-KB2572073_*.htmlFor Microsoft .NET Framework 4:KB2572078_*_*-Microsoft .NET Framework 4 Client Profile-MSP0.txtKB2572078_*_*.htmlFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see Microsoft Knowledge Base Article 897341.Removal InformationFor all supported versions of Microsoft .NET Framework, use the Add or Remove Programs tool in Control Panel.File InformationSee Microsoft Knowledge Base Article 2604930Registry Key VerificationFor Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP3\\KB2572069\\For Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 x64 Edition Service Pack 2 and Windows Server 2003 Itanium-based Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.1\\M2572067\"Installed\" = dword:1For Microsoft .NET Framework 2.0 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Microsoft .NET Framework 2.0 Service Pack 2\\SP2\\KB2572073\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2 and Windows Server 2003 Itanium-based Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\" Note The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Installing the Update for Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2 (KB2572069) This security update supports the following setup switches for Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2 (KB2572069). Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Install Options****/forceappsclose**Forces other programs to close when the computer shuts down.**/nobackup**Do not back up files for uninstall.**/overwriteoem**Overwrite OEM files without prompting.**/integrate:***path*Integrates the software updates into the Windows installation source files located at the path specified. Note that *:path* refers to the folder that contains the i386 folder.**/ER**Enable extended error reporting.**/d:***path*Specifies a backup directory for Windows Service Pack installation. *:path* indicates the destination folder for the backup files. The default backup location is *%Systemdrive%*\\\\$ntservicepackuninstall$.**/extract\\[:***path***\\]**Extracts files without starting Setup. If \"*:path*\" is not included, you are prompted for the path of a destination folder to extract the files. If \"*:path*\" is used, the files are extracted to the specified destination folder.**/hotpatch:disable**Disables hotpatching functionality, and installs the cold patch only.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Logging Options****/log:***path*Allows the redirection of installation log files.**/verbose**Enables verbose logging. During installation, creates *%Windir%*\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Installing the Update for Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 x64 Edition Service Pack 2 and Windows Server 2003 Itanium-based Edition Service Pack 2 (KB2572067) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/?**Displays the command-line options.Setup Modes**/q**Quiet installation.Install Options**/I**Install (default action)**/U**Uninstall**/Xp\\[:path\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.Logging Options**/l<LogFile>**Generate Log File**/l\\[d | p | f \\] <LogFile>**d – Log package detailsp – Log affected productsf – Log included files For more information about the installer, visit the [MSDN Web site](http://msdn.microsoft.com/en-us/library/aa367988(vs.85).aspx). For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 2.0 Service Pack 2 (KB2572073) and Microsoft .NET Framework 4 (KB2572078) This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Removing the Update** This security update supports the following setup switches. Removing the Update for Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2 (KB2572069) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Install Options****/forceappsclose**Forces other programs to close when the computer shuts down.**/nobackup**Do not back up files for uninstall.**/overwriteoem**Overwrite OEM files without prompting.**/integrate:***path*Integrates the software updates into the Windows installation source files located at the path specified. Note that *:path* refers to the folder that contains the i386 folder.**/ER**Enable extended error reporting.**/d:***path*Specifies a backup directory for Windows Service Pack installation. *:path* indicates the destination folder for the backup files. The default backup location is *%Systemdrive%*\\\\$ntservicepackuninstall$.**/extract\\[:***path***\\]**Extracts files without starting Setup. If \"*:path*\" is not included, you are prompted for the path of a destination folder to extract the files. If \"*:path*\" is used, the files are extracted to the specified destination folder.**/hotpatch:disable**Disables hotpatching functionality, and installs the cold patch only.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Logging Options****/log:***path*Allows the redirection of installation log files.**/verbose**Enables verbose logging. During installation, creates *%Windir%*\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Removing the Update** **for** **Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 x64 Edition Service Pack 2 and Windows Server 2003 Itanium-based Edition Service Pack 2 (KB2572067)** This security update supports the following setup switches. Supported SwitchesSwitchDescription**/?**Displays the command-line options.Setup Modes**/q**Quiet installation.Install Options**/I**Install (default action)**/U**Uninstall**/Xp\\[:path\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.Logging Options**/l<LogFile>**Generate Log File**/l\\[d | p | f \\] <LogFile>**d – Log package detailsp – Log affected productsf – Log included files **Removing the Update for Microsoft .NET Framework 2.0 Service Pack 2 (KB2572073 and Microsoft .NET Framework 4.0 (KB2572078)** This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Vista (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Vista Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista Service Pack 2:Windows6.0-KB2572075-x86.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2:NDP40-KB2572078-x86.exe /qFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Vista x64 Edition Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista x64 Edition Service Pack 2:Windows6.0-KB2572075-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2:NDP40-KB2572078-x64.exe /qInstalling without restartingFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Vista Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista Service Pack 2:Windows6.0-KB2572075-x86.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2:NDP40-KB2572078-x86.exe /norestartFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Vista x64 Edition Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista x64 Edition Service Pack 2:Windows6.0-KB2572075-x64.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2:NDP40-KB2572078-x64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2604930Registry Key VerificationFor Microsoft .NET Framework 1.1 Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.1\\M2572067\"Installed\" = dword:1For Microsoft .NET Framework 2.0 Service Pack 2:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 1.1 Service Pack 1 (KB2572067) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/?**Displays the command-line options.Setup Modes**/q**Quiet installation.Install Options**/I**Install (default action)**/U**Uninstall**/Xp\\[:path\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.Logging Options**/l<LogFile>**Generate Log File**/l\\[d | p | f \\] <LogFile>**d – Log package detailsp – Log affected productsf – Log included files For more information about the installer, visit the [MSDN Web site](http://msdn.microsoft.com/en-us/library/aa367988(vs.85).aspx). For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 2.0 Service Pack 2 (KB2572075) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/?, /h, /help**Displays help on supported switches.Setup Modes**/quiet**Suppresses the display of status or error messages.Restart Options**/norestart**When combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. For more information about the installer, visit the [MSDN Web site](http://msdn.microsoft.com/en-us/library/aa367988(vs.85).aspx). For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 4 (KB2572078) This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for 32-bit Systems Service Pack 2:Windows6.0-KB2572075-x86.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:NDP40-KB2572078-x86.exe /qFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for x64-based Systems Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /quiet /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for x64-based Systems Service Pack 2:Windows6.0-KB2572075-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2:NDP40-KB2572078-x64.exe /qFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /quiet /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 with SP2 for Itanium-based Systems:Windows6.0-KB2572075-ia64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2:NDP40-KB2572078-ia64.exe /qInstalling without restartingFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for 32-bit Systems Service Pack 2:Windows6.0-KB2572075-x86.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:NDP40-KB2572078-x86.exe /norestartFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for x64-based Systems Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for x64-based Systems Service Pack 2:Windows6.0-KB2572075-x64.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2:NDP40-KB2572078-x64.exe /norestartFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 with SP2 for Itanium-based Systems:Windows6.0-KB2572075-ia64.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2:NDP40-KB2572078-ia64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2604930Registry Key VerificationFor Microsoft .NET Framework 1.1 Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.1\\M2572067\"Installed\" = dword:1For Microsoft .NET Framework 2.0 Service Pack 2:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2 and Windows Server 2008 for Itanium-based Systems Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 1.1 Service Pack 1 (KB2572067) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/?**Displays the command-line options.Setup Modes**/q**Quiet installation.Install Options**/I**Install (default action)**/U**Uninstall**/Xp\\[:path\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.Logging Options**/l<LogFile>**Generate Log File**/l\\[d | p | f \\] <LogFile>**d – Log package detailsp – Log affected productsf – Log included files For more information about the installer, visit the [MSDN Web site](http://msdn.microsoft.com/en-us/library/aa367988(vs.85).aspx). For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 2.0 Service Pack 2 (KB2572075) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/?, /h, /help**Displays help on supported switches.Setup Modes**/quiet**Suppresses the display of status or error messages.Restart Options**/norestart**When combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. For more information about the installer, visit the [MSDN Web site](http://msdn.microsoft.com/en-us/library/aa367988(vs.85).aspx). For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 4 (KB2572078) This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems:Windows6.1-KB2572076-x86.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems Service Pack 1:Windows6.1-KB2572077-x86.msu /quietFor Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1:NDP40-KB2572078-x86.exe /quietFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems:Windows6.1-KB2572076-x64.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems Service Pack 1:Windows6.1-KB2572077-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1:NDP40-KB2572078-x64.exe /quietInstalling without restartingFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems:Windows6.1-KB2572076-x86.msu /norestartFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems Service Pack 1:Windows6.1-KB2572077-x86.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1:NDP40-KB2572078-x86.exe /norestartFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems:Windows6.1-KB2572076-x64.msu /norestartFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems Service Pack 1:Windows6.1-KB2572077-x64.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1:NDP40-KB2572078-x64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2604930Registry Key VerificationFor Microsoft .NET Framework 3.5.1 on Windows 7:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems:Windows6.1-KB2572076-x64.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems Service Pack 1:Windows6.1-KB2572077-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1:NDP40-KB2572078-x64.exe /quietFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems:Windows6.1-KB2572076-ia64.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:Windows6.1-KB2572077-ia64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:NDP40-KB2572078-ia64.exe/quietInstalling without restartingFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems:Windows6.1-KB2572076-x64.msu /norestartFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems Service Pack 1:Windows6.1-KB2572077-x64.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1:NDP40-KB2572078-x64.exe /norestartFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems:Windows6.1-KB2572076-ia64.msu /norestartFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:Windows6.1-KB2572077-ia64.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:NDP40-KB2572078-ia64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2604930Registry Key VerificationFor Microsoft .NET Framework 3.5.1:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: An anonymous contributor working with Beyond Security's SecuriTeam Secure Disclosure program for reporting the .NET Framework Class Inheritance Vulnerability (CVE-2011-1253) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published.V1.1 (October 19, 2011): Corrected the installing without restarting switch information for Microsoft .NET Framework 1.1 Service Pack 1. This is an informational change only. There were no changes to the security update files or detection logic.V1.2 (October 26, 2011): Corrected Server Core installation applicability for .NET Framework 4 on Windows Server 2008 R2 for x64-based Systems.V1.3 (July 10, 2012): Microsoft revised this bulletin to communicate a minor detection change for KB2572073 for Microsoft .NET Framework 2.0 Service Pack 2 to correct an offering issue. There were no changes to the security update files. Customers who have already successfully updated their systems do not need to take any action. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Windows Operating System and Components Operating SystemComponentMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XPWindows XP Service Pack 3[Microsoft .NET Framework 1.0 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=a54a7ad5-0504-4cc6-9eca-ba9f31c35a17) (KB2572066) (Media Center Edition 2005 and Tablet PC Edition 2005 only) [Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=719b3da5-52ca-4d56-a2c5-69711039e59d) (KB2572073) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB953295 in [MS09-061](http://go.microsoft.com/fwlink/?linkid=160527) replaced by KB2572066 KB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983583 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572073 No bulletin replaced by KB2572078Windows XP Professional x64 Edition Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=719b3da5-52ca-4d56-a2c5-69711039e59d) (KB2572073) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983583 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572073 No bulletin replaced by KB2572078Windows Server 2003Windows Server 2003 Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=b968b0bd-577b-4ea2-a192-a80fe7c20791) (KB2572069) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=719b3da5-52ca-4d56-a2c5-69711039e59d) (KB2572073) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB953298 in [MS09-061](http://go.microsoft.com/fwlink/?linkid=?????) replaced by KB2572069 KB983583 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572073 No bulletin replaced by KB2572078Windows Server 2003 x64 Edition Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=719b3da5-52ca-4d56-a2c5-69711039e59d) (KB2572073) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983583 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572073 No bulletin replaced by KB2572078Windows Server 2003 with SP2 for Itanium-based Systems[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=719b3da5-52ca-4d56-a2c5-69711039e59d) (KB2572073) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983583 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572073 No bulletin replaced by KB2572078Windows VistaWindows Vista Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=7c27128d-eaf9-4416-b8b1-9edab9102feb) (KB2572075) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983589 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572075 No bulletin replaced by KB2572078Windows Vista x64 Edition Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=7c27128d-eaf9-4416-b8b1-9edab9102feb) (KB2572075) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983589 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572075 No bulletin replaced by KB2572078Windows Server 2008Windows Server 2008 for 32-bit Systems Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507)\\*\\* (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=7c27128d-eaf9-4416-b8b1-9edab9102feb)\\*\\* (KB2572075) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)\\*\\*[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983589 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572075 No bulletin replaced by KB2572078Windows Server 2008 for x64-based Systems Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507)\\*\\* (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=7c27128d-eaf9-4416-b8b1-9edab9102feb)\\*\\* (KB2572075) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)\\*\\*[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983589 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572075 No bulletin replaced by KB2572078Windows Server 2008 for Itanium-based Systems Service Pack 2[Microsoft .NET Framework 1.1 Service Pack 1](https://www.microsoft.com/download/details.aspx?familyid=6100e577-deb5-4395-b851-e19e0ca79507) (KB2572067) [Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=7c27128d-eaf9-4416-b8b1-9edab9102feb) (KB2572075) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalKB2416447 in [MS10-070](http://go.microsoft.com/fwlink/?linkid=202409) replaced by KB2572067 KB983589 in [MS10-060](http://go.microsoft.com/fwlink/?linkid=179830) replaced by KB2572075 No bulletin replaced by KB2572078Windows 7Windows 7 for 32-bit Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=81be7ff1-3ba2-430c-9edf-619cc246daf2) (KB2572076) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572076 No bulletin replaced by KB2572078Windows 7 for 32-bit Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=98403988-7438-4260-95b5-a4796dbe0618) (KB2572077) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572077 No bulletin replaced by KB2572078Windows 7 for x64-based Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=81be7ff1-3ba2-430c-9edf-619cc246daf2) (KB2572076) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572076 No bulletin replaced by KB2572078Windows 7 for x64-based Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=98403988-7438-4260-95b5-a4796dbe0618) (KB2572077) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572077 No bulletin replaced by KB2572078Windows Server 2008 R2Windows Server 2008 R2 for x64-based Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=81be7ff1-3ba2-430c-9edf-619cc246daf2)\\* (KB2572076) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572076 No bulletin replaced by KB2572078Windows Server 2008 R2 for x64-based Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=98403988-7438-4260-95b5-a4796dbe0618)\\* (KB2572077) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)\\*[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572077 No bulletin replaced by KB2572078Windows Server 2008 R2 for Itanium-based Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=81be7ff1-3ba2-430c-9edf-619cc246daf2) (KB2572076) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572076 No bulletin replaced by KB2572078Windows Server 2008 R2 for Itanium-based Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=98403988-7438-4260-95b5-a4796dbe0618) (KB2572077) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=770e7b58-6544-4f59-9893-b3eadf6d6c8a)[1](KB2572078)Remote Code ExecutionCriticalNo bulletin replaced by KB2572077 No bulletin replaced by KB2572078 **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). **Server Core installation not affected. The vulnerabilities addressed by this update do not affect supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, when installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. [1].NET Framework 4 and .NET Framework 4 Client Profile affected. The .NET Framework version 4 redistributable packages are available in two profiles: .NET Framework 4 and .NET Framework 4 Client Profile. .NET Framework 4 Client Profile is a subset of .NET Framework 4. The vulnerability addressed in this update affects both .NET Framework 4 and .NET Framework 4 Client Profile. For more information, see the MSDN article, Installing the .NET Framework. Microsoft Developer Tools and Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Silverlight 4[Microsoft Silverlight 4](https://www.microsoft.com/download/details.aspx?familyid=8bde4992-bdf7-4345-835a-4e1fbfcd8c5f) when installed on Mac (KB2617986)Remote Code ExecutionCriticalNone[Microsoft Silverlight 4](https://www.microsoft.com/download/details.aspx?familyid=8bde4992-bdf7-4345-835a-4e1fbfcd8c5f) when installed on all supported releases of Microsoft Windows clients (KB2617986)Remote Code ExecutionCriticalNone[Microsoft Silverlight 4](https://www.microsoft.com/download/details.aspx?familyid=8bde4992-bdf7-4345-835a-4e1fbfcd8c5f) when installed on all supported releases of Microsoft Windows servers\\*\\* (KB2617986)Remote Code ExecutionCriticalNone **\\*\\*Server Core installation not affected.** The vulnerabilities addressed by this update do not affect supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, when installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). Non-Affected Software Operating SystemMicrosoft .NET Framework 3.5 Service Pack 1 Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. How do I determine which version of the Microsoft .NET Framework is installed?You can install and run multiple versions of the .NET Framework on a system, and you can install the versions in any order. There are several ways to determine which versions of the .NET Framework are currently installed. For more information, please see Microsoft Knowledge Base Article 318785. What is the difference between .NET Framework 4 and .NET Framework 4 Client Profile?The .NET Framework version 4 redistributable packages are available in two profiles: .NET Framework 4 and .NET Framework 4 Client Profile. The .NET Framework 4 Client Profile is a subset of the .NET Framework 4 profile that is optimized for client applications. It provides functionality for most client applications, including Windows Presentation Foundation (WPF), Windows Forms, Windows Communication Foundation (WCF), and ClickOnce features. This enables faster deployment and a smaller install package for applications that target the .NET Framework 4 Client Profile. For more information, see the MSDN article, .NET Framework Client Profile. Which Web browsers support Microsoft Silverlight applications?In order to run Microsoft Silverlight applications, most Web browsers, including Microsoft Internet Explorer, require Microsoft Silverlight to be installed and the corresponding plug-in to be enabled. For more information about Microsoft Silverlight, see the official site, Microsoft Silverlight. Please refer to the documentation of your browser to learn more about how to disable or remove plug-ins. What versions of Microsoft Silverlight 4 are affected by the vulnerability?Microsoft Silverlight build 4.0.60831, which is the current build of Microsoft Silverlight as of when this bulletin was first released, addresses the vulnerability and is not affected. Builds of Microsoft Silverlight previous to 4.0.60831 are affected. How do I know which version and build of Microsoft Silverlight is currently installed?If Microsoft Silverlight is already installed on your computer, you can visit the Get Microsoft Silverlight page, which will indicate which version and build of Microsoft Silverlight are currently installed on your system. Alternatively, you can use the Manage Add-Ons feature of current versions of Microsoft Internet Explorer to determine the version and build information that is currently installed. You can also manually check the version number of sllauncher.exe located in the \"%ProgramFiles%\\Microsoft Silverlight\" directory (on x86 Microsoft Windows systems) or in the \"%ProgramFiles(x86)%\\Microsoft Silverlight\" directory (on x64 Microsoft Windows systems). In addition, on Microsoft Windows, the version and build information of the currently installed version of Microsoft Silverlight can be found in the registry at [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Silverlight]:Version on x86 Microsoft Windows systems, or [HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Silverlight]:Version on x64 Microsoft Windows systems. On Apple Mac OS, the version and build information of the currently installed version of Microsoft Silverlight can be found as follows: Open the Finder.Select the system drive and go to the folder Internet Plug-ins - Library.Right-click the file Silverlight.Plugin (if your mouse has only one button, press the Ctrl key while clicking on the file) to bring up the context menu, then click Show Package Contents.Inside the contents folder, locate the file info.plist and open it with an editor. It will contain an entry like this, which shows you the version number:SilverlightVersion4.0.60831 The version installed with this security update is 4.0.60831. If your version number is higher than or equal to this version number, your system is not vulnerable. How do I upgrade my version of Microsoft Silverlight?The Microsoft Silverlight auto-update feature helps makes sure that your Microsoft Silverlight installation is kept up to date with the latest version of Microsoft Silverlight, Microsoft Silverlight functionality, and security features. For more information about the Microsoft Silverlight auto-update feature, see the Microsoft Silverlight Updater. Customers who have disabled the Microsoft Silverlight auto-update feature can enroll in Microsoft Update to obtain the latest version of Microsoft Silverlight, or download the latest version of Microsoft Silverlight manually using the download link in the Affected Software table in the earlier section, Affected and Non-Affected Software. For information about deploying Microsoft Silverlight in an enterprise environment, see the Silverlight Enterprise Deployment Guide. Are the Silverlight 5 Beta or Release Candidate (RC) versions affected by this vulnerability?No, all versions of Silverlight 5 are unaffected by this issue. I have .NET Framework 3.0 Service Pack 2 installed; this version is not listed among the affected software in this bulletin. Do I need to install an update?This bulletin describes a vulnerability in the .NET Framework 1.1, .NET Framework 2.0 and the .NET Framework 4 feature layers. The .NET Framework 3.0 Service Pack 2 installer chains in the .NET Framework 2.0 Service Pack 2 setup, so installing the former also installs the latter. Therefore, customers who have .NET Framework 3.0 Service Pack 2 installed need to install security updates for .NET Framework 2.0 Service Pack 2. I have .NET Framework 3.5 Service Pack 1 installed. Do I need to install any updates?This bulletin describes a vulnerability in the .NET Framework 1.1, .NET Framework 2.0 feature layer and.NET Framework 4. The .NET Framework 3.5 Service Pack 1 installer chains in both the .NET Framework 2.0 Service Pack 2 setup and the .NET Framework 3.0 Service Pack 2 setup. Therefore, customers who have .NET Framework 3.5 Service Pack 1 installed need to install security updates for .NET Framework 2.0 Service Pack 2. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Lifecycle Supported Service Packs. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the October bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected Software.NET Framework Class Inheritance Vulnerability - CVE-2011-1253Aggregate Severity RatingMicrosoft .NET Framework 1.0 Service Pack 3Microsoft .NET Framework 1.0 Service Pack 3 on Windows XP Tablet Edition 2005 Service Pack 3 and Windows XP Media Center Edition 2005 Service Pack 3**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Service Pack 3**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Professional x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 Itanium-based Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Vista Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Vista x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2\\***Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for x64-based Systems Service Pack 2\\***Critical** Remote Code Execution**Critical**Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows XP Service Pack 3**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows XP Professional x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 with SP2 for Itanium-based Systems**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for 32-bit Systems Service Pack 2\\***Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for x64-based Systems Service Pack 2\\***Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for Itanium-based Systems Service Pack 2**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1\\***Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4Microsoft .NET Framework 4 when installed on Windows XP Service Pack 3[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2003 with SP2 for Itanium-based Systems[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2\\*\\*[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2\\*\\*[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems Service Pack 1\\*[1]**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1[1]**Critical** Remote Code Execution**Critical**Microsoft Silverlight 4Microsoft Silverlight 4 when installed on Mac**Critical** Remote Code Execution**Critical**Microsoft Silverlight 4 when installed on all releases of Microsoft Windows clients**Critical** Remote Code Execution**Critical**Microsoft Silverlight 4 when installed on all releases of Microsoft Windows servers\\*\\***Critical** Remote Code Execution**Critical** **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). **Server Core installation not affected. The vulnerabilities addressed by this update do not affect supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, when installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. [1].NET Framework 4 and .NET Framework 4 Client Profile affected. The .NET Framework version 4 redistributable packages are available in two profiles: .NET Framework 4 and .NET Framework 4 Client Profile. .NET Framework 4 Client Profile is a subset of .NET Framework 4. The vulnerability addressed in this update affects both .NET Framework 4 and .NET Framework 4 Client Profile. For more information, see the MSDN article, Installing the .NET Framework. .NET Framework Class Inheritance Vulnerability - CVE-2011-1253 A remote code execution vulnerability exists in the way that the Microsoft .NET Framework and Silverlight framework restrict inheritance within classes. An attacker who successfully exploited this vulnerability could run arbitrary code in the security context of the logged-on user. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-1253. Mitigating Factors for .NET Framework Class Inheritance Vulnerability - CVE-2011-1253 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a Web browsing attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site.By default, Internet Explorer on Windows Server 2003, Windows Server 2008, and Windows Server 2008 R2 runs in a restricted mode that is known as Enhanced Security Configuration. This mode mitigates this vulnerability only on Windows Server 2008 and Windows Server 2008 R2, and only in a Web browsing attack scenario. See the FAQ section of this vulnerability for more information about Internet Explorer Enhanced Security Configuration.An attacker who successfully exploited this vulnerability could gain the same user rights as the local user or the user account of ASP.NET. Users or accounts that are configured to have fewer user rights on the system could be less impacted than users or accounts that operate with administrative user rights.In a Web-hosting scenario, an attacker must have permission to upload arbitrary ASP.NET pages to a Web site and ASP.NET must be installed on that Web server. In default configuration, an anonymous user cannot upload and run Microsoft .NET code on an Internet Information Server (IIS). Workarounds for .NET Framework Class Inheritance Vulnerability - CVE-2011-1253 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Disable XAML browser applications in Internet ExplorerTo help protect against this vulnerability, change your settings to prompt before running XAML browser applications (XBAPs) or to disable XBAPs in the Internet and Local intranet security zones as follows:In Internet Explorer, click the Tools menu and then select Internet Options.Click the Security tab, click Internet, and then click Custom level. Under Settings, for Loose XAML, click Prompt or Disable, and then click OK.Click the Security tab, click Internet, and then click Custom level. Under Settings, for XAML browser applications, click Prompt or Disable, and then click OK.Click the Security tab, click Internet, and then click Custom level. Under Settings, for XPS documents, click Prompt or Disable, and then click OK.On the Security tab, click Custom level. Under .NET Framework-reliant components, set Run components not signed with Authenticode to either Prompt or Disable, and then click OK. Repeat this step for Run components signed with Authenticode, and then click OK.Click Local intranet, and then click Custom Level. Repeat steps 3 and 4. If you are prompted to confirm that you want to change these settings, click Yes. Click OK to return to Internet Explorer.Impact of workaround. Microsoft .NET code will not run in Internet Explorer or will not run without prompting. Disabling Microsoft .NET applications and components in the Internet and Local intranet security zones may cause some Web sites to work incorrectly. If you have difficulty using a Web site after you change this setting and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.Add sites that you trust to the Internet Explorer Trusted sites zoneAfter you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted Web sites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.To do this, perform the following steps:In Internet Explorer, click Tools, click Internet Options, and then click the Security tab.In the Select a Web content zone to specify its current security settings box, click Trusted Sites, and then click Sites.If you want to add sites that do not require an encrypted channel, click to clear the Require server verification (https:) for all sites in this zone check box.In the Add this Web site to the zone box, type the URL of a site that you trust, and then click Add.Repeat these steps for each site that you want to add to the zone.Click OK two times to accept the changes and return to Internet Explorer.Note Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are *.windowsupdate.microsoft.com and *.update.microsoft.com. These are the sites that will host the update, and it requires an ActiveX Control to install the update.How to undo the workaround. Perform the following steps:In Internet Explorer, click the Tools menu, and then select Internet Options.Click the Security tab, click Reset all zones to default level, and then click OK.Temporarily prevent the Microsoft Silverlight ActiveX control from running in Internet Explorer (Method 1)You can help protect against these vulnerabilities by temporarily preventing attempts to instantiate the Silverlight ActiveX control in Internet Explorer by setting the kill bit for the control.Warning If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.We recommend that you back up the registry before you edit it.Use the following text to create a .reg file that temporarily prevents attempts to instantiate the Silverlight ActiveX control in Internet Explorer. You can copy the following text, paste it into a text editor such as Notepad, and then save the file with the .reg file name extension. Run the .reg file on the vulnerable client.Windows Registry Editor Version 5.00[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{DFEAF541-F3E1-4C24-ACAC-99C30715084A}]\"Compatibility Flags\"=dword:00000400Close Internet Explorer and reopen it for the changes to take effect.For detailed steps about stopping a control from running in Internet Explorer, see Microsoft Knowledge Base Article 240797. Follow these steps and create a Compatibility Flags value in the registry to prevent the Silverlight ActiveX control from running in Internet Explorer.Impact of workaround. Applications and Web sites that require the Microsoft Silverlight ActiveX control may no longer function correctly. If you implement this workaround it would affect any Silverlight ActiveX control you have installed on your system.How to undo the workaround. Remove the registry keys added to temporarily prevent attempts to instantiate the Silverlight ActiveX control in Internet Explorer.Temporarily prevent the Microsoft Silverlight ActiveX control from running in Firefox or ChromeTo modify the registry key to disable Microsoft Silverlight, follow these steps:Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the \"Changing Keys And Values\" Help topic in Registry Editor (Regedit.exe) or view the \"Add and Delete Information in the Registry\" and \"Edit Registry Data\" Help topics in Regedt32.exe.Using the Interactive MethodClick Start, click Run, type Regedit in the Open box, and then click OK.Locate and then click the following registry subkey:HKEY_LOCAL_MACHINE\\SOFTWARE\\MozillaPlugins\\@Microsoft.com/NpCtrl,version=1.0Right click on @Microsoft.com/NpCtrl,version=1.0 and select Export. Save the file to disk.Delete the entire @Microsoft.com/NpCtrl,version=1.0 key.Quit the registry editor.Using a registry fileCreate a backup copy of the registry keys. A backup copy can be made using a managed deployment script with the following command:Regedit.exe /e SL_backup.reg HKEY_LOCAL_MACHINE\\SOFTWARE\\MozillaPlugins\\@Microsoft.com/NpCtrl,version=1.0Save the following to a file with a .REG extension (e.g. Disable_Silverlight.reg):Windows Registry Editor Version 5.00[-HKEY_LOCAL_MACHINE\\SOFTWARE\\MozillaPlugins\\@Microsoft.com/NpCtrl,version=1.0]Run the above registry script created in step 2 on the target system with the following command:Regedit /s Disable_Silverlight.regHow to undo the workaround.Using the Interactive MethodClick Start, click Run, type Regedit in the Open box, and then click OK.On the File menu, click Import.In Look in, select the drive, folder, or network computer and folder where the file you previously exported is located.Select the correct file name and then click Open.Using a Managed Deployment ScriptRestore the file backed up in Using a registry file Step 1, above, with the following command:Regedit /s SL_backup.reg FAQ for .NET Framework Class Inheritance Vulnerability - CVE-2011-1253 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability is the result of .NET Framework improperly restricting inheritance within classes. What is Microsoft Silverlight?Microsoft Silverlight is a cross-browser, cross-platform implementation of the Microsoft .NET Framework for building media experiences and rich interactive applications for the Web. For more information, see the official site of Microsoft Silverlight. What might an attacker use the vulnerability to do?In the Web browsing scenario, an attacker who successfully exploited this vulnerability could obtain the same permissions as the currently logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. In the Web hosting scenario, an attacker who successfully exploits this vulnerability could obtain the same permissions as the service account associated with the application pool identity of the application pool in which a Microsoft .NET application is running. Depending on application pool isolation configuration and permissions granted to the service account, an attacker might be able to take control over other application pools on the Web server or be able to take complete control of the affected system. For more information about application pool identities and configuration, see the TechNet article, Configure Application Pool Identity. How could an attacker exploit the vulnerability?There are three attack scenarios possible for exploiting this vulnerability: a Web browsing scenario, a Web hosting scenario, and a Windows .NET application bypass of Code Access Security (CAS) restrictions. These scenarios are described as follows: Web browsing attack scenarioAn attacker could host a specially crafted Web site that contains a specially crafted XBAP (XAML browser application) that could exploit this vulnerability and then convince a user to view the Web site. The attacker could also take advantage of compromised Web sites and Web sites that accept or host user-provided content or advertisements. These Web sites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to convince users to visit the Web site, typically by getting them to click a link in an e-mail message or in an Instant Messenger message that takes users to the attacker's Web site. It could also be possible to display specially crafted Web content by using banner advertisements or by using other methods to deliver Web content to affected systems.Web hosting attack scenarioIf a Web hosting environment allows users to upload custom ASP.NET applications, an attacker could upload a malicious ASP.NET application that uses this vulnerability to break out of the sandbox used to prevent ASP.NET code from performing harmful actions on the server system.Windows .NET applications attack scenarioThis vulnerability could also be used by Windows .NET applications to bypass Code Access Security (CAS) restrictions. What is an XAML Browser Application (XBAP)?An XAML browser application (XBAP) combines features of both a Web application and a rich-client application. Like Web applications, XBAPs can be published to a Web server and launched from Internet Explorer. Like rich-client applications, XBAPs can take advantage of the capabilities of Windows Presentation Foundation (WPF). For more information about XBAPs, see MSDN article, Windows Presentation Foundation XAML Browser Applications Overview. What are .NET Framework Code Access Security (CAS) Restrictions?The .NET Framework provides a security mechanism called code access security to help protect computer systems from malicious mobile code, to allow code from unknown origins to run with protection, and to help prevent trusted code from intentionally or accidentally compromising security. Code access security (CAS) enables code to be trusted to varying degrees depending on where the code originates and on other aspects of the code's identity. Code access security also enforces the varying levels of trust on code, which minimizes the amount of code that must be fully trusted in order to run. Using code access security can reduce the likelihood that your code will be misused by malicious or error-filled code. For more information on CAS, see the MSDN article, Code Access Security. What systems are primarily at risk from the vulnerability?There are three types of systems at risk from this vulnerability, described as follows: systems that are using the Web browsing scenario, systems that are using the Web hosting scenario, and systems that are using the Windows .NET applications scenario. Web browsing scenarioSuccessful exploitation of this vulnerability requires that a user is logged on and is visiting Web sites using a Web browser capable of instantiating XBAPs. Therefore, any systems where a Web browser is used frequently, such as workstations or terminal servers, are at the most risk from this vulnerability. Servers could be at more risk if administrators allow users to browse and read e-mail on servers. However, best practices strongly discourage allowing this.Web hosting scenarioWeb hosting sites that allow users to upload custom ASP.NET applications are at increased risk.Windows .NET applicationsWorkstations and server that run untrusted Windows .NET applications are also at risk from this vulnerability. I am running Internet Explorer for Windows Server 2003,Windows Server 2008, or Windows Server 2008 R2. Does this mitigate this vulnerability?Yes. By default, Internet Explorer on Windows Server 2003, Windows Server 2008, and Windows Server 2008 R2 runs in a restricted mode that is known as Enhanced Security Configuration. Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted Web content on a server. This is a mitigating factor for Web sites that you have not added to the Internet Explorer Trusted sites zone. For CVE-2011-1253, Enhanced Security Configuration mitigates this vulnerability only on Windows Server 2008 and Windows Server 2008 R2, and only in a Web browsing attack scenario. What does the update do?The update addresses the vulnerability by correcting the manner in which the .NET Framework restricts inheritance within classes. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Security Central Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from Microsoft Update and Windows Update. Security updates are also available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the Microsoft Update Catalog. The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the Microsoft Update Catalog FAQ. Detection and Deployment Guidance Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see Microsoft Knowledge Base Article 961747. Microsoft Baseline Security Analyzer Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit Microsoft Baseline Security Analyzer. The following table provides the MBSA detection summary for this security update. SoftwareMBSAWindows XP Service Pack 3YesWindows XP Professional x64 Edition Service Pack 2YesWindows Server 2003 Service Pack 2YesWindows Server 2003 x64 Edition Service Pack 2YesWindows Server 2003 with SP2 for Itanium-based SystemsYesWindows Vista Service Pack 2YesWindows Vista x64 Edition Service Pack 2YesWindows Server 2008 for 32-bit Systems Service Pack 2YesWindows Server 2008 for x64-based Systems Service Pack 2YesWindows Server 2008 for Itanium-based Systems Service Pack 2YesWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1YesWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1YesWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1YesWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1YesMicrosoft Silverlight 4 when installed on MacNoMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows clientsYesMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows serversYes Note For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit Microsoft Baseline Security Analyzer and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. Windows Server Update Services Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, Windows Server Update Services. Systems Management Server The following table provides the SMS detection and deployment summary for this security update. SoftwareSMS 2003 with ITMUConfiguration Manager 2007Windows XP Service Pack 3YesYesWindows XP Professional x64 Edition Service Pack 2YesYesWindows Server 2003 Service Pack 2YesYesWindows Server 2003 x64 Edition Service Pack 2YesYesWindows Server 2003 with SP2 for Itanium-based SystemsYesYesWindows Vista Service Pack 2YesYesWindows Vista x64 Edition Service Pack 2YesYesWindows Server 2008 for 32-bit Systems Service Pack 2YesYesWindows Server 2008 for x64-based Systems Service Pack 2YesYesWindows Server 2008 for Itanium-based Systems Service Pack 2YesYesWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1YesYesWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1YesYesWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1YesYesWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1YesYesMicrosoft Silverlight 4 when installed on MacNoNoMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows clientsYesYesMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows serversYesYes Note Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to System Center Configuration Manager 2007. For customers remaining on SMS 2003 Service Pack 3, the Inventory Tool for Microsoft Updates (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by Microsoft Update and that are supported by Windows Server Update Services. For more information about the SMS 2003 ITMU, see SMS 2003 Inventory Tool for Microsoft Updates. For more information about SMS scanning tools, see SMS 2003 Software Update Scanning Tools. See also Downloads for Systems Management Server 2003. System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit System Center Configuration Manager 2007. For more information about SMS, visit the SMS Web site. For more detailed information, see Microsoft Knowledge Base Article 910723: Summary list of monthly detection and deployment guidance articles. Update Compatibility Evaluator and Application Compatibility Toolkit Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the Update Compatibility Evaluator components included with Application Compatibility Toolkit. The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Windows XP (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 1.0 Service Pack 3 on Windows XP Tablet Edition 2005 Service Pack 3 and Windows XP Media Center Edition 2005 Service Pack 3:NDP1.0SP3-KB2572066-X86-OCM-ENU.exe /quietFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Service Pack 3:NDP1.1SP1-KB2572067-x86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Service Pack 3:NDP20SP2-KB2572073-x86.exe /qFor Microsoft .NET Framework 4 when installed on Windows XP Service Pack 3:NDP40-KB2572078-x86.exe /qFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Professional x64 Edition Service Pack 2:NDP1.1SP1-KB2572067-x86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Professional Edition x64 Edition Service Pack 2:NDP20SP2-KB2572073-x64.exe /qFor Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2:NDP40-KB2572078-x64.exe /qInstalling without restartingFor Microsoft .NET Framework 1.0 Service Pack 3 on Windows XP Tablet Edition 2005 Service Pack 3 and Windows XP Media Center Edition 2005 Service Pack 3:NDP1.0SP3-KB2572066-X86-OCM-ENU.exe /norestartFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Service Pack 3:NDP1.1SP1-KB2572067-x86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Service Pack 3:NDP20SP2-KB2572073-x86.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows XP Service Pack 3:NDP40-KB2572078-x86.exe /norestartFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Professional x64 Edition Service Pack 2:NDP1.1SP1-KB2572067-x86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Professional Edition x64 Edition Service Pack 2:NDP20SP2-KB2572073-x64.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2:NDP40-KB2572078-x64.exe /norestartUpdate log fileFor Microsoft .NET Framework 1.0 Service Pack 3:KB2572066.logFor Microsoft .NET Framework 1.1 Service Pack 1:NDP1.1SP1-KB2572067-x86-msi.0.logNDP1.1SP1-KB2572067-x86-wrapper.logFor Microsoft .NET Framework 2.0 Service Pack 2:Microsoft .NET Framework 2.0-KB2572073_*-msi0.txtMicrosoft .NET Framework 2.0-KB2572073_*.htmlFor Microsoft .NET Framework 4:KB2572078_*_*-Microsoft .NET Framework 4 Client Profile-MSP0.txtKB2572078_*_*.htmlFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012HotPatchingNot applicableRemoval InformationFor all supported versions of Microsoft .NET Framework, use the Add or Remove Programs tool in Control Panel.File InformationSee Microsoft Knowledge Base Article 2604930Registry Key VerificationFor Microsoft .NET Framework 1.0 Service Pack 3 on Windows XP Tablet Edition 2005 Service Pack 3 and Windows XP Media Center Edition 2005 Service Pack 3:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.0\\M2572066\\For Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Service Pack 3:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.1\\M2572067\"Installed\" = dword:1For Microsoft .NET Framework 2.0 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Microsoft .NET Framework 2.0 Service Pack 2\\SP2\\KB2572073\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 on Windows XP Service Pack 3:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows XP Professional x64 Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.1\\M2572067\"Installed\" = dword:1For Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\" Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 1.0 Service Pack 3 (KB2572066) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Install** **Options****/forceappsclose**Forces other programs to close when the computer shuts down.**/nobackup**Do not back up files for uninstall.**/overwriteoem**Overwrite OEM files without prompting.**/integrate:***path*Integrates the software updates into the Windows installation source files located at the path specified. Note that *:path* refers to the folder that contains the i386 folder.**/ER**Enable extended error reporting.**/d:***path*Specifies a backup directory for Windows Service Pack installation. *:path* indicates the destination folder for the backup files. The default backup location is *%Systemdrive%*\\\\$ntservicepackuninstall$.**/extract\\[:***path***\\]**Extracts files without starting Setup. If \"*:path*\" is not included, you are prompted for the path of a destination folder to extract the files. If \"*:path*\" is used, the files are extracted to the specified destination folder.**/hotpatch:disable**Disables hotpatching functionality, and installs the cold patch only.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Logging** **Options****/log:***path*Allows the redirection of installation log files.**/verbose**Enables verbose logging. During installation, creates *%Windir%*\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Installing the Update for Microsoft .NET Framework 1.1 Service Pack 1 (KB2572067) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/?**Displays the command-line options.Setup Modes**/q**Quiet installation.Install Options**/I**Install (default action)**/U**Uninstall**/Xp\\[:path\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.Logging Options**/l<LogFile>**Generate Log File**/l\\[d | p | f \\] <LogFile>**d – Log package detailsp – Log affected productsf – Log included files For more information about the installer, visit the [MSDN Web site](http://msdn.microsoft.com/en-us/library/aa367988(vs.85).aspx). For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 2.0 Service Pack 2(KB2572073)and Microsoft .NET Framework 4(KB2572078) This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h** **/help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Removing the Update** Removing the Update for Microsoft .NET Framework 1.0 Service Pack 3 (KB2572066) This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Removing the Update for Microsoft .NET Framework 1.1 Service Pack 1 (KB2572067)** This security update supports the following setup switches. Supported SwitchesSwitchDescription**/?**Displays the command-line options.Setup Modes**/q**Quiet installation.Install Options**/I**Install (default action)**/U**Uninstall**/Xp\\[:path\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.Logging Options**/l<LogFile>**Generate Log File**/l\\[d | p | f \\] <LogFile>**d – Log package detailsp – Log affected productsf – Log included files **Removing the Update for Microsoft .NET Framework 2.0 Service Pack 2 (KB2572073** **and Microsoft .NET Framework 4.0 (KB2572078)** This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2:WindowsServer2003-KB2572069-x86-enu.exe /quietFor Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 Service Pack 2:NDP20SP2-KB2572073-x86.exe /qFor Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2:NDP40-KB2572078-x86.exe /q For Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /q For Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP20SP2-KB2572073-x64.exe /q For Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP40-KB2572078-x64.exe /qFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 Itanium-based Edition Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 with SP2 for Itanium-based Systems:NDP20SP2-KB2572073-ia64.exe /qFor Microsoft .NET Framework 4 when installed on Windows Server 2003 with SP2 for Itanium-based Systems:NDP40-KB2572078-ia64.exe /qInstalling without restartingFor Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2:WindowsServer2003-KB2572069-x86-enu.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 Service Pack 2:NDP20SP2-KB2572073-x86.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2:NDP40-KB2572078-x86.exe /norestart For Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestart For Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP20SP2-KB2572073-x64.exe /norestart For Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP40-KB2572078-x64.exe /norestartFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 Itanium-based Edition Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 with SP2 for Itanium-based Systems:NDP20SP2-KB2572073-ia64.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2003 with SP2 for Itanium-based Systems:NDP40-KB2572078-ia64.exe /norestartUpdate log fileFor Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2:KB2572069.logFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 x64 Edition Service Pack 2 and Windows Server 2003 Itanium-based Edition Service Pack 2:NDP1.1SP1-KB2572067-x86-msi.0.logNDP1.1SP1-KB2572067-x86-wrapper.logFor Microsoft .NET Framework 2.0 Service Pack 2:Microsoft .NET Framework 2.0-KB2572073_*-msi0.txtMicrosoft .NET Framework 2.0-KB2572073_*.htmlFor Microsoft .NET Framework 4:KB2572078_*_*-Microsoft .NET Framework 4 Client Profile-MSP0.txtKB2572078_*_*.htmlFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see Microsoft Knowledge Base Article 897341.Removal InformationFor all supported versions of Microsoft .NET Framework, use the Add or Remove Programs tool in Control Panel.File InformationSee Microsoft Knowledge Base Article 2604930Registry Key VerificationFor Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP3\\KB2572069\\For Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2003 x64 Edition Service Pack 2 and Windows Server 2003 Itanium-based Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.1\\M2572067\"Installed\" = dword:1For Microsoft .NET Framework 2.0 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Microsoft .NET Framework 2.0 Service Pack 2\\SP2\\KB2572073\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2 and Windows Server 2003 Itanium-based Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\" Note The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Installing the Update for Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2 (KB2572069) This security update supports the following setup switches for Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2 (KB2572069). Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Install Options****/forceappsclose**Forces other programs to close when the computer shuts down.**/nobackup**Do not back up files for uninstall.**/overwriteoem**Overwrite OEM files without prompting.**/integrate:***path*Integrates the software updates into the Windows installation source files located at the path specified. Note that *:path* refers to the folder that contains the i386 folder.**/ER**Enable extended error reporting.**/d:***path*Specifies a backup directory for Windows Service Pack installation. *:path* indicates the destination folder for the backup files. The default backup location is *%Systemdrive%*\\\\$ntservicepackuninstall$.**/extract\\[:***path***\\]**Extracts files without starting Setup. If \"*:path*\" is not included, you are prompted for the path of a destination folder to extract the files. If \"*:path*\" is used, the files are extracted to the specified destination folder.**/hotpatch:disable**Disables hotpatching functionality, and installs the cold patch only.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Logging Options****/log:***path*Allows the redirection of installation log files.**/verbose**Enables verbose logging. During installation, creates *%Windir%*\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Installing the Update for Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 x64 Edition Service Pack 2 and Windows Server 2003 Itanium-based Edition Service Pack 2 (KB2572067) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/?**Displays the command-line options.Setup Modes**/q**Quiet installation.Install Options**/I**Install (default action)**/U**Uninstall**/Xp\\[:path\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.Logging Options**/l<LogFile>**Generate Log File**/l\\[d | p | f \\] <LogFile>**d – Log package detailsp – Log affected productsf – Log included files For more information about the installer, visit the [MSDN Web site](http://msdn.microsoft.com/en-us/library/aa367988(vs.85).aspx). For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 2.0 Service Pack 2 (KB2572073) and Microsoft .NET Framework 4 (KB2572078) This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Removing the Update** This security update supports the following setup switches. Removing the Update for Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 Service Pack 2 (KB2572069) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Install Options****/forceappsclose**Forces other programs to close when the computer shuts down.**/nobackup**Do not back up files for uninstall.**/overwriteoem**Overwrite OEM files without prompting.**/integrate:***path*Integrates the software updates into the Windows installation source files located at the path specified. Note that *:path* refers to the folder that contains the i386 folder.**/ER**Enable extended error reporting.**/d:***path*Specifies a backup directory for Windows Service Pack installation. *:path* indicates the destination folder for the backup files. The default backup location is *%Systemdrive%*\\\\$ntservicepackuninstall$.**/extract\\[:***path***\\]**Extracts files without starting Setup. If \"*:path*\" is not included, you are prompted for the path of a destination folder to extract the files. If \"*:path*\" is used, the files are extracted to the specified destination folder.**/hotpatch:disable**Disables hotpatching functionality, and installs the cold patch only.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Logging Options****/log:***path*Allows the redirection of installation log files.**/verbose**Enables verbose logging. During installation, creates *%Windir%*\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Removing the Update** **for** **Microsoft .NET Framework 1.1 Service Pack 1 on Windows Server 2003 x64 Edition Service Pack 2 and Windows Server 2003 Itanium-based Edition Service Pack 2 (KB2572067)** This security update supports the following setup switches. Supported SwitchesSwitchDescription**/?**Displays the command-line options.Setup Modes**/q**Quiet installation.Install Options**/I**Install (default action)**/U**Uninstall**/Xp\\[:path\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.Logging Options**/l<LogFile>**Generate Log File**/l\\[d | p | f \\] <LogFile>**d – Log package detailsp – Log affected productsf – Log included files **Removing the Update for Microsoft .NET Framework 2.0 Service Pack 2 (KB2572073 and Microsoft .NET Framework 4.0 (KB2572078)** This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Vista (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Vista Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista Service Pack 2:Windows6.0-KB2572075-x86.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2:NDP40-KB2572078-x86.exe /qFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Vista x64 Edition Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista x64 Edition Service Pack 2:Windows6.0-KB2572075-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2:NDP40-KB2572078-x64.exe /qInstalling without restartingFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Vista Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista Service Pack 2:Windows6.0-KB2572075-x86.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2:NDP40-KB2572078-x86.exe /norestartFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Vista x64 Edition Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista x64 Edition Service Pack 2:Windows6.0-KB2572075-x64.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2:NDP40-KB2572078-x64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2604930Registry Key VerificationFor Microsoft .NET Framework 1.1 Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.1\\M2572067\"Installed\" = dword:1For Microsoft .NET Framework 2.0 Service Pack 2:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 1.1 Service Pack 1 (KB2572067) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/?**Displays the command-line options.Setup Modes**/q**Quiet installation.Install Options**/I**Install (default action)**/U**Uninstall**/Xp\\[:path\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.Logging Options**/l<LogFile>**Generate Log File**/l\\[d | p | f \\] <LogFile>**d – Log package detailsp – Log affected productsf – Log included files For more information about the installer, visit the [MSDN Web site](http://msdn.microsoft.com/en-us/library/aa367988(vs.85).aspx). For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 2.0 Service Pack 2 (KB2572075) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/?, /h, /help**Displays help on supported switches.Setup Modes**/quiet**Suppresses the display of status or error messages.Restart Options**/norestart**When combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. For more information about the installer, visit the [MSDN Web site](http://msdn.microsoft.com/en-us/library/aa367988(vs.85).aspx). For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 4 (KB2572078) This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for 32-bit Systems Service Pack 2:Windows6.0-KB2572075-x86.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:NDP40-KB2572078-x86.exe /qFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for x64-based Systems Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /quiet /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for x64-based Systems Service Pack 2:Windows6.0-KB2572075-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2:NDP40-KB2572078-x64.exe /qFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /quiet /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 with SP2 for Itanium-based Systems:Windows6.0-KB2572075-ia64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2:NDP40-KB2572078-ia64.exe /qInstalling without restartingFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for 32-bit Systems Service Pack 2:Windows6.0-KB2572075-x86.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:NDP40-KB2572078-x86.exe /norestartFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for x64-based Systems Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for x64-based Systems Service Pack 2:Windows6.0-KB2572075-x64.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2:NDP40-KB2572078-x64.exe /norestartFor Microsoft .NET Framework 1.1 Service Pack 1 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2:NDP1.1sp1-KB2572067-X86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 with SP2 for Itanium-based Systems:Windows6.0-KB2572075-ia64.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2:NDP40-KB2572078-ia64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2604930Registry Key VerificationFor Microsoft .NET Framework 1.1 Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.1\\M2572067\"Installed\" = dword:1For Microsoft .NET Framework 2.0 Service Pack 2:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2 and Windows Server 2008 for Itanium-based Systems Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 1.1 Service Pack 1 (KB2572067) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/?**Displays the command-line options.Setup Modes**/q**Quiet installation.Install Options**/I**Install (default action)**/U**Uninstall**/Xp\\[:path\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.Logging Options**/l<LogFile>**Generate Log File**/l\\[d | p | f \\] <LogFile>**d – Log package detailsp – Log affected productsf – Log included files For more information about the installer, visit the [MSDN Web site](http://msdn.microsoft.com/en-us/library/aa367988(vs.85).aspx). For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 2.0 Service Pack 2 (KB2572075) This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/?, /h, /help**Displays help on supported switches.Setup Modes**/quiet**Suppresses the display of status or error messages.Restart Options**/norestart**When combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. For more information about the installer, visit the [MSDN Web site](http://msdn.microsoft.com/en-us/library/aa367988(vs.85).aspx). For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 4 (KB2572078) This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems:Windows6.1-KB2572076-x86.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems Service Pack 1:Windows6.1-KB2572077-x86.msu /quietFor Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1:NDP40-KB2572078-x86.exe /quietFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems:Windows6.1-KB2572076-x64.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems Service Pack 1:Windows6.1-KB2572077-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1:NDP40-KB2572078-x64.exe /quietInstalling without restartingFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems:Windows6.1-KB2572076-x86.msu /norestartFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems Service Pack 1:Windows6.1-KB2572077-x86.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1:NDP40-KB2572078-x86.exe /norestartFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems:Windows6.1-KB2572076-x64.msu /norestartFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems Service Pack 1:Windows6.1-KB2572077-x64.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1:NDP40-KB2572078-x64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2604930Registry Key VerificationFor Microsoft .NET Framework 3.5.1 on Windows 7:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems:Windows6.1-KB2572076-x64.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems Service Pack 1:Windows6.1-KB2572077-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1:NDP40-KB2572078-x64.exe /quietFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems:Windows6.1-KB2572076-ia64.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:Windows6.1-KB2572077-ia64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:NDP40-KB2572078-ia64.exe/quietInstalling without restartingFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems:Windows6.1-KB2572076-x64.msu /norestartFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems Service Pack 1:Windows6.1-KB2572077-x64.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1:NDP40-KB2572078-x64.exe /norestartFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems:Windows6.1-KB2572076-ia64.msu /norestartFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:Windows6.1-KB2572077-ia64.msu /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:NDP40-KB2572078-ia64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2604930Registry Key VerificationFor Microsoft .NET Framework 3.5.1:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2572078\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: An anonymous contributor working with Beyond Security's SecuriTeam Secure Disclosure program for reporting the .NET Framework Class Inheritance Vulnerability (CVE-2011-1253) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published.V1.1 (October 19, 2011): Corrected the installing without restarting switch information for Microsoft .NET Framework 1.1 Service Pack 1. This is an informational change only. There were no changes to the security update files or detection logic.V1.2 (October 26, 2011): Corrected Server Core installation applicability for .NET Framework 4 on Windows Server 2008 R2 for x64-based Systems.V1.3 (July 10, 2012): Microsoft revised this bulletin to communicate a minor detection change for KB2572073 for Microsoft .NET Framework 2.0 Service Pack 2 to correct an offering issue. There were no changes to the security update files. Customers who have already successfully updated their systems do not need to take any action. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-1895": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-079",
        "title": "Vulnerabilities in Microsoft Forefront Unified Access Gateway Could Cause Remote Code Execution (2544641)",
        "body": "This security update resolves five privately reported vulnerabilities in Microsoft Forefront Unified Access Gateway (UAG). The most severe of these vulnerabilities could allow remote code execution if a user visits an affected Web site using a specially crafted URL. However, an attacker would have no way to force users to visit such a Web site. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. This security update is rated Important for all supported versions of Microsoft Forefront Unified Access Gateway 2010. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerabilities by modifying the way that UAG handles specially crafted requests, modifying the MicrosoftClient.JAR file, and adding exception handling around the null value of the UAG Web server. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. Microsoft recommends that customers apply the update at the earliest opportunity. Known Issues. Microsoft Knowledge Base Article 2544641 documents the currently known issues that customers may experience when installing this security update. The article also documents recommended solutions for these issues. Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Forefront Unified Access Gateway 2010[1](KB2522482)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 1[1](KB2522483)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 2[1](KB2522484)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1[1](KB2522485)Remote Code ExecutionImportantNone [1] This update is available from the Microsoft Download Center only. Please see the next section, **Frequently Asked Questions (FAQ) Related to This Security Update**. Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Why are the updates only available from the Microsoft Download Center?** Microsoft is releasing these updates to the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129) so that customers can begin updating their systems as soon as possible. **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **Is Intelligent Application Gateway (IAG) affected by the vulnerabilities described in this bulletin?** Yes. Microsoft Intelligent Application Gateway 2007 Service Pack 2 is affected by ExcelTable Response Splitting Vulnerability (CVE-2011-1895), ExcelTable Reflected XSS Vulnerability (CVE-2011-1896), Default Reflected XSS Vulnerability (CVE-2011-1897), and Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969). For more information, IAG customers should contact their OEMs. Customers in the U.S. and Canada can also receive technical support from Customer Service and Support at 1-800-936-3100. International customers can also receive technical support from the Services and Field Security Support Team at 1-425-454-7946. Microsoft does not charge for support calls that are associated with security updates. For more information about how to contact Microsoft for support issues, visit [Microsoft Support](http://go.microsoft.com/fwlink/?linkid=21155). **Do administrators need to perform any additional actions after installing this update?** Yes. After installing this update, the UAG administrator needs to open the Forefront UAG Management console and activate the configuration for customers to be protected from the vulnerabilities described in this bulletin. **Why does this update address several reported security vulnerabilities?** This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895ExcelTable Reflected XSS Vulnerability - CVE-2011-1896Default Reflected XSS Vulnerability - CVE-2011-1897Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969Null Session Cookie Crash - CVE-2011-2012Aggregate Severity RatingMicrosoft Forefront Unified Access Gateway 2010Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 2Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportant ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 --------------------------------------------------------------- An HTTP response splitting vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1895](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1895). #### Mitigating Factors for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script contained in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 ------------------------------------------------------ An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1896](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1896). #### Mitigating Factors for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Default Reflected XSS Vulnerability - CVE-2011-1897 --------------------------------------------------- An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1897](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1897). #### Mitigating Factors for Default Reflected XSS Vulnerability - CVE-2011-1897 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for Default Reflected XSS Vulnerability - CVE-2011-1897 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Default Reflected XSS Vulnerability - CVE-2011-1897 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle specially crafted requests, allowing for allows content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, that then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update modifies the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 ------------------------------------------------------------ Microsoft Forefront Unified Access Gateway (UAG) applies a signed Java applet that can be leveraged by malicious Web sites to cause remote code execution on any Java-enabled Web browser. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1969](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1969). #### Mitigating Factors for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. #### Workarounds for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Blacklist the MicrosoftClient.Jar file** Add the entry for the following file: Java\\\\jre6\\\\lib\\\\security\\\\blacklist ``` # UAG Client MicrosoftClient.jar SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g= ``` **Impact of workaround.** MicrosoftClient.JAR will be blocked from running on the system.**How to undo the workaround.** Remove the entry for the following file:Java\\\\jre6\\\\lib\\\\security\\\\blacklist```# UAG Client MicrosoftClient.jarSHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=``` FAQ for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 What is the scope of the vulnerability? This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. What causes the vulnerability? This vulnerability is caused by a vulnerable Java applet that is installed on a browser by the Forefront Unified Access Gateway (UAG) server. What might an attacker use the vulnerability to do? An attacker could use this vulnerability to exploit clients that use UAG. How could an attacker exploit the vulnerability? A remote code execution vulnerability is introduced onto any Java-enabled browser by installing a vulnerable .jar file on client systems. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What systems are primarily at risk from the vulnerability? Client systems that use UAG are affected by this vulnerability. This vulnerability does not allow for compromise of the UAG server. What does the update do? This update modifies the vulnerable .jar file. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Null Session Cookie Crash - CVE-2011-2012 A denial of service vulnerability exists in implementations of Microsoft Forefront Unified Access Gateway (UAG). When this occurs, an attacker could leverage the vulnerability to stop the IIS worker process and deny access to Web services on the affected system. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-2012. Mitigating Factors for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any mitigating factors for this vulnerability. Workarounds for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any workarounds for this vulnerability. FAQ for Null Session Cookie Crash - CVE-2011-2012 What is the scope of the vulnerability? This is a denial of service vulnerability. What causes the vulnerability? This vulnerability is caused by improper validation of a NULL value contained within the session cookie. What might an attacker use the vulnerability to do? An attacker who exploits this vulnerability could use it to crash the web server on the affected UAG machine. How could an attacker exploit the vulnerability? An attacker could exploit this vulnerability by sending specially crafted network traffic to the affected UAG Web server. What systems are primarily at risk from the vulnerability? Systems running UAG Web server. What does the update do? This update adds exception handling around the null value of the UAG Web server. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" These updates will also be provided through our other standard distribution methods once testing has been completed to ensure distribution will be successful through these channels. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Forefront Unified Access Gateway 2010 (all versions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /quietFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /quietInstalling without restartingFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /norestartFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /norestartFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /norestartFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /norestartUpdate log fileFor Forefront Unified Access Gateway 2010 (KB2522482):MSI2522482.logFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):MSI2522483.logFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):MSI2522484.logFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):MSI2522485.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse the Installed Updates window as build-in Administrator or run msiexec from an elevated command line.File InformationFor Forefront Unified Access Gateway 2010 (KB2522482):See Microsoft Knowledge Base Article 2522482For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):See Microsoft Knowledge Base Article 2522483For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):See Microsoft Knowledge Base Article 2522484For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):See Microsoft Knowledge Base Article 2522485Registry Key VerificationFor Forefront Unified Access Gateway 2010 (KB2522482):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\54EBBA62-C7BB-4006-91D2-EFEB0738F93AFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\038FB8C4-F12D-428B-83F5-A964C34B6F2EFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\95244A26-7896-47D2-A49D-1FF43BC1C53CFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\715FC104-32DB-4AAB-A1B9-F1F496F71DE5 Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Note for this update However, you may not combine /quiet and /forcerestart for this update. See this known issue about install switch options in Microsoft Knowledge Base Article 2316074. Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Reflected XSS Vulnerability (CVE-2011-1896)Elisabeth Demeter of SEC Consult Unternehmensberatung GmbH for reporting the Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Forefront Unified Access Gateway 2010[1](KB2522482)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 1[1](KB2522483)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 2[1](KB2522484)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1[1](KB2522485)Remote Code ExecutionImportantNone [1] This update is available from the Microsoft Download Center only. Please see the next section, **Frequently Asked Questions (FAQ) Related to This Security Update**. Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Why are the updates only available from the Microsoft Download Center?** Microsoft is releasing these updates to the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129) so that customers can begin updating their systems as soon as possible. **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **Is Intelligent Application Gateway (IAG) affected by the vulnerabilities described in this bulletin?** Yes. Microsoft Intelligent Application Gateway 2007 Service Pack 2 is affected by ExcelTable Response Splitting Vulnerability (CVE-2011-1895), ExcelTable Reflected XSS Vulnerability (CVE-2011-1896), Default Reflected XSS Vulnerability (CVE-2011-1897), and Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969). For more information, IAG customers should contact their OEMs. Customers in the U.S. and Canada can also receive technical support from Customer Service and Support at 1-800-936-3100. International customers can also receive technical support from the Services and Field Security Support Team at 1-425-454-7946. Microsoft does not charge for support calls that are associated with security updates. For more information about how to contact Microsoft for support issues, visit [Microsoft Support](http://go.microsoft.com/fwlink/?linkid=21155). **Do administrators need to perform any additional actions after installing this update?** Yes. After installing this update, the UAG administrator needs to open the Forefront UAG Management console and activate the configuration for customers to be protected from the vulnerabilities described in this bulletin. **Why does this update address several reported security vulnerabilities?** This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895ExcelTable Reflected XSS Vulnerability - CVE-2011-1896Default Reflected XSS Vulnerability - CVE-2011-1897Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969Null Session Cookie Crash - CVE-2011-2012Aggregate Severity RatingMicrosoft Forefront Unified Access Gateway 2010Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 2Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportant ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 --------------------------------------------------------------- An HTTP response splitting vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1895](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1895). #### Mitigating Factors for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script contained in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 ------------------------------------------------------ An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1896](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1896). #### Mitigating Factors for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Default Reflected XSS Vulnerability - CVE-2011-1897 --------------------------------------------------- An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1897](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1897). #### Mitigating Factors for Default Reflected XSS Vulnerability - CVE-2011-1897 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for Default Reflected XSS Vulnerability - CVE-2011-1897 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Default Reflected XSS Vulnerability - CVE-2011-1897 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle specially crafted requests, allowing for allows content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, that then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update modifies the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 ------------------------------------------------------------ Microsoft Forefront Unified Access Gateway (UAG) applies a signed Java applet that can be leveraged by malicious Web sites to cause remote code execution on any Java-enabled Web browser. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1969](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1969). #### Mitigating Factors for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. #### Workarounds for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Blacklist the MicrosoftClient.Jar file** Add the entry for the following file: Java\\\\jre6\\\\lib\\\\security\\\\blacklist ``` # UAG Client MicrosoftClient.jar SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g= ``` **Impact of workaround.** MicrosoftClient.JAR will be blocked from running on the system.**How to undo the workaround.** Remove the entry for the following file:Java\\\\jre6\\\\lib\\\\security\\\\blacklist```# UAG Client MicrosoftClient.jarSHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=``` FAQ for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 What is the scope of the vulnerability? This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. What causes the vulnerability? This vulnerability is caused by a vulnerable Java applet that is installed on a browser by the Forefront Unified Access Gateway (UAG) server. What might an attacker use the vulnerability to do? An attacker could use this vulnerability to exploit clients that use UAG. How could an attacker exploit the vulnerability? A remote code execution vulnerability is introduced onto any Java-enabled browser by installing a vulnerable .jar file on client systems. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What systems are primarily at risk from the vulnerability? Client systems that use UAG are affected by this vulnerability. This vulnerability does not allow for compromise of the UAG server. What does the update do? This update modifies the vulnerable .jar file. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Null Session Cookie Crash - CVE-2011-2012 A denial of service vulnerability exists in implementations of Microsoft Forefront Unified Access Gateway (UAG). When this occurs, an attacker could leverage the vulnerability to stop the IIS worker process and deny access to Web services on the affected system. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-2012. Mitigating Factors for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any mitigating factors for this vulnerability. Workarounds for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any workarounds for this vulnerability. FAQ for Null Session Cookie Crash - CVE-2011-2012 What is the scope of the vulnerability? This is a denial of service vulnerability. What causes the vulnerability? This vulnerability is caused by improper validation of a NULL value contained within the session cookie. What might an attacker use the vulnerability to do? An attacker who exploits this vulnerability could use it to crash the web server on the affected UAG machine. How could an attacker exploit the vulnerability? An attacker could exploit this vulnerability by sending specially crafted network traffic to the affected UAG Web server. What systems are primarily at risk from the vulnerability? Systems running UAG Web server. What does the update do? This update adds exception handling around the null value of the UAG Web server. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" These updates will also be provided through our other standard distribution methods once testing has been completed to ensure distribution will be successful through these channels. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Forefront Unified Access Gateway 2010 (all versions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /quietFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /quietInstalling without restartingFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /norestartFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /norestartFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /norestartFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /norestartUpdate log fileFor Forefront Unified Access Gateway 2010 (KB2522482):MSI2522482.logFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):MSI2522483.logFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):MSI2522484.logFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):MSI2522485.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse the Installed Updates window as build-in Administrator or run msiexec from an elevated command line.File InformationFor Forefront Unified Access Gateway 2010 (KB2522482):See Microsoft Knowledge Base Article 2522482For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):See Microsoft Knowledge Base Article 2522483For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):See Microsoft Knowledge Base Article 2522484For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):See Microsoft Knowledge Base Article 2522485Registry Key VerificationFor Forefront Unified Access Gateway 2010 (KB2522482):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\54EBBA62-C7BB-4006-91D2-EFEB0738F93AFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\038FB8C4-F12D-428B-83F5-A964C34B6F2EFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\95244A26-7896-47D2-A49D-1FF43BC1C53CFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\715FC104-32DB-4AAB-A1B9-F1F496F71DE5 Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Note for this update However, you may not combine /quiet and /forcerestart for this update. See this known issue about install switch options in Microsoft Knowledge Base Article 2316074. Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Reflected XSS Vulnerability (CVE-2011-1896)Elisabeth Demeter of SEC Consult Unternehmensberatung GmbH for reporting the Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-1896": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-079",
        "title": "Vulnerabilities in Microsoft Forefront Unified Access Gateway Could Cause Remote Code Execution (2544641)",
        "body": "This security update resolves five privately reported vulnerabilities in Microsoft Forefront Unified Access Gateway (UAG). The most severe of these vulnerabilities could allow remote code execution if a user visits an affected Web site using a specially crafted URL. However, an attacker would have no way to force users to visit such a Web site. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. This security update is rated Important for all supported versions of Microsoft Forefront Unified Access Gateway 2010. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerabilities by modifying the way that UAG handles specially crafted requests, modifying the MicrosoftClient.JAR file, and adding exception handling around the null value of the UAG Web server. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. Microsoft recommends that customers apply the update at the earliest opportunity. Known Issues. Microsoft Knowledge Base Article 2544641 documents the currently known issues that customers may experience when installing this security update. The article also documents recommended solutions for these issues. Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Forefront Unified Access Gateway 2010[1](KB2522482)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 1[1](KB2522483)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 2[1](KB2522484)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1[1](KB2522485)Remote Code ExecutionImportantNone [1] This update is available from the Microsoft Download Center only. Please see the next section, **Frequently Asked Questions (FAQ) Related to This Security Update**. Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Why are the updates only available from the Microsoft Download Center?** Microsoft is releasing these updates to the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129) so that customers can begin updating their systems as soon as possible. **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **Is Intelligent Application Gateway (IAG) affected by the vulnerabilities described in this bulletin?** Yes. Microsoft Intelligent Application Gateway 2007 Service Pack 2 is affected by ExcelTable Response Splitting Vulnerability (CVE-2011-1895), ExcelTable Reflected XSS Vulnerability (CVE-2011-1896), Default Reflected XSS Vulnerability (CVE-2011-1897), and Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969). For more information, IAG customers should contact their OEMs. Customers in the U.S. and Canada can also receive technical support from Customer Service and Support at 1-800-936-3100. International customers can also receive technical support from the Services and Field Security Support Team at 1-425-454-7946. Microsoft does not charge for support calls that are associated with security updates. For more information about how to contact Microsoft for support issues, visit [Microsoft Support](http://go.microsoft.com/fwlink/?linkid=21155). **Do administrators need to perform any additional actions after installing this update?** Yes. After installing this update, the UAG administrator needs to open the Forefront UAG Management console and activate the configuration for customers to be protected from the vulnerabilities described in this bulletin. **Why does this update address several reported security vulnerabilities?** This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895ExcelTable Reflected XSS Vulnerability - CVE-2011-1896Default Reflected XSS Vulnerability - CVE-2011-1897Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969Null Session Cookie Crash - CVE-2011-2012Aggregate Severity RatingMicrosoft Forefront Unified Access Gateway 2010Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 2Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportant ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 --------------------------------------------------------------- An HTTP response splitting vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1895](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1895). #### Mitigating Factors for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script contained in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 ------------------------------------------------------ An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1896](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1896). #### Mitigating Factors for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Default Reflected XSS Vulnerability - CVE-2011-1897 --------------------------------------------------- An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1897](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1897). #### Mitigating Factors for Default Reflected XSS Vulnerability - CVE-2011-1897 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for Default Reflected XSS Vulnerability - CVE-2011-1897 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Default Reflected XSS Vulnerability - CVE-2011-1897 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle specially crafted requests, allowing for allows content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, that then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update modifies the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 ------------------------------------------------------------ Microsoft Forefront Unified Access Gateway (UAG) applies a signed Java applet that can be leveraged by malicious Web sites to cause remote code execution on any Java-enabled Web browser. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1969](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1969). #### Mitigating Factors for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. #### Workarounds for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Blacklist the MicrosoftClient.Jar file** Add the entry for the following file: Java\\\\jre6\\\\lib\\\\security\\\\blacklist ``` # UAG Client MicrosoftClient.jar SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g= ``` **Impact of workaround.** MicrosoftClient.JAR will be blocked from running on the system.**How to undo the workaround.** Remove the entry for the following file:Java\\\\jre6\\\\lib\\\\security\\\\blacklist```# UAG Client MicrosoftClient.jarSHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=``` FAQ for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 What is the scope of the vulnerability? This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. What causes the vulnerability? This vulnerability is caused by a vulnerable Java applet that is installed on a browser by the Forefront Unified Access Gateway (UAG) server. What might an attacker use the vulnerability to do? An attacker could use this vulnerability to exploit clients that use UAG. How could an attacker exploit the vulnerability? A remote code execution vulnerability is introduced onto any Java-enabled browser by installing a vulnerable .jar file on client systems. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What systems are primarily at risk from the vulnerability? Client systems that use UAG are affected by this vulnerability. This vulnerability does not allow for compromise of the UAG server. What does the update do? This update modifies the vulnerable .jar file. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Null Session Cookie Crash - CVE-2011-2012 A denial of service vulnerability exists in implementations of Microsoft Forefront Unified Access Gateway (UAG). When this occurs, an attacker could leverage the vulnerability to stop the IIS worker process and deny access to Web services on the affected system. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-2012. Mitigating Factors for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any mitigating factors for this vulnerability. Workarounds for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any workarounds for this vulnerability. FAQ for Null Session Cookie Crash - CVE-2011-2012 What is the scope of the vulnerability? This is a denial of service vulnerability. What causes the vulnerability? This vulnerability is caused by improper validation of a NULL value contained within the session cookie. What might an attacker use the vulnerability to do? An attacker who exploits this vulnerability could use it to crash the web server on the affected UAG machine. How could an attacker exploit the vulnerability? An attacker could exploit this vulnerability by sending specially crafted network traffic to the affected UAG Web server. What systems are primarily at risk from the vulnerability? Systems running UAG Web server. What does the update do? This update adds exception handling around the null value of the UAG Web server. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" These updates will also be provided through our other standard distribution methods once testing has been completed to ensure distribution will be successful through these channels. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Forefront Unified Access Gateway 2010 (all versions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /quietFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /quietInstalling without restartingFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /norestartFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /norestartFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /norestartFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /norestartUpdate log fileFor Forefront Unified Access Gateway 2010 (KB2522482):MSI2522482.logFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):MSI2522483.logFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):MSI2522484.logFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):MSI2522485.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse the Installed Updates window as build-in Administrator or run msiexec from an elevated command line.File InformationFor Forefront Unified Access Gateway 2010 (KB2522482):See Microsoft Knowledge Base Article 2522482For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):See Microsoft Knowledge Base Article 2522483For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):See Microsoft Knowledge Base Article 2522484For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):See Microsoft Knowledge Base Article 2522485Registry Key VerificationFor Forefront Unified Access Gateway 2010 (KB2522482):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\54EBBA62-C7BB-4006-91D2-EFEB0738F93AFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\038FB8C4-F12D-428B-83F5-A964C34B6F2EFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\95244A26-7896-47D2-A49D-1FF43BC1C53CFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\715FC104-32DB-4AAB-A1B9-F1F496F71DE5 Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Note for this update However, you may not combine /quiet and /forcerestart for this update. See this known issue about install switch options in Microsoft Knowledge Base Article 2316074. Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Reflected XSS Vulnerability (CVE-2011-1896)Elisabeth Demeter of SEC Consult Unternehmensberatung GmbH for reporting the Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Forefront Unified Access Gateway 2010[1](KB2522482)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 1[1](KB2522483)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 2[1](KB2522484)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1[1](KB2522485)Remote Code ExecutionImportantNone [1] This update is available from the Microsoft Download Center only. Please see the next section, **Frequently Asked Questions (FAQ) Related to This Security Update**. Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Why are the updates only available from the Microsoft Download Center?** Microsoft is releasing these updates to the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129) so that customers can begin updating their systems as soon as possible. **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **Is Intelligent Application Gateway (IAG) affected by the vulnerabilities described in this bulletin?** Yes. Microsoft Intelligent Application Gateway 2007 Service Pack 2 is affected by ExcelTable Response Splitting Vulnerability (CVE-2011-1895), ExcelTable Reflected XSS Vulnerability (CVE-2011-1896), Default Reflected XSS Vulnerability (CVE-2011-1897), and Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969). For more information, IAG customers should contact their OEMs. Customers in the U.S. and Canada can also receive technical support from Customer Service and Support at 1-800-936-3100. International customers can also receive technical support from the Services and Field Security Support Team at 1-425-454-7946. Microsoft does not charge for support calls that are associated with security updates. For more information about how to contact Microsoft for support issues, visit [Microsoft Support](http://go.microsoft.com/fwlink/?linkid=21155). **Do administrators need to perform any additional actions after installing this update?** Yes. After installing this update, the UAG administrator needs to open the Forefront UAG Management console and activate the configuration for customers to be protected from the vulnerabilities described in this bulletin. **Why does this update address several reported security vulnerabilities?** This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895ExcelTable Reflected XSS Vulnerability - CVE-2011-1896Default Reflected XSS Vulnerability - CVE-2011-1897Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969Null Session Cookie Crash - CVE-2011-2012Aggregate Severity RatingMicrosoft Forefront Unified Access Gateway 2010Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 2Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportant ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 --------------------------------------------------------------- An HTTP response splitting vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1895](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1895). #### Mitigating Factors for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script contained in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 ------------------------------------------------------ An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1896](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1896). #### Mitigating Factors for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Default Reflected XSS Vulnerability - CVE-2011-1897 --------------------------------------------------- An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1897](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1897). #### Mitigating Factors for Default Reflected XSS Vulnerability - CVE-2011-1897 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for Default Reflected XSS Vulnerability - CVE-2011-1897 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Default Reflected XSS Vulnerability - CVE-2011-1897 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle specially crafted requests, allowing for allows content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, that then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update modifies the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 ------------------------------------------------------------ Microsoft Forefront Unified Access Gateway (UAG) applies a signed Java applet that can be leveraged by malicious Web sites to cause remote code execution on any Java-enabled Web browser. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1969](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1969). #### Mitigating Factors for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. #### Workarounds for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Blacklist the MicrosoftClient.Jar file** Add the entry for the following file: Java\\\\jre6\\\\lib\\\\security\\\\blacklist ``` # UAG Client MicrosoftClient.jar SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g= ``` **Impact of workaround.** MicrosoftClient.JAR will be blocked from running on the system.**How to undo the workaround.** Remove the entry for the following file:Java\\\\jre6\\\\lib\\\\security\\\\blacklist```# UAG Client MicrosoftClient.jarSHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=``` FAQ for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 What is the scope of the vulnerability? This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. What causes the vulnerability? This vulnerability is caused by a vulnerable Java applet that is installed on a browser by the Forefront Unified Access Gateway (UAG) server. What might an attacker use the vulnerability to do? An attacker could use this vulnerability to exploit clients that use UAG. How could an attacker exploit the vulnerability? A remote code execution vulnerability is introduced onto any Java-enabled browser by installing a vulnerable .jar file on client systems. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What systems are primarily at risk from the vulnerability? Client systems that use UAG are affected by this vulnerability. This vulnerability does not allow for compromise of the UAG server. What does the update do? This update modifies the vulnerable .jar file. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Null Session Cookie Crash - CVE-2011-2012 A denial of service vulnerability exists in implementations of Microsoft Forefront Unified Access Gateway (UAG). When this occurs, an attacker could leverage the vulnerability to stop the IIS worker process and deny access to Web services on the affected system. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-2012. Mitigating Factors for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any mitigating factors for this vulnerability. Workarounds for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any workarounds for this vulnerability. FAQ for Null Session Cookie Crash - CVE-2011-2012 What is the scope of the vulnerability? This is a denial of service vulnerability. What causes the vulnerability? This vulnerability is caused by improper validation of a NULL value contained within the session cookie. What might an attacker use the vulnerability to do? An attacker who exploits this vulnerability could use it to crash the web server on the affected UAG machine. How could an attacker exploit the vulnerability? An attacker could exploit this vulnerability by sending specially crafted network traffic to the affected UAG Web server. What systems are primarily at risk from the vulnerability? Systems running UAG Web server. What does the update do? This update adds exception handling around the null value of the UAG Web server. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" These updates will also be provided through our other standard distribution methods once testing has been completed to ensure distribution will be successful through these channels. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Forefront Unified Access Gateway 2010 (all versions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /quietFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /quietInstalling without restartingFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /norestartFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /norestartFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /norestartFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /norestartUpdate log fileFor Forefront Unified Access Gateway 2010 (KB2522482):MSI2522482.logFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):MSI2522483.logFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):MSI2522484.logFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):MSI2522485.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse the Installed Updates window as build-in Administrator or run msiexec from an elevated command line.File InformationFor Forefront Unified Access Gateway 2010 (KB2522482):See Microsoft Knowledge Base Article 2522482For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):See Microsoft Knowledge Base Article 2522483For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):See Microsoft Knowledge Base Article 2522484For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):See Microsoft Knowledge Base Article 2522485Registry Key VerificationFor Forefront Unified Access Gateway 2010 (KB2522482):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\54EBBA62-C7BB-4006-91D2-EFEB0738F93AFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\038FB8C4-F12D-428B-83F5-A964C34B6F2EFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\95244A26-7896-47D2-A49D-1FF43BC1C53CFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\715FC104-32DB-4AAB-A1B9-F1F496F71DE5 Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Note for this update However, you may not combine /quiet and /forcerestart for this update. See this known issue about install switch options in Microsoft Knowledge Base Article 2316074. Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Reflected XSS Vulnerability (CVE-2011-1896)Elisabeth Demeter of SEC Consult Unternehmensberatung GmbH for reporting the Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-1897": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-079",
        "title": "Vulnerabilities in Microsoft Forefront Unified Access Gateway Could Cause Remote Code Execution (2544641)",
        "body": "This security update resolves five privately reported vulnerabilities in Microsoft Forefront Unified Access Gateway (UAG). The most severe of these vulnerabilities could allow remote code execution if a user visits an affected Web site using a specially crafted URL. However, an attacker would have no way to force users to visit such a Web site. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. This security update is rated Important for all supported versions of Microsoft Forefront Unified Access Gateway 2010. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerabilities by modifying the way that UAG handles specially crafted requests, modifying the MicrosoftClient.JAR file, and adding exception handling around the null value of the UAG Web server. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. Microsoft recommends that customers apply the update at the earliest opportunity. Known Issues. Microsoft Knowledge Base Article 2544641 documents the currently known issues that customers may experience when installing this security update. The article also documents recommended solutions for these issues. Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Forefront Unified Access Gateway 2010[1](KB2522482)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 1[1](KB2522483)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 2[1](KB2522484)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1[1](KB2522485)Remote Code ExecutionImportantNone [1] This update is available from the Microsoft Download Center only. Please see the next section, **Frequently Asked Questions (FAQ) Related to This Security Update**. Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Why are the updates only available from the Microsoft Download Center?** Microsoft is releasing these updates to the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129) so that customers can begin updating their systems as soon as possible. **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **Is Intelligent Application Gateway (IAG) affected by the vulnerabilities described in this bulletin?** Yes. Microsoft Intelligent Application Gateway 2007 Service Pack 2 is affected by ExcelTable Response Splitting Vulnerability (CVE-2011-1895), ExcelTable Reflected XSS Vulnerability (CVE-2011-1896), Default Reflected XSS Vulnerability (CVE-2011-1897), and Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969). For more information, IAG customers should contact their OEMs. Customers in the U.S. and Canada can also receive technical support from Customer Service and Support at 1-800-936-3100. International customers can also receive technical support from the Services and Field Security Support Team at 1-425-454-7946. Microsoft does not charge for support calls that are associated with security updates. For more information about how to contact Microsoft for support issues, visit [Microsoft Support](http://go.microsoft.com/fwlink/?linkid=21155). **Do administrators need to perform any additional actions after installing this update?** Yes. After installing this update, the UAG administrator needs to open the Forefront UAG Management console and activate the configuration for customers to be protected from the vulnerabilities described in this bulletin. **Why does this update address several reported security vulnerabilities?** This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895ExcelTable Reflected XSS Vulnerability - CVE-2011-1896Default Reflected XSS Vulnerability - CVE-2011-1897Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969Null Session Cookie Crash - CVE-2011-2012Aggregate Severity RatingMicrosoft Forefront Unified Access Gateway 2010Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 2Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportant ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 --------------------------------------------------------------- An HTTP response splitting vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1895](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1895). #### Mitigating Factors for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script contained in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 ------------------------------------------------------ An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1896](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1896). #### Mitigating Factors for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Default Reflected XSS Vulnerability - CVE-2011-1897 --------------------------------------------------- An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1897](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1897). #### Mitigating Factors for Default Reflected XSS Vulnerability - CVE-2011-1897 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for Default Reflected XSS Vulnerability - CVE-2011-1897 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Default Reflected XSS Vulnerability - CVE-2011-1897 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle specially crafted requests, allowing for allows content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, that then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update modifies the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 ------------------------------------------------------------ Microsoft Forefront Unified Access Gateway (UAG) applies a signed Java applet that can be leveraged by malicious Web sites to cause remote code execution on any Java-enabled Web browser. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1969](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1969). #### Mitigating Factors for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. #### Workarounds for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Blacklist the MicrosoftClient.Jar file** Add the entry for the following file: Java\\\\jre6\\\\lib\\\\security\\\\blacklist ``` # UAG Client MicrosoftClient.jar SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g= ``` **Impact of workaround.** MicrosoftClient.JAR will be blocked from running on the system.**How to undo the workaround.** Remove the entry for the following file:Java\\\\jre6\\\\lib\\\\security\\\\blacklist```# UAG Client MicrosoftClient.jarSHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=``` FAQ for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 What is the scope of the vulnerability? This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. What causes the vulnerability? This vulnerability is caused by a vulnerable Java applet that is installed on a browser by the Forefront Unified Access Gateway (UAG) server. What might an attacker use the vulnerability to do? An attacker could use this vulnerability to exploit clients that use UAG. How could an attacker exploit the vulnerability? A remote code execution vulnerability is introduced onto any Java-enabled browser by installing a vulnerable .jar file on client systems. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What systems are primarily at risk from the vulnerability? Client systems that use UAG are affected by this vulnerability. This vulnerability does not allow for compromise of the UAG server. What does the update do? This update modifies the vulnerable .jar file. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Null Session Cookie Crash - CVE-2011-2012 A denial of service vulnerability exists in implementations of Microsoft Forefront Unified Access Gateway (UAG). When this occurs, an attacker could leverage the vulnerability to stop the IIS worker process and deny access to Web services on the affected system. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-2012. Mitigating Factors for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any mitigating factors for this vulnerability. Workarounds for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any workarounds for this vulnerability. FAQ for Null Session Cookie Crash - CVE-2011-2012 What is the scope of the vulnerability? This is a denial of service vulnerability. What causes the vulnerability? This vulnerability is caused by improper validation of a NULL value contained within the session cookie. What might an attacker use the vulnerability to do? An attacker who exploits this vulnerability could use it to crash the web server on the affected UAG machine. How could an attacker exploit the vulnerability? An attacker could exploit this vulnerability by sending specially crafted network traffic to the affected UAG Web server. What systems are primarily at risk from the vulnerability? Systems running UAG Web server. What does the update do? This update adds exception handling around the null value of the UAG Web server. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" These updates will also be provided through our other standard distribution methods once testing has been completed to ensure distribution will be successful through these channels. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Forefront Unified Access Gateway 2010 (all versions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /quietFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /quietInstalling without restartingFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /norestartFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /norestartFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /norestartFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /norestartUpdate log fileFor Forefront Unified Access Gateway 2010 (KB2522482):MSI2522482.logFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):MSI2522483.logFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):MSI2522484.logFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):MSI2522485.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse the Installed Updates window as build-in Administrator or run msiexec from an elevated command line.File InformationFor Forefront Unified Access Gateway 2010 (KB2522482):See Microsoft Knowledge Base Article 2522482For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):See Microsoft Knowledge Base Article 2522483For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):See Microsoft Knowledge Base Article 2522484For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):See Microsoft Knowledge Base Article 2522485Registry Key VerificationFor Forefront Unified Access Gateway 2010 (KB2522482):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\54EBBA62-C7BB-4006-91D2-EFEB0738F93AFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\038FB8C4-F12D-428B-83F5-A964C34B6F2EFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\95244A26-7896-47D2-A49D-1FF43BC1C53CFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\715FC104-32DB-4AAB-A1B9-F1F496F71DE5 Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Note for this update However, you may not combine /quiet and /forcerestart for this update. See this known issue about install switch options in Microsoft Knowledge Base Article 2316074. Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Reflected XSS Vulnerability (CVE-2011-1896)Elisabeth Demeter of SEC Consult Unternehmensberatung GmbH for reporting the Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Forefront Unified Access Gateway 2010[1](KB2522482)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 1[1](KB2522483)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 2[1](KB2522484)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1[1](KB2522485)Remote Code ExecutionImportantNone [1] This update is available from the Microsoft Download Center only. Please see the next section, **Frequently Asked Questions (FAQ) Related to This Security Update**. Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Why are the updates only available from the Microsoft Download Center?** Microsoft is releasing these updates to the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129) so that customers can begin updating their systems as soon as possible. **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **Is Intelligent Application Gateway (IAG) affected by the vulnerabilities described in this bulletin?** Yes. Microsoft Intelligent Application Gateway 2007 Service Pack 2 is affected by ExcelTable Response Splitting Vulnerability (CVE-2011-1895), ExcelTable Reflected XSS Vulnerability (CVE-2011-1896), Default Reflected XSS Vulnerability (CVE-2011-1897), and Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969). For more information, IAG customers should contact their OEMs. Customers in the U.S. and Canada can also receive technical support from Customer Service and Support at 1-800-936-3100. International customers can also receive technical support from the Services and Field Security Support Team at 1-425-454-7946. Microsoft does not charge for support calls that are associated with security updates. For more information about how to contact Microsoft for support issues, visit [Microsoft Support](http://go.microsoft.com/fwlink/?linkid=21155). **Do administrators need to perform any additional actions after installing this update?** Yes. After installing this update, the UAG administrator needs to open the Forefront UAG Management console and activate the configuration for customers to be protected from the vulnerabilities described in this bulletin. **Why does this update address several reported security vulnerabilities?** This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895ExcelTable Reflected XSS Vulnerability - CVE-2011-1896Default Reflected XSS Vulnerability - CVE-2011-1897Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969Null Session Cookie Crash - CVE-2011-2012Aggregate Severity RatingMicrosoft Forefront Unified Access Gateway 2010Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 2Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportant ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 --------------------------------------------------------------- An HTTP response splitting vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1895](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1895). #### Mitigating Factors for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script contained in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 ------------------------------------------------------ An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1896](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1896). #### Mitigating Factors for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Default Reflected XSS Vulnerability - CVE-2011-1897 --------------------------------------------------- An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1897](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1897). #### Mitigating Factors for Default Reflected XSS Vulnerability - CVE-2011-1897 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for Default Reflected XSS Vulnerability - CVE-2011-1897 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Default Reflected XSS Vulnerability - CVE-2011-1897 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle specially crafted requests, allowing for allows content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, that then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update modifies the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 ------------------------------------------------------------ Microsoft Forefront Unified Access Gateway (UAG) applies a signed Java applet that can be leveraged by malicious Web sites to cause remote code execution on any Java-enabled Web browser. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1969](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1969). #### Mitigating Factors for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. #### Workarounds for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Blacklist the MicrosoftClient.Jar file** Add the entry for the following file: Java\\\\jre6\\\\lib\\\\security\\\\blacklist ``` # UAG Client MicrosoftClient.jar SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g= ``` **Impact of workaround.** MicrosoftClient.JAR will be blocked from running on the system.**How to undo the workaround.** Remove the entry for the following file:Java\\\\jre6\\\\lib\\\\security\\\\blacklist```# UAG Client MicrosoftClient.jarSHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=``` FAQ for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 What is the scope of the vulnerability? This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. What causes the vulnerability? This vulnerability is caused by a vulnerable Java applet that is installed on a browser by the Forefront Unified Access Gateway (UAG) server. What might an attacker use the vulnerability to do? An attacker could use this vulnerability to exploit clients that use UAG. How could an attacker exploit the vulnerability? A remote code execution vulnerability is introduced onto any Java-enabled browser by installing a vulnerable .jar file on client systems. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What systems are primarily at risk from the vulnerability? Client systems that use UAG are affected by this vulnerability. This vulnerability does not allow for compromise of the UAG server. What does the update do? This update modifies the vulnerable .jar file. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Null Session Cookie Crash - CVE-2011-2012 A denial of service vulnerability exists in implementations of Microsoft Forefront Unified Access Gateway (UAG). When this occurs, an attacker could leverage the vulnerability to stop the IIS worker process and deny access to Web services on the affected system. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-2012. Mitigating Factors for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any mitigating factors for this vulnerability. Workarounds for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any workarounds for this vulnerability. FAQ for Null Session Cookie Crash - CVE-2011-2012 What is the scope of the vulnerability? This is a denial of service vulnerability. What causes the vulnerability? This vulnerability is caused by improper validation of a NULL value contained within the session cookie. What might an attacker use the vulnerability to do? An attacker who exploits this vulnerability could use it to crash the web server on the affected UAG machine. How could an attacker exploit the vulnerability? An attacker could exploit this vulnerability by sending specially crafted network traffic to the affected UAG Web server. What systems are primarily at risk from the vulnerability? Systems running UAG Web server. What does the update do? This update adds exception handling around the null value of the UAG Web server. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" These updates will also be provided through our other standard distribution methods once testing has been completed to ensure distribution will be successful through these channels. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Forefront Unified Access Gateway 2010 (all versions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /quietFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /quietInstalling without restartingFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /norestartFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /norestartFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /norestartFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /norestartUpdate log fileFor Forefront Unified Access Gateway 2010 (KB2522482):MSI2522482.logFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):MSI2522483.logFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):MSI2522484.logFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):MSI2522485.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse the Installed Updates window as build-in Administrator or run msiexec from an elevated command line.File InformationFor Forefront Unified Access Gateway 2010 (KB2522482):See Microsoft Knowledge Base Article 2522482For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):See Microsoft Knowledge Base Article 2522483For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):See Microsoft Knowledge Base Article 2522484For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):See Microsoft Knowledge Base Article 2522485Registry Key VerificationFor Forefront Unified Access Gateway 2010 (KB2522482):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\54EBBA62-C7BB-4006-91D2-EFEB0738F93AFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\038FB8C4-F12D-428B-83F5-A964C34B6F2EFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\95244A26-7896-47D2-A49D-1FF43BC1C53CFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\715FC104-32DB-4AAB-A1B9-F1F496F71DE5 Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Note for this update However, you may not combine /quiet and /forcerestart for this update. See this known issue about install switch options in Microsoft Knowledge Base Article 2316074. Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Reflected XSS Vulnerability (CVE-2011-1896)Elisabeth Demeter of SEC Consult Unternehmensberatung GmbH for reporting the Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-1969": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-079",
        "title": "Vulnerabilities in Microsoft Forefront Unified Access Gateway Could Cause Remote Code Execution (2544641)",
        "body": "This security update resolves five privately reported vulnerabilities in Microsoft Forefront Unified Access Gateway (UAG). The most severe of these vulnerabilities could allow remote code execution if a user visits an affected Web site using a specially crafted URL. However, an attacker would have no way to force users to visit such a Web site. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. This security update is rated Important for all supported versions of Microsoft Forefront Unified Access Gateway 2010. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerabilities by modifying the way that UAG handles specially crafted requests, modifying the MicrosoftClient.JAR file, and adding exception handling around the null value of the UAG Web server. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. Microsoft recommends that customers apply the update at the earliest opportunity. Known Issues. Microsoft Knowledge Base Article 2544641 documents the currently known issues that customers may experience when installing this security update. The article also documents recommended solutions for these issues. Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Forefront Unified Access Gateway 2010[1](KB2522482)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 1[1](KB2522483)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 2[1](KB2522484)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1[1](KB2522485)Remote Code ExecutionImportantNone [1] This update is available from the Microsoft Download Center only. Please see the next section, **Frequently Asked Questions (FAQ) Related to This Security Update**. Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Why are the updates only available from the Microsoft Download Center?** Microsoft is releasing these updates to the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129) so that customers can begin updating their systems as soon as possible. **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **Is Intelligent Application Gateway (IAG) affected by the vulnerabilities described in this bulletin?** Yes. Microsoft Intelligent Application Gateway 2007 Service Pack 2 is affected by ExcelTable Response Splitting Vulnerability (CVE-2011-1895), ExcelTable Reflected XSS Vulnerability (CVE-2011-1896), Default Reflected XSS Vulnerability (CVE-2011-1897), and Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969). For more information, IAG customers should contact their OEMs. Customers in the U.S. and Canada can also receive technical support from Customer Service and Support at 1-800-936-3100. International customers can also receive technical support from the Services and Field Security Support Team at 1-425-454-7946. Microsoft does not charge for support calls that are associated with security updates. For more information about how to contact Microsoft for support issues, visit [Microsoft Support](http://go.microsoft.com/fwlink/?linkid=21155). **Do administrators need to perform any additional actions after installing this update?** Yes. After installing this update, the UAG administrator needs to open the Forefront UAG Management console and activate the configuration for customers to be protected from the vulnerabilities described in this bulletin. **Why does this update address several reported security vulnerabilities?** This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895ExcelTable Reflected XSS Vulnerability - CVE-2011-1896Default Reflected XSS Vulnerability - CVE-2011-1897Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969Null Session Cookie Crash - CVE-2011-2012Aggregate Severity RatingMicrosoft Forefront Unified Access Gateway 2010Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 2Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportant ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 --------------------------------------------------------------- An HTTP response splitting vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1895](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1895). #### Mitigating Factors for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script contained in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 ------------------------------------------------------ An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1896](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1896). #### Mitigating Factors for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Default Reflected XSS Vulnerability - CVE-2011-1897 --------------------------------------------------- An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1897](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1897). #### Mitigating Factors for Default Reflected XSS Vulnerability - CVE-2011-1897 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for Default Reflected XSS Vulnerability - CVE-2011-1897 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Default Reflected XSS Vulnerability - CVE-2011-1897 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle specially crafted requests, allowing for allows content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, that then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update modifies the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 ------------------------------------------------------------ Microsoft Forefront Unified Access Gateway (UAG) applies a signed Java applet that can be leveraged by malicious Web sites to cause remote code execution on any Java-enabled Web browser. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1969](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1969). #### Mitigating Factors for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. #### Workarounds for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Blacklist the MicrosoftClient.Jar file** Add the entry for the following file: Java\\\\jre6\\\\lib\\\\security\\\\blacklist ``` # UAG Client MicrosoftClient.jar SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g= ``` **Impact of workaround.** MicrosoftClient.JAR will be blocked from running on the system.**How to undo the workaround.** Remove the entry for the following file:Java\\\\jre6\\\\lib\\\\security\\\\blacklist```# UAG Client MicrosoftClient.jarSHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=``` FAQ for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 What is the scope of the vulnerability? This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. What causes the vulnerability? This vulnerability is caused by a vulnerable Java applet that is installed on a browser by the Forefront Unified Access Gateway (UAG) server. What might an attacker use the vulnerability to do? An attacker could use this vulnerability to exploit clients that use UAG. How could an attacker exploit the vulnerability? A remote code execution vulnerability is introduced onto any Java-enabled browser by installing a vulnerable .jar file on client systems. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What systems are primarily at risk from the vulnerability? Client systems that use UAG are affected by this vulnerability. This vulnerability does not allow for compromise of the UAG server. What does the update do? This update modifies the vulnerable .jar file. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Null Session Cookie Crash - CVE-2011-2012 A denial of service vulnerability exists in implementations of Microsoft Forefront Unified Access Gateway (UAG). When this occurs, an attacker could leverage the vulnerability to stop the IIS worker process and deny access to Web services on the affected system. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-2012. Mitigating Factors for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any mitigating factors for this vulnerability. Workarounds for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any workarounds for this vulnerability. FAQ for Null Session Cookie Crash - CVE-2011-2012 What is the scope of the vulnerability? This is a denial of service vulnerability. What causes the vulnerability? This vulnerability is caused by improper validation of a NULL value contained within the session cookie. What might an attacker use the vulnerability to do? An attacker who exploits this vulnerability could use it to crash the web server on the affected UAG machine. How could an attacker exploit the vulnerability? An attacker could exploit this vulnerability by sending specially crafted network traffic to the affected UAG Web server. What systems are primarily at risk from the vulnerability? Systems running UAG Web server. What does the update do? This update adds exception handling around the null value of the UAG Web server. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" These updates will also be provided through our other standard distribution methods once testing has been completed to ensure distribution will be successful through these channels. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Forefront Unified Access Gateway 2010 (all versions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /quietFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /quietInstalling without restartingFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /norestartFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /norestartFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /norestartFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /norestartUpdate log fileFor Forefront Unified Access Gateway 2010 (KB2522482):MSI2522482.logFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):MSI2522483.logFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):MSI2522484.logFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):MSI2522485.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse the Installed Updates window as build-in Administrator or run msiexec from an elevated command line.File InformationFor Forefront Unified Access Gateway 2010 (KB2522482):See Microsoft Knowledge Base Article 2522482For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):See Microsoft Knowledge Base Article 2522483For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):See Microsoft Knowledge Base Article 2522484For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):See Microsoft Knowledge Base Article 2522485Registry Key VerificationFor Forefront Unified Access Gateway 2010 (KB2522482):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\54EBBA62-C7BB-4006-91D2-EFEB0738F93AFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\038FB8C4-F12D-428B-83F5-A964C34B6F2EFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\95244A26-7896-47D2-A49D-1FF43BC1C53CFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\715FC104-32DB-4AAB-A1B9-F1F496F71DE5 Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Note for this update However, you may not combine /quiet and /forcerestart for this update. See this known issue about install switch options in Microsoft Knowledge Base Article 2316074. Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Reflected XSS Vulnerability (CVE-2011-1896)Elisabeth Demeter of SEC Consult Unternehmensberatung GmbH for reporting the Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Forefront Unified Access Gateway 2010[1](KB2522482)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 1[1](KB2522483)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 2[1](KB2522484)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1[1](KB2522485)Remote Code ExecutionImportantNone [1] This update is available from the Microsoft Download Center only. Please see the next section, **Frequently Asked Questions (FAQ) Related to This Security Update**. Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Why are the updates only available from the Microsoft Download Center?** Microsoft is releasing these updates to the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129) so that customers can begin updating their systems as soon as possible. **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **Is Intelligent Application Gateway (IAG) affected by the vulnerabilities described in this bulletin?** Yes. Microsoft Intelligent Application Gateway 2007 Service Pack 2 is affected by ExcelTable Response Splitting Vulnerability (CVE-2011-1895), ExcelTable Reflected XSS Vulnerability (CVE-2011-1896), Default Reflected XSS Vulnerability (CVE-2011-1897), and Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969). For more information, IAG customers should contact their OEMs. Customers in the U.S. and Canada can also receive technical support from Customer Service and Support at 1-800-936-3100. International customers can also receive technical support from the Services and Field Security Support Team at 1-425-454-7946. Microsoft does not charge for support calls that are associated with security updates. For more information about how to contact Microsoft for support issues, visit [Microsoft Support](http://go.microsoft.com/fwlink/?linkid=21155). **Do administrators need to perform any additional actions after installing this update?** Yes. After installing this update, the UAG administrator needs to open the Forefront UAG Management console and activate the configuration for customers to be protected from the vulnerabilities described in this bulletin. **Why does this update address several reported security vulnerabilities?** This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895ExcelTable Reflected XSS Vulnerability - CVE-2011-1896Default Reflected XSS Vulnerability - CVE-2011-1897Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969Null Session Cookie Crash - CVE-2011-2012Aggregate Severity RatingMicrosoft Forefront Unified Access Gateway 2010Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 2Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportant ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 --------------------------------------------------------------- An HTTP response splitting vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1895](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1895). #### Mitigating Factors for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script contained in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 ------------------------------------------------------ An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1896](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1896). #### Mitigating Factors for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Default Reflected XSS Vulnerability - CVE-2011-1897 --------------------------------------------------- An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1897](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1897). #### Mitigating Factors for Default Reflected XSS Vulnerability - CVE-2011-1897 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for Default Reflected XSS Vulnerability - CVE-2011-1897 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Default Reflected XSS Vulnerability - CVE-2011-1897 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle specially crafted requests, allowing for allows content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, that then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update modifies the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 ------------------------------------------------------------ Microsoft Forefront Unified Access Gateway (UAG) applies a signed Java applet that can be leveraged by malicious Web sites to cause remote code execution on any Java-enabled Web browser. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1969](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1969). #### Mitigating Factors for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. #### Workarounds for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Blacklist the MicrosoftClient.Jar file** Add the entry for the following file: Java\\\\jre6\\\\lib\\\\security\\\\blacklist ``` # UAG Client MicrosoftClient.jar SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g= ``` **Impact of workaround.** MicrosoftClient.JAR will be blocked from running on the system.**How to undo the workaround.** Remove the entry for the following file:Java\\\\jre6\\\\lib\\\\security\\\\blacklist```# UAG Client MicrosoftClient.jarSHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=``` FAQ for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 What is the scope of the vulnerability? This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. What causes the vulnerability? This vulnerability is caused by a vulnerable Java applet that is installed on a browser by the Forefront Unified Access Gateway (UAG) server. What might an attacker use the vulnerability to do? An attacker could use this vulnerability to exploit clients that use UAG. How could an attacker exploit the vulnerability? A remote code execution vulnerability is introduced onto any Java-enabled browser by installing a vulnerable .jar file on client systems. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What systems are primarily at risk from the vulnerability? Client systems that use UAG are affected by this vulnerability. This vulnerability does not allow for compromise of the UAG server. What does the update do? This update modifies the vulnerable .jar file. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Null Session Cookie Crash - CVE-2011-2012 A denial of service vulnerability exists in implementations of Microsoft Forefront Unified Access Gateway (UAG). When this occurs, an attacker could leverage the vulnerability to stop the IIS worker process and deny access to Web services on the affected system. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-2012. Mitigating Factors for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any mitigating factors for this vulnerability. Workarounds for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any workarounds for this vulnerability. FAQ for Null Session Cookie Crash - CVE-2011-2012 What is the scope of the vulnerability? This is a denial of service vulnerability. What causes the vulnerability? This vulnerability is caused by improper validation of a NULL value contained within the session cookie. What might an attacker use the vulnerability to do? An attacker who exploits this vulnerability could use it to crash the web server on the affected UAG machine. How could an attacker exploit the vulnerability? An attacker could exploit this vulnerability by sending specially crafted network traffic to the affected UAG Web server. What systems are primarily at risk from the vulnerability? Systems running UAG Web server. What does the update do? This update adds exception handling around the null value of the UAG Web server. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" These updates will also be provided through our other standard distribution methods once testing has been completed to ensure distribution will be successful through these channels. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Forefront Unified Access Gateway 2010 (all versions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /quietFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /quietInstalling without restartingFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /norestartFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /norestartFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /norestartFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /norestartUpdate log fileFor Forefront Unified Access Gateway 2010 (KB2522482):MSI2522482.logFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):MSI2522483.logFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):MSI2522484.logFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):MSI2522485.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse the Installed Updates window as build-in Administrator or run msiexec from an elevated command line.File InformationFor Forefront Unified Access Gateway 2010 (KB2522482):See Microsoft Knowledge Base Article 2522482For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):See Microsoft Knowledge Base Article 2522483For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):See Microsoft Knowledge Base Article 2522484For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):See Microsoft Knowledge Base Article 2522485Registry Key VerificationFor Forefront Unified Access Gateway 2010 (KB2522482):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\54EBBA62-C7BB-4006-91D2-EFEB0738F93AFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\038FB8C4-F12D-428B-83F5-A964C34B6F2EFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\95244A26-7896-47D2-A49D-1FF43BC1C53CFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\715FC104-32DB-4AAB-A1B9-F1F496F71DE5 Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Note for this update However, you may not combine /quiet and /forcerestart for this update. See this known issue about install switch options in Microsoft Knowledge Base Article 2316074. Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Reflected XSS Vulnerability (CVE-2011-1896)Elisabeth Demeter of SEC Consult Unternehmensberatung GmbH for reporting the Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-2005": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-080",
        "title": "Vulnerability in Ancillary Function Driver Could Allow Elevation of Privilege (2592799)",
        "body": "This security update resolves a privately reported vulnerability in the Microsoft Windows Ancillary Function Driver (AFD). The vulnerability could allow elevation of privilege if an attacker logs on to a user's system and runs a specially crafted application. An attacker must have valid logon credentials and be able to log on locally to exploit the vulnerability. This security update is rated Important for all supported editions of Windows XP and Windows Server 2003. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerability by correcting the way that the Ancillary Function Driver (AFD) validates input before passing the input from user-mode to the Windows kernel. For more information about the vulnerability, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. The majority of customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see Microsoft Knowledge Base Article 294871. For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers apply the update at the earliest opportunity using update management software, or by checking for updates using the Microsoft Update service. See also the section, Detection and Deployment Tools and Guidance, later in this bulletin. Known Issues. None Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XP Service Pack 3Elevation of PrivilegeImportantMS11-046Windows XP Professional x64 Edition Service Pack 2Elevation of PrivilegeImportantMS11-046Windows Server 2003 Service Pack 2Elevation of PrivilegeImportantMS11-046Windows Server 2003 x64 Edition Service Pack 2Elevation of PrivilegeImportantMS11-046Windows Server 2003 with SP2 for Itanium-based SystemsElevation of PrivilegeImportantMS11-046 Non-Affected Software Operating SystemWindows Vista Service Pack 2Windows Vista x64 Edition Service Pack 2Windows Server 2008 for 32-bit Systems Service Pack 2Windows Server 2008 for x64-based Systems Service Pack 2Windows Server 2008 for Itanium-based Systems Service Pack 2Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Lifecycle Supported Service Packs. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the October bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareAncillary Function Driver Elevation of Privilege Vulnerability - CVE-2011-2005Aggregate Severity RatingWindows XP Service Pack 3Important Elevation of PrivilegeImportantWindows XP Professional x64 Edition Service Pack 2Important Elevation of PrivilegeImportantWindows Server 2003 Service Pack 2Important Elevation of PrivilegeImportantWindows Server 2003 x64 Edition Service Pack 2Important Elevation of PrivilegeImportantWindows Server 2003 with SP2 for Itanium-based SystemsImportant Elevation of PrivilegeImportant Ancillary Function Driver Elevation of Privilege Vulnerability - CVE-2011-2005 ------------------------------------------------------------------------------ An elevation of privilege vulnerability exists where the Ancillary Function Driver (afd.sys) improperly validates input passed from user mode to the Windows kernel. The vulnerability could allow an attacker to run code with elevated privileges. A local attacker who successfully exploited this vulnerability could execute arbitrary code and take complete control of an affected system. The attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2005](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2005). #### Mitigating Factors for Ancillary Function Driver Elevation of Privilege Vulnerability - CVE-2011-2005 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. #### Workarounds for Ancillary Function Driver Elevation of Privilege Vulnerability - CVE-2011-2005 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Ancillary Function Driver Elevation of Privilege Vulnerability - CVE-2011-2005 **What is the scope of the vulnerability?** This is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when the afd.sys driver improperly validates input when receiving data from user mode. **What is the Ancillary Function Driver (AFD)?** The AFD component provides the \"ancillary function driver,\" which supports Windows sockets applications and is contained in the afd.sys file. The afd.sys driver runs in kernel mode and manages the Winsock TCP/IP communications protocol. This Winsock Kernel Interface provides access to the TDI transports. **What is the Transport Driver Interface (TDI)?** The Transport Driver Interface (TDI) defines a kernel-mode network interface that is exposed at the upper edge of all transport protocol stacks. The highest level protocol driver in every such stack supports the TDI interface for still higher level kernel-mode network clients. For more information about the TDI Component, see the MSDN article, [Transport Driver Interface](http://msdn.microsoft.com/en-us/library/ff565685.aspx). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the** **vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses this vulnerability by correcting the way that the AFD validates input before passing the input from user-mode to the Windows kernel. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |--------------------------------------------------------|------| | Windows XP Service Pack 3 | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | | Windows Server 2003 Service Pack 2 | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |--------------------------------------------------------|--------------------|----------------------------| | Windows XP Service Pack 3 | Yes | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 Service Pack 2 | Yes | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Windows XP (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Windows XP Service Pack 3:WindowsXP-KB2592799-x86-enu.exe /quietFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2592799-x64-enu.exe /quietInstalling without restartingFor Windows XP Service Pack 3:WindowsXP-KB2592799-x86-enu.exe /norestartFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2592799-x64-enu.exe /norestartUpdate log fileKB2592799.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\$NTUninstallKB2592799$\\Spuninst folderFile InformationSee Microsoft Knowledge Base Article 2592799Registry Key VerificationFor all supported 32-bit editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP4\\KB2592799\\FilelistFor all supported x64-based editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP3\\KB2592799\\Filelist Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. **Inclusion in Future Service Packs**The update for this issue will be included in a future service pack or update rollup**Deployment**Installing without user interventionFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2592799-x86-enu.exe /quiet For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2592799-x64-enu.exe /quietFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2592799-ia64-enu.exe /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2592799-x86-enu.exe /norestart For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2592799-x64-enu.exe /norestartFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2592799-ia64-enu.exe /norestartUpdate log fileKB2592799.logFurther informationSee the subsection, **Detection and Deployment Tools and Guidance****Restart Requirement** Restart required?Yes, you must restart your system after you apply this security update.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](http://support.microsoft.com/kb/897341).**Removal Information**Use **Add or Remove Programs** tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\\\$NTUninstallKB2592799$\\\\Spuninst folder**File Information**See [Microsoft Knowledge Base Article 2592799](http://support.microsoft.com/kb/2592799)**Registry Key Verification**HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Updates\\\\Windows Server 2003\\\\SP3\\\\KB2592799\\\\Filelist **Note** The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Bo Zhou of National University of Defense Technology for reporting the Ancillary Function Driver Elevation of Privilege Vulnerability (CVE-2011-2005) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XP Service Pack 3Elevation of PrivilegeImportantMS11-046Windows XP Professional x64 Edition Service Pack 2Elevation of PrivilegeImportantMS11-046Windows Server 2003 Service Pack 2Elevation of PrivilegeImportantMS11-046Windows Server 2003 x64 Edition Service Pack 2Elevation of PrivilegeImportantMS11-046Windows Server 2003 with SP2 for Itanium-based SystemsElevation of PrivilegeImportantMS11-046 Non-Affected Software Operating SystemWindows Vista Service Pack 2Windows Vista x64 Edition Service Pack 2Windows Server 2008 for 32-bit Systems Service Pack 2Windows Server 2008 for x64-based Systems Service Pack 2Windows Server 2008 for Itanium-based Systems Service Pack 2Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Lifecycle Supported Service Packs. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the October bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareAncillary Function Driver Elevation of Privilege Vulnerability - CVE-2011-2005Aggregate Severity RatingWindows XP Service Pack 3Important Elevation of PrivilegeImportantWindows XP Professional x64 Edition Service Pack 2Important Elevation of PrivilegeImportantWindows Server 2003 Service Pack 2Important Elevation of PrivilegeImportantWindows Server 2003 x64 Edition Service Pack 2Important Elevation of PrivilegeImportantWindows Server 2003 with SP2 for Itanium-based SystemsImportant Elevation of PrivilegeImportant Ancillary Function Driver Elevation of Privilege Vulnerability - CVE-2011-2005 ------------------------------------------------------------------------------ An elevation of privilege vulnerability exists where the Ancillary Function Driver (afd.sys) improperly validates input passed from user mode to the Windows kernel. The vulnerability could allow an attacker to run code with elevated privileges. A local attacker who successfully exploited this vulnerability could execute arbitrary code and take complete control of an affected system. The attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2005](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2005). #### Mitigating Factors for Ancillary Function Driver Elevation of Privilege Vulnerability - CVE-2011-2005 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. #### Workarounds for Ancillary Function Driver Elevation of Privilege Vulnerability - CVE-2011-2005 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Ancillary Function Driver Elevation of Privilege Vulnerability - CVE-2011-2005 **What is the scope of the vulnerability?** This is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when the afd.sys driver improperly validates input when receiving data from user mode. **What is the Ancillary Function Driver (AFD)?** The AFD component provides the \"ancillary function driver,\" which supports Windows sockets applications and is contained in the afd.sys file. The afd.sys driver runs in kernel mode and manages the Winsock TCP/IP communications protocol. This Winsock Kernel Interface provides access to the TDI transports. **What is the Transport Driver Interface (TDI)?** The Transport Driver Interface (TDI) defines a kernel-mode network interface that is exposed at the upper edge of all transport protocol stacks. The highest level protocol driver in every such stack supports the TDI interface for still higher level kernel-mode network clients. For more information about the TDI Component, see the MSDN article, [Transport Driver Interface](http://msdn.microsoft.com/en-us/library/ff565685.aspx). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the** **vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses this vulnerability by correcting the way that the AFD validates input before passing the input from user-mode to the Windows kernel. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |--------------------------------------------------------|------| | Windows XP Service Pack 3 | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | | Windows Server 2003 Service Pack 2 | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |--------------------------------------------------------|--------------------|----------------------------| | Windows XP Service Pack 3 | Yes | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 Service Pack 2 | Yes | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Windows XP (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Windows XP Service Pack 3:WindowsXP-KB2592799-x86-enu.exe /quietFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2592799-x64-enu.exe /quietInstalling without restartingFor Windows XP Service Pack 3:WindowsXP-KB2592799-x86-enu.exe /norestartFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2592799-x64-enu.exe /norestartUpdate log fileKB2592799.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\$NTUninstallKB2592799$\\Spuninst folderFile InformationSee Microsoft Knowledge Base Article 2592799Registry Key VerificationFor all supported 32-bit editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP4\\KB2592799\\FilelistFor all supported x64-based editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP3\\KB2592799\\Filelist Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. **Inclusion in Future Service Packs**The update for this issue will be included in a future service pack or update rollup**Deployment**Installing without user interventionFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2592799-x86-enu.exe /quiet For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2592799-x64-enu.exe /quietFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2592799-ia64-enu.exe /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2592799-x86-enu.exe /norestart For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2592799-x64-enu.exe /norestartFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2592799-ia64-enu.exe /norestartUpdate log fileKB2592799.logFurther informationSee the subsection, **Detection and Deployment Tools and Guidance****Restart Requirement** Restart required?Yes, you must restart your system after you apply this security update.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](http://support.microsoft.com/kb/897341).**Removal Information**Use **Add or Remove Programs** tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\\\$NTUninstallKB2592799$\\\\Spuninst folder**File Information**See [Microsoft Knowledge Base Article 2592799](http://support.microsoft.com/kb/2592799)**Registry Key Verification**HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Updates\\\\Windows Server 2003\\\\SP3\\\\KB2592799\\\\Filelist **Note** The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Bo Zhou of National University of Defense Technology for reporting the Ancillary Function Driver Elevation of Privilege Vulnerability (CVE-2011-2005) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-2007": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-082",
        "title": "Vulnerabilities in Host Integration Server Could Allow Denial of Service (2607670)",
        "body": "This security update resolves two publicly disclosed vulnerabilities in Host Integration Server. The vulnerabilities could allow denial of service if a remote attacker sends specially crafted network packets to a Host Integration Server listening on UDP port 1478 or TCP ports 1477 and 1478. Firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed. In this case, the Host Integration Server ports should be blocked from the Internet. This security update is rated Important for all supported editions of Microsoft Host Integration Server 2004, Microsoft Host Integration Server 2006, Microsoft Host Integration Server 2009, and Microsoft Host Integration Server 2010. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerabilities by modifying the way that Host Integration Server handles specially crafted UDP and TCP packets. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. The majority of customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see Microsoft Knowledge Base Article 294871. For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers apply the update at the earliest opportunity using update management software, or by checking for updates using the Microsoft Update service. See also the section, Detection and Deployment Tools and Guidance, later in this bulletin. Known Issues. None Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Host Integration Server 2004 Service Pack 1(KB2578757)Denial of ServiceImportantNoneMicrosoft Host Integration Server 2006 Service Pack 1(KB2579597)Denial of ServiceImportantNoneMicrosoft Host Integration Server 2009(KB2579598)Denial of ServiceImportantNoneMicrosoft Host Integration Server 2010(KB2579599)Denial of ServiceImportantNone **Non-Affected Software** | **Operating System** | |-------------------------------------------------------| | Microsoft Host Integration Server 2000 Service Pack 2 | Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **I am using an older release of the software discussed in this security bulletin. What should I do?** The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the [Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742) Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see [Select a Product for Lifecycle Information](http://go.microsoft.com/fwlink/?linkid=169555). For more information about service packs for these software releases, see [Lifecycle Supported Service Packs](http://go.microsoft.com/fwlink/?linkid=89213). Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the [Microsoft Worldwide Information](http://go.microsoft.com/fwlink/?linkid=33329) Web site, select the country in the Contact Information list, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Microsoft Support Lifecycle Policy FAQ](http://go.microsoft.com/fwlink/?linkid=169557). ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareEndless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008Aggregate Severity RatingMicrosoft Host Integration Server 2004 Service Pack 1Important Denial of ServiceImportant Denial of ServiceImportantMicrosoft Host Integration Server 2006 Service Pack 1Important Denial of ServiceImportant Denial of ServiceImportantMicrosoft Host Integration Server 2009Important Denial of ServiceImportant Denial of ServiceImportantMicrosoft Host Integration Server 2010Important Denial of ServiceImportant Denial of ServiceImportant Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 ------------------------------------------------------------- An unauthenticated denial of service vulnerability exists in the way that Host Integration Server handles some UDP and TCP network traffic. The vulnerability could allow a remote user to cause snabase.exe, snaserver.exe, snalink.exe, or mngagent.exe to stop responding to new requests. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2007](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2007). #### Mitigating Factors for Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - Firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed. In this case, the Host Integration Server ports should be blocked from the Internet. #### Workarounds for Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Block TCP ports1477** **and** **1478and UDP port** **1478** **at your firewall** These ports are used to initiate a connection with the affected component. Blocking them at the enterprise firewall, both inbound and outbound, will help protect systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). For more information about the Windows Firewall, see TechNet article, [How to Configure Windows Firewall on a Single Computer](http://www.microsoft.com/technet/security/smallbusiness/prodtech/windowsxp/cfgfwall.mspx). #### FAQ for Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 **What is the scope of the vulnerability?** This is a denial of service vulnerability. A remote, anonymous attacker who exploited this vulnerability could cause the affected SNA Server service and all dependent services to stop responding. Note that this vulnerability would not allow an attacker to execute code or to elevate their user rights. **What causes the vulnerability?** This vulnerability is caused by improper input validation when Host Integration Server processes specially crafted network traffic. **What might an attacker use the vulnerability to do?** A remote, anonymous attacker who exploited this vulnerability could cause the affected system's SNA Server service to stop responding to new requests. **How could an attacker exploit the vulnerability?** A remote attacker could exploit this vulnerability by sending specially crafted network packets to Host Integration Server listening on UDP port 1478 or TCP ports 1477 and 1478. **What systems are primarily at risk from the vulnerability?** Servers running Host Integration Server (HIS). **What does the update do?** This update addresses the vulnerability by modifying the way that Host Integration Server handles specially crafted UDP and TCP packets. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number [CVE-2011-2007](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2007). **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 -------------------------------------------------------------- An unauthenticated denial of service vulnerability exists in the way that Host Integration Server handles some UDP and TCP network traffic. The vulnerability could allow a remote user to cause snabase.exe, snaserver.exe, snalink.exe, or mngagent.exe to stop responding to new requests. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2008](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2008). #### Mitigating Factors for Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - Firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed. In this case, the Host Integration Server ports should be blocked from the Internet. #### Workarounds for Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Block TCP ports 1477 and 1478 and UDP port 1478 at your firewall** These ports are used to initiate a connection with the affected component. Blocking them at the enterprise firewall, both inbound and outbound, will help protect systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). For more information about the Windows Firewall, see TechNet article, [How to Configure Windows Firewall on a Single Computer](http://www.microsoft.com/technet/security/smallbusiness/prodtech/windowsxp/cfgfwall.mspx). #### FAQ for Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 **What is the scope of the vulnerability?** This is a denial of service vulnerability. A remote, anonymous attacker who exploited this vulnerability could cause the affected SNA Server service and all dependent services to stop responding. **What causes the vulnerability?** This vulnerability is caused by improper input validation when Host Integration Server processes specially crafted network traffic. **What might an attacker use the vulnerability to do?** A remote, anonymous attacker who exploited this vulnerability could cause the affected system's SNA Server service to stop responding to new requests. **How could an attacker exploit the vulnerability?** A remote attacker could exploit this vulnerability by sending specially crafted network packets to Host Integration Server listening on UDP port 1478 or TCP ports 1477 and 1478. **What systems are primarily at risk from the vulnerability?** Servers running Host Integration Server (HIS). **What does the update do?** This update addresses the vulnerability by modifying the way that Host Integration Server handles specially crafted UDP and TCP packets. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number [CVE-2011-2008](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2008). **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |-------------------------------------------------------|------| | Microsoft Host Integration Server 2004 Service Pack 1 | Yes | | Microsoft Host Integration Server 2006 Service Pack 1 | Yes | | Microsoft Host Integration Server 2009 | Yes | | Microsoft Host Integration Server 2010 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |-------------------------------------------------------|--------------------|----------------------------| | Microsoft Host Integration Server 2004 Service Pack 1 | Yes | Yes | | Microsoft Host Integration Server 2006 Service Pack 1 | Yes | Yes | | Microsoft Host Integration Server 2009 | Yes | Yes | | Microsoft Host Integration Server 2010 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Microsoft Host Integration Server (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft Host Integration Server 2004 Service Pack 1:HIS2004-SP1-KB2578757-x86-ENU.exe /quietFor Microsoft Host Integration Server 2006 Service Pack 1:HIS2006-SP1-KB2579597-ENU.exe /quietFor Microsoft Host Integration Server 2009:HIS2009-RTM-KB2579598-ENU /quietFor Microsoft Host Integration Server 2010:HIS2010-RTM-KB2579599-ENU /quietInstalling without restartingFor Microsoft Host Integration Server 2004 Service Pack 1:HIS2004-SP1-KB2578757-x86-ENU.exe /norestartFor Microsoft Host Integration Server 2006 Service Pack 1:HIS2006-SP1-KB2579597-ENU.exe /norestartFor Microsoft Host Integration Server 2009:HIS2009-RTM-KB2579598-ENU /norestartFor Microsoft Host Integration Server 2010:HIS2010-RTM-KB2579599-ENU /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel.File InformationFor Microsoft Host Integration Server 2004 Service Pack 1:See Microsoft Knowledge Base Article 2578757For Microsoft Host Integration Server 2006 Service Pack 1:See Microsoft Knowledge Base Article 2579597For Microsoft Host Integration Server 2009:See Microsoft Knowledge Base Article 2579598For Microsoft Host Integration Server 2010:See Microsoft Knowledge Base Article 2579599Registry Key VerificationFor Microsoft Host Integration Server 2004 Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2004 SP1 Hotfix [See KB article 2578757 for details]GDRFor Microsoft Host Integration Server 2004 Service Pack 1 (Japan only):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2004 SP1 Hotfix [KB 2578757]GDRFor Microsoft Host Integration Server 2006 Service Pack 1 (32-bit systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2006 SP1 Hotfix [See KB article 2579597 for details]LDRFor Microsoft Host Integration Server 2006 Service Pack 1 (x64-based systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2006 SP1 Hotfix [See KB article 2579597 for details]LDRFor Microsoft Host Integration Server 2009 (32-bit systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]LDRFor Microsoft Host Integration Server 2009 (x64-based systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]LDRFor Microsoft Host Integration Server 2010 (32-bit systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]LDRFor Microsoft Host Integration Server 2010 (x64-based systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]LDR Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Host Integration Server 2004 Service Pack 1(KB2578757)Denial of ServiceImportantNoneMicrosoft Host Integration Server 2006 Service Pack 1(KB2579597)Denial of ServiceImportantNoneMicrosoft Host Integration Server 2009(KB2579598)Denial of ServiceImportantNoneMicrosoft Host Integration Server 2010(KB2579599)Denial of ServiceImportantNone **Non-Affected Software** | **Operating System** | |-------------------------------------------------------| | Microsoft Host Integration Server 2000 Service Pack 2 | Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **I am using an older release of the software discussed in this security bulletin. What should I do?** The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the [Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742) Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see [Select a Product for Lifecycle Information](http://go.microsoft.com/fwlink/?linkid=169555). For more information about service packs for these software releases, see [Lifecycle Supported Service Packs](http://go.microsoft.com/fwlink/?linkid=89213). Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the [Microsoft Worldwide Information](http://go.microsoft.com/fwlink/?linkid=33329) Web site, select the country in the Contact Information list, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Microsoft Support Lifecycle Policy FAQ](http://go.microsoft.com/fwlink/?linkid=169557). ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareEndless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008Aggregate Severity RatingMicrosoft Host Integration Server 2004 Service Pack 1Important Denial of ServiceImportant Denial of ServiceImportantMicrosoft Host Integration Server 2006 Service Pack 1Important Denial of ServiceImportant Denial of ServiceImportantMicrosoft Host Integration Server 2009Important Denial of ServiceImportant Denial of ServiceImportantMicrosoft Host Integration Server 2010Important Denial of ServiceImportant Denial of ServiceImportant Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 ------------------------------------------------------------- An unauthenticated denial of service vulnerability exists in the way that Host Integration Server handles some UDP and TCP network traffic. The vulnerability could allow a remote user to cause snabase.exe, snaserver.exe, snalink.exe, or mngagent.exe to stop responding to new requests. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2007](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2007). #### Mitigating Factors for Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - Firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed. In this case, the Host Integration Server ports should be blocked from the Internet. #### Workarounds for Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Block TCP ports1477** **and** **1478and UDP port** **1478** **at your firewall** These ports are used to initiate a connection with the affected component. Blocking them at the enterprise firewall, both inbound and outbound, will help protect systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). For more information about the Windows Firewall, see TechNet article, [How to Configure Windows Firewall on a Single Computer](http://www.microsoft.com/technet/security/smallbusiness/prodtech/windowsxp/cfgfwall.mspx). #### FAQ for Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 **What is the scope of the vulnerability?** This is a denial of service vulnerability. A remote, anonymous attacker who exploited this vulnerability could cause the affected SNA Server service and all dependent services to stop responding. Note that this vulnerability would not allow an attacker to execute code or to elevate their user rights. **What causes the vulnerability?** This vulnerability is caused by improper input validation when Host Integration Server processes specially crafted network traffic. **What might an attacker use the vulnerability to do?** A remote, anonymous attacker who exploited this vulnerability could cause the affected system's SNA Server service to stop responding to new requests. **How could an attacker exploit the vulnerability?** A remote attacker could exploit this vulnerability by sending specially crafted network packets to Host Integration Server listening on UDP port 1478 or TCP ports 1477 and 1478. **What systems are primarily at risk from the vulnerability?** Servers running Host Integration Server (HIS). **What does the update do?** This update addresses the vulnerability by modifying the way that Host Integration Server handles specially crafted UDP and TCP packets. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number [CVE-2011-2007](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2007). **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 -------------------------------------------------------------- An unauthenticated denial of service vulnerability exists in the way that Host Integration Server handles some UDP and TCP network traffic. The vulnerability could allow a remote user to cause snabase.exe, snaserver.exe, snalink.exe, or mngagent.exe to stop responding to new requests. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2008](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2008). #### Mitigating Factors for Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - Firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed. In this case, the Host Integration Server ports should be blocked from the Internet. #### Workarounds for Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Block TCP ports 1477 and 1478 and UDP port 1478 at your firewall** These ports are used to initiate a connection with the affected component. Blocking them at the enterprise firewall, both inbound and outbound, will help protect systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). For more information about the Windows Firewall, see TechNet article, [How to Configure Windows Firewall on a Single Computer](http://www.microsoft.com/technet/security/smallbusiness/prodtech/windowsxp/cfgfwall.mspx). #### FAQ for Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 **What is the scope of the vulnerability?** This is a denial of service vulnerability. A remote, anonymous attacker who exploited this vulnerability could cause the affected SNA Server service and all dependent services to stop responding. **What causes the vulnerability?** This vulnerability is caused by improper input validation when Host Integration Server processes specially crafted network traffic. **What might an attacker use the vulnerability to do?** A remote, anonymous attacker who exploited this vulnerability could cause the affected system's SNA Server service to stop responding to new requests. **How could an attacker exploit the vulnerability?** A remote attacker could exploit this vulnerability by sending specially crafted network packets to Host Integration Server listening on UDP port 1478 or TCP ports 1477 and 1478. **What systems are primarily at risk from the vulnerability?** Servers running Host Integration Server (HIS). **What does the update do?** This update addresses the vulnerability by modifying the way that Host Integration Server handles specially crafted UDP and TCP packets. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number [CVE-2011-2008](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2008). **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |-------------------------------------------------------|------| | Microsoft Host Integration Server 2004 Service Pack 1 | Yes | | Microsoft Host Integration Server 2006 Service Pack 1 | Yes | | Microsoft Host Integration Server 2009 | Yes | | Microsoft Host Integration Server 2010 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |-------------------------------------------------------|--------------------|----------------------------| | Microsoft Host Integration Server 2004 Service Pack 1 | Yes | Yes | | Microsoft Host Integration Server 2006 Service Pack 1 | Yes | Yes | | Microsoft Host Integration Server 2009 | Yes | Yes | | Microsoft Host Integration Server 2010 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Microsoft Host Integration Server (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft Host Integration Server 2004 Service Pack 1:HIS2004-SP1-KB2578757-x86-ENU.exe /quietFor Microsoft Host Integration Server 2006 Service Pack 1:HIS2006-SP1-KB2579597-ENU.exe /quietFor Microsoft Host Integration Server 2009:HIS2009-RTM-KB2579598-ENU /quietFor Microsoft Host Integration Server 2010:HIS2010-RTM-KB2579599-ENU /quietInstalling without restartingFor Microsoft Host Integration Server 2004 Service Pack 1:HIS2004-SP1-KB2578757-x86-ENU.exe /norestartFor Microsoft Host Integration Server 2006 Service Pack 1:HIS2006-SP1-KB2579597-ENU.exe /norestartFor Microsoft Host Integration Server 2009:HIS2009-RTM-KB2579598-ENU /norestartFor Microsoft Host Integration Server 2010:HIS2010-RTM-KB2579599-ENU /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel.File InformationFor Microsoft Host Integration Server 2004 Service Pack 1:See Microsoft Knowledge Base Article 2578757For Microsoft Host Integration Server 2006 Service Pack 1:See Microsoft Knowledge Base Article 2579597For Microsoft Host Integration Server 2009:See Microsoft Knowledge Base Article 2579598For Microsoft Host Integration Server 2010:See Microsoft Knowledge Base Article 2579599Registry Key VerificationFor Microsoft Host Integration Server 2004 Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2004 SP1 Hotfix [See KB article 2578757 for details]GDRFor Microsoft Host Integration Server 2004 Service Pack 1 (Japan only):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2004 SP1 Hotfix [KB 2578757]GDRFor Microsoft Host Integration Server 2006 Service Pack 1 (32-bit systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2006 SP1 Hotfix [See KB article 2579597 for details]LDRFor Microsoft Host Integration Server 2006 Service Pack 1 (x64-based systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2006 SP1 Hotfix [See KB article 2579597 for details]LDRFor Microsoft Host Integration Server 2009 (32-bit systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]LDRFor Microsoft Host Integration Server 2009 (x64-based systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]LDRFor Microsoft Host Integration Server 2010 (32-bit systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]LDRFor Microsoft Host Integration Server 2010 (x64-based systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]LDR Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-2008": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-082",
        "title": "Vulnerabilities in Host Integration Server Could Allow Denial of Service (2607670)",
        "body": "This security update resolves two publicly disclosed vulnerabilities in Host Integration Server. The vulnerabilities could allow denial of service if a remote attacker sends specially crafted network packets to a Host Integration Server listening on UDP port 1478 or TCP ports 1477 and 1478. Firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed. In this case, the Host Integration Server ports should be blocked from the Internet. This security update is rated Important for all supported editions of Microsoft Host Integration Server 2004, Microsoft Host Integration Server 2006, Microsoft Host Integration Server 2009, and Microsoft Host Integration Server 2010. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerabilities by modifying the way that Host Integration Server handles specially crafted UDP and TCP packets. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. The majority of customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see Microsoft Knowledge Base Article 294871. For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers apply the update at the earliest opportunity using update management software, or by checking for updates using the Microsoft Update service. See also the section, Detection and Deployment Tools and Guidance, later in this bulletin. Known Issues. None Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Host Integration Server 2004 Service Pack 1(KB2578757)Denial of ServiceImportantNoneMicrosoft Host Integration Server 2006 Service Pack 1(KB2579597)Denial of ServiceImportantNoneMicrosoft Host Integration Server 2009(KB2579598)Denial of ServiceImportantNoneMicrosoft Host Integration Server 2010(KB2579599)Denial of ServiceImportantNone **Non-Affected Software** | **Operating System** | |-------------------------------------------------------| | Microsoft Host Integration Server 2000 Service Pack 2 | Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **I am using an older release of the software discussed in this security bulletin. What should I do?** The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the [Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742) Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see [Select a Product for Lifecycle Information](http://go.microsoft.com/fwlink/?linkid=169555). For more information about service packs for these software releases, see [Lifecycle Supported Service Packs](http://go.microsoft.com/fwlink/?linkid=89213). Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the [Microsoft Worldwide Information](http://go.microsoft.com/fwlink/?linkid=33329) Web site, select the country in the Contact Information list, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Microsoft Support Lifecycle Policy FAQ](http://go.microsoft.com/fwlink/?linkid=169557). ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareEndless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008Aggregate Severity RatingMicrosoft Host Integration Server 2004 Service Pack 1Important Denial of ServiceImportant Denial of ServiceImportantMicrosoft Host Integration Server 2006 Service Pack 1Important Denial of ServiceImportant Denial of ServiceImportantMicrosoft Host Integration Server 2009Important Denial of ServiceImportant Denial of ServiceImportantMicrosoft Host Integration Server 2010Important Denial of ServiceImportant Denial of ServiceImportant Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 ------------------------------------------------------------- An unauthenticated denial of service vulnerability exists in the way that Host Integration Server handles some UDP and TCP network traffic. The vulnerability could allow a remote user to cause snabase.exe, snaserver.exe, snalink.exe, or mngagent.exe to stop responding to new requests. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2007](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2007). #### Mitigating Factors for Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - Firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed. In this case, the Host Integration Server ports should be blocked from the Internet. #### Workarounds for Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Block TCP ports1477** **and** **1478and UDP port** **1478** **at your firewall** These ports are used to initiate a connection with the affected component. Blocking them at the enterprise firewall, both inbound and outbound, will help protect systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). For more information about the Windows Firewall, see TechNet article, [How to Configure Windows Firewall on a Single Computer](http://www.microsoft.com/technet/security/smallbusiness/prodtech/windowsxp/cfgfwall.mspx). #### FAQ for Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 **What is the scope of the vulnerability?** This is a denial of service vulnerability. A remote, anonymous attacker who exploited this vulnerability could cause the affected SNA Server service and all dependent services to stop responding. Note that this vulnerability would not allow an attacker to execute code or to elevate their user rights. **What causes the vulnerability?** This vulnerability is caused by improper input validation when Host Integration Server processes specially crafted network traffic. **What might an attacker use the vulnerability to do?** A remote, anonymous attacker who exploited this vulnerability could cause the affected system's SNA Server service to stop responding to new requests. **How could an attacker exploit the vulnerability?** A remote attacker could exploit this vulnerability by sending specially crafted network packets to Host Integration Server listening on UDP port 1478 or TCP ports 1477 and 1478. **What systems are primarily at risk from the vulnerability?** Servers running Host Integration Server (HIS). **What does the update do?** This update addresses the vulnerability by modifying the way that Host Integration Server handles specially crafted UDP and TCP packets. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number [CVE-2011-2007](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2007). **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 -------------------------------------------------------------- An unauthenticated denial of service vulnerability exists in the way that Host Integration Server handles some UDP and TCP network traffic. The vulnerability could allow a remote user to cause snabase.exe, snaserver.exe, snalink.exe, or mngagent.exe to stop responding to new requests. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2008](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2008). #### Mitigating Factors for Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - Firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed. In this case, the Host Integration Server ports should be blocked from the Internet. #### Workarounds for Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Block TCP ports 1477 and 1478 and UDP port 1478 at your firewall** These ports are used to initiate a connection with the affected component. Blocking them at the enterprise firewall, both inbound and outbound, will help protect systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). For more information about the Windows Firewall, see TechNet article, [How to Configure Windows Firewall on a Single Computer](http://www.microsoft.com/technet/security/smallbusiness/prodtech/windowsxp/cfgfwall.mspx). #### FAQ for Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 **What is the scope of the vulnerability?** This is a denial of service vulnerability. A remote, anonymous attacker who exploited this vulnerability could cause the affected SNA Server service and all dependent services to stop responding. **What causes the vulnerability?** This vulnerability is caused by improper input validation when Host Integration Server processes specially crafted network traffic. **What might an attacker use the vulnerability to do?** A remote, anonymous attacker who exploited this vulnerability could cause the affected system's SNA Server service to stop responding to new requests. **How could an attacker exploit the vulnerability?** A remote attacker could exploit this vulnerability by sending specially crafted network packets to Host Integration Server listening on UDP port 1478 or TCP ports 1477 and 1478. **What systems are primarily at risk from the vulnerability?** Servers running Host Integration Server (HIS). **What does the update do?** This update addresses the vulnerability by modifying the way that Host Integration Server handles specially crafted UDP and TCP packets. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number [CVE-2011-2008](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2008). **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |-------------------------------------------------------|------| | Microsoft Host Integration Server 2004 Service Pack 1 | Yes | | Microsoft Host Integration Server 2006 Service Pack 1 | Yes | | Microsoft Host Integration Server 2009 | Yes | | Microsoft Host Integration Server 2010 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |-------------------------------------------------------|--------------------|----------------------------| | Microsoft Host Integration Server 2004 Service Pack 1 | Yes | Yes | | Microsoft Host Integration Server 2006 Service Pack 1 | Yes | Yes | | Microsoft Host Integration Server 2009 | Yes | Yes | | Microsoft Host Integration Server 2010 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Microsoft Host Integration Server (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft Host Integration Server 2004 Service Pack 1:HIS2004-SP1-KB2578757-x86-ENU.exe /quietFor Microsoft Host Integration Server 2006 Service Pack 1:HIS2006-SP1-KB2579597-ENU.exe /quietFor Microsoft Host Integration Server 2009:HIS2009-RTM-KB2579598-ENU /quietFor Microsoft Host Integration Server 2010:HIS2010-RTM-KB2579599-ENU /quietInstalling without restartingFor Microsoft Host Integration Server 2004 Service Pack 1:HIS2004-SP1-KB2578757-x86-ENU.exe /norestartFor Microsoft Host Integration Server 2006 Service Pack 1:HIS2006-SP1-KB2579597-ENU.exe /norestartFor Microsoft Host Integration Server 2009:HIS2009-RTM-KB2579598-ENU /norestartFor Microsoft Host Integration Server 2010:HIS2010-RTM-KB2579599-ENU /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel.File InformationFor Microsoft Host Integration Server 2004 Service Pack 1:See Microsoft Knowledge Base Article 2578757For Microsoft Host Integration Server 2006 Service Pack 1:See Microsoft Knowledge Base Article 2579597For Microsoft Host Integration Server 2009:See Microsoft Knowledge Base Article 2579598For Microsoft Host Integration Server 2010:See Microsoft Knowledge Base Article 2579599Registry Key VerificationFor Microsoft Host Integration Server 2004 Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2004 SP1 Hotfix [See KB article 2578757 for details]GDRFor Microsoft Host Integration Server 2004 Service Pack 1 (Japan only):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2004 SP1 Hotfix [KB 2578757]GDRFor Microsoft Host Integration Server 2006 Service Pack 1 (32-bit systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2006 SP1 Hotfix [See KB article 2579597 for details]LDRFor Microsoft Host Integration Server 2006 Service Pack 1 (x64-based systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2006 SP1 Hotfix [See KB article 2579597 for details]LDRFor Microsoft Host Integration Server 2009 (32-bit systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]LDRFor Microsoft Host Integration Server 2009 (x64-based systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]LDRFor Microsoft Host Integration Server 2010 (32-bit systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]LDRFor Microsoft Host Integration Server 2010 (x64-based systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]LDR Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Host Integration Server 2004 Service Pack 1(KB2578757)Denial of ServiceImportantNoneMicrosoft Host Integration Server 2006 Service Pack 1(KB2579597)Denial of ServiceImportantNoneMicrosoft Host Integration Server 2009(KB2579598)Denial of ServiceImportantNoneMicrosoft Host Integration Server 2010(KB2579599)Denial of ServiceImportantNone **Non-Affected Software** | **Operating System** | |-------------------------------------------------------| | Microsoft Host Integration Server 2000 Service Pack 2 | Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **I am using an older release of the software discussed in this security bulletin. What should I do?** The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the [Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742) Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see [Select a Product for Lifecycle Information](http://go.microsoft.com/fwlink/?linkid=169555). For more information about service packs for these software releases, see [Lifecycle Supported Service Packs](http://go.microsoft.com/fwlink/?linkid=89213). Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the [Microsoft Worldwide Information](http://go.microsoft.com/fwlink/?linkid=33329) Web site, select the country in the Contact Information list, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Microsoft Support Lifecycle Policy FAQ](http://go.microsoft.com/fwlink/?linkid=169557). ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareEndless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008Aggregate Severity RatingMicrosoft Host Integration Server 2004 Service Pack 1Important Denial of ServiceImportant Denial of ServiceImportantMicrosoft Host Integration Server 2006 Service Pack 1Important Denial of ServiceImportant Denial of ServiceImportantMicrosoft Host Integration Server 2009Important Denial of ServiceImportant Denial of ServiceImportantMicrosoft Host Integration Server 2010Important Denial of ServiceImportant Denial of ServiceImportant Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 ------------------------------------------------------------- An unauthenticated denial of service vulnerability exists in the way that Host Integration Server handles some UDP and TCP network traffic. The vulnerability could allow a remote user to cause snabase.exe, snaserver.exe, snalink.exe, or mngagent.exe to stop responding to new requests. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2007](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2007). #### Mitigating Factors for Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - Firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed. In this case, the Host Integration Server ports should be blocked from the Internet. #### Workarounds for Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Block TCP ports1477** **and** **1478and UDP port** **1478** **at your firewall** These ports are used to initiate a connection with the affected component. Blocking them at the enterprise firewall, both inbound and outbound, will help protect systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). For more information about the Windows Firewall, see TechNet article, [How to Configure Windows Firewall on a Single Computer](http://www.microsoft.com/technet/security/smallbusiness/prodtech/windowsxp/cfgfwall.mspx). #### FAQ for Endless Loop DoS in snabase.exe Vulnerability - CVE-2011-2007 **What is the scope of the vulnerability?** This is a denial of service vulnerability. A remote, anonymous attacker who exploited this vulnerability could cause the affected SNA Server service and all dependent services to stop responding. Note that this vulnerability would not allow an attacker to execute code or to elevate their user rights. **What causes the vulnerability?** This vulnerability is caused by improper input validation when Host Integration Server processes specially crafted network traffic. **What might an attacker use the vulnerability to do?** A remote, anonymous attacker who exploited this vulnerability could cause the affected system's SNA Server service to stop responding to new requests. **How could an attacker exploit the vulnerability?** A remote attacker could exploit this vulnerability by sending specially crafted network packets to Host Integration Server listening on UDP port 1478 or TCP ports 1477 and 1478. **What systems are primarily at risk from the vulnerability?** Servers running Host Integration Server (HIS). **What does the update do?** This update addresses the vulnerability by modifying the way that Host Integration Server handles specially crafted UDP and TCP packets. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number [CVE-2011-2007](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2007). **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 -------------------------------------------------------------- An unauthenticated denial of service vulnerability exists in the way that Host Integration Server handles some UDP and TCP network traffic. The vulnerability could allow a remote user to cause snabase.exe, snaserver.exe, snalink.exe, or mngagent.exe to stop responding to new requests. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2008](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2008). #### Mitigating Factors for Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - Firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed. In this case, the Host Integration Server ports should be blocked from the Internet. #### Workarounds for Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Block TCP ports 1477 and 1478 and UDP port 1478 at your firewall** These ports are used to initiate a connection with the affected component. Blocking them at the enterprise firewall, both inbound and outbound, will help protect systems that are behind that firewall from attempts to exploit this vulnerability. We recommend that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). For more information about the Windows Firewall, see TechNet article, [How to Configure Windows Firewall on a Single Computer](http://www.microsoft.com/technet/security/smallbusiness/prodtech/windowsxp/cfgfwall.mspx). #### FAQ for Access of Unallocated Memory DoS Vulnerability - CVE-2011-2008 **What is the scope of the vulnerability?** This is a denial of service vulnerability. A remote, anonymous attacker who exploited this vulnerability could cause the affected SNA Server service and all dependent services to stop responding. **What causes the vulnerability?** This vulnerability is caused by improper input validation when Host Integration Server processes specially crafted network traffic. **What might an attacker use the vulnerability to do?** A remote, anonymous attacker who exploited this vulnerability could cause the affected system's SNA Server service to stop responding to new requests. **How could an attacker exploit the vulnerability?** A remote attacker could exploit this vulnerability by sending specially crafted network packets to Host Integration Server listening on UDP port 1478 or TCP ports 1477 and 1478. **What systems are primarily at risk from the vulnerability?** Servers running Host Integration Server (HIS). **What does the update do?** This update addresses the vulnerability by modifying the way that Host Integration Server handles specially crafted UDP and TCP packets. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number [CVE-2011-2008](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2008). **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |-------------------------------------------------------|------| | Microsoft Host Integration Server 2004 Service Pack 1 | Yes | | Microsoft Host Integration Server 2006 Service Pack 1 | Yes | | Microsoft Host Integration Server 2009 | Yes | | Microsoft Host Integration Server 2010 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |-------------------------------------------------------|--------------------|----------------------------| | Microsoft Host Integration Server 2004 Service Pack 1 | Yes | Yes | | Microsoft Host Integration Server 2006 Service Pack 1 | Yes | Yes | | Microsoft Host Integration Server 2009 | Yes | Yes | | Microsoft Host Integration Server 2010 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Microsoft Host Integration Server (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft Host Integration Server 2004 Service Pack 1:HIS2004-SP1-KB2578757-x86-ENU.exe /quietFor Microsoft Host Integration Server 2006 Service Pack 1:HIS2006-SP1-KB2579597-ENU.exe /quietFor Microsoft Host Integration Server 2009:HIS2009-RTM-KB2579598-ENU /quietFor Microsoft Host Integration Server 2010:HIS2010-RTM-KB2579599-ENU /quietInstalling without restartingFor Microsoft Host Integration Server 2004 Service Pack 1:HIS2004-SP1-KB2578757-x86-ENU.exe /norestartFor Microsoft Host Integration Server 2006 Service Pack 1:HIS2006-SP1-KB2579597-ENU.exe /norestartFor Microsoft Host Integration Server 2009:HIS2009-RTM-KB2579598-ENU /norestartFor Microsoft Host Integration Server 2010:HIS2010-RTM-KB2579599-ENU /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel.File InformationFor Microsoft Host Integration Server 2004 Service Pack 1:See Microsoft Knowledge Base Article 2578757For Microsoft Host Integration Server 2006 Service Pack 1:See Microsoft Knowledge Base Article 2579597For Microsoft Host Integration Server 2009:See Microsoft Knowledge Base Article 2579598For Microsoft Host Integration Server 2010:See Microsoft Knowledge Base Article 2579599Registry Key VerificationFor Microsoft Host Integration Server 2004 Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2004 SP1 Hotfix [See KB article 2578757 for details]GDRFor Microsoft Host Integration Server 2004 Service Pack 1 (Japan only):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2004 SP1 Hotfix [KB 2578757]GDRFor Microsoft Host Integration Server 2006 Service Pack 1 (32-bit systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2006 SP1 Hotfix [See KB article 2579597 for details]LDRFor Microsoft Host Integration Server 2006 Service Pack 1 (x64-based systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2006 SP1 Hotfix [See KB article 2579597 for details]LDRFor Microsoft Host Integration Server 2009 (32-bit systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]LDRFor Microsoft Host Integration Server 2009 (x64-based systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2009 Hotfix [See KB article 2579598 for details]LDRFor Microsoft Host Integration Server 2010 (32-bit systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]LDRFor Microsoft Host Integration Server 2010 (x64-based systems):HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]GDR or HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Microsoft Host Integration Server 2010 Hotfix [See KB article 2579599 for detail]LDR Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-2012": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-079",
        "title": "Vulnerabilities in Microsoft Forefront Unified Access Gateway Could Cause Remote Code Execution (2544641)",
        "body": "This security update resolves five privately reported vulnerabilities in Microsoft Forefront Unified Access Gateway (UAG). The most severe of these vulnerabilities could allow remote code execution if a user visits an affected Web site using a specially crafted URL. However, an attacker would have no way to force users to visit such a Web site. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. This security update is rated Important for all supported versions of Microsoft Forefront Unified Access Gateway 2010. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerabilities by modifying the way that UAG handles specially crafted requests, modifying the MicrosoftClient.JAR file, and adding exception handling around the null value of the UAG Web server. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. Microsoft recommends that customers apply the update at the earliest opportunity. Known Issues. Microsoft Knowledge Base Article 2544641 documents the currently known issues that customers may experience when installing this security update. The article also documents recommended solutions for these issues. Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Forefront Unified Access Gateway 2010[1](KB2522482)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 1[1](KB2522483)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 2[1](KB2522484)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1[1](KB2522485)Remote Code ExecutionImportantNone [1] This update is available from the Microsoft Download Center only. Please see the next section, **Frequently Asked Questions (FAQ) Related to This Security Update**. Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Why are the updates only available from the Microsoft Download Center?** Microsoft is releasing these updates to the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129) so that customers can begin updating their systems as soon as possible. **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **Is Intelligent Application Gateway (IAG) affected by the vulnerabilities described in this bulletin?** Yes. Microsoft Intelligent Application Gateway 2007 Service Pack 2 is affected by ExcelTable Response Splitting Vulnerability (CVE-2011-1895), ExcelTable Reflected XSS Vulnerability (CVE-2011-1896), Default Reflected XSS Vulnerability (CVE-2011-1897), and Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969). For more information, IAG customers should contact their OEMs. Customers in the U.S. and Canada can also receive technical support from Customer Service and Support at 1-800-936-3100. International customers can also receive technical support from the Services and Field Security Support Team at 1-425-454-7946. Microsoft does not charge for support calls that are associated with security updates. For more information about how to contact Microsoft for support issues, visit [Microsoft Support](http://go.microsoft.com/fwlink/?linkid=21155). **Do administrators need to perform any additional actions after installing this update?** Yes. After installing this update, the UAG administrator needs to open the Forefront UAG Management console and activate the configuration for customers to be protected from the vulnerabilities described in this bulletin. **Why does this update address several reported security vulnerabilities?** This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895ExcelTable Reflected XSS Vulnerability - CVE-2011-1896Default Reflected XSS Vulnerability - CVE-2011-1897Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969Null Session Cookie Crash - CVE-2011-2012Aggregate Severity RatingMicrosoft Forefront Unified Access Gateway 2010Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 2Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportant ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 --------------------------------------------------------------- An HTTP response splitting vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1895](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1895). #### Mitigating Factors for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script contained in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 ------------------------------------------------------ An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1896](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1896). #### Mitigating Factors for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Default Reflected XSS Vulnerability - CVE-2011-1897 --------------------------------------------------- An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1897](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1897). #### Mitigating Factors for Default Reflected XSS Vulnerability - CVE-2011-1897 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for Default Reflected XSS Vulnerability - CVE-2011-1897 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Default Reflected XSS Vulnerability - CVE-2011-1897 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle specially crafted requests, allowing for allows content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, that then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update modifies the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 ------------------------------------------------------------ Microsoft Forefront Unified Access Gateway (UAG) applies a signed Java applet that can be leveraged by malicious Web sites to cause remote code execution on any Java-enabled Web browser. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1969](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1969). #### Mitigating Factors for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. #### Workarounds for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Blacklist the MicrosoftClient.Jar file** Add the entry for the following file: Java\\\\jre6\\\\lib\\\\security\\\\blacklist ``` # UAG Client MicrosoftClient.jar SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g= ``` **Impact of workaround.** MicrosoftClient.JAR will be blocked from running on the system.**How to undo the workaround.** Remove the entry for the following file:Java\\\\jre6\\\\lib\\\\security\\\\blacklist```# UAG Client MicrosoftClient.jarSHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=``` FAQ for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 What is the scope of the vulnerability? This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. What causes the vulnerability? This vulnerability is caused by a vulnerable Java applet that is installed on a browser by the Forefront Unified Access Gateway (UAG) server. What might an attacker use the vulnerability to do? An attacker could use this vulnerability to exploit clients that use UAG. How could an attacker exploit the vulnerability? A remote code execution vulnerability is introduced onto any Java-enabled browser by installing a vulnerable .jar file on client systems. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What systems are primarily at risk from the vulnerability? Client systems that use UAG are affected by this vulnerability. This vulnerability does not allow for compromise of the UAG server. What does the update do? This update modifies the vulnerable .jar file. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Null Session Cookie Crash - CVE-2011-2012 A denial of service vulnerability exists in implementations of Microsoft Forefront Unified Access Gateway (UAG). When this occurs, an attacker could leverage the vulnerability to stop the IIS worker process and deny access to Web services on the affected system. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-2012. Mitigating Factors for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any mitigating factors for this vulnerability. Workarounds for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any workarounds for this vulnerability. FAQ for Null Session Cookie Crash - CVE-2011-2012 What is the scope of the vulnerability? This is a denial of service vulnerability. What causes the vulnerability? This vulnerability is caused by improper validation of a NULL value contained within the session cookie. What might an attacker use the vulnerability to do? An attacker who exploits this vulnerability could use it to crash the web server on the affected UAG machine. How could an attacker exploit the vulnerability? An attacker could exploit this vulnerability by sending specially crafted network traffic to the affected UAG Web server. What systems are primarily at risk from the vulnerability? Systems running UAG Web server. What does the update do? This update adds exception handling around the null value of the UAG Web server. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" These updates will also be provided through our other standard distribution methods once testing has been completed to ensure distribution will be successful through these channels. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Forefront Unified Access Gateway 2010 (all versions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /quietFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /quietInstalling without restartingFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /norestartFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /norestartFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /norestartFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /norestartUpdate log fileFor Forefront Unified Access Gateway 2010 (KB2522482):MSI2522482.logFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):MSI2522483.logFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):MSI2522484.logFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):MSI2522485.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse the Installed Updates window as build-in Administrator or run msiexec from an elevated command line.File InformationFor Forefront Unified Access Gateway 2010 (KB2522482):See Microsoft Knowledge Base Article 2522482For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):See Microsoft Knowledge Base Article 2522483For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):See Microsoft Knowledge Base Article 2522484For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):See Microsoft Knowledge Base Article 2522485Registry Key VerificationFor Forefront Unified Access Gateway 2010 (KB2522482):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\54EBBA62-C7BB-4006-91D2-EFEB0738F93AFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\038FB8C4-F12D-428B-83F5-A964C34B6F2EFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\95244A26-7896-47D2-A49D-1FF43BC1C53CFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\715FC104-32DB-4AAB-A1B9-F1F496F71DE5 Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Note for this update However, you may not combine /quiet and /forcerestart for this update. See this known issue about install switch options in Microsoft Knowledge Base Article 2316074. Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Reflected XSS Vulnerability (CVE-2011-1896)Elisabeth Demeter of SEC Consult Unternehmensberatung GmbH for reporting the Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Forefront Unified Access Gateway 2010[1](KB2522482)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 1[1](KB2522483)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Update 2[1](KB2522484)Remote Code ExecutionImportantNoneMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1[1](KB2522485)Remote Code ExecutionImportantNone [1] This update is available from the Microsoft Download Center only. Please see the next section, **Frequently Asked Questions (FAQ) Related to This Security Update**. Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **Why are the updates only available from the Microsoft Download Center?** Microsoft is releasing these updates to the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129) so that customers can begin updating their systems as soon as possible. **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **Is Intelligent Application Gateway (IAG) affected by the vulnerabilities described in this bulletin?** Yes. Microsoft Intelligent Application Gateway 2007 Service Pack 2 is affected by ExcelTable Response Splitting Vulnerability (CVE-2011-1895), ExcelTable Reflected XSS Vulnerability (CVE-2011-1896), Default Reflected XSS Vulnerability (CVE-2011-1897), and Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969). For more information, IAG customers should contact their OEMs. Customers in the U.S. and Canada can also receive technical support from Customer Service and Support at 1-800-936-3100. International customers can also receive technical support from the Services and Field Security Support Team at 1-425-454-7946. Microsoft does not charge for support calls that are associated with security updates. For more information about how to contact Microsoft for support issues, visit [Microsoft Support](http://go.microsoft.com/fwlink/?linkid=21155). **Do administrators need to perform any additional actions after installing this update?** Yes. After installing this update, the UAG administrator needs to open the Forefront UAG Management console and activate the configuration for customers to be protected from the vulnerabilities described in this bulletin. **Why does this update address several reported security vulnerabilities?** This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [October bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-oct). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895ExcelTable Reflected XSS Vulnerability - CVE-2011-1896Default Reflected XSS Vulnerability - CVE-2011-1897Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969Null Session Cookie Crash - CVE-2011-2012Aggregate Severity RatingMicrosoft Forefront Unified Access Gateway 2010Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Update 2Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportantMicrosoft Forefront Unified Access Gateway 2010 Service Pack 1Important Elevation of PrivilegeImportant Elevation of PrivilegeImportant Elevation of PrivilegeImportant Remote Code ExecutionImportant Denial of ServiceImportant ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 --------------------------------------------------------------- An HTTP response splitting vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1895](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1895). #### Mitigating Factors for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Response Splitting XSS Vulnerability - CVE-2011-1895 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script contained in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 ------------------------------------------------------ An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1896](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1896). #### Mitigating Factors for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for ExcelTable Reflected XSS Vulnerability - CVE-2011-1896 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle script in a specially crafted request, allowing for malicious content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, which then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update addresses the vulnerability by modifying the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Default Reflected XSS Vulnerability - CVE-2011-1897 --------------------------------------------------- An XSS vulnerability exists in Microsoft Forefront Unified Access Gateway (UAG) server where JavaScript can be injected back to the user in the resulting page, effectively allowing attacker-controlled JavaScript to run in the context of the user clicking the link. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1897](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1897). #### Mitigating Factors for Default Reflected XSS Vulnerability - CVE-2011-1897 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. #### Workarounds for Default Reflected XSS Vulnerability - CVE-2011-1897 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Default Reflected XSS Vulnerability - CVE-2011-1897 **What is the scope of the vulnerability?** This is a cross-site scripting vulnerability that could result in elevation of privilege or information disclosure. **What causes the vulnerability?** This vulnerability is caused when Forefront Unified Access Gateway (UAG) does not properly handle specially crafted requests, allowing for allows content to be reflected back to the user. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could read content that the attacker is not authorized to read, use the victim's identity to take actions on behalf of the victim, and inject malicious content in the browser of the victim. **How could an attacker exploit the** **vulnerability?** For this vulnerability to be exploited, an authorized UAG user must click a specially crafted URL that takes the user to a targeted site on the UAG server that contains the malicious script, that then reflects the script back to the user's browser. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending an e-mail message containing the specially crafted URL to the user of the targeted UAG site and by convincing the user to click on the specially crafted URL. In a Web-based attack scenario, an attacker would have to host a Web site that contains a specially crafted URL to the targeted site that is used to attempt to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted Web site. Instead, an attacker would have to convince them to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes them to the attacker's Web site, and then convince them to click on the specially crafted URL. **What systems are primarily at risk from the vulnerability?** Users with access to a UAG server are at risk of exploitation of this vulnerability. **What does the update do?** This update modifies the way that UAG handles specially crafted requests, blocking the ability to reflect content back to the user. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 ------------------------------------------------------------ Microsoft Forefront Unified Access Gateway (UAG) applies a signed Java applet that can be leveraged by malicious Web sites to cause remote code execution on any Java-enabled Web browser. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1969](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1969). #### Mitigating Factors for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - An attacker who successfully exploited this vulnerability could gain the same user rights as the local user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. #### Workarounds for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Blacklist the MicrosoftClient.Jar file** Add the entry for the following file: Java\\\\jre6\\\\lib\\\\security\\\\blacklist ``` # UAG Client MicrosoftClient.jar SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g= ``` **Impact of workaround.** MicrosoftClient.JAR will be blocked from running on the system.**How to undo the workaround.** Remove the entry for the following file:Java\\\\jre6\\\\lib\\\\security\\\\blacklist```# UAG Client MicrosoftClient.jarSHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=``` FAQ for Poisoned Cup of Code Execution Vulnerability - CVE-2011-1969 What is the scope of the vulnerability? This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. What causes the vulnerability? This vulnerability is caused by a vulnerable Java applet that is installed on a browser by the Forefront Unified Access Gateway (UAG) server. What might an attacker use the vulnerability to do? An attacker could use this vulnerability to exploit clients that use UAG. How could an attacker exploit the vulnerability? A remote code execution vulnerability is introduced onto any Java-enabled browser by installing a vulnerable .jar file on client systems. An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. If a user is logged on with administrative user rights, an attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What systems are primarily at risk from the vulnerability? Client systems that use UAG are affected by this vulnerability. This vulnerability does not allow for compromise of the UAG server. What does the update do? This update modifies the vulnerable .jar file. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Null Session Cookie Crash - CVE-2011-2012 A denial of service vulnerability exists in implementations of Microsoft Forefront Unified Access Gateway (UAG). When this occurs, an attacker could leverage the vulnerability to stop the IIS worker process and deny access to Web services on the affected system. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-2012. Mitigating Factors for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any mitigating factors for this vulnerability. Workarounds for Null Session Cookie Crash - CVE-2011-2012 Microsoft has not identified any workarounds for this vulnerability. FAQ for Null Session Cookie Crash - CVE-2011-2012 What is the scope of the vulnerability? This is a denial of service vulnerability. What causes the vulnerability? This vulnerability is caused by improper validation of a NULL value contained within the session cookie. What might an attacker use the vulnerability to do? An attacker who exploits this vulnerability could use it to crash the web server on the affected UAG machine. How could an attacker exploit the vulnerability? An attacker could exploit this vulnerability by sending specially crafted network traffic to the affected UAG Web server. What systems are primarily at risk from the vulnerability? Systems running UAG Web server. What does the update do? This update adds exception handling around the null value of the UAG Web server. When this security bulletin was issued, had this vulnerability been publicly disclosed? No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited? No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" These updates will also be provided through our other standard distribution methods once testing has been completed to ensure distribution will be successful through these channels. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Forefront Unified Access Gateway 2010 (all versions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /quietFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /quietFor Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /quietInstalling without restartingFor Forefront Unified Access Gateway 2010 (KB2522482):UAG_HF_KB2522482_0_0_8.msp /norestartFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):UAG-KB2522483-v4.0.1152.163-ENU.msp /norestartFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):UAG-KB2522484-v4.0.1269.284-ENU.msp /norestartFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):UAG-KB2522485-v4.0.1752.10073-ENU.msp /norestartUpdate log fileFor Forefront Unified Access Gateway 2010 (KB2522482):MSI2522482.logFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):MSI2522483.logFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):MSI2522484.logFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):MSI2522485.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse the Installed Updates window as build-in Administrator or run msiexec from an elevated command line.File InformationFor Forefront Unified Access Gateway 2010 (KB2522482):See Microsoft Knowledge Base Article 2522482For Forefront Unified Access Gateway 2010 Update 1 (KB2522483):See Microsoft Knowledge Base Article 2522483For Forefront Unified Access Gateway 2010 Update 2 (KB2522484):See Microsoft Knowledge Base Article 2522484For Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):See Microsoft Knowledge Base Article 2522485Registry Key VerificationFor Forefront Unified Access Gateway 2010 (KB2522482):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\54EBBA62-C7BB-4006-91D2-EFEB0738F93AFor Forefront Unified Access Gateway 2010 Update 1 (KB2522483):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\038FB8C4-F12D-428B-83F5-A964C34B6F2EFor Forefront Unified Access Gateway 2010 Update 2 (KB2522484):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\95244A26-7896-47D2-A49D-1FF43BC1C53CFor Microsoft Forefront Unified Access Gateway 2010 Service Pack 1 (KB2522485):\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\S-1-5-18\\Components\\1F535B6CD0A46D11CA9800102002AF58\\E85EC0B9221C4BC4081C15D414260CC7\\715FC104-32DB-4AAB-A1B9-F1F496F71DE5 Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Note for this update However, you may not combine /quiet and /forcerestart for this update. See this known issue about install switch options in Microsoft Knowledge Base Article 2316074. Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Response Splitting XSS Vulnerabilitiy (CVE-2011-1895)Tenable Network Security for reporting the ExcelTable Reflected XSS Vulnerability (CVE-2011-1896)Elisabeth Demeter of SEC Consult Unternehmensberatung GmbH for reporting the Poisoned Cup of Code Execution Vulnerability (CVE-2011-1969) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-2002": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-077",
        "title": "Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Remote Code Execution (2567053)",
        "body": "This security update resolves four privately reported vulnerabilities in Microsoft Windows. The most severe of these vulnerabilities could allow remote code execution if a user opens a specially crafted font file (such as a .fon file) in a network share, a UNC or WebDAV location, or an e-mail attachment. For a remote attack to be successful, a user must visit an untrusted remote file system location or WebDAV share and open the specially crafted font file, or open the file as an e-mail attachment. This security update is rated Important for all supported releases of Microsoft Windows. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerabilities by correcting the way that the Windows kernel-mode drivers validate input passed from user mode, handle the TrueType font type, allocate the proper buffer size before writing to memory, and manage kernel-mode driver objects. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. The majority of customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see Microsoft Knowledge Base Article 294871. For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers apply the update at the earliest opportunity using update management software, or by checking for updates using the Microsoft Update service. See also the section, Detection and Deployment Tools and Guidance, later in this bulletin. Known Issues. None Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XP Service Pack 3Remote Code ExecutionImportantMS11-054Windows XP Professional x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 with SP2 for Itanium-based SystemsRemote Code ExecutionImportantMS11-054Windows Vista Service Pack 2Remote Code ExecutionImportantMS11-054Windows Vista x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2008 for 32-bit Systems Service Pack 2*Remote Code ExecutionImportantMS11-054Windows Server 2008 for x64-based Systems Service Pack 2*Remote Code ExecutionImportantMS11-054Windows Server 2008 for Itanium-based Systems Service Pack 2Remote Code ExecutionImportantMS11-054Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Remote Code ExecutionImportantMS11-054Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Remote Code ExecutionImportantMS11-054Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Remote Code ExecutionImportantMS11-054Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Remote Code ExecutionImportantMS11-054 *Server Core installation affected. This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Lifecycle Supported Service Packs. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the October bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareWin32k Null Pointer De-reference Vulnerability - CVE-2011-1985Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002Font Library File Buffer Overrun Vulnerability - CVE-2011-2003Win32k Use After Free Vulnerability - CVE-2011-2011Aggregate Severity RatingWindows XP Service Pack 3Important Elevation of PrivilegeNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows XP Professional x64 Edition Service Pack 2Moderate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 Service Pack 2Important Elevation of PrivilegeNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 x64 Edition Service Pack 2Moderate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 with SP2 for Itanium-based SystemsModerate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Vista Service Pack 2Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Vista x64 Edition Service Pack 2Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for 32-bit Systems Service Pack 2*Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for x64-based Systems Service Pack 2*Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for Itanium-based Systems Service Pack 2Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportant **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 -------------------------------------------------------------- An elevation of privilege vulnerability exists in the way that Windows kernel-mode drivers validate data supplied from user mode to kernel mode. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1985](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1985). #### Mitigating Factors for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. The vulnerability could not be exploited remotely or by anonymous users. #### Workarounds for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 **What is the scope of the vulnerability?** On 32-bit operating systems this is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. On x64-based and Itanium-based operating systems this is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when the Windows kernel-mode drivers do not properly validate input passed from user mode. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers validate input passed from user mode. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 ------------------------------------------------------------------- A denial of service vulnerability exists in implementations of Microsoft Windows when the system improperly processes a specially crafted TrueType font file. An attacker who successfully exploited this vulnerability could cause the affected system to stop responding. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2002](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2002). #### Mitigating Factors for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. #### FAQ for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 **What is the scope of the vulnerability?** This is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when a Windows kernel-mode driver fails to properly handle the TrueType font type. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** **The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could cause the affected system to stop responding and restart. **How could an attacker exploit the vulnerability?** An attacker could host a specially crafted TrueType font file on a network share. Then, when the user navigates to the share in Windows Explorer, the affected control path is triggered via the Details and Preview panes. The specially crafted TrueType font could then exploit the vulnerability and cause the system to stop responding. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way the Windows kernel-mode drivers handle the TrueType font type. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 -------------------------------------------------------------- A remote code execution vulnerability exists in the Windows kernel due to improper handling of a specially crafted .fon font file. The vulnerability could allow an attacker to run code in kernel-mode and then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2003](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2003). #### Mitigating Factors for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - For a remote attack to be successful, a user must visit an untrusted remote file system location or WebDAV share and open a specially crafted font file (such as a .fon file), or open the file as an e-mail attachment. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. #### FAQ for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 **What is the scope of the vulnerability?** This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could execute arbitrary code and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when a Windows kernel-mode driver does not perform proper validation when writing into a buffer. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the** **vulnerability?** In a network attack scenario, an attacker could place a specially crafted font file (such as a .fon file) in a network share, a UNC, or WebDAV location and then convince the user to open the file. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending a specially crafted font file attachment (such as a .fon file) to a user, and convince the user to open the file. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers allocate the proper buffer size before writing to memory. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Win32k Use After Free Vulnerability - CVE-2011-2011 --------------------------------------------------- An elevation of privilege vulnerability exists due to the way that Windows Kernel-mode drivers manage kernel-mode driver objects. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2011](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2011). #### Mitigating Factors for Win32k Use After Free Vulnerability - CVE-2011-2011 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. #### Workarounds for Win32k Use After Free Vulnerability - CVE-2011-2011 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Win32k Use After Free Vulnerability - CVE-2011-2011 **What is the scope of the vulnerability?** This is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when the kernel-mode drivers improperly manage kernel-mode driver objects. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What are TrueType fonts?** The TrueType font technology consists of two parts: the description of the fonts themselves (the TrueType font files) and a program that reads the font description and generates a bitmap representation of the font (the TrueType rasterizer). The TrueType rasterizer is a computer program that is incorporated as part of the operating system. A TrueType font file includes many different kinds of information used by the TrueType rasterizer and the operating system software to ensure that characters display on the computer screen or print out exactly as the font designer intended them to. For more information, see the MSDN article, [About Font Embedding](http://msdn.microsoft.com/en-us/library/ms533034.aspx). All operating systems listed in the Affected Software table support the rendering of EOT fonts by default. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers manage kernel-mode driver objects. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |----------------------------------------------------------------------------------------------------------------------|------| | Windows XP Service Pack 3 | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | | Windows Server 2003 Service Pack 2 | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | | Windows Vista Service Pack 2 | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |----------------------------------------------------------------------------------------------------------------------|--------------------|----------------------------| | Windows XP Service Pack 3 | Yes | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 Service Pack 2 | Yes | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | Yes | | Windows Vista Service Pack 2 | Yes | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Windows XP (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Windows XP Service Pack 3:WindowsXP-KB2567053-x86-enu.exe /quietFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /quietInstalling without restartingFor Windows XP Service Pack 3:WindowsXP-KB2567053-x86-enu.exe /norestartFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /norestartUpdate log fileKB2567053.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\$NTUninstallKB2567053$\\Spuninst folderFile InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationFor all supported 32-bit editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP4\\KB2567053\\FilelistFor all supported x64-based editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP3\\KB2567053\\Filelist Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. **Inclusion in Future Service Packs**The update for this issue will be included in a future service pack or update rollup**Deployment**Installing without user interventionFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2567053-x86-enu.exe /quiet For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /quietFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2567053-ia64-enu.exe /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2567053-x86-enu.exe /norestart For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /norestartFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2567053-ia64-enu.exe /norestartUpdate log fileKB2567053.logFurther informationSee the subsection, **Detection and Deployment Tools and Guidance****Restart Requirement** Restart required?Yes, you must restart your system after you apply this security update.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](http://support.microsoft.com/kb/897341).**Removal Information**Use **Add or Remove Programs** tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\\\$NTUninstallKB2567053$\\\\Spuninst folder**File Information**See [Microsoft Knowledge Base Article 2567053](http://support.microsoft.com/kb/2567053)**Registry Key Verification**HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Updates\\\\Windows Server 2003\\\\SP3\\\\KB2567053\\\\Filelist **Note** The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Vista (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows Vista:Windows6.0-KB2567053-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Vista:Windows6.0-KB2567053-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2567053-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2567053-ia64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2567053-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2567053-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows 7:Windows6.1-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows 7:Windows6.1-KB2567053-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows 7:Windows6.1-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows 7:Windows6.1-KB2567053-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-ia64.msu /quietInstalling without restartingFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Andrei Lutas of BitDefender for reporting the Win32k Null Pointer De-reference Vulnerability (CVE-2011-1985)Tarjei Mandt of Norman for reporting the Win32k Null Pointer De-reference Vulnerability (CVE-2011-1985)Maik Wellmann for reporting the Win32k TrueType Font Type Translation Vulnerability (CVE-2011-2002)Will Dorman of the CERT/CC for reporting the Font Library File Buffer Overrun Vulnerability (CVE-2011-2003) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XP Service Pack 3Remote Code ExecutionImportantMS11-054Windows XP Professional x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 with SP2 for Itanium-based SystemsRemote Code ExecutionImportantMS11-054Windows Vista Service Pack 2Remote Code ExecutionImportantMS11-054Windows Vista x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2008 for 32-bit Systems Service Pack 2*Remote Code ExecutionImportantMS11-054Windows Server 2008 for x64-based Systems Service Pack 2*Remote Code ExecutionImportantMS11-054Windows Server 2008 for Itanium-based Systems Service Pack 2Remote Code ExecutionImportantMS11-054Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Remote Code ExecutionImportantMS11-054Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Remote Code ExecutionImportantMS11-054Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Remote Code ExecutionImportantMS11-054Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Remote Code ExecutionImportantMS11-054 *Server Core installation affected. This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Lifecycle Supported Service Packs. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the October bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareWin32k Null Pointer De-reference Vulnerability - CVE-2011-1985Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002Font Library File Buffer Overrun Vulnerability - CVE-2011-2003Win32k Use After Free Vulnerability - CVE-2011-2011Aggregate Severity RatingWindows XP Service Pack 3Important Elevation of PrivilegeNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows XP Professional x64 Edition Service Pack 2Moderate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 Service Pack 2Important Elevation of PrivilegeNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 x64 Edition Service Pack 2Moderate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 with SP2 for Itanium-based SystemsModerate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Vista Service Pack 2Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Vista x64 Edition Service Pack 2Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for 32-bit Systems Service Pack 2*Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for x64-based Systems Service Pack 2*Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for Itanium-based Systems Service Pack 2Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportant **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 -------------------------------------------------------------- An elevation of privilege vulnerability exists in the way that Windows kernel-mode drivers validate data supplied from user mode to kernel mode. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1985](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1985). #### Mitigating Factors for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. The vulnerability could not be exploited remotely or by anonymous users. #### Workarounds for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 **What is the scope of the vulnerability?** On 32-bit operating systems this is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. On x64-based and Itanium-based operating systems this is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when the Windows kernel-mode drivers do not properly validate input passed from user mode. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers validate input passed from user mode. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 ------------------------------------------------------------------- A denial of service vulnerability exists in implementations of Microsoft Windows when the system improperly processes a specially crafted TrueType font file. An attacker who successfully exploited this vulnerability could cause the affected system to stop responding. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2002](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2002). #### Mitigating Factors for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. #### FAQ for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 **What is the scope of the vulnerability?** This is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when a Windows kernel-mode driver fails to properly handle the TrueType font type. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** **The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could cause the affected system to stop responding and restart. **How could an attacker exploit the vulnerability?** An attacker could host a specially crafted TrueType font file on a network share. Then, when the user navigates to the share in Windows Explorer, the affected control path is triggered via the Details and Preview panes. The specially crafted TrueType font could then exploit the vulnerability and cause the system to stop responding. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way the Windows kernel-mode drivers handle the TrueType font type. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 -------------------------------------------------------------- A remote code execution vulnerability exists in the Windows kernel due to improper handling of a specially crafted .fon font file. The vulnerability could allow an attacker to run code in kernel-mode and then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2003](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2003). #### Mitigating Factors for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - For a remote attack to be successful, a user must visit an untrusted remote file system location or WebDAV share and open a specially crafted font file (such as a .fon file), or open the file as an e-mail attachment. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. #### FAQ for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 **What is the scope of the vulnerability?** This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could execute arbitrary code and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when a Windows kernel-mode driver does not perform proper validation when writing into a buffer. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the** **vulnerability?** In a network attack scenario, an attacker could place a specially crafted font file (such as a .fon file) in a network share, a UNC, or WebDAV location and then convince the user to open the file. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending a specially crafted font file attachment (such as a .fon file) to a user, and convince the user to open the file. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers allocate the proper buffer size before writing to memory. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Win32k Use After Free Vulnerability - CVE-2011-2011 --------------------------------------------------- An elevation of privilege vulnerability exists due to the way that Windows Kernel-mode drivers manage kernel-mode driver objects. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2011](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2011). #### Mitigating Factors for Win32k Use After Free Vulnerability - CVE-2011-2011 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. #### Workarounds for Win32k Use After Free Vulnerability - CVE-2011-2011 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Win32k Use After Free Vulnerability - CVE-2011-2011 **What is the scope of the vulnerability?** This is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when the kernel-mode drivers improperly manage kernel-mode driver objects. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What are TrueType fonts?** The TrueType font technology consists of two parts: the description of the fonts themselves (the TrueType font files) and a program that reads the font description and generates a bitmap representation of the font (the TrueType rasterizer). The TrueType rasterizer is a computer program that is incorporated as part of the operating system. A TrueType font file includes many different kinds of information used by the TrueType rasterizer and the operating system software to ensure that characters display on the computer screen or print out exactly as the font designer intended them to. For more information, see the MSDN article, [About Font Embedding](http://msdn.microsoft.com/en-us/library/ms533034.aspx). All operating systems listed in the Affected Software table support the rendering of EOT fonts by default. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers manage kernel-mode driver objects. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |----------------------------------------------------------------------------------------------------------------------|------| | Windows XP Service Pack 3 | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | | Windows Server 2003 Service Pack 2 | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | | Windows Vista Service Pack 2 | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |----------------------------------------------------------------------------------------------------------------------|--------------------|----------------------------| | Windows XP Service Pack 3 | Yes | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 Service Pack 2 | Yes | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | Yes | | Windows Vista Service Pack 2 | Yes | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Windows XP (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Windows XP Service Pack 3:WindowsXP-KB2567053-x86-enu.exe /quietFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /quietInstalling without restartingFor Windows XP Service Pack 3:WindowsXP-KB2567053-x86-enu.exe /norestartFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /norestartUpdate log fileKB2567053.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\$NTUninstallKB2567053$\\Spuninst folderFile InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationFor all supported 32-bit editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP4\\KB2567053\\FilelistFor all supported x64-based editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP3\\KB2567053\\Filelist Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. **Inclusion in Future Service Packs**The update for this issue will be included in a future service pack or update rollup**Deployment**Installing without user interventionFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2567053-x86-enu.exe /quiet For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /quietFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2567053-ia64-enu.exe /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2567053-x86-enu.exe /norestart For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /norestartFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2567053-ia64-enu.exe /norestartUpdate log fileKB2567053.logFurther informationSee the subsection, **Detection and Deployment Tools and Guidance****Restart Requirement** Restart required?Yes, you must restart your system after you apply this security update.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](http://support.microsoft.com/kb/897341).**Removal Information**Use **Add or Remove Programs** tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\\\$NTUninstallKB2567053$\\\\Spuninst folder**File Information**See [Microsoft Knowledge Base Article 2567053](http://support.microsoft.com/kb/2567053)**Registry Key Verification**HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Updates\\\\Windows Server 2003\\\\SP3\\\\KB2567053\\\\Filelist **Note** The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Vista (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows Vista:Windows6.0-KB2567053-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Vista:Windows6.0-KB2567053-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2567053-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2567053-ia64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2567053-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2567053-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows 7:Windows6.1-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows 7:Windows6.1-KB2567053-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows 7:Windows6.1-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows 7:Windows6.1-KB2567053-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-ia64.msu /quietInstalling without restartingFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Andrei Lutas of BitDefender for reporting the Win32k Null Pointer De-reference Vulnerability (CVE-2011-1985)Tarjei Mandt of Norman for reporting the Win32k Null Pointer De-reference Vulnerability (CVE-2011-1985)Maik Wellmann for reporting the Win32k TrueType Font Type Translation Vulnerability (CVE-2011-2002)Will Dorman of the CERT/CC for reporting the Font Library File Buffer Overrun Vulnerability (CVE-2011-2003) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-2003": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-077",
        "title": "Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Remote Code Execution (2567053)",
        "body": "This security update resolves four privately reported vulnerabilities in Microsoft Windows. The most severe of these vulnerabilities could allow remote code execution if a user opens a specially crafted font file (such as a .fon file) in a network share, a UNC or WebDAV location, or an e-mail attachment. For a remote attack to be successful, a user must visit an untrusted remote file system location or WebDAV share and open the specially crafted font file, or open the file as an e-mail attachment. This security update is rated Important for all supported releases of Microsoft Windows. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerabilities by correcting the way that the Windows kernel-mode drivers validate input passed from user mode, handle the TrueType font type, allocate the proper buffer size before writing to memory, and manage kernel-mode driver objects. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. The majority of customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see Microsoft Knowledge Base Article 294871. For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers apply the update at the earliest opportunity using update management software, or by checking for updates using the Microsoft Update service. See also the section, Detection and Deployment Tools and Guidance, later in this bulletin. Known Issues. None Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XP Service Pack 3Remote Code ExecutionImportantMS11-054Windows XP Professional x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 with SP2 for Itanium-based SystemsRemote Code ExecutionImportantMS11-054Windows Vista Service Pack 2Remote Code ExecutionImportantMS11-054Windows Vista x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2008 for 32-bit Systems Service Pack 2*Remote Code ExecutionImportantMS11-054Windows Server 2008 for x64-based Systems Service Pack 2*Remote Code ExecutionImportantMS11-054Windows Server 2008 for Itanium-based Systems Service Pack 2Remote Code ExecutionImportantMS11-054Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Remote Code ExecutionImportantMS11-054Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Remote Code ExecutionImportantMS11-054Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Remote Code ExecutionImportantMS11-054Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Remote Code ExecutionImportantMS11-054 *Server Core installation affected. This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Lifecycle Supported Service Packs. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the October bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareWin32k Null Pointer De-reference Vulnerability - CVE-2011-1985Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002Font Library File Buffer Overrun Vulnerability - CVE-2011-2003Win32k Use After Free Vulnerability - CVE-2011-2011Aggregate Severity RatingWindows XP Service Pack 3Important Elevation of PrivilegeNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows XP Professional x64 Edition Service Pack 2Moderate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 Service Pack 2Important Elevation of PrivilegeNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 x64 Edition Service Pack 2Moderate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 with SP2 for Itanium-based SystemsModerate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Vista Service Pack 2Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Vista x64 Edition Service Pack 2Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for 32-bit Systems Service Pack 2*Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for x64-based Systems Service Pack 2*Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for Itanium-based Systems Service Pack 2Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportant **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 -------------------------------------------------------------- An elevation of privilege vulnerability exists in the way that Windows kernel-mode drivers validate data supplied from user mode to kernel mode. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1985](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1985). #### Mitigating Factors for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. The vulnerability could not be exploited remotely or by anonymous users. #### Workarounds for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 **What is the scope of the vulnerability?** On 32-bit operating systems this is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. On x64-based and Itanium-based operating systems this is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when the Windows kernel-mode drivers do not properly validate input passed from user mode. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers validate input passed from user mode. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 ------------------------------------------------------------------- A denial of service vulnerability exists in implementations of Microsoft Windows when the system improperly processes a specially crafted TrueType font file. An attacker who successfully exploited this vulnerability could cause the affected system to stop responding. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2002](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2002). #### Mitigating Factors for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. #### FAQ for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 **What is the scope of the vulnerability?** This is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when a Windows kernel-mode driver fails to properly handle the TrueType font type. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** **The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could cause the affected system to stop responding and restart. **How could an attacker exploit the vulnerability?** An attacker could host a specially crafted TrueType font file on a network share. Then, when the user navigates to the share in Windows Explorer, the affected control path is triggered via the Details and Preview panes. The specially crafted TrueType font could then exploit the vulnerability and cause the system to stop responding. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way the Windows kernel-mode drivers handle the TrueType font type. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 -------------------------------------------------------------- A remote code execution vulnerability exists in the Windows kernel due to improper handling of a specially crafted .fon font file. The vulnerability could allow an attacker to run code in kernel-mode and then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2003](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2003). #### Mitigating Factors for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - For a remote attack to be successful, a user must visit an untrusted remote file system location or WebDAV share and open a specially crafted font file (such as a .fon file), or open the file as an e-mail attachment. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. #### FAQ for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 **What is the scope of the vulnerability?** This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could execute arbitrary code and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when a Windows kernel-mode driver does not perform proper validation when writing into a buffer. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the** **vulnerability?** In a network attack scenario, an attacker could place a specially crafted font file (such as a .fon file) in a network share, a UNC, or WebDAV location and then convince the user to open the file. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending a specially crafted font file attachment (such as a .fon file) to a user, and convince the user to open the file. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers allocate the proper buffer size before writing to memory. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Win32k Use After Free Vulnerability - CVE-2011-2011 --------------------------------------------------- An elevation of privilege vulnerability exists due to the way that Windows Kernel-mode drivers manage kernel-mode driver objects. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2011](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2011). #### Mitigating Factors for Win32k Use After Free Vulnerability - CVE-2011-2011 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. #### Workarounds for Win32k Use After Free Vulnerability - CVE-2011-2011 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Win32k Use After Free Vulnerability - CVE-2011-2011 **What is the scope of the vulnerability?** This is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when the kernel-mode drivers improperly manage kernel-mode driver objects. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What are TrueType fonts?** The TrueType font technology consists of two parts: the description of the fonts themselves (the TrueType font files) and a program that reads the font description and generates a bitmap representation of the font (the TrueType rasterizer). The TrueType rasterizer is a computer program that is incorporated as part of the operating system. A TrueType font file includes many different kinds of information used by the TrueType rasterizer and the operating system software to ensure that characters display on the computer screen or print out exactly as the font designer intended them to. For more information, see the MSDN article, [About Font Embedding](http://msdn.microsoft.com/en-us/library/ms533034.aspx). All operating systems listed in the Affected Software table support the rendering of EOT fonts by default. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers manage kernel-mode driver objects. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |----------------------------------------------------------------------------------------------------------------------|------| | Windows XP Service Pack 3 | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | | Windows Server 2003 Service Pack 2 | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | | Windows Vista Service Pack 2 | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |----------------------------------------------------------------------------------------------------------------------|--------------------|----------------------------| | Windows XP Service Pack 3 | Yes | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 Service Pack 2 | Yes | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | Yes | | Windows Vista Service Pack 2 | Yes | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Windows XP (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Windows XP Service Pack 3:WindowsXP-KB2567053-x86-enu.exe /quietFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /quietInstalling without restartingFor Windows XP Service Pack 3:WindowsXP-KB2567053-x86-enu.exe /norestartFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /norestartUpdate log fileKB2567053.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\$NTUninstallKB2567053$\\Spuninst folderFile InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationFor all supported 32-bit editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP4\\KB2567053\\FilelistFor all supported x64-based editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP3\\KB2567053\\Filelist Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. **Inclusion in Future Service Packs**The update for this issue will be included in a future service pack or update rollup**Deployment**Installing without user interventionFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2567053-x86-enu.exe /quiet For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /quietFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2567053-ia64-enu.exe /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2567053-x86-enu.exe /norestart For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /norestartFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2567053-ia64-enu.exe /norestartUpdate log fileKB2567053.logFurther informationSee the subsection, **Detection and Deployment Tools and Guidance****Restart Requirement** Restart required?Yes, you must restart your system after you apply this security update.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](http://support.microsoft.com/kb/897341).**Removal Information**Use **Add or Remove Programs** tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\\\$NTUninstallKB2567053$\\\\Spuninst folder**File Information**See [Microsoft Knowledge Base Article 2567053](http://support.microsoft.com/kb/2567053)**Registry Key Verification**HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Updates\\\\Windows Server 2003\\\\SP3\\\\KB2567053\\\\Filelist **Note** The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Vista (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows Vista:Windows6.0-KB2567053-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Vista:Windows6.0-KB2567053-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2567053-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2567053-ia64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2567053-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2567053-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows 7:Windows6.1-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows 7:Windows6.1-KB2567053-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows 7:Windows6.1-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows 7:Windows6.1-KB2567053-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-ia64.msu /quietInstalling without restartingFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Andrei Lutas of BitDefender for reporting the Win32k Null Pointer De-reference Vulnerability (CVE-2011-1985)Tarjei Mandt of Norman for reporting the Win32k Null Pointer De-reference Vulnerability (CVE-2011-1985)Maik Wellmann for reporting the Win32k TrueType Font Type Translation Vulnerability (CVE-2011-2002)Will Dorman of the CERT/CC for reporting the Font Library File Buffer Overrun Vulnerability (CVE-2011-2003) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XP Service Pack 3Remote Code ExecutionImportantMS11-054Windows XP Professional x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 with SP2 for Itanium-based SystemsRemote Code ExecutionImportantMS11-054Windows Vista Service Pack 2Remote Code ExecutionImportantMS11-054Windows Vista x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2008 for 32-bit Systems Service Pack 2*Remote Code ExecutionImportantMS11-054Windows Server 2008 for x64-based Systems Service Pack 2*Remote Code ExecutionImportantMS11-054Windows Server 2008 for Itanium-based Systems Service Pack 2Remote Code ExecutionImportantMS11-054Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Remote Code ExecutionImportantMS11-054Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Remote Code ExecutionImportantMS11-054Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Remote Code ExecutionImportantMS11-054Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Remote Code ExecutionImportantMS11-054 *Server Core installation affected. This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Lifecycle Supported Service Packs. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the October bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareWin32k Null Pointer De-reference Vulnerability - CVE-2011-1985Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002Font Library File Buffer Overrun Vulnerability - CVE-2011-2003Win32k Use After Free Vulnerability - CVE-2011-2011Aggregate Severity RatingWindows XP Service Pack 3Important Elevation of PrivilegeNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows XP Professional x64 Edition Service Pack 2Moderate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 Service Pack 2Important Elevation of PrivilegeNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 x64 Edition Service Pack 2Moderate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 with SP2 for Itanium-based SystemsModerate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Vista Service Pack 2Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Vista x64 Edition Service Pack 2Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for 32-bit Systems Service Pack 2*Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for x64-based Systems Service Pack 2*Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for Itanium-based Systems Service Pack 2Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportant **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 -------------------------------------------------------------- An elevation of privilege vulnerability exists in the way that Windows kernel-mode drivers validate data supplied from user mode to kernel mode. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1985](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1985). #### Mitigating Factors for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. The vulnerability could not be exploited remotely or by anonymous users. #### Workarounds for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 **What is the scope of the vulnerability?** On 32-bit operating systems this is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. On x64-based and Itanium-based operating systems this is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when the Windows kernel-mode drivers do not properly validate input passed from user mode. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers validate input passed from user mode. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 ------------------------------------------------------------------- A denial of service vulnerability exists in implementations of Microsoft Windows when the system improperly processes a specially crafted TrueType font file. An attacker who successfully exploited this vulnerability could cause the affected system to stop responding. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2002](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2002). #### Mitigating Factors for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. #### FAQ for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 **What is the scope of the vulnerability?** This is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when a Windows kernel-mode driver fails to properly handle the TrueType font type. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** **The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could cause the affected system to stop responding and restart. **How could an attacker exploit the vulnerability?** An attacker could host a specially crafted TrueType font file on a network share. Then, when the user navigates to the share in Windows Explorer, the affected control path is triggered via the Details and Preview panes. The specially crafted TrueType font could then exploit the vulnerability and cause the system to stop responding. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way the Windows kernel-mode drivers handle the TrueType font type. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 -------------------------------------------------------------- A remote code execution vulnerability exists in the Windows kernel due to improper handling of a specially crafted .fon font file. The vulnerability could allow an attacker to run code in kernel-mode and then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2003](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2003). #### Mitigating Factors for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - For a remote attack to be successful, a user must visit an untrusted remote file system location or WebDAV share and open a specially crafted font file (such as a .fon file), or open the file as an e-mail attachment. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. #### FAQ for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 **What is the scope of the vulnerability?** This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could execute arbitrary code and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when a Windows kernel-mode driver does not perform proper validation when writing into a buffer. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the** **vulnerability?** In a network attack scenario, an attacker could place a specially crafted font file (such as a .fon file) in a network share, a UNC, or WebDAV location and then convince the user to open the file. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending a specially crafted font file attachment (such as a .fon file) to a user, and convince the user to open the file. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers allocate the proper buffer size before writing to memory. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Win32k Use After Free Vulnerability - CVE-2011-2011 --------------------------------------------------- An elevation of privilege vulnerability exists due to the way that Windows Kernel-mode drivers manage kernel-mode driver objects. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2011](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2011). #### Mitigating Factors for Win32k Use After Free Vulnerability - CVE-2011-2011 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. #### Workarounds for Win32k Use After Free Vulnerability - CVE-2011-2011 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Win32k Use After Free Vulnerability - CVE-2011-2011 **What is the scope of the vulnerability?** This is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when the kernel-mode drivers improperly manage kernel-mode driver objects. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What are TrueType fonts?** The TrueType font technology consists of two parts: the description of the fonts themselves (the TrueType font files) and a program that reads the font description and generates a bitmap representation of the font (the TrueType rasterizer). The TrueType rasterizer is a computer program that is incorporated as part of the operating system. A TrueType font file includes many different kinds of information used by the TrueType rasterizer and the operating system software to ensure that characters display on the computer screen or print out exactly as the font designer intended them to. For more information, see the MSDN article, [About Font Embedding](http://msdn.microsoft.com/en-us/library/ms533034.aspx). All operating systems listed in the Affected Software table support the rendering of EOT fonts by default. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers manage kernel-mode driver objects. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |----------------------------------------------------------------------------------------------------------------------|------| | Windows XP Service Pack 3 | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | | Windows Server 2003 Service Pack 2 | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | | Windows Vista Service Pack 2 | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |----------------------------------------------------------------------------------------------------------------------|--------------------|----------------------------| | Windows XP Service Pack 3 | Yes | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 Service Pack 2 | Yes | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | Yes | | Windows Vista Service Pack 2 | Yes | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Windows XP (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Windows XP Service Pack 3:WindowsXP-KB2567053-x86-enu.exe /quietFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /quietInstalling without restartingFor Windows XP Service Pack 3:WindowsXP-KB2567053-x86-enu.exe /norestartFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /norestartUpdate log fileKB2567053.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\$NTUninstallKB2567053$\\Spuninst folderFile InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationFor all supported 32-bit editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP4\\KB2567053\\FilelistFor all supported x64-based editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP3\\KB2567053\\Filelist Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. **Inclusion in Future Service Packs**The update for this issue will be included in a future service pack or update rollup**Deployment**Installing without user interventionFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2567053-x86-enu.exe /quiet For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /quietFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2567053-ia64-enu.exe /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2567053-x86-enu.exe /norestart For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /norestartFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2567053-ia64-enu.exe /norestartUpdate log fileKB2567053.logFurther informationSee the subsection, **Detection and Deployment Tools and Guidance****Restart Requirement** Restart required?Yes, you must restart your system after you apply this security update.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](http://support.microsoft.com/kb/897341).**Removal Information**Use **Add or Remove Programs** tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\\\$NTUninstallKB2567053$\\\\Spuninst folder**File Information**See [Microsoft Knowledge Base Article 2567053](http://support.microsoft.com/kb/2567053)**Registry Key Verification**HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Updates\\\\Windows Server 2003\\\\SP3\\\\KB2567053\\\\Filelist **Note** The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Vista (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows Vista:Windows6.0-KB2567053-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Vista:Windows6.0-KB2567053-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2567053-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2567053-ia64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2567053-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2567053-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows 7:Windows6.1-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows 7:Windows6.1-KB2567053-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows 7:Windows6.1-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows 7:Windows6.1-KB2567053-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-ia64.msu /quietInstalling without restartingFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Andrei Lutas of BitDefender for reporting the Win32k Null Pointer De-reference Vulnerability (CVE-2011-1985)Tarjei Mandt of Norman for reporting the Win32k Null Pointer De-reference Vulnerability (CVE-2011-1985)Maik Wellmann for reporting the Win32k TrueType Font Type Translation Vulnerability (CVE-2011-2002)Will Dorman of the CERT/CC for reporting the Font Library File Buffer Overrun Vulnerability (CVE-2011-2003) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-2004": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-084",
        "title": "Vulnerability in Windows Kernel-Mode Drivers Could Allow Denial of Service (2617657)",
        "body": "This security update resolves a privately reported vulnerability in Microsoft Windows. The vulnerability could allow denial of service if a user opens a specially crafted TrueType font file as an e-mail attachment or navigates to a network share or WebDAV location containing a specially crafted TrueType font file. For an attack to be successful, a user must visit the untrusted remote file system location or WebDAV share containing the specially crafted TrueType font file, or open the file as an e-mail attachment. In all cases, however, an attacker would have no way to force users to perform these actions. Instead, an attacker would have to persuade users to do so, typically by getting them to click a link in an e-mail message or Instant Messenger message. This security update is rated Moderate for all supported editions of Windows 7 and Windows 2008 R2. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerability by ensuring that the Windows kernel-mode drivers properly validate array indexes when loading TrueType font files. For more information about the vulnerability, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. The majority of customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see Microsoft Knowledge Base Article 294871. For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers consider applying the security update using update management software, or by checking for updates using the Microsoft Update service. See also the section, Detection and Deployment Tools and Guidance, later in this bulletin. Known Issues. None Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Denial of ServiceModerateMS11-077Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Denial of ServiceModerateMS11-077Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1***Denial of ServiceModerateMS11-077Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Denial of ServiceModerateMS11-077 ***Server Core installation not affected. The vulnerability addressed by this update does not affect supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, when installed using the Server Core installation option, even though files affected by this vulnerability may be present on the system. However, users with the affected files will still be offered this update because the update files are newer (with higher version numbers) than the files that are currently on your system. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. Non-Affected Software Operating SystemWindows XP Service Pack 3Windows XP Professional x64 Edition Service Pack 2Windows Server 2003 Service Pack 2Windows Server 2003 x64 Edition Service Pack 2Windows Server 2003 with SP2 for Itanium-based SystemsWindows Vista Service Pack 2Windows Vista x64 Edition Service Pack 2Windows Server 2008 for 32-bit Systems Service Pack 2Windows Server 2008 for x64-based Systems Service Pack 2Windows Server 2008 for Itanium-based Systems Service Pack 2 Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Service Pack Lifecycle Support Policy. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the November bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareTrueType Font Parsing Vulnerability - CVE-2011-2004Aggregate Severity RatingWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Moderate Denial of ServiceModerateWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Moderate Denial of ServiceModerateWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1***Moderate Denial of ServiceModerateWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Moderate Denial of ServiceModerate **\\*\\*\\*Server Core installation not affected.** The vulnerability addressed by this update does not affect supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, when installed using the Server Core installation option, even though files affected by this vulnerability may be present on the system. However, users with the affected files will still be offered this update because the update files are newer (with higher version numbers) than the files that are currently on your system. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). TrueType Font Parsing Vulnerability - CVE-2011-2004 --------------------------------------------------- A denial of service vulnerability exists in the Microsoft Windows kernel. This vulnerability is caused when the Windows kernel improperly processes a specifically crafted TrueType font file. An attacker who successfully exploited this vulnerability could cause the affected system to stop responding and restart. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2004](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2004). #### Mitigating Factors for TrueType Font Parsing Vulnerability - CVE-2011-2004 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - For an attack to be successful, a user must visit an untrusted remote file system location or WebDAV share containing a specially crafted TrueType font file, or open the file as an e-mail attachment. In all cases, however, an attacker would have no way to force users to perform these actions. Instead, an attacker would have to persuade users to do so, typically by getting them to click a link in an e-mail message or Instant Messenger message. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for TrueType Font Parsing Vulnerability - CVE-2011-2004 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. - **Block TCP ports 139 and 445 at the firewall** These ports are used to initiate a connection with the affected component. Blocking TCP ports 139 and 445 at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. For this specific vulnerability, both inbound and outbound SMB traffic should be blocked to reduce exposure. Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see the TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). **Impact of workaround.** Several Windows services use the affected ports. Blocking connectivity to the ports may cause various applications or services to not function. Some of the applications or services that could be impacted are listed below: - Applications that use SMB (CIFS) - Applications that use mailslots or named pipes (RPC over SMB) - Server (File and Print Sharing) - Group Policy - Net Logon - Distributed File System (DFS) - Terminal Server Licensing - Print Spooler - Computer Browser - Remote Procedure Call Locator - Fax Service - Indexing Service - Performance Logs and Alerts - Systems Management Server - License Logging Service **How to undo the workaround.** Unblock TCP ports 139 and 445 at the firewall. For more information about ports, see the TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). #### FAQ for TrueType Font Parsing Vulnerability - CVE-2011-2004 **What is the scope of the vulnerability?** This is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when Windows kernel-mode drivers fail to perform sufficient validation on an array index when loading a TrueType font file. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker that successfully exploited this vulnerability could cause the target system to stop responding and restart. **How could an attacker exploit the** **vulnerability?** An attacker could host a specially crafted TrueType font on a network share and when the user navigates to the share in Windows Explorer, the affected control path is triggered via the Details and Preview panes. The specially crafted TrueType font could then exploit the vulnerability and cause the system to stop responding. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses this vulnerability by ensuring that the Windows kernel-mode drivers properly validate array indexes when loading TrueType font files. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [](http://go.microsoft.com/fwlink/?linkid=21130)[Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |----------------------------------------------------------------------------------------------------------------------|------| | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |----------------------------------------------------------------------------------------------------------------------|--------------------|----------------------------| | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Windows 7 (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows 7:Windows6.1-KB2617657-x86.msu /quietFor all supported x64-based editions of Windows 7:Windows6.1-KB2617657-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows 7:Windows6.1-KB2617657-x86.msu /quiet /norestartFor all supported x64-based editions of Windows 7:Windows6.1-KB2617657-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2617657Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2617657-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2617657-ia64.msu /quietInstalling without restartingFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2617657-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2617657-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2617657Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Will Dorman of the CERT/CC for reporting the TrueType Font Parsing Vulnerability (CVE-2011-2004) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY (1-866-727-2338). There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (November 8, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Denial of ServiceModerateMS11-077Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Denial of ServiceModerateMS11-077Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1***Denial of ServiceModerateMS11-077Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Denial of ServiceModerateMS11-077 ***Server Core installation not affected. The vulnerability addressed by this update does not affect supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, when installed using the Server Core installation option, even though files affected by this vulnerability may be present on the system. However, users with the affected files will still be offered this update because the update files are newer (with higher version numbers) than the files that are currently on your system. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. Non-Affected Software Operating SystemWindows XP Service Pack 3Windows XP Professional x64 Edition Service Pack 2Windows Server 2003 Service Pack 2Windows Server 2003 x64 Edition Service Pack 2Windows Server 2003 with SP2 for Itanium-based SystemsWindows Vista Service Pack 2Windows Vista x64 Edition Service Pack 2Windows Server 2008 for 32-bit Systems Service Pack 2Windows Server 2008 for x64-based Systems Service Pack 2Windows Server 2008 for Itanium-based Systems Service Pack 2 Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Service Pack Lifecycle Support Policy. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the November bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareTrueType Font Parsing Vulnerability - CVE-2011-2004Aggregate Severity RatingWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Moderate Denial of ServiceModerateWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Moderate Denial of ServiceModerateWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1***Moderate Denial of ServiceModerateWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Moderate Denial of ServiceModerate **\\*\\*\\*Server Core installation not affected.** The vulnerability addressed by this update does not affect supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, when installed using the Server Core installation option, even though files affected by this vulnerability may be present on the system. However, users with the affected files will still be offered this update because the update files are newer (with higher version numbers) than the files that are currently on your system. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). TrueType Font Parsing Vulnerability - CVE-2011-2004 --------------------------------------------------- A denial of service vulnerability exists in the Microsoft Windows kernel. This vulnerability is caused when the Windows kernel improperly processes a specifically crafted TrueType font file. An attacker who successfully exploited this vulnerability could cause the affected system to stop responding and restart. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2004](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2004). #### Mitigating Factors for TrueType Font Parsing Vulnerability - CVE-2011-2004 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - For an attack to be successful, a user must visit an untrusted remote file system location or WebDAV share containing a specially crafted TrueType font file, or open the file as an e-mail attachment. In all cases, however, an attacker would have no way to force users to perform these actions. Instead, an attacker would have to persuade users to do so, typically by getting them to click a link in an e-mail message or Instant Messenger message. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for TrueType Font Parsing Vulnerability - CVE-2011-2004 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. - **Block TCP ports 139 and 445 at the firewall** These ports are used to initiate a connection with the affected component. Blocking TCP ports 139 and 445 at the firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. For this specific vulnerability, both inbound and outbound SMB traffic should be blocked to reduce exposure. Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about ports, see the TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). **Impact of workaround.** Several Windows services use the affected ports. Blocking connectivity to the ports may cause various applications or services to not function. Some of the applications or services that could be impacted are listed below: - Applications that use SMB (CIFS) - Applications that use mailslots or named pipes (RPC over SMB) - Server (File and Print Sharing) - Group Policy - Net Logon - Distributed File System (DFS) - Terminal Server Licensing - Print Spooler - Computer Browser - Remote Procedure Call Locator - Fax Service - Indexing Service - Performance Logs and Alerts - Systems Management Server - License Logging Service **How to undo the workaround.** Unblock TCP ports 139 and 445 at the firewall. For more information about ports, see the TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). #### FAQ for TrueType Font Parsing Vulnerability - CVE-2011-2004 **What is the scope of the vulnerability?** This is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when Windows kernel-mode drivers fail to perform sufficient validation on an array index when loading a TrueType font file. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker that successfully exploited this vulnerability could cause the target system to stop responding and restart. **How could an attacker exploit the** **vulnerability?** An attacker could host a specially crafted TrueType font on a network share and when the user navigates to the share in Windows Explorer, the affected control path is triggered via the Details and Preview panes. The specially crafted TrueType font could then exploit the vulnerability and cause the system to stop responding. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses this vulnerability by ensuring that the Windows kernel-mode drivers properly validate array indexes when loading TrueType font files. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [](http://go.microsoft.com/fwlink/?linkid=21130)[Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |----------------------------------------------------------------------------------------------------------------------|------| | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |----------------------------------------------------------------------------------------------------------------------|--------------------|----------------------------| | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Windows 7 (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows 7:Windows6.1-KB2617657-x86.msu /quietFor all supported x64-based editions of Windows 7:Windows6.1-KB2617657-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows 7:Windows6.1-KB2617657-x86.msu /quiet /norestartFor all supported x64-based editions of Windows 7:Windows6.1-KB2617657-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2617657Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2617657-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2617657-ia64.msu /quietInstalling without restartingFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2617657-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2617657-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2617657Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Will Dorman of the CERT/CC for reporting the TrueType Font Parsing Vulnerability (CVE-2011-2004) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY (1-866-727-2338). There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (November 8, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-2011": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-077",
        "title": "Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Remote Code Execution (2567053)",
        "body": "This security update resolves four privately reported vulnerabilities in Microsoft Windows. The most severe of these vulnerabilities could allow remote code execution if a user opens a specially crafted font file (such as a .fon file) in a network share, a UNC or WebDAV location, or an e-mail attachment. For a remote attack to be successful, a user must visit an untrusted remote file system location or WebDAV share and open the specially crafted font file, or open the file as an e-mail attachment. This security update is rated Important for all supported releases of Microsoft Windows. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerabilities by correcting the way that the Windows kernel-mode drivers validate input passed from user mode, handle the TrueType font type, allocate the proper buffer size before writing to memory, and manage kernel-mode driver objects. For more information about the vulnerabilities, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. The majority of customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see Microsoft Knowledge Base Article 294871. For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers apply the update at the earliest opportunity using update management software, or by checking for updates using the Microsoft Update service. See also the section, Detection and Deployment Tools and Guidance, later in this bulletin. Known Issues. None Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XP Service Pack 3Remote Code ExecutionImportantMS11-054Windows XP Professional x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 with SP2 for Itanium-based SystemsRemote Code ExecutionImportantMS11-054Windows Vista Service Pack 2Remote Code ExecutionImportantMS11-054Windows Vista x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2008 for 32-bit Systems Service Pack 2*Remote Code ExecutionImportantMS11-054Windows Server 2008 for x64-based Systems Service Pack 2*Remote Code ExecutionImportantMS11-054Windows Server 2008 for Itanium-based Systems Service Pack 2Remote Code ExecutionImportantMS11-054Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Remote Code ExecutionImportantMS11-054Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Remote Code ExecutionImportantMS11-054Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Remote Code ExecutionImportantMS11-054Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Remote Code ExecutionImportantMS11-054 *Server Core installation affected. This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Lifecycle Supported Service Packs. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the October bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareWin32k Null Pointer De-reference Vulnerability - CVE-2011-1985Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002Font Library File Buffer Overrun Vulnerability - CVE-2011-2003Win32k Use After Free Vulnerability - CVE-2011-2011Aggregate Severity RatingWindows XP Service Pack 3Important Elevation of PrivilegeNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows XP Professional x64 Edition Service Pack 2Moderate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 Service Pack 2Important Elevation of PrivilegeNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 x64 Edition Service Pack 2Moderate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 with SP2 for Itanium-based SystemsModerate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Vista Service Pack 2Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Vista x64 Edition Service Pack 2Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for 32-bit Systems Service Pack 2*Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for x64-based Systems Service Pack 2*Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for Itanium-based Systems Service Pack 2Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportant **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 -------------------------------------------------------------- An elevation of privilege vulnerability exists in the way that Windows kernel-mode drivers validate data supplied from user mode to kernel mode. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1985](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1985). #### Mitigating Factors for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. The vulnerability could not be exploited remotely or by anonymous users. #### Workarounds for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 **What is the scope of the vulnerability?** On 32-bit operating systems this is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. On x64-based and Itanium-based operating systems this is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when the Windows kernel-mode drivers do not properly validate input passed from user mode. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers validate input passed from user mode. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 ------------------------------------------------------------------- A denial of service vulnerability exists in implementations of Microsoft Windows when the system improperly processes a specially crafted TrueType font file. An attacker who successfully exploited this vulnerability could cause the affected system to stop responding. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2002](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2002). #### Mitigating Factors for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. #### FAQ for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 **What is the scope of the vulnerability?** This is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when a Windows kernel-mode driver fails to properly handle the TrueType font type. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** **The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could cause the affected system to stop responding and restart. **How could an attacker exploit the vulnerability?** An attacker could host a specially crafted TrueType font file on a network share. Then, when the user navigates to the share in Windows Explorer, the affected control path is triggered via the Details and Preview panes. The specially crafted TrueType font could then exploit the vulnerability and cause the system to stop responding. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way the Windows kernel-mode drivers handle the TrueType font type. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 -------------------------------------------------------------- A remote code execution vulnerability exists in the Windows kernel due to improper handling of a specially crafted .fon font file. The vulnerability could allow an attacker to run code in kernel-mode and then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2003](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2003). #### Mitigating Factors for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - For a remote attack to be successful, a user must visit an untrusted remote file system location or WebDAV share and open a specially crafted font file (such as a .fon file), or open the file as an e-mail attachment. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. #### FAQ for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 **What is the scope of the vulnerability?** This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could execute arbitrary code and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when a Windows kernel-mode driver does not perform proper validation when writing into a buffer. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the** **vulnerability?** In a network attack scenario, an attacker could place a specially crafted font file (such as a .fon file) in a network share, a UNC, or WebDAV location and then convince the user to open the file. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending a specially crafted font file attachment (such as a .fon file) to a user, and convince the user to open the file. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers allocate the proper buffer size before writing to memory. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Win32k Use After Free Vulnerability - CVE-2011-2011 --------------------------------------------------- An elevation of privilege vulnerability exists due to the way that Windows Kernel-mode drivers manage kernel-mode driver objects. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2011](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2011). #### Mitigating Factors for Win32k Use After Free Vulnerability - CVE-2011-2011 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. #### Workarounds for Win32k Use After Free Vulnerability - CVE-2011-2011 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Win32k Use After Free Vulnerability - CVE-2011-2011 **What is the scope of the vulnerability?** This is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when the kernel-mode drivers improperly manage kernel-mode driver objects. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What are TrueType fonts?** The TrueType font technology consists of two parts: the description of the fonts themselves (the TrueType font files) and a program that reads the font description and generates a bitmap representation of the font (the TrueType rasterizer). The TrueType rasterizer is a computer program that is incorporated as part of the operating system. A TrueType font file includes many different kinds of information used by the TrueType rasterizer and the operating system software to ensure that characters display on the computer screen or print out exactly as the font designer intended them to. For more information, see the MSDN article, [About Font Embedding](http://msdn.microsoft.com/en-us/library/ms533034.aspx). All operating systems listed in the Affected Software table support the rendering of EOT fonts by default. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers manage kernel-mode driver objects. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |----------------------------------------------------------------------------------------------------------------------|------| | Windows XP Service Pack 3 | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | | Windows Server 2003 Service Pack 2 | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | | Windows Vista Service Pack 2 | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |----------------------------------------------------------------------------------------------------------------------|--------------------|----------------------------| | Windows XP Service Pack 3 | Yes | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 Service Pack 2 | Yes | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | Yes | | Windows Vista Service Pack 2 | Yes | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Windows XP (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Windows XP Service Pack 3:WindowsXP-KB2567053-x86-enu.exe /quietFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /quietInstalling without restartingFor Windows XP Service Pack 3:WindowsXP-KB2567053-x86-enu.exe /norestartFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /norestartUpdate log fileKB2567053.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\$NTUninstallKB2567053$\\Spuninst folderFile InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationFor all supported 32-bit editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP4\\KB2567053\\FilelistFor all supported x64-based editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP3\\KB2567053\\Filelist Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. **Inclusion in Future Service Packs**The update for this issue will be included in a future service pack or update rollup**Deployment**Installing without user interventionFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2567053-x86-enu.exe /quiet For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /quietFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2567053-ia64-enu.exe /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2567053-x86-enu.exe /norestart For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /norestartFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2567053-ia64-enu.exe /norestartUpdate log fileKB2567053.logFurther informationSee the subsection, **Detection and Deployment Tools and Guidance****Restart Requirement** Restart required?Yes, you must restart your system after you apply this security update.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](http://support.microsoft.com/kb/897341).**Removal Information**Use **Add or Remove Programs** tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\\\$NTUninstallKB2567053$\\\\Spuninst folder**File Information**See [Microsoft Knowledge Base Article 2567053](http://support.microsoft.com/kb/2567053)**Registry Key Verification**HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Updates\\\\Windows Server 2003\\\\SP3\\\\KB2567053\\\\Filelist **Note** The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Vista (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows Vista:Windows6.0-KB2567053-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Vista:Windows6.0-KB2567053-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2567053-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2567053-ia64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2567053-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2567053-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows 7:Windows6.1-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows 7:Windows6.1-KB2567053-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows 7:Windows6.1-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows 7:Windows6.1-KB2567053-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-ia64.msu /quietInstalling without restartingFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Andrei Lutas of BitDefender for reporting the Win32k Null Pointer De-reference Vulnerability (CVE-2011-1985)Tarjei Mandt of Norman for reporting the Win32k Null Pointer De-reference Vulnerability (CVE-2011-1985)Maik Wellmann for reporting the Win32k TrueType Font Type Translation Vulnerability (CVE-2011-2002)Will Dorman of the CERT/CC for reporting the Font Library File Buffer Overrun Vulnerability (CVE-2011-2003) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XP Service Pack 3Remote Code ExecutionImportantMS11-054Windows XP Professional x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2003 with SP2 for Itanium-based SystemsRemote Code ExecutionImportantMS11-054Windows Vista Service Pack 2Remote Code ExecutionImportantMS11-054Windows Vista x64 Edition Service Pack 2Remote Code ExecutionImportantMS11-054Windows Server 2008 for 32-bit Systems Service Pack 2*Remote Code ExecutionImportantMS11-054Windows Server 2008 for x64-based Systems Service Pack 2*Remote Code ExecutionImportantMS11-054Windows Server 2008 for Itanium-based Systems Service Pack 2Remote Code ExecutionImportantMS11-054Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Remote Code ExecutionImportantMS11-054Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Remote Code ExecutionImportantMS11-054Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Remote Code ExecutionImportantMS11-054Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Remote Code ExecutionImportantMS11-054 *Server Core installation affected. This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Lifecycle Supported Service Packs. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the October bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareWin32k Null Pointer De-reference Vulnerability - CVE-2011-1985Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002Font Library File Buffer Overrun Vulnerability - CVE-2011-2003Win32k Use After Free Vulnerability - CVE-2011-2011Aggregate Severity RatingWindows XP Service Pack 3Important Elevation of PrivilegeNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows XP Professional x64 Edition Service Pack 2Moderate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 Service Pack 2Important Elevation of PrivilegeNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 x64 Edition Service Pack 2Moderate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2003 with SP2 for Itanium-based SystemsModerate Denial of ServiceNot applicableImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Vista Service Pack 2Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Vista x64 Edition Service Pack 2Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for 32-bit Systems Service Pack 2*Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for x64-based Systems Service Pack 2*Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 for Itanium-based Systems Service Pack 2Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Important Elevation of PrivilegeModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportantWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Moderate Denial of ServiceModerate Denial of ServiceImportant Remote Code ExecutionImportant Elevation of PrivilegeImportant **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 -------------------------------------------------------------- An elevation of privilege vulnerability exists in the way that Windows kernel-mode drivers validate data supplied from user mode to kernel mode. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-1985](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-1985). #### Mitigating Factors for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. The vulnerability could not be exploited remotely or by anonymous users. #### Workarounds for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Win32k Null Pointer De-reference Vulnerability - CVE-2011-1985 **What is the scope of the vulnerability?** On 32-bit operating systems this is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. On x64-based and Itanium-based operating systems this is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when the Windows kernel-mode drivers do not properly validate input passed from user mode. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers validate input passed from user mode. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 ------------------------------------------------------------------- A denial of service vulnerability exists in implementations of Microsoft Windows when the system improperly processes a specially crafted TrueType font file. An attacker who successfully exploited this vulnerability could cause the affected system to stop responding. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2002](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2002). #### Mitigating Factors for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - In a Web-based attack scenario, an attacker could host a Web site that contains a Web page that is used to exploit this vulnerability. In addition, compromised Web sites and Web sites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these Web sites. Instead, an attacker would have to persuade users to visit the Web site, typically by getting them to click a link in an e-mail message or Instant Messenger message that takes users to the attacker's Web site. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. #### FAQ for Win32k TrueType Font Type Translation Vulnerability - CVE-2011-2002 **What is the scope of the vulnerability?** This is a denial of service vulnerability. **What causes the vulnerability?** The vulnerability is caused when a Windows kernel-mode driver fails to properly handle the TrueType font type. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** **The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could cause the affected system to stop responding and restart. **How could an attacker exploit the vulnerability?** An attacker could host a specially crafted TrueType font file on a network share. Then, when the user navigates to the share in Windows Explorer, the affected control path is triggered via the Details and Preview panes. The specially crafted TrueType font could then exploit the vulnerability and cause the system to stop responding. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way the Windows kernel-mode drivers handle the TrueType font type. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 -------------------------------------------------------------- A remote code execution vulnerability exists in the Windows kernel due to improper handling of a specially crafted .fon font file. The vulnerability could allow an attacker to run code in kernel-mode and then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2003](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2003). #### Mitigating Factors for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - For a remote attack to be successful, a user must visit an untrusted remote file system location or WebDAV share and open a specially crafted font file (such as a .fon file), or open the file as an e-mail attachment. - The file sharing protocol SMB is often disabled on the perimeter firewall. This limits the potential remote attack vectors for this vulnerability. #### Workarounds for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Disable the** **WebClient** **service** Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround it is still possible for remote attackers who successfully exploit this vulnerability to cause the system to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Disabled**. If the service is running, click **Stop**. 4. Click **OK** and exit the management application. **Impact of workaround.** When the WebClient service is disabled, Web Distributed Authoring and Versioning (WebDAV) requests are not transmitted. In addition, any services that explicitly depend on the WebClient service will not start, and an error message will be logged in the System log. For example, WebDAV shares will be inaccessible from the client computer. **How to undo the workaround.** To re-enable the WebClient Service, perform the following steps: 1. Click **Start**, click **Run**, type **Services.msc** and then click **OK**. 2. Right-click **WebClient** service and select **Properties**. 3. Change the Startup type to **Automatic**. If the service is not running, click **Start**. 4. Click **OK** and exit the management application. #### FAQ for Font Library File Buffer Overrun Vulnerability - CVE-2011-2003 **What is the scope of the vulnerability?** This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could execute arbitrary code and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when a Windows kernel-mode driver does not perform proper validation when writing into a buffer. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the** **vulnerability?** In a network attack scenario, an attacker could place a specially crafted font file (such as a .fon file) in a network share, a UNC, or WebDAV location and then convince the user to open the file. In an e-mail attack scenario, an attacker could exploit the vulnerability by sending a specially crafted font file attachment (such as a .fon file) to a user, and convince the user to open the file. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers allocate the proper buffer size before writing to memory. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Win32k Use After Free Vulnerability - CVE-2011-2011 --------------------------------------------------- An elevation of privilege vulnerability exists due to the way that Windows Kernel-mode drivers manage kernel-mode driver objects. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2011](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2011). #### Mitigating Factors for Win32k Use After Free Vulnerability - CVE-2011-2011 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: - An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. #### Workarounds for Win32k Use After Free Vulnerability - CVE-2011-2011 Microsoft has not identified any workarounds for this vulnerability. #### FAQ for Win32k Use After Free Vulnerability - CVE-2011-2011 **What is the scope of the vulnerability?** This is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **What causes the vulnerability?** The vulnerability is caused when the kernel-mode drivers improperly manage kernel-mode driver objects. **What is the component affected by this vulnerability?** Win32k.sys is the Windows component affected by the vulnerability. **What is the Windows kernel?** The Windows kernel is the core of the operating system. It provides system-level services such as device management and memory management, allocates processor time to processes, and manages error handling. **What is the Windows kernel-mode driver (win32k.sys)?** Win32k.sys is a kernel-mode device driver and is the kernel part of the Windows subsystem. It contains the window manager, which controls window displays; manages screen output; collects input from the keyboard, mouse, and other devices; and passes user messages to applications. It also contains the Graphics Device Interface (GDI), which is a library of functions for graphics output devices. Finally, it serves as a wrapper for DirectX support that is implemented in another driver (dxgkrnl.sys). **What are TrueType fonts?** The TrueType font technology consists of two parts: the description of the fonts themselves (the TrueType font files) and a program that reads the font description and generates a bitmap representation of the font (the TrueType rasterizer). The TrueType rasterizer is a computer program that is incorporated as part of the operating system. A TrueType font file includes many different kinds of information used by the TrueType rasterizer and the operating system software to ensure that characters display on the computer screen or print out exactly as the font designer intended them to. For more information, see the MSDN article, [About Font Embedding](http://msdn.microsoft.com/en-us/library/ms533034.aspx). All operating systems listed in the Affected Software table support the rendering of EOT fonts by default. **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode and take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. **How could an attacker exploit the vulnerability?** To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system. **What systems are primarily at risk from the vulnerability?** Workstations and terminal servers are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. **What does the update do?** The update addresses the vulnerability by correcting the way that the Windows kernel-mode drivers manage kernel-mode driver objects. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |----------------------------------------------------------------------------------------------------------------------|------| | Windows XP Service Pack 3 | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | | Windows Server 2003 Service Pack 2 | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | | Windows Vista Service Pack 2 | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |----------------------------------------------------------------------------------------------------------------------|--------------------|----------------------------| | Windows XP Service Pack 3 | Yes | Yes | | Windows XP Professional x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 Service Pack 2 | Yes | Yes | | Windows Server 2003 x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2003 with SP2 for Itanium-based Systems | Yes | Yes | | Windows Vista Service Pack 2 | Yes | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Windows XP (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Windows XP Service Pack 3:WindowsXP-KB2567053-x86-enu.exe /quietFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /quietInstalling without restartingFor Windows XP Service Pack 3:WindowsXP-KB2567053-x86-enu.exe /norestartFor Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /norestartUpdate log fileKB2567053.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\$NTUninstallKB2567053$\\Spuninst folderFile InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationFor all supported 32-bit editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP4\\KB2567053\\FilelistFor all supported x64-based editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP3\\KB2567053\\Filelist Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. **Inclusion in Future Service Packs**The update for this issue will be included in a future service pack or update rollup**Deployment**Installing without user interventionFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2567053-x86-enu.exe /quiet For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /quietFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2567053-ia64-enu.exe /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2003: WindowsServer2003-KB2567053-x86-enu.exe /norestart For all supported x64-based editions of Windows Server 2003: WindowsServer2003.WindowsXP-KB2567053-x64-enu.exe /norestartFor all supported Itanium-based editions of Windows Server 2003: WindowsServer2003-KB2567053-ia64-enu.exe /norestartUpdate log fileKB2567053.logFurther informationSee the subsection, **Detection and Deployment Tools and Guidance****Restart Requirement** Restart required?Yes, you must restart your system after you apply this security update.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](http://support.microsoft.com/kb/897341).**Removal Information**Use **Add or Remove Programs** tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\\\$NTUninstallKB2567053$\\\\Spuninst folder**File Information**See [Microsoft Knowledge Base Article 2567053](http://support.microsoft.com/kb/2567053)**Registry Key Verification**HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Updates\\\\Windows Server 2003\\\\SP3\\\\KB2567053\\\\Filelist **Note** The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Vista (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows Vista:Windows6.0-KB2567053-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Vista:Windows6.0-KB2567053-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2567053-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2567053-ia64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2567053-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2567053-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows 7:Windows6.1-KB2567053-x86.msu /quietFor all supported x64-based editions of Windows 7:Windows6.1-KB2567053-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows 7:Windows6.1-KB2567053-x86.msu /quiet /norestartFor all supported x64-based editions of Windows 7:Windows6.1-KB2567053-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-ia64.msu /quietInstalling without restartingFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2567053-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2567053Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Andrei Lutas of BitDefender for reporting the Win32k Null Pointer De-reference Vulnerability (CVE-2011-1985)Tarjei Mandt of Norman for reporting the Win32k Null Pointer De-reference Vulnerability (CVE-2011-1985)Maik Wellmann for reporting the Win32k TrueType Font Type Translation Vulnerability (CVE-2011-2002)Will Dorman of the CERT/CC for reporting the Font Library File Buffer Overrun Vulnerability (CVE-2011-2003) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (October 11, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-2013": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-083",
        "title": "Vulnerability in TCP/IP Could Allow Remote Code Execution (2588516)",
        "body": "This security update resolves a privately reported vulnerability in Microsoft Windows. The vulnerability could allow remote code execution if an attacker sends a continuous flow of specially crafted UDP packets to a closed port on a target system. This security update is rated Critical for all supported editions of Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2. For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerability by modifying the way that the Windows TCP/IP stack keeps track of UDP packets within memory. For more information about the vulnerability, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. The majority of customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see Microsoft Knowledge Base Article 294871. For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers apply the update immediately using update management software, or by checking for updates using the Microsoft Update service. See also the section, Detection and Deployment Tools and Guidance, later in this bulletin. Known Issues. None Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows Vista Service Pack 2CriticalRemote Code ExecutionMS11-064Windows Vista x64 Edition Service Pack 2CriticalRemote Code ExecutionMS11-064Windows Server 2008 for 32-bit Systems Service Pack 2*CriticalRemote Code ExecutionMS11-064Windows Server 2008 for x64-based Systems Service Pack 2*CriticalRemote Code ExecutionMS11-064Windows Server 2008 for Itanium-based Systems Service Pack 2CriticalRemote Code ExecutionMS11-064Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1CriticalRemote Code ExecutionMS11-064Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1CriticalRemote Code ExecutionMS11-064Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*CriticalRemote Code ExecutionMS11-064Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1CriticalRemote Code ExecutionMS11-064 *Server Core installation affected. This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. Non-Affected Software Operating SystemWindows XP Service Pack 3Windows XP Professional x64 Edition Service Pack 2Windows Server 2003 Service Pack 2Windows Server 2003 x64 Edition Service Pack 2Windows Server 2003 with SP2 for Itanium-based Systems Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Service Pack Lifecycle Support Policy. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the November bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareReference Counter Overflow Vulnerability - CVE-2011-2013Aggregate Severity RatingWindows Vista Service Pack 2Critical Remote Code ExecutionCriticalWindows Vista x64 Edition Service Pack 2Critical Remote Code ExecutionCriticalWindows Server 2008 for 32-bit Systems Service Pack 2*Critical Remote Code ExecutionCriticalWindows Server 2008 for x64-based Systems Service Pack 2*Critical Remote Code ExecutionCriticalWindows Server 2008 for Itanium-based Systems Service Pack 2Critical Remote Code ExecutionCriticalWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Critical Remote Code ExecutionCriticalWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Critical Remote Code ExecutionCriticalWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Critical Remote Code ExecutionCriticalWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Critical Remote Code ExecutionCritical **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). Reference Counter Overflow Vulnerability - CVE-2011-2013 -------------------------------------------------------- A remote code execution vulnerability exists in the Windows TCP/IP stack due to the processing of a continuous flow of specially crafted UDP packets. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2013](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2013). #### Mitigating Factors for Reference Counter Overflow Vulnerability - CVE-2011-2013 Microsoft has not identified any mitigating factors for this vulnerability. #### Workarounds for Reference Counter Overflow Vulnerability - CVE-2011-2013 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Block unused UDP ports at the perimeter firewall** Blocking unused (closed) UDP ports at the perimeter firewall helps protect systems that are behind that firewall from attempts to exploit this vulnerability. For more information about ports, see the TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). #### FAQ for Reference Counter Overflow Vulnerability - CVE-2011-2013 **What is the scope of the vulnerability?** This is a remote code execution vulnerability in the context of the Windows kernel. **What causes the vulnerability?** The vulnerability is caused when the Windows TCP/IP stack processes a continuous flow of specially crafted UDP packets, resulting in an integer overflow. **What is TCP/IP?** TCP/IP is a set of networking protocols that are widely used on the Internet. TCP/IP provides communications across interconnected networks of computers that have diverse hardware architectures and that run various operating systems. TCP/IP includes standards for how computers communicate and conventions for connecting networks and for routing traffic. For more information about TCP/IP, see the TechNet article, [Overview of networking and TCP/IP](http://technet.microsoft.com/en-us/library/cc739443(ws.10).aspx). **What is UDP?** The User Datagram Protocol (UDP) is a TCP/IP standard defined in RFC 768, \"User Datagram Protocol (UDP).\" UDP is used by some programs instead of TCP for fast, lightweight, unreliable transportation of data between TCP/IP hosts. UDP provides a connectionless datagram service that offers best-effort delivery, which means that UDP does not guarantee delivery or verify sequencing for any datagrams. A source host that needs reliable communication must use either TCP or a program that provides its own sequencing and acknowledgment services. For more information, see the TechNet article, [User Datagram Protocol (UDP)](http://technet.microsoft.com/en-us/library/cc785220(ws.10).aspx). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. **How could an attacker exploit the** **vulnerability?** An attacker could exploit this vulnerability by sending a continuous flow of specially crafted UDP packets to a closed port on a target system. **What systems are primarily at risk from the vulnerability?** Workstations and servers are primarily at risk of this vulnerability. **What does the update do?** The update addresses this vulnerability by modifying the way that the Windows TCP/IP stack keeps track of UDP packets within memory. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [](http://go.microsoft.com/fwlink/?linkid=21130)[Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |----------------------------------------------------------------------------------------------------------------------|------| | Windows Vista Service Pack 2 | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |----------------------------------------------------------------------------------------------------------------------|--------------------|----------------------------| | Windows Vista Service Pack 2 | Yes | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Windows Vista (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2588516-x86.msu /quietFor all supported x64-based editions of Windows Vista:Windows6.0-KB2588516-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2588516-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Vista:Windows6.0-KB2588516-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2588516Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2588516-x86.msu /quietFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2588516-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2588516-ia64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2588516-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2588516-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2588516-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2588516Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows 7:Windows6.1-KB2588516-x86.msu /quietFor all supported x64-based editions of Windows 7:Windows6.1-KB2588516-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows 7:Windows6.1-KB2588516-x86.msu /quiet /norestartFor all supported x64-based editions of Windows 7:Windows6.1-KB2588516-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2588516Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2588516-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2588516-ia64.msu /quietInstalling without restartingFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2588516-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2588516-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2588516Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY (1-866-727-2338). There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (November 8, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows Vista Service Pack 2CriticalRemote Code ExecutionMS11-064Windows Vista x64 Edition Service Pack 2CriticalRemote Code ExecutionMS11-064Windows Server 2008 for 32-bit Systems Service Pack 2*CriticalRemote Code ExecutionMS11-064Windows Server 2008 for x64-based Systems Service Pack 2*CriticalRemote Code ExecutionMS11-064Windows Server 2008 for Itanium-based Systems Service Pack 2CriticalRemote Code ExecutionMS11-064Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1CriticalRemote Code ExecutionMS11-064Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1CriticalRemote Code ExecutionMS11-064Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*CriticalRemote Code ExecutionMS11-064Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1CriticalRemote Code ExecutionMS11-064 *Server Core installation affected. This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. Non-Affected Software Operating SystemWindows XP Service Pack 3Windows XP Professional x64 Edition Service Pack 2Windows Server 2003 Service Pack 2Windows Server 2003 x64 Edition Service Pack 2Windows Server 2003 with SP2 for Itanium-based Systems Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Service Pack Lifecycle Support Policy. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information Web site, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the November bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareReference Counter Overflow Vulnerability - CVE-2011-2013Aggregate Severity RatingWindows Vista Service Pack 2Critical Remote Code ExecutionCriticalWindows Vista x64 Edition Service Pack 2Critical Remote Code ExecutionCriticalWindows Server 2008 for 32-bit Systems Service Pack 2*Critical Remote Code ExecutionCriticalWindows Server 2008 for x64-based Systems Service Pack 2*Critical Remote Code ExecutionCriticalWindows Server 2008 for Itanium-based Systems Service Pack 2Critical Remote Code ExecutionCriticalWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1Critical Remote Code ExecutionCriticalWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1Critical Remote Code ExecutionCriticalWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1*Critical Remote Code ExecutionCriticalWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1Critical Remote Code ExecutionCritical **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). Reference Counter Overflow Vulnerability - CVE-2011-2013 -------------------------------------------------------- A remote code execution vulnerability exists in the Windows TCP/IP stack due to the processing of a continuous flow of specially crafted UDP packets. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see [CVE-2011-2013](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2011-2013). #### Mitigating Factors for Reference Counter Overflow Vulnerability - CVE-2011-2013 Microsoft has not identified any mitigating factors for this vulnerability. #### Workarounds for Reference Counter Overflow Vulnerability - CVE-2011-2013 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: - **Block unused UDP ports at the perimeter firewall** Blocking unused (closed) UDP ports at the perimeter firewall helps protect systems that are behind that firewall from attempts to exploit this vulnerability. For more information about ports, see the TechNet article, [TCP and UDP Port Assignments](http://go.microsoft.com/fwlink/?linkid=21312). #### FAQ for Reference Counter Overflow Vulnerability - CVE-2011-2013 **What is the scope of the vulnerability?** This is a remote code execution vulnerability in the context of the Windows kernel. **What causes the vulnerability?** The vulnerability is caused when the Windows TCP/IP stack processes a continuous flow of specially crafted UDP packets, resulting in an integer overflow. **What is TCP/IP?** TCP/IP is a set of networking protocols that are widely used on the Internet. TCP/IP provides communications across interconnected networks of computers that have diverse hardware architectures and that run various operating systems. TCP/IP includes standards for how computers communicate and conventions for connecting networks and for routing traffic. For more information about TCP/IP, see the TechNet article, [Overview of networking and TCP/IP](http://technet.microsoft.com/en-us/library/cc739443(ws.10).aspx). **What is UDP?** The User Datagram Protocol (UDP) is a TCP/IP standard defined in RFC 768, \"User Datagram Protocol (UDP).\" UDP is used by some programs instead of TCP for fast, lightweight, unreliable transportation of data between TCP/IP hosts. UDP provides a connectionless datagram service that offers best-effort delivery, which means that UDP does not guarantee delivery or verify sequencing for any datagrams. A source host that needs reliable communication must use either TCP or a program that provides its own sequencing and acknowledgment services. For more information, see the TechNet article, [User Datagram Protocol (UDP)](http://technet.microsoft.com/en-us/library/cc785220(ws.10).aspx). **What might an attacker use the vulnerability to do?** An attacker who successfully exploited this vulnerability could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. **How could an attacker exploit the** **vulnerability?** An attacker could exploit this vulnerability by sending a continuous flow of specially crafted UDP packets to a closed port on a target system. **What systems are primarily at risk from the vulnerability?** Workstations and servers are primarily at risk of this vulnerability. **What does the update do?** The update addresses this vulnerability by modifying the way that the Windows TCP/IP stack keeps track of UDP packets within memory. **When this security bulletin was issued, had this vulnerability been publicly disclosed?** No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. **When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?** No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. ### Update Information Detection and Deployment Tools and Guidance ------------------------------------------- **Security Central** Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903). The [Microsoft TechNet Security Web site](http://go.microsoft.com/fwlink/?linkid=21132) provides additional information about security in Microsoft products. Security updates are available from [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and [](http://go.microsoft.com/fwlink/?linkid=21130)[Windows Update](http://go.microsoft.com/fwlink/?linkid=21130). Security updates are also available from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the [Microsoft Update Catalog](http://go.microsoft.com/fwlink/?linkid=96155). The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the [Microsoft Update Catalog FAQ](http://go.microsoft.com/fwlink/?linkid=97900). **Detection and Deployment Guidance** Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see [Microsoft Knowledge Base Article 961747](http://support.microsoft.com/kb/961747). **Microsoft Baseline Security Analyzer** Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). The following table provides the MBSA detection summary for this security update. | Software | MBSA | |----------------------------------------------------------------------------------------------------------------------|------| | Windows Vista Service Pack 2 | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | **Note** For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsahome.mspx) and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. **Windows Server Update Services** Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, [Windows Server Update Services](http://technet.microsoft.com/en-us/wsus/default.aspx). **Systems Management Server** The following table provides the SMS detection and deployment summary for this security update. | Software | SMS 2003 with ITMU | Configuration Manager 2007 | |----------------------------------------------------------------------------------------------------------------------|--------------------|----------------------------| | Windows Vista Service Pack 2 | Yes | Yes | | Windows Vista x64 Edition Service Pack 2 | Yes | Yes | | Windows Server 2008 for 32-bit Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for x64-based Systems Service Pack 2 | Yes | Yes | | Windows Server 2008 for Itanium-based Systems Service Pack 2 | Yes | Yes | | Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1 | Yes | Yes | | Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1 | Yes | Yes | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 | Yes | Yes | **Note** Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For customers remaining on SMS 2003 Service Pack 3, the [Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx) (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) and that are supported by [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). For more information about the SMS 2003 ITMU, see [SMS 2003 Inventory Tool for Microsoft Updates](http://technet.microsoft.com/en-us/sms/bb676783.aspx). For more information about SMS scanning tools, see [SMS 2003 Software Update Scanning Tools](http://technet.microsoft.com/en-us/sms/bb676786.aspx). See also [Downloads for Systems Management Server 2003](http://technet.microsoft.com/en-us/sms/bb676766.aspx). System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit [System Center Configuration Manager 2007](http://technet.microsoft.com/en-us/library/bb735860.aspx). For more information about SMS, visit the [SMS Web site](http://go.microsoft.com/fwlink/?linkid=21158). For more detailed information, see [Microsoft Knowledge Base Article 910723](http://support.microsoft.com/kb/910723): Summary list of monthly detection and deployment guidance articles. **Update Compatibility Evaluator and Application Compatibility Toolkit** Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the [Update Compatibility Evaluator](http://technet2.microsoft.com/windowsvista/en/library/4279e239-37a4-44aa-aec5-4e70fe39f9de1033.mspx?mfr=true) components included with [Application Compatibility Toolkit](https://www.microsoft.com/download/details.aspx?familyid=24da89e9-b581-47b0-b45e-492dd6da2971&displaylang=en). The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment -------------------------- **Affected Software** For information about the specific security update for your affected software, click the appropriate link: #### Windows Vista (all editions) **Reference Table** The following table contains the security update information for this software. You can find additional information in the subsection, **Deployment Information**, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2588516-x86.msu /quietFor all supported x64-based editions of Windows Vista:Windows6.0-KB2588516-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Vista:Windows6.0-KB2588516-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Vista:Windows6.0-KB2588516-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2588516Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2588516-x86.msu /quietFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2588516-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2588516-ia64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2588516-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Server 2008:Windows6.0-KB2588516-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008:Windows6.0-KB2588516-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2588516Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows 7:Windows6.1-KB2588516-x86.msu /quietFor all supported x64-based editions of Windows 7:Windows6.1-KB2588516-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows 7:Windows6.1-KB2588516-x86.msu /quiet /norestartFor all supported x64-based editions of Windows 7:Windows6.1-KB2588516-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2588516Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2588516-x64.msu /quietFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2588516-ia64.msu /quietInstalling without restartingFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2588516-x64.msu /quiet /norestartFor all supported Itanium-based editions of Windows Server 2008 R2:Windows6.1-KB2588516-ia64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2588516Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY (1-866-727-2338). There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (November 8, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2011-2014": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-086",
        "title": "Vulnerability in Active Directory Could Allow Elevation of Privilege (2630837)",
        "body": "This security update resolves a privately reported vulnerability in Active Directory, Active Directory Application Mode (ADAM), and Active Directory Lightweight Directory Service (AD LDS). The vulnerability could allow elevation of privilege if Active Directory is configured to use LDAP over SSL (LDAPS) and an attacker acquires a revoked certificate that is associated with a valid domain account and then uses that revoked certificate to authenticate to the Active Directory domain. By default, Active Directory is not configured to use LDAP over SSL. This security update is rated Important for Active Directory, ADAM, and AD LDS when installed on supported editions of Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008 (except Itanium), Windows 7, and Windows Server 2008 R2 (except Itanium). For more information, see the subsection, Affected and Non-Affected Software, in this section. The security update addresses the vulnerability by changing the way that Active Directory verifies certificates against the Certificate Revocation List (CRL). For more information about the vulnerability, see the Frequently Asked Questions (FAQ) subsection for the specific vulnerability entry under the next section, Vulnerability Information. Recommendation. The majority of customers have automatic updating enabled and will not need to take any action because this security update will be downloaded and installed automatically. Customers who have not enabled automatic updating need to check for updates and install this update manually. For information about specific configuration options in automatic updating, see Microsoft Knowledge Base Article 294871. For administrators and enterprise installations, or end users who want to install this security update manually, Microsoft recommends that customers apply the update at the earliest opportunity using update management software, or by checking for updates using the Microsoft Update service. See also the section, Detection and Deployment Tools and Guidance, later in this bulletin. Known Issues. None Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemComponentMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XP Service Pack 3Active Directory Application Mode (ADAM)(KB2616310)Elevation of PrivilegeImportantMS10-068Windows XP Professional x64 Edition Service Pack 2Active Directory Application Mode (ADAM)(KB2616310)Elevation of PrivilegeImportantMS10-068Windows Server 2003 Service Pack 2Active Directory(KB2601626)Active Directory Application Mode (ADAM)(KB2616310)Elevation of PrivilegeImportantMS10-068Windows Server 2003 x64 Edition Service Pack 2Active Directory(KB2601626)Active Directory Application Mode (ADAM)(KB2616310)Elevation of PrivilegeImportantMS10-068Windows Server 2003 with SP2 for Itanium-based SystemsActive Directory(KB2601626)Elevation of PrivilegeImportantMS10-068Windows Vista Service Pack 2Active Directory Lightweight Directory Service (AD LDS)(KB2601626)Elevation of PrivilegeImportantMS10-068Windows Vista x64 Edition Service Pack 2Active Directory Lightweight Directory Service (AD LDS)(KB2601626)Elevation of PrivilegeImportantMS10-068Windows Server 2008 for 32-bit Systems Service Pack 2Active Directory and Active Directory Lightweight Directory Service (AD LDS)*(KB2601626)Elevation of PrivilegeImportantMS10-068Windows Server 2008 for x64-based Systems Service Pack 2Active Directory and Active Directory Lightweight Directory Service (AD LDS)*(KB2601626)Elevation of PrivilegeImportantMS10-068Windows 7 for 32-bit SystemsActive Directory Lightweight Directory Service (AD LDS)(KB2601626)Elevation of PrivilegeImportantMS10-068Windows 7 for 32-bit Systems Service Pack 1Active Directory Lightweight Directory Service (AD LDS)(KB2601626)Elevation of PrivilegeImportantNoneWindows 7 for x64-based SystemsActive Directory Lightweight Directory Service (AD LDS)(KB2601626)Elevation of PrivilegeImportantMS10-068Windows 7 for x64-based Systems Service Pack 1Active Directory Lightweight Directory Service (AD LDS)(KB2601626)Elevation of PrivilegeImportantNoneWindows Server 2008 R2 for x64-based SystemsActive Directory and Active Directory Lightweight Directory Service (AD LDS)*(KB2601626)Elevation of PrivilegeImportantMS10-068Windows Server 2008 R2 for x64-based Systems Service Pack 1Active Directory and Active Directory Lightweight Directory Service (AD LDS)*(KB2601626)Elevation of PrivilegeImportantNone **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). **Non-Affected Software** | **Operating System** | |---------------------------------------------------------------------------------------------------------------------------| | Windows Server 2008 for Itanium-based Systems Service Pack 2 [1] | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 [1] | [1] These editions of Microsoft Windows are not affected because they do not include ADAM, AD LDS, or the Active Directory server component Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **I am running one of the operating systems thatislisted in the affected software table. Why am I not being offered the update?** The update will only be offered to systems on which the affected component is installed. **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **I am using an older release of the software discussed in this security bulletin. What should I do?** The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the [Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742) Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see [Select a Product for Lifecycle Information](http://go.microsoft.com/fwlink/?linkid=169555). For more information about service packs for these software releases, see [Service Pack Lifecycle Support Policy](http://go.microsoft.com/fwlink/?linkid=89213). Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the [Microsoft Worldwide Information](http://go.microsoft.com/fwlink/?linkid=33329) Web site, select the country in the Contact Information list, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Microsoft Support Lifecycle Policy FAQ](http://go.microsoft.com/fwlink/?linkid=169557). ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [November bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-nov). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected Software Affected Software LDAPS Authentication Bypass Vulnerability - CVE-2011-2014 Aggregate Severity Rating Active Directory Windows Server 2003 Service Pack 2**Important** Elevation of Privilege**Important**Windows Server 2003 x64 Edition Service Pack 2**Important** Elevation of Privilege**Important**Windows Server 2003 with SP2 for Itanium-based Systems**Important** Elevation of Privilege**Important**Windows Server 2008 for 32-bit Systems Service Pack 2\\***Important** Elevation of Privilege**Important**Windows Server 2008 for x64-based Systems Service Pack 2\\***Important** Elevation of Privilege**Important**Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1\\***Important** Elevation of Privilege**Important**Active Directory Application Mode (ADAM)Windows XP Service Pack 3**Important** Elevation of Privilege**Important**Windows XP Professional x64 Edition Service Pack 2**Important** Elevation of Privilege**Important**Windows Server 2003 Service Pack 2**Important** Elevation of Privilege**Important**Windows Server 2003 x64 Edition Service Pack 2**Important** Elevation of Privilege**Important**Active Directory Lightweight Directory Service (AD LDS)Windows Vista Service Pack 2**Important** Elevation of Privilege**Important**Windows Vista x64 Edition Service Pack 2**Important** Elevation of Privilege**Important**Windows Server 2008 for 32-bit Systems Service Pack 2\\***Important** Elevation of Privilege**Important**Windows Server 2008 for x64-based Systems Service Pack 2\\***Important** Elevation of Privilege**Important**Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1**Important** Elevation of Privilege**Important**Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1**Important** Elevation of Privilege**Important**Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1\\***Important** Elevation of Privilege**Important** **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). LDAPS Authentication Bypass Vulnerability - CVE-2011-2014 An elevation of privilege vulnerability exists in Active Directory when configured to use LDAP over SSL (LDAPS). An attacker could exploit this vulnerability by using a previously revoked certificate to authenticate to the Active Directory domain and gain access to network resources or run code under the privileges of a specific authorized user with which the certificate is associated. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-2014. Mitigating Factors for LDAPS Authentication Bypass Vulnerability - CVE-2011-2014 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: Firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed. Workarounds for LDAPS Authentication Bypass Vulnerability - CVE-2011-2014 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Removethe useraccountfrom the domain that was subject to the revokedcertificate.Use IPsec-based connections in \"Always check CRL\" mode, in addition to using LDAPS.For information on how to enable CRL checking with IPsec, see the TechNet article, Certificate revocation list (CRL) verification - an application choice.NotesUse IPsec to encrypt and protect the connection to LDAPS using certificate authentication with CRL checking.Use IPsec to protect the connection to LDAPS using certificate authentication with CRL checking and no encryption. In this case, LDAPS handles the encryption.For affected editions of Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, AuthIP (the IPsec extension that allows user-authentication) can be employed to prevent an attacker from performing IPsec certificate authentication using a machine certificate and then using the revoked user certificate to perform LDAPS authentication.Use NULL encapsulation for LDAPS to prevent encrypting twice and be aware that certificate authentication on the IPsec level is independent of the authentication happening in SSL. This means that using separate certificates at each layer can still allow access to LDAPS via the expired certificate. FAQ for LDAPS Authentication Bypass Vulnerability - CVE-2011-2014 What is the scope of the vulnerability?This is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could obtain access to network resources or run code under the privileges of a specific authorized user. What causes the vulnerability?The vulnerability is caused when Active Directory is configured to use LDAPS and fails to validate the revocation status of an SSL certificate against the CRL associated with the domain account. This allows a certificate to be accepted as valid even after it has been revoked by the certification authority (CA). What is a certification authority (CA)?Certification authorities are the organizations that issue certificates. They establish and verify the authenticity of public keys that belong to people or other certification authorities, and they verify the identity of a person or organization that asks for a certificate. What are Active Directory Services?Active Directory Services contains an extensible and scalable set of services that enables you to efficiently manage corporate identities, credentials, information protection, and system and application settings. Active Directory Services include Active Directory Certificate Services (AD CS), Active Directory Domain Services (AD DS), Active Directory Federation Services (AD FS), Active Directory Lightweight Directory Services (AD LDS), and Active Directory Rights Management Services (AD RMS). What is Active Directory Lightweight Directory Service (AD LDS)?Active Directory Lightweight Directory Services (AD LDS) is an independent mode of Active Directory that provides dedicated directory services for applications. AD LDS is available for Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2. AD LDS replaces Active Directory Application Mode (ADAM), which is available for Windows XP and Windows Server 2003. For more information on AD LDS, see the TechNet article, Active Directory Lightweight Directory Services. What is Active Directory Application Mode?Active Directory Application Mode (ADAM) is a Lightweight Directory Access Protocol (LDAP) directory service that runs as a user service for Windows XP and Windows Server 2003, rather than as a system service. For more information on ADAM, please see the TechNet article, Introducing ADAM. What is the Lightweight Directory Access Protocol (LDAP)?The Lightweight Directory Access Protocol (LDAP) is a directory service protocol that runs directly over the TCP/IP stack. The information model (for both data and namespaces) of LDAP is similar to that of the X.500 OSI directory service, but with fewer features and lower resource requirements than X.500. Unlike most other Internet protocols, LDAP has an associated API that simplifies writing Internet directory service applications. The LDAP API is applicable to directory management and browser applications that do not have directory service support as their primary function. LDAP cannot create directories or specify how a directory service operates. What is a Certificate Revocation List (CRL)?CRL is a digitally signed list, issued by a CA, that contains a list of certificates issued by the CA and subsequently revoked by the CA. For each individual revoked certificate, the listing includes the serial number of the certificate, the date that the certificate was revoked, and the revocation reason. Applications can perform CRL checking to determine a presented certificate's revocation status. For more information on certificate revocation checking, see the TechNet article, Certificate Revocation and Status Checking. What is LDAP over SSL(LDAPS)?LDAP over SSL (LDAPS) encrypts traffic transmitted between client computers and server computers with a Secure Sockets Layer (SSL)/Transport Layer Security (TLS) technology. What is Active Directory Domain Services?Active Directory Domain Services (AD DS) stores directory data and manages communication between users and domains, including user logon processes, authentication, and directory searches. An Active Directory domain controller is a server that is running AD DS. For more information on AD DS, please see the TechNet article, Active Directory Domain Services. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could obtain access to network resources or run code under the privileges of a specific authorized user. If the user has administrator privileges, an attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. How could an attacker exploit thevulnerability?To exploit this vulnerability, an attacker would first have to acquire a revoked certificate that is associated with a valid account on the domain. An attacker could then exploit this vulnerability by using this previously revoked certificate to authenticate to the Active Directory domain and gain access to network resources or run code under the privileges of a specific authorized user with which the certificate is associated. What systems are primarily at risk from the vulnerability?All systems running an affected operating system with Active Directory services installed are affected by this vulnerability. What does the update do?The update addresses the vulnerability by changing the way that Active Directory verifies the validity of certificates against the CRL. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Security Central Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from Microsoft Update and Windows Update. Security updates are also available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the Microsoft Update Catalog. The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the Microsoft Update Catalog FAQ. Detection and Deployment Guidance Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see Microsoft Knowledge Base Article 961747. Microsoft Baseline Security Analyzer Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit Microsoft Baseline Security Analyzer. The following table provides the MBSA detection summary for this security update. SoftwareMBSAWindows XP Service Pack 3YesWindows XP Professional x64 Edition Service Pack 2YesWindows Server 2003 Service Pack 2YesWindows Server 2003 x64 Edition Service Pack 2YesWindows Server 2003 with SP2 for Itanium-based SystemsYesWindows Vista Service Pack 2YesWindows Vista x64 Edition Service Pack 2YesWindows Server 2008 for 32-bit Systems Service Pack 2YesWindows Server 2008 for x64-based Systems Service Pack 2YesWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1YesWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1YesWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1Yes Note For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit Microsoft Baseline Security Analyzer and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. Windows Server Update Services Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, Windows Server Update Services. Systems Management Server The following table provides the SMS detection and deployment summary for this security update. SoftwareSMS 2003 with ITMUConfiguration Manager 2007Windows XP Service Pack 3YesYesWindows XP Professional x64 Edition Service Pack 2YesYesWindows Server 2003 Service Pack 2YesYesWindows Server 2003 x64 Edition Service Pack 2YesYesWindows Server 2003 with SP2 for Itanium-based SystemsYesYesWindows Vista Service Pack 2YesYesWindows Vista x64 Edition Service Pack 2YesYesWindows Server 2008 for 32-bit Systems Service Pack 2YesYesWindows Server 2008 for x64-based Systems Service Pack 2YesYesWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1YesYesWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1YesYesWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1YesYes Note Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to System Center Configuration Manager 2007. For customers remaining on SMS 2003 Service Pack 3, the Inventory Tool for Microsoft Updates (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by Microsoft Update and that are supported by Windows Server Update Services. For more information about the SMS 2003 ITMU, see SMS 2003 Inventory Tool for Microsoft Updates. For more information about SMS scanning tools, see SMS 2003 Software Update Scanning Tools. See also Downloads for Systems Management Server 2003. System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit System Center Configuration Manager 2007. For more information about SMS, visit the SMS Web site. For more detailed information, see Microsoft Knowledge Base Article 910723: Summary list of monthly detection and deployment guidance articles. Update Compatibility Evaluator and Application Compatibility Toolkit Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the Update Compatibility Evaluator components included with Application Compatibility Toolkit. The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Windows XP (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Active Directory Application Mode (ADAM) on Windows XP Service Pack 3:WindowsXP-KB2616310-x86-enu.exe /quietFor Active Directory Application Mode (ADAM) on Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2616310-x64-enu.exe /quietInstalling without restartingFor Active Directory Application Mode (ADAM) on Windows XP Service Pack 3:WindowsXP-KB2616310-x86-enu.exe /norestartFor Active Directory Application Mode (ADAM) on Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2616310-x64-enu.exe /norestartUpdate log fileKB2616310.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\$NTUninstallKB2616310$\\Spuninst folderFile InformationSee Microsoft Knowledge Base Article 2616310Registry Key VerificationFor all supported 32-bit editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP4\\KB2616310\\FilelistFor all supported x64-based editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP3\\KB2616310\\Filelist Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. **Inclusion in Future Service Packs**The update for this issue will be included in a future service pack or update rollup**Deployment**Installing without user interventionFor Active Directory on Windows Server 2003 Service Pack 2: WindowsServer2003-KB2601626-x86-enu.exe /quietFor Active Directory Application Mode (ADAM) on Windows Server 2003 Service Pack 2: WindowsServer2003-KB2616310-x86-enu.exe /quiet For Active Directory on Windows Server 2003 x64 Edition Service Pack 2: WindowsServer2003.WindowsXP-KB2601626-x64-enu.exe /quietFor Active Directory Application Mode (ADAM) on Windows Server 2003 x64 Edition Service Pack 2: WindowsServer2003.WindowsXP-KB2616310-x64-enu.exe /quietFor Active Directory on Windows Server 2003 with SP2 for Itanium-based Systems: WindowsServer2003-KB2601626-ia64-enu.exe /quietInstalling without restartingFor Active Directory on Windows Server 2003 Service Pack 2: WindowsServer2003-KB2601626-x86-enu.exe /norestartFor Active Directory Application Mode (ADAM) on Windows Server 2003 Service Pack 2: WindowsServer2003-KB2616310-x86-enu.exe /norestart For Active Directory on Windows Server 2003 x64 Edition Service Pack 2: WindowsServer2003.WindowsXP-KB2601626-x64-enu.exe /norestartFor Active Directory Application Mode (ADAM) on Windows Server 2003 x64 Edition Service Pack 2: WindowsServer2003.WindowsXP-KB2616310-x64-enu.exe /norestartFor Active Directory on Windows Server 2003 with SP2 for Itanium-based Systems: WindowsServer2003-KB2601626-ia64-enu.exe /norestartUpdate log fileKB2601626.log KB2616310.logFurther informationSee the subsection, **Detection and Deployment Tools and Guidance****Restart Requirement** Restart required?Yes, you must restart your system after you apply this security update.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](http://support.microsoft.com/kb/897341).**Removal Information**For Active Directory, use **Add or Remove Programs** tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\\\$NTUninstallKB2601626$\\\\Spuninst folderFor Active Directory Application Mode (ADAM), use **Add or Remove Programs** tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\\\$NTUninstallKB2616310$\\\\Spuninst folder**File Information**For Active Directory on Windows Server 2003, see [Microsoft Knowledge Base Article 2601626](http://support.microsoft.com/kb/2601626)For Active Directory Application Mode (ADAM) on Windows Server 2003, see [Microsoft Knowledge Base Article 2616310](http://support.microsoft.com/kb/2616310)**Registry Key Verification**For Active Directory on Windows Server 2003: HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Updates\\\\Windows Server 2003\\\\SP3\\\\KB2601626\\\\FilelistFor Active Directory Application Mode (ADAM) on Windows Server 2003: HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Updates\\\\Windows Server 2003\\\\SP3\\\\KB2616310\\\\Filelist **Note** The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Vista (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Vista with AD LDS:Windows6.0-KB2601626-x86.msu /quietFor all supported x64-based editions of Windows Vista with AD LDS:Windows6.0-KB2601626-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Vista with AD LDS:Windows6.0-KB2601626-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Vista with AD LDS:Windows6.0-KB2601626-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2601626Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h,/helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Active Directory and Active Directory Lightweight Directory Service (AD LDS) on all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2601626-x86.msu /quietFor Active Directory and Active Directory Lightweight Directory Service (AD LDS) on all supported x64-based editions of Windows Server 2008:Windows6.0-KB2601626-x64.msu /quietInstalling without restartingFor Active Directory and Active Directory Lightweight Directory Service (AD LDS) on all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2601626-x86.msu /quiet /norestartFor Active Directory and Active Directory Lightweight Directory Service (AD LDS) on all supported x64-based editions of Windows Server 2008:Windows6.0-KB2601626-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2601626Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h,/helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows 7 with AD LDS:Windows6.1-KB2601626-x86.msu /quietFor all supported x64-based editions of Windows 7 with AD LDS:Windows6.1-KB2601626 -x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows 7 with AD LDS:Windows6.1-KB2601626-x86.msu /quiet /norestartFor all supported x64-based editions of Windows 7 with AD LDS:Windows6.1-KB2601626-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2601626Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h,/helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying Thatthe Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2601626-x64.msu /quietInstalling without restartingFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2601626-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2601626Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h,/helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Xavier Lassoie and Sébastien Godard of Autosécurité for reporting the LDAPS Authentication Bypass Vulnerability (CVE-2011-2014) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY (1-866-727-2338). There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (November 8, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemComponentMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XP Service Pack 3Active Directory Application Mode (ADAM)(KB2616310)Elevation of PrivilegeImportantMS10-068Windows XP Professional x64 Edition Service Pack 2Active Directory Application Mode (ADAM)(KB2616310)Elevation of PrivilegeImportantMS10-068Windows Server 2003 Service Pack 2Active Directory(KB2601626)Active Directory Application Mode (ADAM)(KB2616310)Elevation of PrivilegeImportantMS10-068Windows Server 2003 x64 Edition Service Pack 2Active Directory(KB2601626)Active Directory Application Mode (ADAM)(KB2616310)Elevation of PrivilegeImportantMS10-068Windows Server 2003 with SP2 for Itanium-based SystemsActive Directory(KB2601626)Elevation of PrivilegeImportantMS10-068Windows Vista Service Pack 2Active Directory Lightweight Directory Service (AD LDS)(KB2601626)Elevation of PrivilegeImportantMS10-068Windows Vista x64 Edition Service Pack 2Active Directory Lightweight Directory Service (AD LDS)(KB2601626)Elevation of PrivilegeImportantMS10-068Windows Server 2008 for 32-bit Systems Service Pack 2Active Directory and Active Directory Lightweight Directory Service (AD LDS)*(KB2601626)Elevation of PrivilegeImportantMS10-068Windows Server 2008 for x64-based Systems Service Pack 2Active Directory and Active Directory Lightweight Directory Service (AD LDS)*(KB2601626)Elevation of PrivilegeImportantMS10-068Windows 7 for 32-bit SystemsActive Directory Lightweight Directory Service (AD LDS)(KB2601626)Elevation of PrivilegeImportantMS10-068Windows 7 for 32-bit Systems Service Pack 1Active Directory Lightweight Directory Service (AD LDS)(KB2601626)Elevation of PrivilegeImportantNoneWindows 7 for x64-based SystemsActive Directory Lightweight Directory Service (AD LDS)(KB2601626)Elevation of PrivilegeImportantMS10-068Windows 7 for x64-based Systems Service Pack 1Active Directory Lightweight Directory Service (AD LDS)(KB2601626)Elevation of PrivilegeImportantNoneWindows Server 2008 R2 for x64-based SystemsActive Directory and Active Directory Lightweight Directory Service (AD LDS)*(KB2601626)Elevation of PrivilegeImportantMS10-068Windows Server 2008 R2 for x64-based Systems Service Pack 1Active Directory and Active Directory Lightweight Directory Service (AD LDS)*(KB2601626)Elevation of PrivilegeImportantNone **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). **Non-Affected Software** | **Operating System** | |---------------------------------------------------------------------------------------------------------------------------| | Windows Server 2008 for Itanium-based Systems Service Pack 2 [1] | | Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 [1] | [1] These editions of Microsoft Windows are not affected because they do not include ADAM, AD LDS, or the Active Directory server component Frequently Asked Questions (FAQ) Related to This Security Update ---------------------------------------------------------------- **I am running one of the operating systems thatislisted in the affected software table. Why am I not being offered the update?** The update will only be offered to systems on which the affected component is installed. **Where are the file information details?** Refer to the reference tables in the **Security Update Deployment** section for the location of the file information details. **I am using an older release of the software discussed in this security bulletin. What should I do?** The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the [Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742) Web site. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see [Select a Product for Lifecycle Information](http://go.microsoft.com/fwlink/?linkid=169555). For more information about service packs for these software releases, see [Service Pack Lifecycle Support Policy](http://go.microsoft.com/fwlink/?linkid=89213). Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the [Microsoft Worldwide Information](http://go.microsoft.com/fwlink/?linkid=33329) Web site, select the country in the Contact Information list, and then click **Go** to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the [Microsoft Support Lifecycle Policy FAQ](http://go.microsoft.com/fwlink/?linkid=169557). ### **Vulnerability Information** Severity Ratings and Vulnerability Identifiers ---------------------------------------------- The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [November bulletin summary](http://technet.microsoft.com/security/bulletin/ms11-nov). For more information, see [Microsoft Exploitability Index](http://technet.microsoft.com/en-us/security/cc998259.aspx). Vulnerability Severity Rating and Maximum Security Impact by Affected Software Affected Software LDAPS Authentication Bypass Vulnerability - CVE-2011-2014 Aggregate Severity Rating Active Directory Windows Server 2003 Service Pack 2**Important** Elevation of Privilege**Important**Windows Server 2003 x64 Edition Service Pack 2**Important** Elevation of Privilege**Important**Windows Server 2003 with SP2 for Itanium-based Systems**Important** Elevation of Privilege**Important**Windows Server 2008 for 32-bit Systems Service Pack 2\\***Important** Elevation of Privilege**Important**Windows Server 2008 for x64-based Systems Service Pack 2\\***Important** Elevation of Privilege**Important**Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1\\***Important** Elevation of Privilege**Important**Active Directory Application Mode (ADAM)Windows XP Service Pack 3**Important** Elevation of Privilege**Important**Windows XP Professional x64 Edition Service Pack 2**Important** Elevation of Privilege**Important**Windows Server 2003 Service Pack 2**Important** Elevation of Privilege**Important**Windows Server 2003 x64 Edition Service Pack 2**Important** Elevation of Privilege**Important**Active Directory Lightweight Directory Service (AD LDS)Windows Vista Service Pack 2**Important** Elevation of Privilege**Important**Windows Vista x64 Edition Service Pack 2**Important** Elevation of Privilege**Important**Windows Server 2008 for 32-bit Systems Service Pack 2\\***Important** Elevation of Privilege**Important**Windows Server 2008 for x64-based Systems Service Pack 2\\***Important** Elevation of Privilege**Important**Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1**Important** Elevation of Privilege**Important**Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1**Important** Elevation of Privilege**Important**Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1\\***Important** Elevation of Privilege**Important** **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). LDAPS Authentication Bypass Vulnerability - CVE-2011-2014 An elevation of privilege vulnerability exists in Active Directory when configured to use LDAP over SSL (LDAPS). An attacker could exploit this vulnerability by using a previously revoked certificate to authenticate to the Active Directory domain and gain access to network resources or run code under the privileges of a specific authorized user with which the certificate is associated. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2011-2014. Mitigating Factors for LDAPS Authentication Bypass Vulnerability - CVE-2011-2014 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: Firewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed. Workarounds for LDAPS Authentication Bypass Vulnerability - CVE-2011-2014 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Removethe useraccountfrom the domain that was subject to the revokedcertificate.Use IPsec-based connections in \"Always check CRL\" mode, in addition to using LDAPS.For information on how to enable CRL checking with IPsec, see the TechNet article, Certificate revocation list (CRL) verification - an application choice.NotesUse IPsec to encrypt and protect the connection to LDAPS using certificate authentication with CRL checking.Use IPsec to protect the connection to LDAPS using certificate authentication with CRL checking and no encryption. In this case, LDAPS handles the encryption.For affected editions of Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, AuthIP (the IPsec extension that allows user-authentication) can be employed to prevent an attacker from performing IPsec certificate authentication using a machine certificate and then using the revoked user certificate to perform LDAPS authentication.Use NULL encapsulation for LDAPS to prevent encrypting twice and be aware that certificate authentication on the IPsec level is independent of the authentication happening in SSL. This means that using separate certificates at each layer can still allow access to LDAPS via the expired certificate. FAQ for LDAPS Authentication Bypass Vulnerability - CVE-2011-2014 What is the scope of the vulnerability?This is an elevation of privilege vulnerability. An attacker who successfully exploited this vulnerability could obtain access to network resources or run code under the privileges of a specific authorized user. What causes the vulnerability?The vulnerability is caused when Active Directory is configured to use LDAPS and fails to validate the revocation status of an SSL certificate against the CRL associated with the domain account. This allows a certificate to be accepted as valid even after it has been revoked by the certification authority (CA). What is a certification authority (CA)?Certification authorities are the organizations that issue certificates. They establish and verify the authenticity of public keys that belong to people or other certification authorities, and they verify the identity of a person or organization that asks for a certificate. What are Active Directory Services?Active Directory Services contains an extensible and scalable set of services that enables you to efficiently manage corporate identities, credentials, information protection, and system and application settings. Active Directory Services include Active Directory Certificate Services (AD CS), Active Directory Domain Services (AD DS), Active Directory Federation Services (AD FS), Active Directory Lightweight Directory Services (AD LDS), and Active Directory Rights Management Services (AD RMS). What is Active Directory Lightweight Directory Service (AD LDS)?Active Directory Lightweight Directory Services (AD LDS) is an independent mode of Active Directory that provides dedicated directory services for applications. AD LDS is available for Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2. AD LDS replaces Active Directory Application Mode (ADAM), which is available for Windows XP and Windows Server 2003. For more information on AD LDS, see the TechNet article, Active Directory Lightweight Directory Services. What is Active Directory Application Mode?Active Directory Application Mode (ADAM) is a Lightweight Directory Access Protocol (LDAP) directory service that runs as a user service for Windows XP and Windows Server 2003, rather than as a system service. For more information on ADAM, please see the TechNet article, Introducing ADAM. What is the Lightweight Directory Access Protocol (LDAP)?The Lightweight Directory Access Protocol (LDAP) is a directory service protocol that runs directly over the TCP/IP stack. The information model (for both data and namespaces) of LDAP is similar to that of the X.500 OSI directory service, but with fewer features and lower resource requirements than X.500. Unlike most other Internet protocols, LDAP has an associated API that simplifies writing Internet directory service applications. The LDAP API is applicable to directory management and browser applications that do not have directory service support as their primary function. LDAP cannot create directories or specify how a directory service operates. What is a Certificate Revocation List (CRL)?CRL is a digitally signed list, issued by a CA, that contains a list of certificates issued by the CA and subsequently revoked by the CA. For each individual revoked certificate, the listing includes the serial number of the certificate, the date that the certificate was revoked, and the revocation reason. Applications can perform CRL checking to determine a presented certificate's revocation status. For more information on certificate revocation checking, see the TechNet article, Certificate Revocation and Status Checking. What is LDAP over SSL(LDAPS)?LDAP over SSL (LDAPS) encrypts traffic transmitted between client computers and server computers with a Secure Sockets Layer (SSL)/Transport Layer Security (TLS) technology. What is Active Directory Domain Services?Active Directory Domain Services (AD DS) stores directory data and manages communication between users and domains, including user logon processes, authentication, and directory searches. An Active Directory domain controller is a server that is running AD DS. For more information on AD DS, please see the TechNet article, Active Directory Domain Services. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could obtain access to network resources or run code under the privileges of a specific authorized user. If the user has administrator privileges, an attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. How could an attacker exploit thevulnerability?To exploit this vulnerability, an attacker would first have to acquire a revoked certificate that is associated with a valid account on the domain. An attacker could then exploit this vulnerability by using this previously revoked certificate to authenticate to the Active Directory domain and gain access to network resources or run code under the privileges of a specific authorized user with which the certificate is associated. What systems are primarily at risk from the vulnerability?All systems running an affected operating system with Active Directory services installed are affected by this vulnerability. What does the update do?The update addresses the vulnerability by changing the way that Active Directory verifies the validity of certificates against the CRL. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Security Central Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security Web site provides additional information about security in Microsoft products. Security updates are available from Microsoft Update and Windows Update. Security updates are also available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the Microsoft Update Catalog. The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the Microsoft Update Catalog FAQ. Detection and Deployment Guidance Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see Microsoft Knowledge Base Article 961747. Microsoft Baseline Security Analyzer Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit Microsoft Baseline Security Analyzer. The following table provides the MBSA detection summary for this security update. SoftwareMBSAWindows XP Service Pack 3YesWindows XP Professional x64 Edition Service Pack 2YesWindows Server 2003 Service Pack 2YesWindows Server 2003 x64 Edition Service Pack 2YesWindows Server 2003 with SP2 for Itanium-based SystemsYesWindows Vista Service Pack 2YesWindows Vista x64 Edition Service Pack 2YesWindows Server 2008 for 32-bit Systems Service Pack 2YesWindows Server 2008 for x64-based Systems Service Pack 2YesWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1YesWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1YesWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1Yes Note For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit Microsoft Baseline Security Analyzer and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. Windows Server Update Services Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, Windows Server Update Services. Systems Management Server The following table provides the SMS detection and deployment summary for this security update. SoftwareSMS 2003 with ITMUConfiguration Manager 2007Windows XP Service Pack 3YesYesWindows XP Professional x64 Edition Service Pack 2YesYesWindows Server 2003 Service Pack 2YesYesWindows Server 2003 x64 Edition Service Pack 2YesYesWindows Server 2003 with SP2 for Itanium-based SystemsYesYesWindows Vista Service Pack 2YesYesWindows Vista x64 Edition Service Pack 2YesYesWindows Server 2008 for 32-bit Systems Service Pack 2YesYesWindows Server 2008 for x64-based Systems Service Pack 2YesYesWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1YesYesWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1YesYesWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1YesYes Note Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to System Center Configuration Manager 2007. For customers remaining on SMS 2003 Service Pack 3, the Inventory Tool for Microsoft Updates (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by Microsoft Update and that are supported by Windows Server Update Services. For more information about the SMS 2003 ITMU, see SMS 2003 Inventory Tool for Microsoft Updates. For more information about SMS scanning tools, see SMS 2003 Software Update Scanning Tools. See also Downloads for Systems Management Server 2003. System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit System Center Configuration Manager 2007. For more information about SMS, visit the SMS Web site. For more detailed information, see Microsoft Knowledge Base Article 910723: Summary list of monthly detection and deployment guidance articles. Update Compatibility Evaluator and Application Compatibility Toolkit Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the Update Compatibility Evaluator components included with Application Compatibility Toolkit. The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Microsoft Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Windows XP (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Active Directory Application Mode (ADAM) on Windows XP Service Pack 3:WindowsXP-KB2616310-x86-enu.exe /quietFor Active Directory Application Mode (ADAM) on Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2616310-x64-enu.exe /quietInstalling without restartingFor Active Directory Application Mode (ADAM) on Windows XP Service Pack 3:WindowsXP-KB2616310-x86-enu.exe /norestartFor Active Directory Application Mode (ADAM) on Windows XP Professional x64 Edition Service Pack 2:WindowsServer2003.WindowsXP-KB2616310-x64-enu.exe /norestartUpdate log fileKB2616310.logFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\$NTUninstallKB2616310$\\Spuninst folderFile InformationSee Microsoft Knowledge Base Article 2616310Registry Key VerificationFor all supported 32-bit editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP4\\KB2616310\\FilelistFor all supported x64-based editions of Windows XP:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP3\\KB2616310\\Filelist Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.**Restart Options****/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.**Special Options****/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. **Inclusion in Future Service Packs**The update for this issue will be included in a future service pack or update rollup**Deployment**Installing without user interventionFor Active Directory on Windows Server 2003 Service Pack 2: WindowsServer2003-KB2601626-x86-enu.exe /quietFor Active Directory Application Mode (ADAM) on Windows Server 2003 Service Pack 2: WindowsServer2003-KB2616310-x86-enu.exe /quiet For Active Directory on Windows Server 2003 x64 Edition Service Pack 2: WindowsServer2003.WindowsXP-KB2601626-x64-enu.exe /quietFor Active Directory Application Mode (ADAM) on Windows Server 2003 x64 Edition Service Pack 2: WindowsServer2003.WindowsXP-KB2616310-x64-enu.exe /quietFor Active Directory on Windows Server 2003 with SP2 for Itanium-based Systems: WindowsServer2003-KB2601626-ia64-enu.exe /quietInstalling without restartingFor Active Directory on Windows Server 2003 Service Pack 2: WindowsServer2003-KB2601626-x86-enu.exe /norestartFor Active Directory Application Mode (ADAM) on Windows Server 2003 Service Pack 2: WindowsServer2003-KB2616310-x86-enu.exe /norestart For Active Directory on Windows Server 2003 x64 Edition Service Pack 2: WindowsServer2003.WindowsXP-KB2601626-x64-enu.exe /norestartFor Active Directory Application Mode (ADAM) on Windows Server 2003 x64 Edition Service Pack 2: WindowsServer2003.WindowsXP-KB2616310-x64-enu.exe /norestartFor Active Directory on Windows Server 2003 with SP2 for Itanium-based Systems: WindowsServer2003-KB2601626-ia64-enu.exe /norestartUpdate log fileKB2601626.log KB2616310.logFurther informationSee the subsection, **Detection and Deployment Tools and Guidance****Restart Requirement** Restart required?Yes, you must restart your system after you apply this security update.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see [Microsoft Knowledge Base Article 897341](http://support.microsoft.com/kb/897341).**Removal Information**For Active Directory, use **Add or Remove Programs** tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\\\$NTUninstallKB2601626$\\\\Spuninst folderFor Active Directory Application Mode (ADAM), use **Add or Remove Programs** tool in Control Panel or the Spuninst.exe utility located in the %Windir%\\\\$NTUninstallKB2616310$\\\\Spuninst folder**File Information**For Active Directory on Windows Server 2003, see [Microsoft Knowledge Base Article 2601626](http://support.microsoft.com/kb/2601626)For Active Directory Application Mode (ADAM) on Windows Server 2003, see [Microsoft Knowledge Base Article 2616310](http://support.microsoft.com/kb/2616310)**Registry Key Verification**For Active Directory on Windows Server 2003: HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Updates\\\\Windows Server 2003\\\\SP3\\\\KB2601626\\\\FilelistFor Active Directory Application Mode (ADAM) on Windows Server 2003: HKEY\\_LOCAL\\_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Updates\\\\Windows Server 2003\\\\SP3\\\\KB2616310\\\\Filelist **Note** The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches. Supported Security Update Installation SwitchesSwitchDescription**/help**Displays the command-line options.Setup Modes**/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/overwriteoem**Overwrites OEM files without prompting.**/nobackup**Does not back up files needed for uninstall.**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files.**/integrate:path**Integrates the update into the Windows source files. These files are located at the path that is specified in the switch.**/extract\\[:path\\]**Extracts files without starting the Setup program.**/ER**Enables extended error reporting.**/verbose**Enables verbose logging. During installation, creates %Windir%\\\\CabBuild.log. This log details the files that are copied. Using this switch may cause the installation to proceed more slowly. **Note** You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see [Microsoft Knowledge Base Article 262841](http://support.microsoft.com/kb/262841). Removing the Update This security update supports the following setup switches. Supported Spuninst.exe SwitchesSwitchDescription**/help**Displays the command-line options.**Setup Modes****/passive**Unattended Setup mode. No user interaction is required, but installation status is displayed. If a restart is required at the end of Setup, a dialog box will be presented to the user with a timer warning that the computer will restart in 30 seconds.**/quiet**Quiet mode. This is the same as unattended mode, but no status or error messages are displayed.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Restarts the computer after installation and force other applications to close at shutdown without saving open files first.**/warnrestart\\[:x\\]**Presents a dialog box with a timer warning the user that the computer will restart in *x* seconds. (The default setting is 30 seconds.) Intended for use with the **/quiet** switch or the **/passive** switch.**/promptrestart**Displays a dialog box prompting the local user to allow a restart.Special Options**/forceappsclose**Forces other programs to close when the computer shuts down.**/log:path**Allows the redirection of installation log files. **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Vista (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows Vista with AD LDS:Windows6.0-KB2601626-x86.msu /quietFor all supported x64-based editions of Windows Vista with AD LDS:Windows6.0-KB2601626-x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows Vista with AD LDS:Windows6.0-KB2601626-x86.msu /quiet /norestartFor all supported x64-based editions of Windows Vista with AD LDS:Windows6.0-KB2601626-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2601626Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h,/helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Active Directory and Active Directory Lightweight Directory Service (AD LDS) on all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2601626-x86.msu /quietFor Active Directory and Active Directory Lightweight Directory Service (AD LDS) on all supported x64-based editions of Windows Server 2008:Windows6.0-KB2601626-x64.msu /quietInstalling without restartingFor Active Directory and Active Directory Lightweight Directory Service (AD LDS) on all supported 32-bit editions of Windows Server 2008:Windows6.0-KB2601626-x86.msu /quiet /norestartFor Active Directory and Active Directory Lightweight Directory Service (AD LDS) on all supported x64-based editions of Windows Server 2008:Windows6.0-KB2601626-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationWUSA.exe does not support uninstall of updates. To uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2601626Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h,/helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Note For more information about the wusa.exe installer, see Microsoft Knowledge Base Article 934307. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported 32-bit editions of Windows 7 with AD LDS:Windows6.1-KB2601626-x86.msu /quietFor all supported x64-based editions of Windows 7 with AD LDS:Windows6.1-KB2601626 -x64.msu /quietInstalling without restartingFor all supported 32-bit editions of Windows 7 with AD LDS:Windows6.1-KB2601626-x86.msu /quiet /norestartFor all supported x64-based editions of Windows 7 with AD LDS:Windows6.1-KB2601626-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2601626Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h,/helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying Thatthe Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2601626-x64.msu /quietInstalling without restartingFor all supported x64-based editions of Windows Server 2008 R2:Windows6.1-KB2601626-x64.msu /quiet /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?Yes, you must restart your system after you apply this security update.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, use the /Uninstall setup switch or click Control Panel, click System and Security, and then under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2601626Registry Key VerificationNote A registry key does not exist to validate the presence of this update. #### Deployment Information **Installing the Update** When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as *hotfix*, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/?, /h,/helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Verifying That the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some of the files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Xavier Lassoie and Sébastien Godard of Autosécurité for reporting the LDAPS Authentication Bypass Vulnerability (CVE-2011-2014) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections Web sites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY (1-866-727-2338). There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support Web site. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (November 8, 2011): Bulletin published. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ]
  }
}