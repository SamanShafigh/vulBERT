{
  "year": 2012,
  "total": 8,
  "reference": "docs.microsoft.com",
  "reports": {
    "CVE-2012-0014": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-016",
        "title": "Vulnerabilities in .NET Framework and Microsoft Silverlight Could Allow Remote Code Execution (2651026)",
        "body": "V1.3 (July 10, 2012): Microsoft revised this bulletin to communicate a minor detection change for KB2633880 for Microsoft .NET Framework 2.0 Service Pack 2 to correct an offering issue. There were no changes to the security update files. Customers who have already successfully updated their systems do not need to take any action.",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemComponentMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XPWindows XP Service Pack 3[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=5269e18b-d4f0-4c64-8df8-283a2ca66c59) (KB2633880) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539631 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633880 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows XP Professional x64 Edition Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=5269e18b-d4f0-4c64-8df8-283a2ca66c59) (KB2633880) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539631 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633880 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2003Windows Server 2003 Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=5269e18b-d4f0-4c64-8df8-283a2ca66c59) (KB2633880) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539631 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633880 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2003 x64 Edition Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=5269e18b-d4f0-4c64-8df8-283a2ca66c59) (KB2633880) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539631 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633880 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2003 with SP2 for Itanium-based Systems[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=5269e18b-d4f0-4c64-8df8-283a2ca66c59) (KB2633880) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539631 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633880 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows VistaWindows Vista Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=aab7826d-539b-4e36-b3a1-afa94b37dbe7) (KB2633874) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539633 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633874 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Vista x64 Edition Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=aab7826d-539b-4e36-b3a1-afa94b37dbe7) (KB2633874) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539633 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633874 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008Windows Server 2008 for 32-bit Systems Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=aab7826d-539b-4e36-b3a1-afa94b37dbe7) (KB2633874) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539633 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633874 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008 for x64-based Systems Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=aab7826d-539b-4e36-b3a1-afa94b37dbe7) (KB2633874) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539633 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633874 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008 for Itanium-based Systems Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=aab7826d-539b-4e36-b3a1-afa94b37dbe7) (KB2633874) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539633 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633874 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows 7Windows 7 for 32-bit Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=5a5f3ee7-ca49-41c8-aeec-7c76b66712fc) (KB2633879) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539634 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633879 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows 7 for 32-bit Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=243e8c64-8b6e-4cea-9e99-58d4b1ad35b5) (KB2633873) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539635 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633873 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows 7 for x64-based Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=5a5f3ee7-ca49-41c8-aeec-7c76b66712fc) (KB2633879) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539634 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633879 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows 7 for x64-based Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=243e8c64-8b6e-4cea-9e99-58d4b1ad35b5) (KB2633873) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539635 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633873 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008 R2Windows Server 2008 R2 for x64-based Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=5a5f3ee7-ca49-41c8-aeec-7c76b66712fc)\\* (KB2633879) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539634 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633879 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008 R2 for x64-based Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=243e8c64-8b6e-4cea-9e99-58d4b1ad35b5)\\* (KB2633873) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)\\*[1](KB2633870)Remote Code ExecutionCriticalKB2539635 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633873 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008 R2 for Itanium-based Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=5a5f3ee7-ca49-41c8-aeec-7c76b66712fc) (KB2633879) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539634 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633879 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008 R2 for Itanium-based Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=243e8c64-8b6e-4cea-9e99-58d4b1ad35b5) (KB2633873) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539635 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633873 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870 **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). [1].NET Framework 4 and .NET Framework 4 Client Profile affected. The .NET Framework version 4 redistributable packages are available in two profiles: .NET Framework 4 and .NET Framework 4 Client Profile. .NET Framework 4 Client Profile is a subset of .NET Framework 4. The vulnerability addressed in this update affects both .NET Framework 4 and .NET Framework 4 Client Profile. For more information, see the MSDN article, Installing the .NET Framework. Microsoft Developer Tools and Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Silverlight 4[Microsoft Silverlight 4](https://www.microsoft.com/download/details.aspx?familyid=4c3602f0-9781-4374-8fef-669ddd2c0d40) when installed on Mac (KB2668562)Remote Code ExecutionCriticalNone[Microsoft Silverlight 4](https://www.microsoft.com/download/details.aspx?familyid=4c3602f0-9781-4374-8fef-669ddd2c0d40) when installed on all supported releases of Microsoft Windows clients (KB2668562)Remote Code ExecutionCriticalNone[Microsoft Silverlight 4](https://www.microsoft.com/download/details.aspx?familyid=4c3602f0-9781-4374-8fef-669ddd2c0d40) when installed on all supported releases of Microsoft Windows servers (KB2668562)Remote Code ExecutionCriticalNone **Non-Affected Software** SoftwareMicrosoft .NET Framework 1.1 Service Pack 1Microsoft .NET Framework 3.5 Service Pack 1Microsoft Silverlight 5 when installed on MacMicrosoft Silverlight 5 when installed on all releases of Microsoft Windows clientsMicrosoft Silverlight 5 when installed on all releases of Microsoft Windows servers Frequently Asked Questions (FAQ) Related to This Security Update Why was this bulletin revised on February 14, 2012?Microsoft revised this bulletin to announce a detection change for KB2668562 for Microsoft Silverlight 4 when installed on Windows clients and servers to correct an installation issue. This is a detection change only. There were no changes to the security update files. Customers who have already successfully updated their systems do not need to take any action. Are Microsoft .NET Framework 3.5 and Microsoft .NET Framework 4.5 on Windows Developer Preview and Microsoft .NET Framework 4.5 Developer Preview affected by this vulnerability?Yes. This vulnerability was reported after the release of the Windows Developer Preview and the Microsoft .NET Framework 4.5 Developer Preview. Customers running the Developer Preview software are encouraged to download and apply the update to their systems. For more information, including Microsoft Download Center links, see the following Microsoft Knowledge Base Articles: Affected SoftwareMicrosoft Knowledge Base ArticleMicrosoft .NET Framework 3.5 on Windows Developer PreviewMicrosoft Knowledge Base Article 2633877Microsoft .NET Framework 4.5 on Windows Developer PreviewMicrosoft Knowledge Base Article 2633869Microsoft .NET Framework 4.5 Developer Preview on Windows Server 2008, Windows 7, and Windows Server 2008 R2Microsoft Knowledge Base Article 2638804 Security updates are available from Microsoft Update and Windows Update. Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. How do I determine which version of the Microsoft .NET Framework is installed?You can install and run multiple versions of the .NET Framework on a system, and you can install the versions in any order. There are several ways to determine which versions of the .NET Framework are currently installed. For more information, see Microsoft Knowledge Base Article 318785. What is the difference between .NET Framework 4 and .NET Framework 4 Client Profile?The .NET Framework version 4 redistributable packages are available in two profiles: .NET Framework 4 and .NET Framework 4 Client Profile. The .NET Framework 4 Client Profile is a subset of the .NET Framework 4 profile that is optimized for client applications. It provides functionality for most client applications, including Windows Presentation Foundation (WPF), Windows Forms, Windows Communication Foundation (WCF), and ClickOnce features. This enables faster deployment and a smaller install package for applications that target the .NET Framework 4 Client Profile. For more information, see the MSDN article, .NET Framework Client Profile. Which web browsers support Microsoft Silverlight applications?In order to run Microsoft Silverlight applications, most web browsers, including Microsoft Internet Explorer, require Microsoft Silverlight to be installed and the corresponding plug-in to be enabled. For more information about Microsoft Silverlight, see the official site, Microsoft Silverlight. Please refer to the documentation of your browser to learn more about how to disable or remove plug-ins. What versions of Microsoft Silverlight 4 are affected by the vulnerability?Microsoft Silverlight build 4.1.10111, which is the current build of Microsoft Silverlight as of when this bulletin was first released, addresses the vulnerability and is not affected. Builds of Microsoft Silverlight previous to 4.1.10111 are affected. How do I know which version and build of Microsoft Silverlight is currently installed?If Microsoft Silverlight is already installed on your computer, you can visit the Get Microsoft Silverlight page, which will indicate which version and build of Microsoft Silverlight are currently installed on your system. Alternatively, you can use the Manage Add-Ons feature of current versions of Microsoft Internet Explorer to determine the version and build information that is currently installed. You can also manually check the version number of sllauncher.exe located in the \"%ProgramFiles%\\Microsoft Silverlight\" directory (on x86 Microsoft Windows systems) or in the \"%ProgramFiles(x86)%\\Microsoft Silverlight\" directory (on x64 Microsoft Windows systems). In addition, on Microsoft Windows, the version and build information of the currently installed version of Microsoft Silverlight can be found in the registry at [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Silverlight]:Version on x86 Microsoft Windows systems, or [HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Silverlight]:Version on x64 Microsoft Windows systems. On Apple Mac OS, the version and build information of the currently installed version of Microsoft Silverlight can be found as follows: Open the FinderSelect the system drive and go to the folder Internet Plug-ins - LibraryRight-click the file Silverlight.Plugin (if your mouse has only one button, press the Ctrl key while clicking on the file) to bring up the context menu, then click Show Package ContentsInside the contents folder, locate the file info.plist and open it with an editor. It will contain an entry like this, which shows you the version number:SilverlightVersion4.1.10111 The version installed with this security update is 4.1.10111. If your version number is higher than or equal to this version number, your system is not vulnerable. How do I upgrade my version of Microsoft Silverlight?The Microsoft Silverlight auto-update feature helps makes sure that your Microsoft Silverlight installation is kept up to date with the latest version of Microsoft Silverlight, Microsoft Silverlight functionality, and security features. For more information about the Microsoft Silverlight auto-update feature, see the Microsoft Silverlight Updater. Customers who have disabled the Microsoft Silverlight auto-update feature can enroll in Microsoft Update to obtain the latest version of Microsoft Silverlight, or download the latest version of Microsoft Silverlight manually using the download link in the Affected Software table in the earlier section, Affected and Non-Affected Software. For information about deploying Microsoft Silverlight in an enterprise environment, see the Silverlight Enterprise Deployment Guide. I have .NET Framework 3.0 Service Pack 2 installed; this version is not listed among the affected software in this bulletin. Do I need to install an update?This bulletin describes a vulnerability in the .NET Framework 2.0 feature layer. The .NET Framework 3.0 Service Pack 2 installer chains in the .NET Framework 2.0 Service Pack 2 setup, so installing the former also installs the latter. Therefore, customers who have .NET Framework 3.0 Service Pack 2 installed need to install security updates for .NET Framework 2.0 Service Pack 2. I have .NET Framework 3.5 Service Pack 1 installed. Do I need to install any updates?This bulletin describes a vulnerability in the .NET Framework 2.0 feature layer. The .NET Framework 3.5 Service Pack 1 installer chains in both the .NET Framework 2.0 Service Pack 2 setup and the .NET Framework 3.0 Service Pack 2 setup. Therefore, customers who have .NET Framework 3.5 Service Pack 1 installed need to install security updates for .NET Framework 2.0 Service Pack 2. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle website. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Service Pack Lifecycle Support Policy. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information website, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the February bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected Software.NET Framework Unmanaged Objects Vulnerability - CVE-2012-0014.NET Framework Heap Corruption Vulnerability - CVE-2012-0015Aggregate Severity RatingMicrosoft .NET Framework 2.0 Service Pack 2Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows XP Service Pack 3**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows XP Professional x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 with SP2 for Itanium-based Systems**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for 32-bit Systems Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for x64-based Systems Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 with SP2 for Itanium-based Systems**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems and Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems Service Pack 1\\***Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4Microsoft .NET Framework 4 when installed on Windows XP Service Pack 3[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2003 with SP2 for Itanium-based Systems[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems Service Pack 1\\*[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft Silverlight 4Microsoft Silverlight 4 when installed on Mac**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft Silverlight 4 when installed on all releases of Microsoft Windows clients**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft Silverlight 4 when installed on all releases of Microsoft Windows servers\\*\\***Critical** Remote Code ExecutionNot applicable**Critical** **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). **Server Core installation not affected. The vulnerabilities addressed by this update do not affect supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, when installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. [1].NET Framework 4 and .NET Framework 4 Client Profile affected. The .NET Framework version 4 redistributable packages are available in two profiles: .NET Framework 4 and .NET Framework 4 Client Profile. .NET Framework 4 Client Profile is a subset of .NET Framework 4. The vulnerability addressed in this update affects both .NET Framework 4 and .NET Framework 4 Client Profile. For more information, see the MSDN article, Installing the .NET Framework. .NET Framework Unmanaged Objects Vulnerability - CVE-2012-0014 A remote code execution vulnerability exists in Microsoft .NET Framework and Silverlight that can allow a specially crafted Microsoft .NET Framework application to access memory in an unsafe manner. An attacker who successfully exploited this vulnerability could run arbitrary code in the security context of the logged-on user. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0014. Mitigating Factors for .NET Framework Unmanaged Objects Vulnerability - CVE-2012-0014 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web browsing attack scenario, an attacker could host a website that contains a web page that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes users to the attacker's website.By default, Internet Explorer on Windows Server 2003, Windows Server 2008, and Windows Server 2008 R2 runs in a restricted mode that is known as Enhanced Security Configuration. This mode mitigates this vulnerability only on Windows Server 2008 and Windows Server 2008 R2, and only in a web browsing attack scenario. See the FAQ section of this vulnerability for more information about Internet Explorer Enhanced Security Configuration.An attacker who successfully exploited this vulnerability could gain the same user rights as the local user or the user account of ASP.NET. Users or accounts that are configured to have fewer user rights on the system could be less impacted than users or accounts that operate with administrative user rights.In a web-hosting scenario, an attacker must have permission to upload arbitrary ASP.NET pages to a website and ASP.NET must be installed on that web server. In default configuration, an anonymous user cannot upload and run Microsoft .NET code on an Internet Information Server (IIS).By default, partial trust ASP.NET applications are not granted SocketPermission. As a consequence, in a server-side scenario, this vulnerability can not be exploited in ASP.NET applications with a trust level of medium or lower unless those applications are explicitly granted SocketPermission by the administrator. For more information about ASP.NET trust levels, see the MSDN article ASP.NET Trust Levels and Policy Files. Workarounds for .NET Framework Unmanaged Objects Vulnerability - CVE-2012-0014 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Disable XAML browser applications in Internet ExplorerTo help protect against this vulnerability, change your settings to prompt before running XAML browser applications (XBAPs) or to disable XBAPs in the Internet and Local intranet security zones as follows:In Internet Explorer, click the Tools menu and then select Internet Options.Click the Security tab, click Internet, and then click Custom level. Under Settings, for Loose XAML, click Prompt or Disable, and then click OK.Click the Security tab, click Internet, and then click Custom level. Under Settings, for XAML browser applications, click Prompt or Disable, and then click OK.Click the Security tab, click Internet, and then click Custom level. Under Settings, for XPS documents, click Prompt or Disable, and then click OK.On the Security tab, click Custom level. Under .NET Framework-reliant components, set Run components not signed with Authenticode to either Prompt or Disable, and then click OK. Repeat this step for Run components signed with Authenticode, and then click OK.Click Local intranet, and then click Custom Level. Repeat steps 3 and 4. If you are prompted to confirm that you want to change these settings, click Yes. Click OK to return to Internet Explorer.Impact of workaround. Microsoft .NET code will not run in Internet Explorer or will not run without prompting. Disabling Microsoft .NET applications and components in the Internet and Local intranet security zones may cause some websites to work incorrectly. If you have difficulty using a website after you change this setting and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.Add sites that you trust to the Internet Explorer Trusted sites zoneAfter you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted websites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.To do this, perform the following steps:In Internet Explorer, click Tools, click Internet Options, and then click the Security tab.In the Select a Web content zone to specify its current security settings box, click Trusted Sites, and then click Sites.If you want to add sites that do not require an encrypted channel, click to clear the Require server verification (https:) for all sites in this zone check box.In the Add this Web site to the zone box, type the URL of a site that you trust, and then click Add.Repeat these steps for each site that you want to add to the zone.Click OK two times to accept the changes and return to Internet Explorer.Note Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are *.windowsupdate.microsoft.com and *.update.microsoft.com. These are the sites that will host the update, and it requires an ActiveX Control to install the update.How to undo the workaround. Perform the following steps:In Internet Explorer, click the Tools menu, and then select Internet Options.Click the Security tab, click Reset all zones to default level, and then click OK.Temporarily prevent the Microsoft Silverlight ActiveX control from running in Internet Explorer (Method 1)You can help protect against these vulnerabilities by temporarily preventing attempts to instantiate the Silverlight ActiveX control in Internet Explorer by setting the kill bit for the control.Warning If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.We recommend that you back up the registry before you edit it.Use the following text to create a .reg file that temporarily prevents attempts to instantiate the Silverlight ActiveX control in Internet Explorer. You can copy the following text, paste it into a text editor such as Notepad, and then save the file with the .reg file name extension. Run the .reg file on the vulnerable client.Windows Registry Editor Version 5.00[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{DFEAF541-F3E1-4C24-ACAC-99C30715084A}]\"Compatibility Flags\"=dword:00000400Close Internet Explorer and reopen it for the changes to take effect.For detailed steps about stopping a control from running in Internet Explorer, see Microsoft Knowledge Base Article 240797. Follow these steps and create a Compatibility Flags value in the registry to prevent the Silverlight ActiveX control from running in Internet Explorer.Impact of workaround. Applications and Web sites that require the Microsoft Silverlight ActiveX control may no longer function correctly. If you implement this workaround it would affect any Silverlight ActiveX control you have installed on your system.How to undo the workaround. Remove the registry keys added to temporarily prevent attempts to instantiate the Silverlight ActiveX control in Internet Explorer.Temporarily prevent the Microsoft Silverlight ActiveX control from running in Firefox or ChromeTo modify the registry key to disable Microsoft Silverlight, follow these steps:Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the \"Changing Keys And Values\" Help topic in Registry Editor (Regedit.exe) or view the \"Add and Delete Information in the Registry\" and \"Edit Registry Data\" Help topics in Regedt32.exe.Using the Interactive MethodClick Start, click Run, type Regedit in the Open box, and then click OK.Locate and then click the following registry subkey:HKEY_LOCAL_MACHINE\\SOFTWARE\\MozillaPlugins\\@Microsoft.com/NpCtrl,version=1.0Right click on @Microsoft.com/NpCtrl,version=1.0 and select Export. Save the file to disk.Delete the entire @Microsoft.com/NpCtrl,version=1.0 key.Quit the registry editor.Using a registry fileCreate a backup copy of the registry keys. A backup copy can be made using a managed deployment script with the following command:Regedit.exe /e SL_backup.reg HKEY_LOCAL_MACHINE\\SOFTWARE\\MozillaPlugins\\@Microsoft.com/NpCtrl,version=1.0Save the following to a file with a .REG extension (e.g. Disable_Silverlight.reg):Windows Registry Editor Version 5.00[-HKEY_LOCAL_MACHINE\\SOFTWARE\\MozillaPlugins\\@Microsoft.com/NpCtrl,version=1.0]Run the above registry script created in step 2 on the target system with the following command:Regedit /s Disable_Silverlight.regHow to undo the workaround.Using the Interactive MethodClick Start, click Run, type Regedit in the Open box, and then click OK.On the File menu, click Import.In Look in, select the drive, folder, or network computer and folder where the file you previously exported is located.Select the correct file name and then click Open.Using a Managed Deployment ScriptRestore the file backed up in Using a registry file Step 1, above, with the following command:Regedit /s SL_backup.reg FAQ for .NET Framework Unmanaged Objects Vulnerability - CVE-2012-0014 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability is caused when the Microsoft .NET Framework and Microsoft Silverlight improperly use unmanaged objects. What is Microsoft Silverlight?Microsoft Silverlight is a cross-browser, cross-platform implementation of the Microsoft .NET Framework for building media experiences and rich interactive applications for the web. For more information, see the official site of Microsoft Silverlight. What might an attacker use the vulnerability to do?In the web browsing scenario, an attacker who successfully exploited this vulnerability could obtain the same permissions as the currently logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. In the web hosting scenario, an attacker who successfully exploits this vulnerability could obtain the same permissions as the service account associated with the application pool identity of the application pool in which a Microsoft .NET application is running. Depending on application pool isolation configuration and permissions granted to the service account, an attacker might be able to take control over other application pools on the web server or be able to take complete control of the affected system. For more information about application pool identities and configuration, see the TechNet article, Configure Application Pool Identity. How could an attacker exploit the vulnerability?There are three attack scenarios possible for exploiting this vulnerability: a web browsing scenario, a web hosting scenario, and a Windows .NET application bypass of Code Access Security (CAS) restrictions. These scenarios are described as follows: Web browsing attack scenarioAn attacker could host a specially crafted website that contains a specially crafted XBAP (XAML browser application) that could exploit this vulnerability and then convince a user to view the website. The attacker could also take advantage of compromised websites and websites that accept or host user-provided content or advertisements. These websites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or in an Instant Messenger message that takes users to the attacker's website. It could also be possible to display specially crafted web content by using banner advertisements or by using other methods to deliver web content to affected systems.Web hosting attack scenarioIf a web hosting environment allows users to upload custom ASP.NET applications, an attacker could upload a malicious ASP.NET application that uses this vulnerability to break out of the sandbox used to prevent ASP.NET code from performing harmful actions on the server system.Windows .NET applications attack scenarioThis vulnerability could also be used by Windows .NET applications to bypass Code Access Security (CAS) restrictions. What is an XAML Browser Application (XBAP)?An XAML browser application (XBAP) combines features of both a web application and a rich-client application. Like web applications, XBAPs can be published to a web server and launched from Internet Explorer. Like rich-client applications, XBAPs can take advantage of the capabilities of Windows Presentation Foundation (WPF). For more information about XBAPs, see MSDN article, Windows Presentation Foundation XAML Browser Applications Overview. What are .NET Framework Code Access Security (CAS) Restrictions?The .NET Framework provides a security mechanism called code access security to help protect computer systems from malicious mobile code, to allow code from unknown origins to run with protection, and to help prevent trusted code from intentionally or accidentally compromising security. Code access security (CAS) enables code to be trusted to varying degrees depending on where the code originates and on other aspects of the code's identity. Code access security also enforces the varying levels of trust on code, which minimizes the amount of code that must be fully trusted in order to run. Using code access security can reduce the likelihood that your code will be misused by malicious or error-filled code. For more information on CAS, see the MSDN article, Code Access Security. What systems are primarily at risk from the vulnerability?There are three types of systems at risk from this vulnerability, described as follows: systems that are using the web browsing scenario, systems that are using the web hosting scenario, and systems that are using the Windows .NET applications scenario. Web browsing scenarioSuccessful exploitation of this vulnerability requires that a user is logged on and is visiting websites using a web browser capable of instantiating XBAPs. Therefore, any systems where a web browser is used frequently, such as workstations or terminal servers, are at the most risk from this vulnerability. Servers could be at more risk if administrators allow users to browse and read email on servers. However, best practices strongly discourage allowing this.Web hosting scenarioWeb hosting sites that allow users to upload custom ASP.NET applications are at increased risk.Windows .NET applicationsWorkstations and server that run untrusted Windows .NET applications are also at risk from this vulnerability. I am running Internet Explorer for Windows Server 2003, Windows Server 2008, or Windows Server 2008 R2. Does this mitigate this vulnerability?Yes. By default, Internet Explorer on Windows Server 2003, Windows Server 2008, and Windows Server 2008 R2 runs in a restricted mode that is known as Enhanced Security Configuration. Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted web content on a server. This is a mitigating factor for websites that you have not added to the Internet Explorer Trusted sites zone. What does the update do?The update addresses the vulnerability by correcting the manner in which the Microsoft .NET Framework and Microsoft Silverlight use unmanaged objects. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. .NET Framework Heap Corruption Vulnerability - CVE-2012-0015 A remote code execution vulnerability exists in Microsoft .NET Framework due to it improperly calculating a buffer length while processing specially crafted input. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0015. Mitigating Factors for .NET Framework Heap Corruption Vulnerability - CVE-2012-0015 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web browsing attack scenario, an attacker could host a website that contains a web page that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes users to the attacker's website.By default, Internet Explorer on Windows Server 2003, Windows Server 2008, and Windows Server 2008 R2 runs in a restricted mode that is known as Enhanced Security Configuration. This mode mitigates this vulnerability only on Windows Server 2008 and Windows Server 2008 R2, and only in a web browsing attack scenario. See the FAQ section of this vulnerability for more information about Internet Explorer Enhanced Security Configuration.In a web-hosting scenario, an attacker must have permission to upload arbitrary ASP.NET pages to a website and ASP.NET must be installed on that web server. In default configuration, an anonymous user cannot upload and run Microsoft .NET code on an Internet Information Server (IIS). Workarounds for .NET Framework Heap Corruption Vulnerability - CVE-2012-0015 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Disable XAML browser applications in Internet ExplorerTo help protect against this vulnerability, change your settings to prompt before running XAML browser applications (XBAPs) or to disable XBAPs in the Internet and Local intranet security zones as follows:In Internet Explorer, click the Tools menu and then select Internet Options.Click the Security tab, click Internet, and then click Custom level. Under Settings, for Loose XAML, click Prompt or Disable, and then click OK.Click the Security tab, click Internet, and then click Custom level. Under Settings, for XAML browser applications, click Prompt or Disable, and then click OK.Click the Security tab, click Internet, and then click Custom level. Under Settings, for XPS documents, click Prompt or Disable, and then click OK.On the Security tab, click Custom level. Under .NET Framework-reliant components, set Run components not signed with Authenticode to either Prompt or Disable, and then click OK. Repeat this step for Run components signed with Authenticode, and then click OK.Click Local intranet, and then click Custom Level. Repeat steps 3 and 4. If you are prompted to confirm that you want to change these settings, click Yes. Click OK to return to Internet Explorer.Impact of workaround. Microsoft .NET code will not run in Internet Explorer or will not run without prompting. Disabling Microsoft .NET applications and components in the Internet and Local intranet security zones may cause some websites to work incorrectly. If you have difficulty using a website after you change this setting and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.Add sites that you trust to the Internet Explorer Trusted sites zoneAfter you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted websites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.To do this, perform the following steps:In Internet Explorer, click Tools, click Internet Options, and then click the Security tab.In the Select a Web content zone to specify its current security settings box, click Trusted Sites, and then click Sites.If you want to add sites that do not require an encrypted channel, click to clear the Require server verification (https:) for all sites in this zone check box.In the Add this Web site to the zone box, type the URL of a site that you trust, and then click Add.Repeat these steps for each site that you want to add to the zone.Click OK two times to accept the changes and return to Internet Explorer.Note Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are *.windowsupdate.microsoft.com and *.update.microsoft.com. These are the sites that will host the update, and it requires an ActiveX Control to install the update.How to undo the workaround. Perform the following steps:In Internet Explorer, click the Tools menu, and then select Internet Options.Click the Security tab, click Reset all zones to default level, and then click OK. FAQ for .NET Framework Heap Corruption Vulnerability - CVE-2012-0015 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability is caused when the .NET Framework improperly calculates a buffer length while processing specially crafted input. What might an attacker use the vulnerability to do?In the web browsing scenario, an attacker who successfully exploited this vulnerability could obtain the same permissions as the currently logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. In the web hosting scenario, an attacker who successfully exploits this vulnerability could obtain the same permissions as the service account associated with the application pool identity of the application pool in which a Microsoft .NET application is running. Depending on application pool isolation configuration and permissions granted to the service account, an attacker might be able to take control over other application pools on the web server or be able to take complete control of the affected system. For more information about application pool identities and configuration, see the TechNet article, Configure Application Pool Identity. How could an attacker exploit the vulnerability?There are three attack scenarios possible for exploiting this vulnerability: a web browsing scenario, a web hosting scenario, and a Windows .NET application bypass of Code Access Security (CAS) restrictions scenario. These scenarios are described as follows: Web browsing attack scenarioAn attacker could host a specially crafted website that contains a specially crafted XBAP (XAML browser application) that could exploit this vulnerability and then convince a user to view the website. The attacker could also take advantage of compromised websites and websites that accept or host user-provided content or advertisements. These websites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or in an Instant Messenger message that takes users to the attacker's website. It could also be possible to display specially crafted web content by using banner advertisements or by using other methods to deliver web content to affected systems.Web hosting attack scenarioIf a web hosting environment allows users to upload custom ASP.NET applications, an attacker could upload a malicious ASP.NET application that uses this vulnerability to break out of the sandbox used to prevent ASP.NET code from performing harmful actions on the server system.Windows .NET applications attack scenarioThis vulnerability could also be used by Windows .NET applications to bypass Code Access Security (CAS) restrictions. What is an XAML Browser Application (XBAP)?An XAML browser application (XBAP) combines features of both a web application and a rich-client application. Like web applications, XBAPs can be published to a web server and launched from Internet Explorer. Like rich-client applications, XBAPs can take advantage of the capabilities of Windows Presentation Foundation (WPF). For more information about XBAPs, see MSDN article, Windows Presentation Foundation XAML Browser Applications Overview. What are .NET Framework Code Access Security (CAS) Restrictions?The .NET Framework provides a security mechanism called code access security to help protect computer systems from malicious mobile code, to allow code from unknown origins to run with protection, and to help prevent trusted code from intentionally or accidentally compromising security. Code access security (CAS) enables code to be trusted to varying degrees depending on where the code originates and on other aspects of the code's identity. Code access security also enforces the varying levels of trust on code, which minimizes the amount of code that must be fully trusted in order to run. Using code access security can reduce the likelihood that your code will be misused by malicious or error-filled code. For more information on CAS, see the MSDN article, Code Access Security. What systems are primarily at risk from the vulnerability?There are three types of systems at risk from this vulnerability, described as follows: systems that are using the web browsing scenario, systems that are using the web hosting scenario, and systems that are using the Windows .NET applications scenario. Web browsing scenarioSuccessful exploitation of this vulnerability requires that a user is logged on and is visiting websites using a web browser capable of instantiating XBAPs. Therefore, any systems where a web browser is used frequently, such as workstations or terminal servers, are at the most risk from this vulnerability. Servers could be at more risk if administrators allow users to browse and read email on servers. However, best practices strongly discourage allowing this.Web hosting scenarioWeb hosting sites that allow users to upload custom ASP.NET applications are at increased risk.Windows .NET applicationsWorkstations and server that run untrusted Windows .NET applications are also at risk from this vulnerability. I am running Internet Explorer for Windows Server 2003, Windows Server 2008, or Windows Server 2008 R2. Does this mitigate this vulnerability?Yes. By default, Internet Explorer on Windows Server 2003, Windows Server 2008, and Windows Server 2008 R2 runs in a restricted mode that is known as Enhanced Security Configuration. Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted web content on a server. This is a mitigating factor for websites that you have not added to the Internet Explorer Trusted sites zone. What does the update do?The update addresses the vulnerability by correcting the manner in which the Microsoft .NET Framework calculates buffer lengths. When this security bulletin was issued, had this vulnerability been publicly disclosed?Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number CVE-2012-0015. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Does applying this security update help protect customers from the code, published publicly, that could attempt to exploit this vulnerability?Yes. This security update addresses the vulnerability that potentially could be exploited by using the published proof of concept code. The vulnerability that has been addressed has been assigned Common Vulnerability and Exposure number CVE-2012-0015. Update Information Detection and Deployment Tools and Guidance Security Central Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security website provides additional information about security in Microsoft products. Security updates are available from Microsoft Update and Windows Update. Security updates are also available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the Microsoft Update Catalog. The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the Microsoft Update Catalog FAQ. Detection and Deployment Guidance Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see Microsoft Knowledge Base Article 961747. Microsoft Baseline Security Analyzer Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit Microsoft Baseline Security Analyzer. The following table provides the MBSA detection summary for this security update. SoftwareMBSAWindows XP Service Pack 3YesWindows XP Professional x64 Edition Service Pack 2YesWindows Server 2003 Service Pack 2YesWindows Server 2003 x64 Edition Service Pack 2YesWindows Server 2003 with SP2 for Itanium-based SystemsYesWindows Vista Service Pack 2YesWindows Vista x64 Edition Service Pack 2YesWindows Server 2008 for 32-bit Systems Service Pack 2YesWindows Server 2008 for x64-based Systems Service Pack 2YesWindows Server 2008 for Itanium-based Systems Service Pack 2YesWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1YesWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1YesWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1YesWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1YesMicrosoft Silverlight 4 when installed on MacNoMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows clientsYesMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows serversYes Note For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit Microsoft Baseline Security Analyzer and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. Windows Server Update Services Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, Windows Server Update Services. Systems Management Server The following table provides the SMS detection and deployment summary for this security update. SoftwareSMS 2003 with ITMUConfiguration Manager 2007Windows XP Service Pack 3YesYesWindows XP Professional x64 Edition Service Pack 2YesYesWindows Server 2003 Service Pack 2YesYesWindows Server 2003 x64 Edition Service Pack 2YesYesWindows Server 2003 with SP2 for Itanium-based SystemsYesYesWindows Vista Service Pack 2YesYesWindows Vista x64 Edition Service Pack 2YesYesWindows Server 2008 for 32-bit Systems Service Pack 2YesYesWindows Server 2008 for x64-based Systems Service Pack 2YesYesWindows Server 2008 for Itanium-based Systems Service Pack 2YesYesWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1YesYesWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1YesYesWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1YesYesWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1YesYesMicrosoft Silverlight 4 when installed on MacNoNoMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows clientsYesYesMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows serversYesYes Note Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to System Center Configuration Manager 2007. For customers remaining on SMS 2003 Service Pack 3, the Inventory Tool for Microsoft Updates (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by Microsoft Update and that are supported by Windows Server Update Services. For more information about the SMS 2003 ITMU, see SMS 2003 Inventory Tool for Microsoft Updates. For more information about SMS scanning tools, see SMS 2003 Software Update Scanning Tools. See also Downloads for Systems Management Server 2003. System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit System Center Configuration Manager 2007. For more information about SMS, visit the SMS website. For more detailed information, see Microsoft Knowledge Base Article 910723: Summary list of monthly detection and deployment guidance articles. Update Compatibility Evaluator and Application Compatibility Toolkit Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the Update Compatibility Evaluator components included with Application Compatibility Toolkit. The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Windows XP (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Service Pack 3:NDP20SP2-KB2633880-x86.exe /qFor Microsoft .NET Framework 4 when installed on Windows XP Service Pack 3:NDP40-KB2633870-x86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Professional Edition x64 Edition Service Pack 2:NDP20SP2-KB2633880-x64.exe /qFor Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2:NDP40-KB2633870-x64.exe /qInstalling without restartingFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Service Pack 3:NDP20SP2-KB2633880-x86.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows XP Service Pack 3:NDP40-KB2633870-x86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Professional Edition x64 Edition Service Pack 2:NDP20SP2-KB2633880-x64.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2:NDP40-KB2633870-x64.exe /norestartUpdate log fileFor Microsoft .NET Framework 2.0 Service Pack 2:Microsoft .NET Framework 2.0-KB2633880_*-msi0.txtMicrosoft .NET Framework 2.0-KB2633880_*.htmlFor Microsoft .NET Framework 4:KB2633870_*_*-Microsoft .NET Framework 4 Client Profile-MSP0.txtKB2633870_*_*.htmlFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationFor all supported versions of Microsoft .NET Framework, use the Add or Remove Programs item in Control Panel.File InformationSee Microsoft Knowledge Base Article 2651026Registry Key VerificationFor Microsoft .NET Framework 2.0 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Microsoft .NET Framework 2.0 Service Pack 2\\SP2\\KB2633880\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 on Windows XP Service Pack 3:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\" Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Removing the Update** This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2003 Service Pack 2:NDP20SP2-KB2633880-x86.exe /qFor Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2:NDP40-KB2633870-x86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2003 x64 Edition Service Pack 2:NDP20SP2-KB2633880-x64.exe /q For Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP40-KB2633870-x64.exe /q For Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2003 with SP2 for Itanium-based Systems:NDP20SP2-KB2633880-ia64.exe /qFor Microsoft .NET Framework 4 when installed on Windows Server 2003 with SP2 for Itanium-based Systems:NDP40-KB2633870-ia64.exe /qInstalling without restartingFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2003 Service Pack 2:NDP20SP2-KB2633880-x86.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2:NDP40-KB2633870-x86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2003 x64 Edition Service Pack 2:NDP20SP2-KB2633880-x64.exe /norestart For Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP40-KB2633870-x64.exe /norestart For Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2003 with SP2 for Itanium-based Systems:NDP20SP2-KB2633880-ia64.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2003 with SP2 for Itanium-based Systems:NDP40-KB2633870-ia64.exe /norestartUpdate log fileFor Microsoft .NET Framework 2.0 Service Pack 2:Microsoft .NET Framework 2.0-KB2633880_*-msi0.txtMicrosoft .NET Framework 2.0-KB2633880_*.htmlFor Microsoft .NET Framework 4:KB2633870_*_*-Microsoft .NET Framework 4 Client Profile-MSP0.txtKB2633870_*_*.htmlFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see Microsoft Knowledge Base Article 897341.Removal InformationFor all supported versions of Microsoft .NET Framework, use the Add or Remove Programs item in Control Panel.File InformationSee Microsoft Knowledge Base Article 2651026Registry Key VerificationFor Microsoft .NET Framework 2.0 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Microsoft .NET Framework 2.0 Service Pack 2\\SP2\\KB2633880\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2 and Windows Server 2003 Itanium-based Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\" Note The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Removing the Update** This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Vista (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista Service Pack 2:Windows6.0-KB2633874-x86.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2:NDP40-KB2633870-x86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista x64 Edition Service Pack 2:Windows6.0-KB2633874-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2:NDP40-KB2633870-x64.exe /qInstalling without restartingFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista Service Pack 2:Windows6.0-KB2633874-x86.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2:NDP40-KB2633870-x86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista x64 Edition Service Pack 2:Windows6.0-KB2633874-x64.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2:NDP40-KB2633870-x64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2651026Registry Key VerificationFor Microsoft .NET Framework 2.0 Service Pack 2:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 2.0 Service Pack 2 This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2. SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Installing the Update for Microsoft .NET Framework 4 This security update supports the following setup switches for Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and then click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 2.0 Service Pack 2 Windows Server 2008 for 32-bit Systems Service Pack 2:Windows6.0-KB2633874-x86.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:NDP40-KB2633870-x86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for x64-based Systems Service Pack 2:Windows6.0-KB2633874-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2:NDP40-KB2633870-x64.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 with SP2 for Itanium-based Systems:Windows6.0-KB2633874-ia64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2:NDP40-KB2633870-ia64.exe /qInstalling without restartingFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for 32-bit Systems Service Pack 2:Windows6.0-KB2633874-x86.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:NDP40-KB2633870-x86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for x64-based Systems Service Pack 2:Windows6.0-KB2633874-x64.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2:NDP40-KB2633870-x64.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 with SP2 for Itanium-based Systems:Windows6.0-KB2633874-ia64.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2:NDP40-KB2633870-ia64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2651026Registry Key VerificationFor Microsoft .NET Framework 2.0 Service Pack 2:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2 and Windows Server 2008 for Itanium-based Systems Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 2.0 Service Pack 2 This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2. SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Installing the Update for Microsoft .NET Framework 4 This security update supports the following setup switches for Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and then click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems:Windows6.1-KB2633879-x86.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems Service Pack 1:Windows6.1-KB2633873-x86.msu /quietFor Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1:NDP40-KB2633870-x86.exe /qFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems:Windows6.1-KB2633879-x64.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems Service Pack 1:Windows6.1-KB2633873-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1:NDP40-KB2633870-x64.exe /qInstalling without restartingFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems:Windows6.1-KB2633879-x86.msu /quiet /norestartFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems Service Pack 1:Windows6.1-KB2633873-x86.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1:NDP40-KB2633870-x86.exe /norestartFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems:Windows6.1-KB2633879-x64.msu /quiet /norestartFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems Service Pack 1:Windows6.1-KB2633873-x64.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1:NDP40-KB2633870-x64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2651026Registry Key VerificationFor Microsoft .NET Framework 3.5.1 on Windows 7:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 3.5.1 This security update supports the following setup switches for Microsoft .NET Framework 3.5.1. SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Installing the Update for Microsoft .NET Framework 4 This security update supports the following setup switches for Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That** **the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and then click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems:Windows6.1-KB2633879-x64.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems Service Pack 1:Windows6.1-KB2633873-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1:NDP40-KB2633870-x64.exe /quietFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems:Windows6.1-KB2633879-ia64.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:Windows6.1-KB2633873-ia64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:NDP40-KB2633870-ia64.exe /quietInstalling without restartingFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems:Windows6.1-KB2633879-x64.msu /quiet /norestartFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems Service Pack 1:Windows6.1-KB2633873-x64.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1:NDP40-KB2633870-x64.exe /norestartFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems:Windows6.1-KB2633879-ia64.msu /quiet /norestartFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:Windows6.1-KB2633873-ia64.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:NDP40-KB2633870-ia64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2651026Registry Key VerificationFor Microsoft .NET Framework 3.5.1:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 3.5.1 This security update supports the following setup switches for Microsoft .NET Framework 3.5.1. SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Installing the Update for Microsoft .NET Framework 4 This security update supports the following setup switches for Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and then click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Jeroen Frijters of Sumatra for reporting the .NET Framework Unmanaged Objects Vulnerability (CVE-2012-0014) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections websites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support website. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (February 14, 2012): Bulletin published.V1.1 (February 14, 2012): Added an entry to the update FAQ to announce a detection change for KB2668562 for Microsoft Silverlight 4 when installed on Windows clients and servers to correct an installation issue. This is a detection change only. There were no changes to the security update files. Customers who have already successfully updated their systems do not need to take any action.V1.2 (February 15, 2012): Removed erroneous reference to known issues from the Executive Summary.V1.3 (July 10, 2012): Microsoft revised this bulletin to communicate a minor detection change for KB2633880 for Microsoft .NET Framework 2.0 Service Pack 2 to correct an offering issue. There were no changes to the security update files. Customers who have already successfully updated their systems do not need to take any action. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2012-0015": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-016",
        "title": "Vulnerabilities in .NET Framework and Microsoft Silverlight Could Allow Remote Code Execution (2651026)",
        "body": "V1.3 (July 10, 2012): Microsoft revised this bulletin to communicate a minor detection change for KB2633880 for Microsoft .NET Framework 2.0 Service Pack 2 to correct an offering issue. There were no changes to the security update files. Customers who have already successfully updated their systems do not need to take any action.",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Operating SystemComponentMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateWindows XPWindows XP Service Pack 3[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=5269e18b-d4f0-4c64-8df8-283a2ca66c59) (KB2633880) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539631 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633880 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows XP Professional x64 Edition Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=5269e18b-d4f0-4c64-8df8-283a2ca66c59) (KB2633880) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539631 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633880 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2003Windows Server 2003 Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=5269e18b-d4f0-4c64-8df8-283a2ca66c59) (KB2633880) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539631 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633880 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2003 x64 Edition Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=5269e18b-d4f0-4c64-8df8-283a2ca66c59) (KB2633880) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539631 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633880 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2003 with SP2 for Itanium-based Systems[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=5269e18b-d4f0-4c64-8df8-283a2ca66c59) (KB2633880) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539631 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633880 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows VistaWindows Vista Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=aab7826d-539b-4e36-b3a1-afa94b37dbe7) (KB2633874) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539633 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633874 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Vista x64 Edition Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=aab7826d-539b-4e36-b3a1-afa94b37dbe7) (KB2633874) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539633 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633874 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008Windows Server 2008 for 32-bit Systems Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=aab7826d-539b-4e36-b3a1-afa94b37dbe7) (KB2633874) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539633 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633874 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008 for x64-based Systems Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=aab7826d-539b-4e36-b3a1-afa94b37dbe7) (KB2633874) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539633 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633874 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008 for Itanium-based Systems Service Pack 2[Microsoft .NET Framework 2.0 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=aab7826d-539b-4e36-b3a1-afa94b37dbe7) (KB2633874) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539633 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633874 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows 7Windows 7 for 32-bit Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=5a5f3ee7-ca49-41c8-aeec-7c76b66712fc) (KB2633879) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539634 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633879 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows 7 for 32-bit Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=243e8c64-8b6e-4cea-9e99-58d4b1ad35b5) (KB2633873) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539635 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633873 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows 7 for x64-based Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=5a5f3ee7-ca49-41c8-aeec-7c76b66712fc) (KB2633879) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539634 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633879 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows 7 for x64-based Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=243e8c64-8b6e-4cea-9e99-58d4b1ad35b5) (KB2633873) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539635 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633873 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008 R2Windows Server 2008 R2 for x64-based Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=5a5f3ee7-ca49-41c8-aeec-7c76b66712fc)\\* (KB2633879) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539634 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633879 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008 R2 for x64-based Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=243e8c64-8b6e-4cea-9e99-58d4b1ad35b5)\\* (KB2633873) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)\\*[1](KB2633870)Remote Code ExecutionCriticalKB2539635 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633873 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008 R2 for Itanium-based Systems[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=5a5f3ee7-ca49-41c8-aeec-7c76b66712fc) (KB2633879) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539634 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633879 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870Windows Server 2008 R2 for Itanium-based Systems Service Pack 1[Microsoft .NET Framework 3.5.1](https://www.microsoft.com/download/details.aspx?familyid=243e8c64-8b6e-4cea-9e99-58d4b1ad35b5) (KB2633873) [Microsoft .NET Framework 4](https://www.microsoft.com/download/details.aspx?familyid=70aadf34-abdc-4577-8da9-a0669dccc119)[1](KB2633870)Remote Code ExecutionCriticalKB2539635 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633873 KB2539636 in [MS11-069](http://go.microsoft.com/fwlink/?linkid=221537) is replaced by KB2633870 **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). [1].NET Framework 4 and .NET Framework 4 Client Profile affected. The .NET Framework version 4 redistributable packages are available in two profiles: .NET Framework 4 and .NET Framework 4 Client Profile. .NET Framework 4 Client Profile is a subset of .NET Framework 4. The vulnerability addressed in this update affects both .NET Framework 4 and .NET Framework 4 Client Profile. For more information, see the MSDN article, Installing the .NET Framework. Microsoft Developer Tools and Software Operating SystemMaximum Security ImpactAggregate Severity RatingBulletins Replaced by this UpdateMicrosoft Silverlight 4[Microsoft Silverlight 4](https://www.microsoft.com/download/details.aspx?familyid=4c3602f0-9781-4374-8fef-669ddd2c0d40) when installed on Mac (KB2668562)Remote Code ExecutionCriticalNone[Microsoft Silverlight 4](https://www.microsoft.com/download/details.aspx?familyid=4c3602f0-9781-4374-8fef-669ddd2c0d40) when installed on all supported releases of Microsoft Windows clients (KB2668562)Remote Code ExecutionCriticalNone[Microsoft Silverlight 4](https://www.microsoft.com/download/details.aspx?familyid=4c3602f0-9781-4374-8fef-669ddd2c0d40) when installed on all supported releases of Microsoft Windows servers (KB2668562)Remote Code ExecutionCriticalNone **Non-Affected Software** SoftwareMicrosoft .NET Framework 1.1 Service Pack 1Microsoft .NET Framework 3.5 Service Pack 1Microsoft Silverlight 5 when installed on MacMicrosoft Silverlight 5 when installed on all releases of Microsoft Windows clientsMicrosoft Silverlight 5 when installed on all releases of Microsoft Windows servers Frequently Asked Questions (FAQ) Related to This Security Update Why was this bulletin revised on February 14, 2012?Microsoft revised this bulletin to announce a detection change for KB2668562 for Microsoft Silverlight 4 when installed on Windows clients and servers to correct an installation issue. This is a detection change only. There were no changes to the security update files. Customers who have already successfully updated their systems do not need to take any action. Are Microsoft .NET Framework 3.5 and Microsoft .NET Framework 4.5 on Windows Developer Preview and Microsoft .NET Framework 4.5 Developer Preview affected by this vulnerability?Yes. This vulnerability was reported after the release of the Windows Developer Preview and the Microsoft .NET Framework 4.5 Developer Preview. Customers running the Developer Preview software are encouraged to download and apply the update to their systems. For more information, including Microsoft Download Center links, see the following Microsoft Knowledge Base Articles: Affected SoftwareMicrosoft Knowledge Base ArticleMicrosoft .NET Framework 3.5 on Windows Developer PreviewMicrosoft Knowledge Base Article 2633877Microsoft .NET Framework 4.5 on Windows Developer PreviewMicrosoft Knowledge Base Article 2633869Microsoft .NET Framework 4.5 Developer Preview on Windows Server 2008, Windows 7, and Windows Server 2008 R2Microsoft Knowledge Base Article 2638804 Security updates are available from Microsoft Update and Windows Update. Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. How do I determine which version of the Microsoft .NET Framework is installed?You can install and run multiple versions of the .NET Framework on a system, and you can install the versions in any order. There are several ways to determine which versions of the .NET Framework are currently installed. For more information, see Microsoft Knowledge Base Article 318785. What is the difference between .NET Framework 4 and .NET Framework 4 Client Profile?The .NET Framework version 4 redistributable packages are available in two profiles: .NET Framework 4 and .NET Framework 4 Client Profile. The .NET Framework 4 Client Profile is a subset of the .NET Framework 4 profile that is optimized for client applications. It provides functionality for most client applications, including Windows Presentation Foundation (WPF), Windows Forms, Windows Communication Foundation (WCF), and ClickOnce features. This enables faster deployment and a smaller install package for applications that target the .NET Framework 4 Client Profile. For more information, see the MSDN article, .NET Framework Client Profile. Which web browsers support Microsoft Silverlight applications?In order to run Microsoft Silverlight applications, most web browsers, including Microsoft Internet Explorer, require Microsoft Silverlight to be installed and the corresponding plug-in to be enabled. For more information about Microsoft Silverlight, see the official site, Microsoft Silverlight. Please refer to the documentation of your browser to learn more about how to disable or remove plug-ins. What versions of Microsoft Silverlight 4 are affected by the vulnerability?Microsoft Silverlight build 4.1.10111, which is the current build of Microsoft Silverlight as of when this bulletin was first released, addresses the vulnerability and is not affected. Builds of Microsoft Silverlight previous to 4.1.10111 are affected. How do I know which version and build of Microsoft Silverlight is currently installed?If Microsoft Silverlight is already installed on your computer, you can visit the Get Microsoft Silverlight page, which will indicate which version and build of Microsoft Silverlight are currently installed on your system. Alternatively, you can use the Manage Add-Ons feature of current versions of Microsoft Internet Explorer to determine the version and build information that is currently installed. You can also manually check the version number of sllauncher.exe located in the \"%ProgramFiles%\\Microsoft Silverlight\" directory (on x86 Microsoft Windows systems) or in the \"%ProgramFiles(x86)%\\Microsoft Silverlight\" directory (on x64 Microsoft Windows systems). In addition, on Microsoft Windows, the version and build information of the currently installed version of Microsoft Silverlight can be found in the registry at [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Silverlight]:Version on x86 Microsoft Windows systems, or [HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Silverlight]:Version on x64 Microsoft Windows systems. On Apple Mac OS, the version and build information of the currently installed version of Microsoft Silverlight can be found as follows: Open the FinderSelect the system drive and go to the folder Internet Plug-ins - LibraryRight-click the file Silverlight.Plugin (if your mouse has only one button, press the Ctrl key while clicking on the file) to bring up the context menu, then click Show Package ContentsInside the contents folder, locate the file info.plist and open it with an editor. It will contain an entry like this, which shows you the version number:SilverlightVersion4.1.10111 The version installed with this security update is 4.1.10111. If your version number is higher than or equal to this version number, your system is not vulnerable. How do I upgrade my version of Microsoft Silverlight?The Microsoft Silverlight auto-update feature helps makes sure that your Microsoft Silverlight installation is kept up to date with the latest version of Microsoft Silverlight, Microsoft Silverlight functionality, and security features. For more information about the Microsoft Silverlight auto-update feature, see the Microsoft Silverlight Updater. Customers who have disabled the Microsoft Silverlight auto-update feature can enroll in Microsoft Update to obtain the latest version of Microsoft Silverlight, or download the latest version of Microsoft Silverlight manually using the download link in the Affected Software table in the earlier section, Affected and Non-Affected Software. For information about deploying Microsoft Silverlight in an enterprise environment, see the Silverlight Enterprise Deployment Guide. I have .NET Framework 3.0 Service Pack 2 installed; this version is not listed among the affected software in this bulletin. Do I need to install an update?This bulletin describes a vulnerability in the .NET Framework 2.0 feature layer. The .NET Framework 3.0 Service Pack 2 installer chains in the .NET Framework 2.0 Service Pack 2 setup, so installing the former also installs the latter. Therefore, customers who have .NET Framework 3.0 Service Pack 2 installed need to install security updates for .NET Framework 2.0 Service Pack 2. I have .NET Framework 3.5 Service Pack 1 installed. Do I need to install any updates?This bulletin describes a vulnerability in the .NET Framework 2.0 feature layer. The .NET Framework 3.5 Service Pack 1 installer chains in both the .NET Framework 2.0 Service Pack 2 setup and the .NET Framework 3.0 Service Pack 2 setup. Therefore, customers who have .NET Framework 3.5 Service Pack 1 installed need to install security updates for .NET Framework 2.0 Service Pack 2. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle website. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Service Pack Lifecycle Support Policy. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information website, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the February bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected Software.NET Framework Unmanaged Objects Vulnerability - CVE-2012-0014.NET Framework Heap Corruption Vulnerability - CVE-2012-0015Aggregate Severity RatingMicrosoft .NET Framework 2.0 Service Pack 2Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows XP Service Pack 3**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows XP Professional x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 when installed on Windows Server 2003 with SP2 for Itanium-based Systems**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista x64 Edition Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for 32-bit Systems Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for x64-based Systems Service Pack 2**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 with SP2 for Itanium-based Systems**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems and Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems Service Pack 1\\***Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1**Critical** Remote Code Execution**Critical** Remote Code Execution**Critical**Microsoft .NET Framework 4Microsoft .NET Framework 4 when installed on Windows XP Service Pack 3[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2003 with SP2 for Itanium-based Systems[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems Service Pack 1\\*[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1[1]**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft Silverlight 4Microsoft Silverlight 4 when installed on Mac**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft Silverlight 4 when installed on all releases of Microsoft Windows clients**Critical** Remote Code ExecutionNot applicable**Critical**Microsoft Silverlight 4 when installed on all releases of Microsoft Windows servers\\*\\***Critical** Remote Code ExecutionNot applicable**Critical** **\\*Server Core installation affected.** This update applies, with the same severity rating, to supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, whether or not installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, [Managing a Server Core Installation](http://technet.microsoft.com/en-us/library/ee441255(ws.10).aspx) and [Servicing a Server Core Installation](http://technet.microsoft.com/en-us/library/ff698994(ws.10).aspx). Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see [Compare Server Core Installation Options](http://www.microsoft.com/windowsserver2008/en/us/compare-core-installation.aspx). **Server Core installation not affected. The vulnerabilities addressed by this update do not affect supported editions of Windows Server 2008 or Windows Server 2008 R2 as indicated, when installed using the Server Core installation option. For more information on this installation option, see the TechNet articles, Managing a Server Core Installation and Servicing a Server Core Installation. Note that the Server Core installation option does not apply to certain editions of Windows Server 2008 and Windows Server 2008 R2; see Compare Server Core Installation Options. [1].NET Framework 4 and .NET Framework 4 Client Profile affected. The .NET Framework version 4 redistributable packages are available in two profiles: .NET Framework 4 and .NET Framework 4 Client Profile. .NET Framework 4 Client Profile is a subset of .NET Framework 4. The vulnerability addressed in this update affects both .NET Framework 4 and .NET Framework 4 Client Profile. For more information, see the MSDN article, Installing the .NET Framework. .NET Framework Unmanaged Objects Vulnerability - CVE-2012-0014 A remote code execution vulnerability exists in Microsoft .NET Framework and Silverlight that can allow a specially crafted Microsoft .NET Framework application to access memory in an unsafe manner. An attacker who successfully exploited this vulnerability could run arbitrary code in the security context of the logged-on user. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0014. Mitigating Factors for .NET Framework Unmanaged Objects Vulnerability - CVE-2012-0014 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web browsing attack scenario, an attacker could host a website that contains a web page that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes users to the attacker's website.By default, Internet Explorer on Windows Server 2003, Windows Server 2008, and Windows Server 2008 R2 runs in a restricted mode that is known as Enhanced Security Configuration. This mode mitigates this vulnerability only on Windows Server 2008 and Windows Server 2008 R2, and only in a web browsing attack scenario. See the FAQ section of this vulnerability for more information about Internet Explorer Enhanced Security Configuration.An attacker who successfully exploited this vulnerability could gain the same user rights as the local user or the user account of ASP.NET. Users or accounts that are configured to have fewer user rights on the system could be less impacted than users or accounts that operate with administrative user rights.In a web-hosting scenario, an attacker must have permission to upload arbitrary ASP.NET pages to a website and ASP.NET must be installed on that web server. In default configuration, an anonymous user cannot upload and run Microsoft .NET code on an Internet Information Server (IIS).By default, partial trust ASP.NET applications are not granted SocketPermission. As a consequence, in a server-side scenario, this vulnerability can not be exploited in ASP.NET applications with a trust level of medium or lower unless those applications are explicitly granted SocketPermission by the administrator. For more information about ASP.NET trust levels, see the MSDN article ASP.NET Trust Levels and Policy Files. Workarounds for .NET Framework Unmanaged Objects Vulnerability - CVE-2012-0014 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Disable XAML browser applications in Internet ExplorerTo help protect against this vulnerability, change your settings to prompt before running XAML browser applications (XBAPs) or to disable XBAPs in the Internet and Local intranet security zones as follows:In Internet Explorer, click the Tools menu and then select Internet Options.Click the Security tab, click Internet, and then click Custom level. Under Settings, for Loose XAML, click Prompt or Disable, and then click OK.Click the Security tab, click Internet, and then click Custom level. Under Settings, for XAML browser applications, click Prompt or Disable, and then click OK.Click the Security tab, click Internet, and then click Custom level. Under Settings, for XPS documents, click Prompt or Disable, and then click OK.On the Security tab, click Custom level. Under .NET Framework-reliant components, set Run components not signed with Authenticode to either Prompt or Disable, and then click OK. Repeat this step for Run components signed with Authenticode, and then click OK.Click Local intranet, and then click Custom Level. Repeat steps 3 and 4. If you are prompted to confirm that you want to change these settings, click Yes. Click OK to return to Internet Explorer.Impact of workaround. Microsoft .NET code will not run in Internet Explorer or will not run without prompting. Disabling Microsoft .NET applications and components in the Internet and Local intranet security zones may cause some websites to work incorrectly. If you have difficulty using a website after you change this setting and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.Add sites that you trust to the Internet Explorer Trusted sites zoneAfter you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted websites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.To do this, perform the following steps:In Internet Explorer, click Tools, click Internet Options, and then click the Security tab.In the Select a Web content zone to specify its current security settings box, click Trusted Sites, and then click Sites.If you want to add sites that do not require an encrypted channel, click to clear the Require server verification (https:) for all sites in this zone check box.In the Add this Web site to the zone box, type the URL of a site that you trust, and then click Add.Repeat these steps for each site that you want to add to the zone.Click OK two times to accept the changes and return to Internet Explorer.Note Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are *.windowsupdate.microsoft.com and *.update.microsoft.com. These are the sites that will host the update, and it requires an ActiveX Control to install the update.How to undo the workaround. Perform the following steps:In Internet Explorer, click the Tools menu, and then select Internet Options.Click the Security tab, click Reset all zones to default level, and then click OK.Temporarily prevent the Microsoft Silverlight ActiveX control from running in Internet Explorer (Method 1)You can help protect against these vulnerabilities by temporarily preventing attempts to instantiate the Silverlight ActiveX control in Internet Explorer by setting the kill bit for the control.Warning If you use Registry Editor incorrectly, you may cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that you can solve problems that result from using Registry Editor incorrectly. Use Registry Editor at your own risk.We recommend that you back up the registry before you edit it.Use the following text to create a .reg file that temporarily prevents attempts to instantiate the Silverlight ActiveX control in Internet Explorer. You can copy the following text, paste it into a text editor such as Notepad, and then save the file with the .reg file name extension. Run the .reg file on the vulnerable client.Windows Registry Editor Version 5.00[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{DFEAF541-F3E1-4C24-ACAC-99C30715084A}]\"Compatibility Flags\"=dword:00000400Close Internet Explorer and reopen it for the changes to take effect.For detailed steps about stopping a control from running in Internet Explorer, see Microsoft Knowledge Base Article 240797. Follow these steps and create a Compatibility Flags value in the registry to prevent the Silverlight ActiveX control from running in Internet Explorer.Impact of workaround. Applications and Web sites that require the Microsoft Silverlight ActiveX control may no longer function correctly. If you implement this workaround it would affect any Silverlight ActiveX control you have installed on your system.How to undo the workaround. Remove the registry keys added to temporarily prevent attempts to instantiate the Silverlight ActiveX control in Internet Explorer.Temporarily prevent the Microsoft Silverlight ActiveX control from running in Firefox or ChromeTo modify the registry key to disable Microsoft Silverlight, follow these steps:Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the \"Changing Keys And Values\" Help topic in Registry Editor (Regedit.exe) or view the \"Add and Delete Information in the Registry\" and \"Edit Registry Data\" Help topics in Regedt32.exe.Using the Interactive MethodClick Start, click Run, type Regedit in the Open box, and then click OK.Locate and then click the following registry subkey:HKEY_LOCAL_MACHINE\\SOFTWARE\\MozillaPlugins\\@Microsoft.com/NpCtrl,version=1.0Right click on @Microsoft.com/NpCtrl,version=1.0 and select Export. Save the file to disk.Delete the entire @Microsoft.com/NpCtrl,version=1.0 key.Quit the registry editor.Using a registry fileCreate a backup copy of the registry keys. A backup copy can be made using a managed deployment script with the following command:Regedit.exe /e SL_backup.reg HKEY_LOCAL_MACHINE\\SOFTWARE\\MozillaPlugins\\@Microsoft.com/NpCtrl,version=1.0Save the following to a file with a .REG extension (e.g. Disable_Silverlight.reg):Windows Registry Editor Version 5.00[-HKEY_LOCAL_MACHINE\\SOFTWARE\\MozillaPlugins\\@Microsoft.com/NpCtrl,version=1.0]Run the above registry script created in step 2 on the target system with the following command:Regedit /s Disable_Silverlight.regHow to undo the workaround.Using the Interactive MethodClick Start, click Run, type Regedit in the Open box, and then click OK.On the File menu, click Import.In Look in, select the drive, folder, or network computer and folder where the file you previously exported is located.Select the correct file name and then click Open.Using a Managed Deployment ScriptRestore the file backed up in Using a registry file Step 1, above, with the following command:Regedit /s SL_backup.reg FAQ for .NET Framework Unmanaged Objects Vulnerability - CVE-2012-0014 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability is caused when the Microsoft .NET Framework and Microsoft Silverlight improperly use unmanaged objects. What is Microsoft Silverlight?Microsoft Silverlight is a cross-browser, cross-platform implementation of the Microsoft .NET Framework for building media experiences and rich interactive applications for the web. For more information, see the official site of Microsoft Silverlight. What might an attacker use the vulnerability to do?In the web browsing scenario, an attacker who successfully exploited this vulnerability could obtain the same permissions as the currently logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. In the web hosting scenario, an attacker who successfully exploits this vulnerability could obtain the same permissions as the service account associated with the application pool identity of the application pool in which a Microsoft .NET application is running. Depending on application pool isolation configuration and permissions granted to the service account, an attacker might be able to take control over other application pools on the web server or be able to take complete control of the affected system. For more information about application pool identities and configuration, see the TechNet article, Configure Application Pool Identity. How could an attacker exploit the vulnerability?There are three attack scenarios possible for exploiting this vulnerability: a web browsing scenario, a web hosting scenario, and a Windows .NET application bypass of Code Access Security (CAS) restrictions. These scenarios are described as follows: Web browsing attack scenarioAn attacker could host a specially crafted website that contains a specially crafted XBAP (XAML browser application) that could exploit this vulnerability and then convince a user to view the website. The attacker could also take advantage of compromised websites and websites that accept or host user-provided content or advertisements. These websites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or in an Instant Messenger message that takes users to the attacker's website. It could also be possible to display specially crafted web content by using banner advertisements or by using other methods to deliver web content to affected systems.Web hosting attack scenarioIf a web hosting environment allows users to upload custom ASP.NET applications, an attacker could upload a malicious ASP.NET application that uses this vulnerability to break out of the sandbox used to prevent ASP.NET code from performing harmful actions on the server system.Windows .NET applications attack scenarioThis vulnerability could also be used by Windows .NET applications to bypass Code Access Security (CAS) restrictions. What is an XAML Browser Application (XBAP)?An XAML browser application (XBAP) combines features of both a web application and a rich-client application. Like web applications, XBAPs can be published to a web server and launched from Internet Explorer. Like rich-client applications, XBAPs can take advantage of the capabilities of Windows Presentation Foundation (WPF). For more information about XBAPs, see MSDN article, Windows Presentation Foundation XAML Browser Applications Overview. What are .NET Framework Code Access Security (CAS) Restrictions?The .NET Framework provides a security mechanism called code access security to help protect computer systems from malicious mobile code, to allow code from unknown origins to run with protection, and to help prevent trusted code from intentionally or accidentally compromising security. Code access security (CAS) enables code to be trusted to varying degrees depending on where the code originates and on other aspects of the code's identity. Code access security also enforces the varying levels of trust on code, which minimizes the amount of code that must be fully trusted in order to run. Using code access security can reduce the likelihood that your code will be misused by malicious or error-filled code. For more information on CAS, see the MSDN article, Code Access Security. What systems are primarily at risk from the vulnerability?There are three types of systems at risk from this vulnerability, described as follows: systems that are using the web browsing scenario, systems that are using the web hosting scenario, and systems that are using the Windows .NET applications scenario. Web browsing scenarioSuccessful exploitation of this vulnerability requires that a user is logged on and is visiting websites using a web browser capable of instantiating XBAPs. Therefore, any systems where a web browser is used frequently, such as workstations or terminal servers, are at the most risk from this vulnerability. Servers could be at more risk if administrators allow users to browse and read email on servers. However, best practices strongly discourage allowing this.Web hosting scenarioWeb hosting sites that allow users to upload custom ASP.NET applications are at increased risk.Windows .NET applicationsWorkstations and server that run untrusted Windows .NET applications are also at risk from this vulnerability. I am running Internet Explorer for Windows Server 2003, Windows Server 2008, or Windows Server 2008 R2. Does this mitigate this vulnerability?Yes. By default, Internet Explorer on Windows Server 2003, Windows Server 2008, and Windows Server 2008 R2 runs in a restricted mode that is known as Enhanced Security Configuration. Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted web content on a server. This is a mitigating factor for websites that you have not added to the Internet Explorer Trusted sites zone. What does the update do?The update addresses the vulnerability by correcting the manner in which the Microsoft .NET Framework and Microsoft Silverlight use unmanaged objects. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. .NET Framework Heap Corruption Vulnerability - CVE-2012-0015 A remote code execution vulnerability exists in Microsoft .NET Framework due to it improperly calculating a buffer length while processing specially crafted input. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0015. Mitigating Factors for .NET Framework Heap Corruption Vulnerability - CVE-2012-0015 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web browsing attack scenario, an attacker could host a website that contains a web page that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes users to the attacker's website.By default, Internet Explorer on Windows Server 2003, Windows Server 2008, and Windows Server 2008 R2 runs in a restricted mode that is known as Enhanced Security Configuration. This mode mitigates this vulnerability only on Windows Server 2008 and Windows Server 2008 R2, and only in a web browsing attack scenario. See the FAQ section of this vulnerability for more information about Internet Explorer Enhanced Security Configuration.In a web-hosting scenario, an attacker must have permission to upload arbitrary ASP.NET pages to a website and ASP.NET must be installed on that web server. In default configuration, an anonymous user cannot upload and run Microsoft .NET code on an Internet Information Server (IIS). Workarounds for .NET Framework Heap Corruption Vulnerability - CVE-2012-0015 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Disable XAML browser applications in Internet ExplorerTo help protect against this vulnerability, change your settings to prompt before running XAML browser applications (XBAPs) or to disable XBAPs in the Internet and Local intranet security zones as follows:In Internet Explorer, click the Tools menu and then select Internet Options.Click the Security tab, click Internet, and then click Custom level. Under Settings, for Loose XAML, click Prompt or Disable, and then click OK.Click the Security tab, click Internet, and then click Custom level. Under Settings, for XAML browser applications, click Prompt or Disable, and then click OK.Click the Security tab, click Internet, and then click Custom level. Under Settings, for XPS documents, click Prompt or Disable, and then click OK.On the Security tab, click Custom level. Under .NET Framework-reliant components, set Run components not signed with Authenticode to either Prompt or Disable, and then click OK. Repeat this step for Run components signed with Authenticode, and then click OK.Click Local intranet, and then click Custom Level. Repeat steps 3 and 4. If you are prompted to confirm that you want to change these settings, click Yes. Click OK to return to Internet Explorer.Impact of workaround. Microsoft .NET code will not run in Internet Explorer or will not run without prompting. Disabling Microsoft .NET applications and components in the Internet and Local intranet security zones may cause some websites to work incorrectly. If you have difficulty using a website after you change this setting and you are sure the site is safe to use, you can add that site to your list of trusted sites. This will allow the site to work correctly.Add sites that you trust to the Internet Explorer Trusted sites zoneAfter you set Internet Explorer to require a prompt before it runs ActiveX controls and Active Scripting in the Internet zone and in the Local intranet zone, you can add sites that you trust to the Internet Explorer Trusted sites zone. This will allow you to continue to use trusted websites exactly as you do today, while helping to protect you from this attack on untrusted sites. We recommend that you add only sites that you trust to the Trusted sites zone.To do this, perform the following steps:In Internet Explorer, click Tools, click Internet Options, and then click the Security tab.In the Select a Web content zone to specify its current security settings box, click Trusted Sites, and then click Sites.If you want to add sites that do not require an encrypted channel, click to clear the Require server verification (https:) for all sites in this zone check box.In the Add this Web site to the zone box, type the URL of a site that you trust, and then click Add.Repeat these steps for each site that you want to add to the zone.Click OK two times to accept the changes and return to Internet Explorer.Note Add any sites that you trust not to take malicious action on your system. Two in particular that you may want to add are *.windowsupdate.microsoft.com and *.update.microsoft.com. These are the sites that will host the update, and it requires an ActiveX Control to install the update.How to undo the workaround. Perform the following steps:In Internet Explorer, click the Tools menu, and then select Internet Options.Click the Security tab, click Reset all zones to default level, and then click OK. FAQ for .NET Framework Heap Corruption Vulnerability - CVE-2012-0015 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability is caused when the .NET Framework improperly calculates a buffer length while processing specially crafted input. What might an attacker use the vulnerability to do?In the web browsing scenario, an attacker who successfully exploited this vulnerability could obtain the same permissions as the currently logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. In the web hosting scenario, an attacker who successfully exploits this vulnerability could obtain the same permissions as the service account associated with the application pool identity of the application pool in which a Microsoft .NET application is running. Depending on application pool isolation configuration and permissions granted to the service account, an attacker might be able to take control over other application pools on the web server or be able to take complete control of the affected system. For more information about application pool identities and configuration, see the TechNet article, Configure Application Pool Identity. How could an attacker exploit the vulnerability?There are three attack scenarios possible for exploiting this vulnerability: a web browsing scenario, a web hosting scenario, and a Windows .NET application bypass of Code Access Security (CAS) restrictions scenario. These scenarios are described as follows: Web browsing attack scenarioAn attacker could host a specially crafted website that contains a specially crafted XBAP (XAML browser application) that could exploit this vulnerability and then convince a user to view the website. The attacker could also take advantage of compromised websites and websites that accept or host user-provided content or advertisements. These websites could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or in an Instant Messenger message that takes users to the attacker's website. It could also be possible to display specially crafted web content by using banner advertisements or by using other methods to deliver web content to affected systems.Web hosting attack scenarioIf a web hosting environment allows users to upload custom ASP.NET applications, an attacker could upload a malicious ASP.NET application that uses this vulnerability to break out of the sandbox used to prevent ASP.NET code from performing harmful actions on the server system.Windows .NET applications attack scenarioThis vulnerability could also be used by Windows .NET applications to bypass Code Access Security (CAS) restrictions. What is an XAML Browser Application (XBAP)?An XAML browser application (XBAP) combines features of both a web application and a rich-client application. Like web applications, XBAPs can be published to a web server and launched from Internet Explorer. Like rich-client applications, XBAPs can take advantage of the capabilities of Windows Presentation Foundation (WPF). For more information about XBAPs, see MSDN article, Windows Presentation Foundation XAML Browser Applications Overview. What are .NET Framework Code Access Security (CAS) Restrictions?The .NET Framework provides a security mechanism called code access security to help protect computer systems from malicious mobile code, to allow code from unknown origins to run with protection, and to help prevent trusted code from intentionally or accidentally compromising security. Code access security (CAS) enables code to be trusted to varying degrees depending on where the code originates and on other aspects of the code's identity. Code access security also enforces the varying levels of trust on code, which minimizes the amount of code that must be fully trusted in order to run. Using code access security can reduce the likelihood that your code will be misused by malicious or error-filled code. For more information on CAS, see the MSDN article, Code Access Security. What systems are primarily at risk from the vulnerability?There are three types of systems at risk from this vulnerability, described as follows: systems that are using the web browsing scenario, systems that are using the web hosting scenario, and systems that are using the Windows .NET applications scenario. Web browsing scenarioSuccessful exploitation of this vulnerability requires that a user is logged on and is visiting websites using a web browser capable of instantiating XBAPs. Therefore, any systems where a web browser is used frequently, such as workstations or terminal servers, are at the most risk from this vulnerability. Servers could be at more risk if administrators allow users to browse and read email on servers. However, best practices strongly discourage allowing this.Web hosting scenarioWeb hosting sites that allow users to upload custom ASP.NET applications are at increased risk.Windows .NET applicationsWorkstations and server that run untrusted Windows .NET applications are also at risk from this vulnerability. I am running Internet Explorer for Windows Server 2003, Windows Server 2008, or Windows Server 2008 R2. Does this mitigate this vulnerability?Yes. By default, Internet Explorer on Windows Server 2003, Windows Server 2008, and Windows Server 2008 R2 runs in a restricted mode that is known as Enhanced Security Configuration. Enhanced Security Configuration is a group of preconfigured settings in Internet Explorer that can reduce the likelihood of a user or administrator downloading and running specially crafted web content on a server. This is a mitigating factor for websites that you have not added to the Internet Explorer Trusted sites zone. What does the update do?The update addresses the vulnerability by correcting the manner in which the Microsoft .NET Framework calculates buffer lengths. When this security bulletin was issued, had this vulnerability been publicly disclosed?Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number CVE-2012-0015. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Does applying this security update help protect customers from the code, published publicly, that could attempt to exploit this vulnerability?Yes. This security update addresses the vulnerability that potentially could be exploited by using the published proof of concept code. The vulnerability that has been addressed has been assigned Common Vulnerability and Exposure number CVE-2012-0015. Update Information Detection and Deployment Tools and Guidance Security Central Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security website provides additional information about security in Microsoft products. Security updates are available from Microsoft Update and Windows Update. Security updates are also available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" Finally, security updates can be downloaded from the Microsoft Update Catalog. The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the Microsoft Update Catalog FAQ. Detection and Deployment Guidance Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see Microsoft Knowledge Base Article 961747. Microsoft Baseline Security Analyzer Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit Microsoft Baseline Security Analyzer. The following table provides the MBSA detection summary for this security update. SoftwareMBSAWindows XP Service Pack 3YesWindows XP Professional x64 Edition Service Pack 2YesWindows Server 2003 Service Pack 2YesWindows Server 2003 x64 Edition Service Pack 2YesWindows Server 2003 with SP2 for Itanium-based SystemsYesWindows Vista Service Pack 2YesWindows Vista x64 Edition Service Pack 2YesWindows Server 2008 for 32-bit Systems Service Pack 2YesWindows Server 2008 for x64-based Systems Service Pack 2YesWindows Server 2008 for Itanium-based Systems Service Pack 2YesWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1YesWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1YesWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1YesWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1YesMicrosoft Silverlight 4 when installed on MacNoMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows clientsYesMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows serversYes Note For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit Microsoft Baseline Security Analyzer and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. Windows Server Update Services Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, Windows Server Update Services. Systems Management Server The following table provides the SMS detection and deployment summary for this security update. SoftwareSMS 2003 with ITMUConfiguration Manager 2007Windows XP Service Pack 3YesYesWindows XP Professional x64 Edition Service Pack 2YesYesWindows Server 2003 Service Pack 2YesYesWindows Server 2003 x64 Edition Service Pack 2YesYesWindows Server 2003 with SP2 for Itanium-based SystemsYesYesWindows Vista Service Pack 2YesYesWindows Vista x64 Edition Service Pack 2YesYesWindows Server 2008 for 32-bit Systems Service Pack 2YesYesWindows Server 2008 for x64-based Systems Service Pack 2YesYesWindows Server 2008 for Itanium-based Systems Service Pack 2YesYesWindows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1YesYesWindows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1YesYesWindows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1YesYesWindows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1YesYesMicrosoft Silverlight 4 when installed on MacNoNoMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows clientsYesYesMicrosoft Silverlight 4 when installed on all releases of Microsoft Windows serversYesYes Note Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to System Center Configuration Manager 2007. For customers remaining on SMS 2003 Service Pack 3, the Inventory Tool for Microsoft Updates (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by Microsoft Update and that are supported by Windows Server Update Services. For more information about the SMS 2003 ITMU, see SMS 2003 Inventory Tool for Microsoft Updates. For more information about SMS scanning tools, see SMS 2003 Software Update Scanning Tools. See also Downloads for Systems Management Server 2003. System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit System Center Configuration Manager 2007. For more information about SMS, visit the SMS website. For more detailed information, see Microsoft Knowledge Base Article 910723: Summary list of monthly detection and deployment guidance articles. Update Compatibility Evaluator and Application Compatibility Toolkit Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the Update Compatibility Evaluator components included with Application Compatibility Toolkit. The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Windows XP (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Service Pack 3:NDP20SP2-KB2633880-x86.exe /qFor Microsoft .NET Framework 4 when installed on Windows XP Service Pack 3:NDP40-KB2633870-x86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Professional Edition x64 Edition Service Pack 2:NDP20SP2-KB2633880-x64.exe /qFor Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2:NDP40-KB2633870-x64.exe /qInstalling without restartingFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Service Pack 3:NDP20SP2-KB2633880-x86.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows XP Service Pack 3:NDP40-KB2633870-x86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows XP Professional Edition x64 Edition Service Pack 2:NDP20SP2-KB2633880-x64.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2:NDP40-KB2633870-x64.exe /norestartUpdate log fileFor Microsoft .NET Framework 2.0 Service Pack 2:Microsoft .NET Framework 2.0-KB2633880_*-msi0.txtMicrosoft .NET Framework 2.0-KB2633880_*.htmlFor Microsoft .NET Framework 4:KB2633870_*_*-Microsoft .NET Framework 4 Client Profile-MSP0.txtKB2633870_*_*.htmlFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationFor all supported versions of Microsoft .NET Framework, use the Add or Remove Programs item in Control Panel.File InformationSee Microsoft Knowledge Base Article 2651026Registry Key VerificationFor Microsoft .NET Framework 2.0 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Microsoft .NET Framework 2.0 Service Pack 2\\SP2\\KB2633880\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 on Windows XP Service Pack 3:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows XP Professional x64 Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\" Note The update for supported versions of Windows XP Professional x64 Edition also applies to supported versions of Windows Server 2003 x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Removing the Update** This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Server 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2003 Service Pack 2:NDP20SP2-KB2633880-x86.exe /qFor Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2:NDP40-KB2633870-x86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2003 x64 Edition Service Pack 2:NDP20SP2-KB2633880-x64.exe /q For Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP40-KB2633870-x64.exe /q For Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2003 with SP2 for Itanium-based Systems:NDP20SP2-KB2633880-ia64.exe /qFor Microsoft .NET Framework 4 when installed on Windows Server 2003 with SP2 for Itanium-based Systems:NDP40-KB2633870-ia64.exe /qInstalling without restartingFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2003 Service Pack 2:NDP20SP2-KB2633880-x86.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2:NDP40-KB2633870-x86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2003 x64 Edition Service Pack 2:NDP20SP2-KB2633880-x64.exe /norestart For Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2:NDP40-KB2633870-x64.exe /norestart For Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2003 with SP2 for Itanium-based Systems:NDP20SP2-KB2633880-ia64.exe /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2003 with SP2 for Itanium-based Systems:NDP40-KB2633870-ia64.exe /norestartUpdate log fileFor Microsoft .NET Framework 2.0 Service Pack 2:Microsoft .NET Framework 2.0-KB2633880_*-msi0.txtMicrosoft .NET Framework 2.0-KB2633880_*.htmlFor Microsoft .NET Framework 4:KB2633870_*_*-Microsoft .NET Framework 4 Client Profile-MSP0.txtKB2633870_*_*.htmlFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingThis security update does not support HotPatching. For more information about HotPatching, see Microsoft Knowledge Base Article 897341.Removal InformationFor all supported versions of Microsoft .NET Framework, use the Add or Remove Programs item in Control Panel.File InformationSee Microsoft Knowledge Base Article 2651026Registry Key VerificationFor Microsoft .NET Framework 2.0 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Microsoft .NET Framework 2.0 Service Pack 2\\SP2\\KB2633880\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Server 2003 Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Server 2003 x64 Edition Service Pack 2 and Windows Server 2003 Itanium-based Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\" Note The update for supported versions of Windows Server 2003 x64 Edition also applies to supported versions of Windows XP Professional x64 Edition. Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. If you have previously installed a hotfix to update one of these files, the installer copies the RTMQFE, SP1QFE, or SP2QFE files to your system. Otherwise, the installer copies the RTMGDR, SP1GDR, or SP2GDR files to your system. Security updates may not contain all variations of these files. For more information about this behavior, see Microsoft Knowledge Base Article 824994. For more information about the installer, see Microsoft Knowledge Base Article 832475. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Removing the Update** This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2 and Microsoft .NET Framework 4. Supported SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying that the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start, and then click Search.In the Search Results pane, click All files and folders under Search Companion.In the All or part of the file name box, type a file name from the appropriate file information table, and then click Search.In the list of files, right-click a file name from the appropriate file information table, and then click Properties.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.On the Version tab, determine the version of the file that is installed on your system by comparing it to the version that is documented in the appropriate file information table.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Registry Key VerificationYou may also be able to verify the files that this security update has installed by reviewing the registry keys listed in the Reference Table in this section.These registry keys may not contain a complete list of installed files. Also, these registry keys may not be created correctly when an administrator or an OEM integrates or slipstreams this security update into the Windows installation source files. Windows Vista (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista Service Pack 2:Windows6.0-KB2633874-x86.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2:NDP40-KB2633870-x86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista x64 Edition Service Pack 2:Windows6.0-KB2633874-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2:NDP40-KB2633870-x64.exe /qInstalling without restartingFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista Service Pack 2:Windows6.0-KB2633874-x86.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2:NDP40-KB2633870-x86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Vista x64 Edition Service Pack 2:Windows6.0-KB2633874-x64.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2:NDP40-KB2633870-x64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2651026Registry Key VerificationFor Microsoft .NET Framework 2.0 Service Pack 2:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows Vista Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Vista x64 Edition Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 2.0 Service Pack 2 This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2. SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Installing the Update for Microsoft .NET Framework 4 This security update supports the following setup switches for Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and then click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 2.0 Service Pack 2 Windows Server 2008 for 32-bit Systems Service Pack 2:Windows6.0-KB2633874-x86.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:NDP40-KB2633870-x86.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for x64-based Systems Service Pack 2:Windows6.0-KB2633874-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2:NDP40-KB2633870-x64.exe /qFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 with SP2 for Itanium-based Systems:Windows6.0-KB2633874-ia64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2:NDP40-KB2633870-ia64.exe /qInstalling without restartingFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for 32-bit Systems Service Pack 2:Windows6.0-KB2633874-x86.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:NDP40-KB2633870-x86.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 for x64-based Systems Service Pack 2:Windows6.0-KB2633874-x64.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2:NDP40-KB2633870-x64.exe /norestartFor Microsoft .NET Framework 2.0 Service Pack 2 on Windows Server 2008 with SP2 for Itanium-based Systems:Windows6.0-KB2633874-ia64.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 for Itanium-based Systems Service Pack 2:NDP40-KB2633870-ia64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2651026Registry Key VerificationFor Microsoft .NET Framework 2.0 Service Pack 2:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows Server 2008 for 32-bit Systems Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows Server 2008 for x64-based Systems Service Pack 2 and Windows Server 2008 for Itanium-based Systems Service Pack 2:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 2.0 Service Pack 2 This security update supports the following setup switches for Microsoft .NET Framework 2.0 Service Pack 2. SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation. Installing the Update for Microsoft .NET Framework 4 This security update supports the following setup switches for Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and then click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows 7 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems:Windows6.1-KB2633879-x86.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems Service Pack 1:Windows6.1-KB2633873-x86.msu /quietFor Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1:NDP40-KB2633870-x86.exe /qFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems:Windows6.1-KB2633879-x64.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems Service Pack 1:Windows6.1-KB2633873-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1:NDP40-KB2633870-x64.exe /qInstalling without restartingFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems:Windows6.1-KB2633879-x86.msu /quiet /norestartFor Microsoft .NET Framework 3.5.1 on Windows 7 for 32-bit Systems Service Pack 1:Windows6.1-KB2633873-x86.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1:NDP40-KB2633870-x86.exe /norestartFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems:Windows6.1-KB2633879-x64.msu /quiet /norestartFor Microsoft .NET Framework 3.5.1 on Windows 7 for x64-based Systems Service Pack 1:Windows6.1-KB2633873-x64.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1:NDP40-KB2633870-x64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2651026Registry Key VerificationFor Microsoft .NET Framework 3.5.1 on Windows 7:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows 7 for 32-bit Systems and Windows 7 for 32-bit Systems Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\"For Microsoft .NET Framework 4 when installed on Windows 7 for x64-based Systems and Windows 7 for x64-based Systems Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 3.5.1 This security update supports the following setup switches for Microsoft .NET Framework 3.5.1. SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Installing the Update for Microsoft .NET Framework 4 This security update supports the following setup switches for Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That** **the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Search box.When the file appears under Programs, right-click the file name and then click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Windows Server 2008 R2 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeployment Installing without user interventionFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems:Windows6.1-KB2633879-x64.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems Service Pack 1:Windows6.1-KB2633873-x64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1:NDP40-KB2633870-x64.exe /quietFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems:Windows6.1-KB2633879-ia64.msu /quietFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:Windows6.1-KB2633873-ia64.msu /quietFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:NDP40-KB2633870-ia64.exe /quietInstalling without restartingFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems:Windows6.1-KB2633879-x64.msu /quiet /norestartFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for x64-based Systems Service Pack 1:Windows6.1-KB2633873-x64.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1:NDP40-KB2633870-x64.exe /norestartFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems:Windows6.1-KB2633879-ia64.msu /quiet /norestartFor Microsoft .NET Framework 3.5.1 on Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:Windows6.1-KB2633873-ia64.msu /quiet /norestartFor Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for Itanium-based Systems and Windows Server 2008 R2 for Itanium-based Systems Service Pack 1:NDP40-KB2633870-ia64.exe /norestartFurther informationSee the subsection, Detection and Deployment Tools and GuidanceRestart Requirement Restart required?This update does not require a restart. The installer stops the required services, applies the update, and then restarts the services. However, if the required services cannot be stopped for any reason, or if required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.HotPatchingNot applicable.Removal InformationTo uninstall an update installed by WUSA, click Control Panel, and then click Security. Under Windows Update, click View installed updates and select from the list of updates.File InformationSee Microsoft Knowledge Base Article 2651026Registry Key VerificationFor Microsoft .NET Framework 3.5.1:A registry key does not exist to validate the presence of this update.For Microsoft .NET Framework 4 when installed on Windows Server 2008 R2 for x64-based Systems and Windows Server 2008 R2 for x64-based Systems Service Pack 1:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\Microsoft .NET Framework 4 Client Profile\\KB2633870\"ThisVersionInstalled\" = \"Y\" Deployment Information Installing the Update When you install this security update, the installer checks whether one or more of the files that are being updated on your system have previously been updated by a Microsoft hotfix. For more information about the terminology that appears in this bulletin, such as hotfix, see Microsoft Knowledge Base Article 824684. Installing the Update for Microsoft .NET Framework 3.5.1 This security update supports the following setup switches for Microsoft .NET Framework 3.5.1. SwitchDescription/?, /h, /helpDisplays help on supported switches./quietSuppresses the display of status or error messages./norestartWhen combined with /quiet, the system will not be restarted after installation even if a restart is required to complete installation./warnrestart:<seconds>When combined with /quiet, the installer will warn the user before initiating restart./promptrestartWhen combined with /quiet, the installer will prompt before initiating restart./forcerestartWhen combined with /quiet, the installer will forcefully close applications and initiate restart./log:<file name>Enables logging to specified file./extract:<destination>Extracts the package contents to the destination folder./uninstall /kb:<KB Number>Uninstalls the security update. Note For more information about the wusa.exe installer, see \"Windows Update Stand-alone Installer\" in the TechNet article, Miscellaneous Changes in Windows 7. Installing the Update for Microsoft .NET Framework 4 This security update supports the following setup switches for Microsoft .NET Framework 4. Supported Security Update Installation SwitchesSwitchDescription**/? /h /help**Displays usage dialog box.Setup Modes**/q\\[n|b|r|f\\]**Sets user interface leveln - No UIb - Basic UIr - Reduced UIf - Full UI (default)Install Options**/extract \\[directory\\]**Extract the package to the specified directory.Restart Options**/norestart**Does not restart when installation has completed.**/forcerestart**Always restarts the computer after installation.**/promptrestart**Prompts the user to restart if necessary.Logging Options**/l\\[i|w|e|a|r|u|c|m|o|p|v|x| + |!|\\*\\] <LogFile>**Sets logging optionsi – status messagesw – non-fatal warningse – all error messagesa – start up of actionsr – action-specific recordsu – user requestc – initial UI parametersm – out-of-memory or fatal exit informationo – out-of-disk-space messagesp – terminal propertiesv – verbose outputx – extra debugging information+ – append to existing log file! – flush each line to the log\\* – log all information, except for v and x options**/log <LogFile>**Equivalent of /l\\* <LogFile> **Verifying That the Update Has Been Applied** Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and then click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Jeroen Frijters of Sumatra for reporting the .NET Framework Unmanaged Objects Vulnerability (CVE-2012-0014) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections websites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support Customers in the U.S. and Canada can receive technical support from Security Support or 1-866-PCSAFETY. There is no charge for support calls that are associated with security updates. For more information about available support options, see Microsoft Help and Support.International customers can receive support from their local Microsoft subsidiaries. There is no charge for support that is associated with security updates. For more information about how to contact Microsoft for support issues, visit the International Support website. Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (February 14, 2012): Bulletin published.V1.1 (February 14, 2012): Added an entry to the update FAQ to announce a detection change for KB2668562 for Microsoft Silverlight 4 when installed on Windows clients and servers to correct an installation issue. This is a detection change only. There were no changes to the security update files. Customers who have already successfully updated their systems do not need to take any action.V1.2 (February 15, 2012): Removed erroneous reference to known issues from the Executive Summary.V1.3 (July 10, 2012): Microsoft revised this bulletin to communicate a minor detection change for KB2633880 for Microsoft .NET Framework 2.0 Service Pack 2 to correct an offering issue. There were no changes to the security update files. Customers who have already successfully updated their systems do not need to take any action. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2012-0141": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-030",
        "title": "Vulnerabilities in Microsoft Office Could Allow Remote Code Execution (2663830)",
        "body": "",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Microsoft Office Microsoft Office Suite and Other SoftwareComponentMaximum Security ImpactAggregate Severity RatingUpdates ReplacedMicrosoft Office Suites and ComponentsMicrosoft Office 2003 Service Pack 3[Microsoft Excel 2003 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=162901b1-4c1d-476f-99e9-218780897f92) (KB2597086)Remote Code ExecutionImportantKB2596954 in [MS11-096](http://go.microsoft.com/fwlink/?linkid=232696) replaced by KB2597086Microsoft Office 2007 Service Pack 2[Microsoft Excel 2007 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=22b9b3a6-ad09-4397-892c-2190a86baf3e)[1](KB2597161)Remote Code ExecutionImportantKB2553073 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597161[Microsoft Office 2007 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=6ff6650c-eaf4-4c7d-986c-c4d9e5324dac) (KB2597969)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2007 Service Pack 3[Microsoft Excel 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=22b9b3a6-ad09-4397-892c-2190a86baf3e)[1](KB2597161)Remote Code ExecutionImportantNone[Microsoft Office 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=6ff6650c-eaf4-4c7d-986c-c4d9e5324dac) (KB2597969)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 (32-bit editions)[Microsoft Excel 2010 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=f537f6d0-be63-42af-8b39-fa6f38715f84) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=2e1060fa-c43d-42df-be5f-f536d9b39ba4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 Service Pack 1 (32-bit editions)[Microsoft Excel 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=f537f6d0-be63-42af-8b39-fa6f38715f84) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=2e1060fa-c43d-42df-be5f-f536d9b39ba4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 (64-bit editions)[Microsoft Excel 2010 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=123b96d9-de3f-4aab-bcf8-bf9089fef400) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=ec4371f6-644d-430d-880f-12425f1b36d4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 Service Pack 1 (64-bit editions)[Microsoft Excel 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=123b96d9-de3f-4aab-bcf8-bf9089fef400) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=ec4371f6-644d-430d-880f-12425f1b36d4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office for Mac[Microsoft Office 2008 for Mac](https://www.microsoft.com/download/details.aspx?familyid=8f85fc23-480e-4835-9ce5-0aa56702ef59) (KB2665346)Not applicableRemote Code ExecutionImportantKB2644354 in [MS11-094](http://go.microsoft.com/fwlink/?linkid=232493) replaced by KB2665346[Microsoft Office for Mac 2011](https://www.microsoft.com/download/details.aspx?familyid=5d88d3d4-89bd-44c3-9e5a-657998223e2f) (KB2665351)Not applicableRemote Code ExecutionImportantKB2644347 in [MS11-089](http://go.microsoft.com/fwlink/?linkid=225739) replaced by KB2665351Other Microsoft Office Software[Microsoft Excel Viewer](https://www.microsoft.com/download/details.aspx?familyid=9dedfb18-a651-49f7-b1fc-78f7b6cb234a)[2](KB2596842)Not applicableRemote Code ExecutionImportantKB2553075 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2596842[Microsoft Office Compatibility Pack Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=a8386ad9-635f-45a7-b33e-ac9a3ca55f82) (KB2597162)Not applicableRemote Code ExecutionImportantKB2553074 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597162[Microsoft Office Compatibility Pack Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=a8386ad9-635f-45a7-b33e-ac9a3ca55f82) (KB2597162)Not applicableRemote Code ExecutionImportantKB2553074 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597162 [1] For Microsoft Excel 2007, in addition to security update package KB2597161, customers also need to install the security update for the Microsoft Office Compatibility Pack (KB2597162) to be protected from the vulnerabilities described in this bulletin. [2]Microsoft Excel Viewer must be updated to a supported service pack level (Excel Viewer 2007 Service Pack 2 or Excel Viewer 2007 Service Pack 3) before installing this update. For information about supported Office viewers, see Microsoft Knowledge Base Article 979860. Non-Affected Software Office and Other SoftwareMicrosoft SharePoint Server 2010 and Microsoft SharePoint Server 2010 Service Pack 1Microsoft Office Web Application Companions (WAC)Open XML File Format Converter for MacMicrosoft Visio 2010 and Microsoft Visio 2010 Service Pack 1 (32-bit editions)Microsoft Visio 2010 and Microsoft Visio 2010 Service Pack 1 (64-bit editions)Microsoft Office Word ViewerMicrosoft Visio Viewer 2010 and Microsoft Visio Viewer 2010 Service Pack 1Microsoft Works 9 Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. How is this security update related to MS12-029?The security update packages for Microsoft Office 2008 for Mac (KB2665346) and Microsoft Office for Mac 2011 (KB2665351) offered in this bulletin also address the vulnerabilities described in the MS12-029 security bulletin. Why is this update only rated Important for all affected versions of Excel?Microsoft Excel 2002 and later versions have a built-in feature that prompts a user to Open, Save, or Cancel before opening a document. This mitigating factor reduces the vulnerabilities from Critical to Important because the vulnerabilities require more than a single user action to complete the exploit. The attack vector for the vulnerability is through Microsoft Excel. Why is this a Microsoft Office update?Although the attack vector for the vulnerabilities described in this bulletin is only through affected versions of Microsoft Excel, the vulnerable code is contained in a shared component of Microsoft Office. Other Microsoft Office software, including some supported releases of Microsoft Access, Microsoft Word, and Microsoft PowerPoint contain the vulnerable shared component of Microsoft Office, but because they do not access the vulnerable code, they are not affected by this vulnerability. However, since the vulnerable code is present, this update will be offered. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. Why are multiple package updates available for Microsoft Office 2007 Service Pack 2, Microsoft Office 2007 Service Pack 3, Microsoft Office 2010, and Microsoft Office 2010 Service Pack 1?The updates required to address the vulnerabilities described in this bulletin are offered across different package updates as indicated in the Affected Software table due to the componentized servicing model for Microsoft Office 2007 and Microsoft Office 2010. To be protected from the vulnerabilities, both updates are required, but they do not need to be installed in a particular order. What components of the Microsoft Office Compatibility Pack are updated by this bulletin?The update included with this security bulletin applies only to the Microsoft Excel component within the Microsoft Office Compatibility Pack. How areMicrosoft Office standalone programs affected by the vulnerabilities?A Microsoft Office standalone program is affected with the same severity rating as the corresponding component in a Microsoft Office Suite. For example, a standalone installation of Microsoft Excel is affected with the same severity rating as an installation of Microsoft Excel that was delivered with a Microsoft Office Suite. The Microsoft Office component discussed in this article is part of the Microsoft Office Suite that I have installed on my system; however, I did not choose to install this specific component. Will I be offered this update?Yes, if the component discussed in this bulletin was delivered with the version of the Microsoft Office Suite installed on your system, the system will be offered updates for it whether the component is installed or not. The detection logic used to scan for affected systems is designed to check for updates for all components that were delivered with the particular Microsoft Office Suite and to offer the updates to a system. Users who choose not to apply an update for a component that is not installed, but is delivered with their version of the Microsoft Office Suite, will not increase the security risk of that system. On the other hand, users who do choose to install the update will not have a negative impact on the security or performance of a system. Does the offer to update a non-vulnerable version of Microsoft Office constitute an issue in the Microsoft update mechanism?No, the update mechanism is functioning correctly in that it detects a lower version of the files on the system than in the update package and thus, offers the update. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle website. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Service Pack Lifecycle Support Policy. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information website, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the May bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcel File Format Memory Corruption Vulnerability - CVE-2012-0141Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847Aggregate Severity RatingMicrosoft Office Suites and ComponentsMicrosoft Excel 2003 Service Pack 3**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Microsoft Excel 2007 Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2007 Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2007 Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2007 Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 Service Pack 1 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 Service Pack 1 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 Service Pack 1 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 Service Pack 1 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office for MacMicrosoft Office 2008 for MacNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Microsoft Office for Mac 2011**Important** Remote Code ExecutionNot applicableNot applicable**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Other Microsoft Office SoftwareMicrosoft Excel Viewer**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office Compatibility Pack Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office Compatibility Pack Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important** Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0141. Mitigating Factors for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000 For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps: Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings. Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0142. Mitigating Factors for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office Software Registry Script Microsoft Excel 2003 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000001 Microsoft Excel 2007 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000001 For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office Software Registry Script Microsoft Excel 2003 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000000 Microsoft Excel 2007 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000000 For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0143. Mitigating Factors for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Impact of workaround. For Microsoft Office 2003, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions.How to undo the workaround.For Microsoft Office 2003, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number CVE-2012-0143. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0184. Mitigating Factors for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Set Office File Validation to disable the opening of files that fail validation in Excel 2003 and Excel 2007Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2003 and Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000000Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0185. Mitigating Factors for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Set Office File Validation to disable the opening of files that fail validation in Excel 2007Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000000Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-1847. Mitigating Factors for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Security Central Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security website provides additional information about security in Microsoft products. Security updates are available from Microsoft Update and Windows Update. Security updates are also available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" For customers of Microsoft Office for Mac, Microsoft AutoUpdate for Mac can help keep your Microsoft software up to date. For more information about using Microsoft AutoUpdate for Mac, see Check for software updates automatically. Finally, security updates can be downloaded from the Microsoft Update Catalog. The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the Microsoft Update Catalog FAQ. Detection and Deployment Guidance Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see Microsoft Knowledge Base Article 961747. Microsoft Baseline Security Analyzer Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit Microsoft Baseline Security Analyzer. The following table provides the MBSA detection summary for this security update. SoftwareMBSAMicrosoft Office 2003 Service Pack 3YesMicrosoft Office 2007 Service Pack 2 and Microsoft Excel 2007 Service Pack 3YesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (32-bit editions)YesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (64-bit editions)YesMicrosoft Office 2008 for MacNoMicrosoft Office for Mac 2011NoMicrosoft Excel ViewerYesMicrosoft Office Compatibility Pack Service Pack 2 and Microsoft Office Compatibility Pack Service Pack 3Yes Note For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit Microsoft Baseline Security Analyzer and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. Windows Server Update Services Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, Windows Server Update Services. Systems Management Server The following table provides the SMS detection and deployment summary for this security update. SoftwareSMS 2003 with ITMUConfiguration Manager 2007Microsoft Office 2003 Service Pack 3YesYesMicrosoft Office 2007 Service Pack 2 and Microsoft Excel 2007 Service Pack 3YesYesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (32-bit editions)YesYesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (64-bit editions)YesYesMicrosoft Office 2008 for MacNoNoMicrosoft Office for Mac 2011NoNoMicrosoft Excel ViewerYesYesMicrosoft Office Compatibility Pack Service Pack 2 and Microsoft Office Compatibility Pack Service Pack 3YesYes Note Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to System Center Configuration Manager 2007. For customers remaining on SMS 2003 Service Pack 3, the Inventory Tool for Microsoft Updates (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by Microsoft Update and that are supported by Windows Server Update Services. For more information about the SMS 2003 ITMU, see SMS 2003 Inventory Tool for Microsoft Updates. For more information about SMS scanning tools, see SMS 2003 Software Update Scanning Tools. See also Downloads for Systems Management Server 2003. System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit System Center Configuration Manager 2007. For more information about SMS, visit the SMS website. For more detailed information, see Microsoft Knowledge Base Article 910723: Summary list of monthly detection and deployment guidance articles. Note If you have used an Administrative Installation Point (AIP) for deploying Office XP or Office 2003, you may not be able to deploy the update using SMS if you have updated the AIP from the original baseline. For more information, see the Office Administrative Installation Point heading in this section. Office Administrative Installation Point If you installed your application from a server location, the server administrator must update the server location with the administrative update and deploy that update to your system. For supported versions of Microsoft Office XP, see Creating an Administrative Installation Point. For more information on how to change the source for a client system from an updated administrative installation point to an Office XP original baseline source, see Microsoft Knowledge Base Article 922665.Note If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article Updating Office XP Clients from a Patched Administrative Image.For supported versions of Microsoft Office 2003, see Creating an Administrative Installation Point. For more information on how to change the source for a client computer from an updated administrative installation point to an Office 2003 original baseline source or Service Pack 3 (SP3), see Microsoft Knowledge Base Article 902349.Note If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article, Distributing Office 2003 Product Updates.For creating a network installation point for supported versions of Microsoft Office, see Create a network installation point for Microsoft Office.Note If you plan to manage security updates centrally, use Windows Server Update Services. For more information about how to deploy security updates for Microsoft Office, visit the Windows Server Update Services website. Update Compatibility Evaluator and Application Compatibility Toolkit Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the Update Compatibility Evaluator components included with Application Compatibility Toolkit. The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Office 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the Deployment Information subsection below. Inclusion in Future Service PacksThere are no more service packs planned for this software. The update for this issue may be included in a future update rollup.DeploymentInstalling without user interventionOffice2003-kb2597086-fullfile-enu.exe /q:aInstalling without restartingOffice2003-kb2597086-fullfile-enu.exe /r:nUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance. For features you can selectively install, see the Office Features for Administrative Installations subsection in this section.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.Note When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771.File InformationSee Microsoft Knowledge Base Article 2597086Registry Key VerificationNot applicable #### Office Features The following table contains the list of feature names (case sensitive) that must be reinstalled for the update. To install all features, you can use **REINSTALL=ALL** or you can install the following features: | Product | Feature | |--------------------------------------------------------|---------| | STD11, BASIC11, PERS11, STDP11, PROI11, PRO11, PRO11SB | All | **Note** Administrators working in managed environments can find complete resources for deploying Office updates in an organization at the Office Admin Update Center. At that site, scroll down and look under the **Update Resources** section for the software version you are updating. The [Windows Installer Documentation](http://go.microsoft.com/fwlink/?linkid=21685) also provides more information about the parameters supported by Windows Installer. #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 2.0 or later version be installed on the system. All supported versions of Windows include Windows Installer 2.0 or a later version. To install the 2.0 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) - [Windows Installer 2.0 Redistributable for Microsoft Windows 2000 and Windows NT 4.0](http://go.microsoft.com/fwlink/?linkid=33338) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/qSpecifies quiet mode, or suppresses prompts, when files are being extracted./q:uSpecifies user-quiet mode, which presents some dialog boxes to the user./q:aSpecifies administrator-quiet mode, which does not present any dialog boxes to the user./t:pathSpecifies the target folder for extracting files./cExtracts the files without installing them. If /t:path is not specified, you are prompted for a target folder./c:pathOverrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./r:nNever restarts the system after installation./r:IPrompts the user to restart the system if a restart is required, except when used with /q:a./r:aAlways restarts the system after installation./r:sRestarts the system after installation without prompting the user./n:vNo version checking - Install the program over any earlier version. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2007 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft Excel 2007:excel2007-kb2597161-fullfile-x86-glb.exe /passiveFor Microsoft Office 2007:graph2007-kb2597969-fullfile-x86-glb.exe /passiveFor Microsoft Excel Viewer:xlview2007-kb2596842-fullfile-x86-glb.exe /passiveFor Microsoft Office Compatibility Pack:xlconv2007-kb2597162-fullfile-x86-glb.exe /passiveInstalling without restartingFor Microsoft Excel 2007:excel2007-kb2597161-fullfile-x86-glb.exe /norestartFor Microsoft Office 2007:graph2007-kb2597969-fullfile-x86-glb.exe /norestartFor Microsoft Excel Viewer:xlview2007-kb2596842-fullfile-x86-glb.exe /norestartFor Microsoft Office Compatibility Pack:xlconv2007-kb2597162-fullfile-x86-glb.exe /norestartUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.File InformationFor Microsoft Excel 2007, see Microsoft Knowledge Base Article 2597161For Microsoft Office 2007, see Microsoft Knowledge Base Article 2597969For Microsoft Excel Viewer, see Microsoft Knowledge Base Article 2596842For Microsoft Office Compatibility Pack, see Microsoft Knowledge Base Article 2597162Registry Key VerificationNot applicable #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 3.1 or later version be installed on the system. To install the 3.1 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/? or /helpDisplays usage dialog./passiveSpecifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel./quietSpecifies quiet mode, or suppresses prompts, when files are being extracted./norestartSuppresses restarting the system if the update requires a restart./forcerestartAutomatically restarts the system after applying the update, regardless of whether the update requires the restart./extractExtracts the files without installing them. You are prompted for a target folder./extract:<path>Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./lang:<LCID>Forces the use of a specific language, when the update package supports that language./log:<log file>Enables logging, by both Vnox and Installer, during the update installation. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the 2007 Microsoft Office CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2010 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft Excel 2010 (32-bit editions):excel2010-kb2597166-fullfile-x86-glb.exe /passiveFor Microsoft Office 2010 (32-bit editions):graph2010-kb2553371-fullfile-x86-glb.exe /passiveFor Microsoft Excel 2010 (64-bit editions):excel2010-kb2597166-fullfile-x64-glb.exe /passiveFor Microsoft Office 2010 (64-bit editions):graph2010-kb2553371-fullfile-x64-glb.exe /passiveInstalling without restartingFor Microsoft Excel 2010 (32-bit editions):excel2010-kb2597166-fullfile-x86-glb.exe /norestartFor Microsoft Office 2010 (32-bit editions):graph2010-kb2553371-fullfile-x86-glb.exe /norestartFor Microsoft Excel 2010 (64-bit editions):excel2010-kb2597166-fullfile-x64-glb.exe /norestartFor Microsoft Office 2010 (64-bit editions):graph2010-kb2553371-fullfile-x64-glb.exe /norestartUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.File InformationSee Microsoft Knowledge Base Article 2597166 and Microsoft Knowledge Base Article 2553371Registry Key VerificationNot applicable #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 3.1 or later version be installed on the system. To install the 3.1 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/? or /helpDisplays usage dialog./passiveSpecifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel./quietSpecifies quiet mode, or suppresses prompts, when files are being extracted./norestartSuppresses restarting the system if the update requires a restart./forcerestartAutomatically restarts the system after applying the update, regardless of whether the update requires the restart./extractExtracts the files without installing them. You are prompted for a target folder./extract:<path>Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./lang:<LCID>Forces the use of a specific language, when the update package supports that language./log:<log file>Enables logging, by both Vnox and Installer, during the update installation. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the 2007 Microsoft Office CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2008 for Mac Deployment Information Prerequisites Mac OS X version 10.4.9 or later version on an Intel, PowerPC G5, or PowerPC G4 (500 MHz or faster) processorMac OS X user accounts must have administrator privileges to install this security update Installing the Update Download and install the appropriate language version of the Microsoft Office 2008 for Mac 12.3.3 Update from the Microsoft Download Center. Quit any applications that are running, including virus-protection applications, all Microsoft Office applications, Microsoft Messenger for Mac, and Office Notifications, because they might interfere with installation.Open the Microsoft Office 2008 for Mac 12.3.3 Update volume on your desktop. This step might have been performed for you.To start the update process, in the Microsoft Office 2008 for Mac 12.3.3 Update volume window, double-click the Microsoft Office 2008 for Mac 12.3.3 Update application, and follow the instructions on the screen.If the installation finishes successfully, you can remove the update installer from your hard disk. To verify that the installation finished successfully, see the following \"Verifying Update Installation\" heading. To remove the update installer, first drag the Microsoft Office 2008 for Mac 12.3.3 Update volume to the Trash, and then drag the file that you downloaded to the Trash. Verifying Update Installation To verify that a security update is installed on an affected system, follow these steps: In the Finder, navigate to the Application Folder (Microsoft Office 2008: Office).Select the file, Microsoft Component Plugin.On the File menu, click Get Info or Show Info. If the Version number is 12.3.3, the update has been successfully installed. Restart Requirement This update does not require you to restart your computer. Removing the Update This security update cannot be uninstalled. Additional Information If you have technical questions or problems downloading or using this update, visit Microsoft for Mac Support to learn about the support options that are available to you. Office for Mac 2011 Deployment Information Prerequisites Mac OS X version 10.5.8 or later version on an Intel processorMac OS X user accounts must have administrator privileges to install this security update Installing the Update Download and install the appropriate language version of the Microsoft Office for Mac 2011 14.2.2 Update from the Microsoft Download Center. Quit any applications that are running, including virus-protection applications and all Microsoft Office applications, because they might interfere with installation.Open the Microsoft Office for Mac 2011 14.2.2 Update volume on your desktop. This step might have been performed for you.To start the update process, in the Microsoft Office for Mac 2011 14.2.2 Update volume window, double-click the Microsoft Office for Mac 2011 14.2.2 Update application, and follow the instructions on the screen.When the installation finishes successfully, you can remove the update installer from your hard disk. To verify that the installation finished successfully, see the following \"Verifying Update Installation\" heading. To remove the update installer, first drag the Microsoft Office for Mac 2011 14.2.2 Update volume to the Trash, and then drag the file that you downloaded to the Trash. Verifying Update Installation To verify that a security update is installed on an affected system, follow these steps: In the Finder, navigate to the Application Folder (Microsoft Office 2011).Select Word, Excel, PowerPoint or Outlook and launch the application.On the Application menu, click About Application_Name (where Application_Name is Word, Excel, PowerPoint or Outlook). If the Latest Installed Update Version number is 14.2.2, the update has been successfully installed. Restart Requirement This update does not require you to restart your computer. Removing the Update This security update cannot be uninstalled. Additional Information If you have technical questions or problems downloading or using this update, visit Microsoft for Mac Support to learn about the support options that are available to you. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Omair for reporting the Excel File Format Memory Corruption Vulnerability (CVE-2012-0141)Omair for reporting the Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability (CVE-2012-0142)Omair, working with VeriSign iDefense Labs, for reporting the Excel SXLI Record Memory Corruption Vulnerability (CVE-2012-0184)Sean Larsson and Jun Mao, working with VeriSign iDefense Labs, for reporting the Excel MergeCells Record Heap Overflow Vulnerability (CVE-2012-0185)Sean Larsson and Jun Mao, working with VeriSign iDefense Labs, for reporting the Excel Series Record Parsing Type Mismatch Vulnerability (CVE-2012-1847)An anonymous researcher, working with TippingPoint'sZero Day Initiative, for reporting the Excel Series Record Parsing Type Mismatch Vulnerability (CVE-2012-1847) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections websites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support How to obtain help and support for this security update Help installing updates: Support for Microsoft UpdateSecurity solutions for IT professionals: TechNet Security Troubleshooting and SupportHelp protect your computer that is running Windows from viruses and malware: Virus Solution and Security CenterLocal support according to your country: International Support Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (May 8, 2012): Bulletin published.V1.1 (May 9, 2012): Removed erroneous reference to known issues from the Executive Summary and updated the title of CVE-2012-1847. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2012-0142": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-030",
        "title": "Vulnerabilities in Microsoft Office Could Allow Remote Code Execution (2663830)",
        "body": "",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Microsoft Office Microsoft Office Suite and Other SoftwareComponentMaximum Security ImpactAggregate Severity RatingUpdates ReplacedMicrosoft Office Suites and ComponentsMicrosoft Office 2003 Service Pack 3[Microsoft Excel 2003 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=162901b1-4c1d-476f-99e9-218780897f92) (KB2597086)Remote Code ExecutionImportantKB2596954 in [MS11-096](http://go.microsoft.com/fwlink/?linkid=232696) replaced by KB2597086Microsoft Office 2007 Service Pack 2[Microsoft Excel 2007 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=22b9b3a6-ad09-4397-892c-2190a86baf3e)[1](KB2597161)Remote Code ExecutionImportantKB2553073 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597161[Microsoft Office 2007 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=6ff6650c-eaf4-4c7d-986c-c4d9e5324dac) (KB2597969)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2007 Service Pack 3[Microsoft Excel 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=22b9b3a6-ad09-4397-892c-2190a86baf3e)[1](KB2597161)Remote Code ExecutionImportantNone[Microsoft Office 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=6ff6650c-eaf4-4c7d-986c-c4d9e5324dac) (KB2597969)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 (32-bit editions)[Microsoft Excel 2010 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=f537f6d0-be63-42af-8b39-fa6f38715f84) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=2e1060fa-c43d-42df-be5f-f536d9b39ba4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 Service Pack 1 (32-bit editions)[Microsoft Excel 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=f537f6d0-be63-42af-8b39-fa6f38715f84) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=2e1060fa-c43d-42df-be5f-f536d9b39ba4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 (64-bit editions)[Microsoft Excel 2010 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=123b96d9-de3f-4aab-bcf8-bf9089fef400) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=ec4371f6-644d-430d-880f-12425f1b36d4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 Service Pack 1 (64-bit editions)[Microsoft Excel 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=123b96d9-de3f-4aab-bcf8-bf9089fef400) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=ec4371f6-644d-430d-880f-12425f1b36d4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office for Mac[Microsoft Office 2008 for Mac](https://www.microsoft.com/download/details.aspx?familyid=8f85fc23-480e-4835-9ce5-0aa56702ef59) (KB2665346)Not applicableRemote Code ExecutionImportantKB2644354 in [MS11-094](http://go.microsoft.com/fwlink/?linkid=232493) replaced by KB2665346[Microsoft Office for Mac 2011](https://www.microsoft.com/download/details.aspx?familyid=5d88d3d4-89bd-44c3-9e5a-657998223e2f) (KB2665351)Not applicableRemote Code ExecutionImportantKB2644347 in [MS11-089](http://go.microsoft.com/fwlink/?linkid=225739) replaced by KB2665351Other Microsoft Office Software[Microsoft Excel Viewer](https://www.microsoft.com/download/details.aspx?familyid=9dedfb18-a651-49f7-b1fc-78f7b6cb234a)[2](KB2596842)Not applicableRemote Code ExecutionImportantKB2553075 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2596842[Microsoft Office Compatibility Pack Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=a8386ad9-635f-45a7-b33e-ac9a3ca55f82) (KB2597162)Not applicableRemote Code ExecutionImportantKB2553074 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597162[Microsoft Office Compatibility Pack Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=a8386ad9-635f-45a7-b33e-ac9a3ca55f82) (KB2597162)Not applicableRemote Code ExecutionImportantKB2553074 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597162 [1] For Microsoft Excel 2007, in addition to security update package KB2597161, customers also need to install the security update for the Microsoft Office Compatibility Pack (KB2597162) to be protected from the vulnerabilities described in this bulletin. [2]Microsoft Excel Viewer must be updated to a supported service pack level (Excel Viewer 2007 Service Pack 2 or Excel Viewer 2007 Service Pack 3) before installing this update. For information about supported Office viewers, see Microsoft Knowledge Base Article 979860. Non-Affected Software Office and Other SoftwareMicrosoft SharePoint Server 2010 and Microsoft SharePoint Server 2010 Service Pack 1Microsoft Office Web Application Companions (WAC)Open XML File Format Converter for MacMicrosoft Visio 2010 and Microsoft Visio 2010 Service Pack 1 (32-bit editions)Microsoft Visio 2010 and Microsoft Visio 2010 Service Pack 1 (64-bit editions)Microsoft Office Word ViewerMicrosoft Visio Viewer 2010 and Microsoft Visio Viewer 2010 Service Pack 1Microsoft Works 9 Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. How is this security update related to MS12-029?The security update packages for Microsoft Office 2008 for Mac (KB2665346) and Microsoft Office for Mac 2011 (KB2665351) offered in this bulletin also address the vulnerabilities described in the MS12-029 security bulletin. Why is this update only rated Important for all affected versions of Excel?Microsoft Excel 2002 and later versions have a built-in feature that prompts a user to Open, Save, or Cancel before opening a document. This mitigating factor reduces the vulnerabilities from Critical to Important because the vulnerabilities require more than a single user action to complete the exploit. The attack vector for the vulnerability is through Microsoft Excel. Why is this a Microsoft Office update?Although the attack vector for the vulnerabilities described in this bulletin is only through affected versions of Microsoft Excel, the vulnerable code is contained in a shared component of Microsoft Office. Other Microsoft Office software, including some supported releases of Microsoft Access, Microsoft Word, and Microsoft PowerPoint contain the vulnerable shared component of Microsoft Office, but because they do not access the vulnerable code, they are not affected by this vulnerability. However, since the vulnerable code is present, this update will be offered. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. Why are multiple package updates available for Microsoft Office 2007 Service Pack 2, Microsoft Office 2007 Service Pack 3, Microsoft Office 2010, and Microsoft Office 2010 Service Pack 1?The updates required to address the vulnerabilities described in this bulletin are offered across different package updates as indicated in the Affected Software table due to the componentized servicing model for Microsoft Office 2007 and Microsoft Office 2010. To be protected from the vulnerabilities, both updates are required, but they do not need to be installed in a particular order. What components of the Microsoft Office Compatibility Pack are updated by this bulletin?The update included with this security bulletin applies only to the Microsoft Excel component within the Microsoft Office Compatibility Pack. How areMicrosoft Office standalone programs affected by the vulnerabilities?A Microsoft Office standalone program is affected with the same severity rating as the corresponding component in a Microsoft Office Suite. For example, a standalone installation of Microsoft Excel is affected with the same severity rating as an installation of Microsoft Excel that was delivered with a Microsoft Office Suite. The Microsoft Office component discussed in this article is part of the Microsoft Office Suite that I have installed on my system; however, I did not choose to install this specific component. Will I be offered this update?Yes, if the component discussed in this bulletin was delivered with the version of the Microsoft Office Suite installed on your system, the system will be offered updates for it whether the component is installed or not. The detection logic used to scan for affected systems is designed to check for updates for all components that were delivered with the particular Microsoft Office Suite and to offer the updates to a system. Users who choose not to apply an update for a component that is not installed, but is delivered with their version of the Microsoft Office Suite, will not increase the security risk of that system. On the other hand, users who do choose to install the update will not have a negative impact on the security or performance of a system. Does the offer to update a non-vulnerable version of Microsoft Office constitute an issue in the Microsoft update mechanism?No, the update mechanism is functioning correctly in that it detects a lower version of the files on the system than in the update package and thus, offers the update. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle website. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Service Pack Lifecycle Support Policy. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information website, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the May bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcel File Format Memory Corruption Vulnerability - CVE-2012-0141Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847Aggregate Severity RatingMicrosoft Office Suites and ComponentsMicrosoft Excel 2003 Service Pack 3**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Microsoft Excel 2007 Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2007 Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2007 Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2007 Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 Service Pack 1 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 Service Pack 1 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 Service Pack 1 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 Service Pack 1 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office for MacMicrosoft Office 2008 for MacNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Microsoft Office for Mac 2011**Important** Remote Code ExecutionNot applicableNot applicable**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Other Microsoft Office SoftwareMicrosoft Excel Viewer**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office Compatibility Pack Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office Compatibility Pack Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important** Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0141. Mitigating Factors for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000 For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps: Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings. Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0142. Mitigating Factors for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office Software Registry Script Microsoft Excel 2003 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000001 Microsoft Excel 2007 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000001 For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office Software Registry Script Microsoft Excel 2003 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000000 Microsoft Excel 2007 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000000 For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0143. Mitigating Factors for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Impact of workaround. For Microsoft Office 2003, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions.How to undo the workaround.For Microsoft Office 2003, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number CVE-2012-0143. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0184. Mitigating Factors for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Set Office File Validation to disable the opening of files that fail validation in Excel 2003 and Excel 2007Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2003 and Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000000Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0185. Mitigating Factors for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Set Office File Validation to disable the opening of files that fail validation in Excel 2007Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000000Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-1847. Mitigating Factors for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Security Central Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security website provides additional information about security in Microsoft products. Security updates are available from Microsoft Update and Windows Update. Security updates are also available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" For customers of Microsoft Office for Mac, Microsoft AutoUpdate for Mac can help keep your Microsoft software up to date. For more information about using Microsoft AutoUpdate for Mac, see Check for software updates automatically. Finally, security updates can be downloaded from the Microsoft Update Catalog. The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the Microsoft Update Catalog FAQ. Detection and Deployment Guidance Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see Microsoft Knowledge Base Article 961747. Microsoft Baseline Security Analyzer Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit Microsoft Baseline Security Analyzer. The following table provides the MBSA detection summary for this security update. SoftwareMBSAMicrosoft Office 2003 Service Pack 3YesMicrosoft Office 2007 Service Pack 2 and Microsoft Excel 2007 Service Pack 3YesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (32-bit editions)YesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (64-bit editions)YesMicrosoft Office 2008 for MacNoMicrosoft Office for Mac 2011NoMicrosoft Excel ViewerYesMicrosoft Office Compatibility Pack Service Pack 2 and Microsoft Office Compatibility Pack Service Pack 3Yes Note For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit Microsoft Baseline Security Analyzer and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. Windows Server Update Services Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, Windows Server Update Services. Systems Management Server The following table provides the SMS detection and deployment summary for this security update. SoftwareSMS 2003 with ITMUConfiguration Manager 2007Microsoft Office 2003 Service Pack 3YesYesMicrosoft Office 2007 Service Pack 2 and Microsoft Excel 2007 Service Pack 3YesYesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (32-bit editions)YesYesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (64-bit editions)YesYesMicrosoft Office 2008 for MacNoNoMicrosoft Office for Mac 2011NoNoMicrosoft Excel ViewerYesYesMicrosoft Office Compatibility Pack Service Pack 2 and Microsoft Office Compatibility Pack Service Pack 3YesYes Note Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to System Center Configuration Manager 2007. For customers remaining on SMS 2003 Service Pack 3, the Inventory Tool for Microsoft Updates (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by Microsoft Update and that are supported by Windows Server Update Services. For more information about the SMS 2003 ITMU, see SMS 2003 Inventory Tool for Microsoft Updates. For more information about SMS scanning tools, see SMS 2003 Software Update Scanning Tools. See also Downloads for Systems Management Server 2003. System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit System Center Configuration Manager 2007. For more information about SMS, visit the SMS website. For more detailed information, see Microsoft Knowledge Base Article 910723: Summary list of monthly detection and deployment guidance articles. Note If you have used an Administrative Installation Point (AIP) for deploying Office XP or Office 2003, you may not be able to deploy the update using SMS if you have updated the AIP from the original baseline. For more information, see the Office Administrative Installation Point heading in this section. Office Administrative Installation Point If you installed your application from a server location, the server administrator must update the server location with the administrative update and deploy that update to your system. For supported versions of Microsoft Office XP, see Creating an Administrative Installation Point. For more information on how to change the source for a client system from an updated administrative installation point to an Office XP original baseline source, see Microsoft Knowledge Base Article 922665.Note If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article Updating Office XP Clients from a Patched Administrative Image.For supported versions of Microsoft Office 2003, see Creating an Administrative Installation Point. For more information on how to change the source for a client computer from an updated administrative installation point to an Office 2003 original baseline source or Service Pack 3 (SP3), see Microsoft Knowledge Base Article 902349.Note If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article, Distributing Office 2003 Product Updates.For creating a network installation point for supported versions of Microsoft Office, see Create a network installation point for Microsoft Office.Note If you plan to manage security updates centrally, use Windows Server Update Services. For more information about how to deploy security updates for Microsoft Office, visit the Windows Server Update Services website. Update Compatibility Evaluator and Application Compatibility Toolkit Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the Update Compatibility Evaluator components included with Application Compatibility Toolkit. The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Office 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the Deployment Information subsection below. Inclusion in Future Service PacksThere are no more service packs planned for this software. The update for this issue may be included in a future update rollup.DeploymentInstalling without user interventionOffice2003-kb2597086-fullfile-enu.exe /q:aInstalling without restartingOffice2003-kb2597086-fullfile-enu.exe /r:nUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance. For features you can selectively install, see the Office Features for Administrative Installations subsection in this section.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.Note When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771.File InformationSee Microsoft Knowledge Base Article 2597086Registry Key VerificationNot applicable #### Office Features The following table contains the list of feature names (case sensitive) that must be reinstalled for the update. To install all features, you can use **REINSTALL=ALL** or you can install the following features: | Product | Feature | |--------------------------------------------------------|---------| | STD11, BASIC11, PERS11, STDP11, PROI11, PRO11, PRO11SB | All | **Note** Administrators working in managed environments can find complete resources for deploying Office updates in an organization at the Office Admin Update Center. At that site, scroll down and look under the **Update Resources** section for the software version you are updating. The [Windows Installer Documentation](http://go.microsoft.com/fwlink/?linkid=21685) also provides more information about the parameters supported by Windows Installer. #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 2.0 or later version be installed on the system. All supported versions of Windows include Windows Installer 2.0 or a later version. To install the 2.0 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) - [Windows Installer 2.0 Redistributable for Microsoft Windows 2000 and Windows NT 4.0](http://go.microsoft.com/fwlink/?linkid=33338) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/qSpecifies quiet mode, or suppresses prompts, when files are being extracted./q:uSpecifies user-quiet mode, which presents some dialog boxes to the user./q:aSpecifies administrator-quiet mode, which does not present any dialog boxes to the user./t:pathSpecifies the target folder for extracting files./cExtracts the files without installing them. If /t:path is not specified, you are prompted for a target folder./c:pathOverrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./r:nNever restarts the system after installation./r:IPrompts the user to restart the system if a restart is required, except when used with /q:a./r:aAlways restarts the system after installation./r:sRestarts the system after installation without prompting the user./n:vNo version checking - Install the program over any earlier version. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2007 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft Excel 2007:excel2007-kb2597161-fullfile-x86-glb.exe /passiveFor Microsoft Office 2007:graph2007-kb2597969-fullfile-x86-glb.exe /passiveFor Microsoft Excel Viewer:xlview2007-kb2596842-fullfile-x86-glb.exe /passiveFor Microsoft Office Compatibility Pack:xlconv2007-kb2597162-fullfile-x86-glb.exe /passiveInstalling without restartingFor Microsoft Excel 2007:excel2007-kb2597161-fullfile-x86-glb.exe /norestartFor Microsoft Office 2007:graph2007-kb2597969-fullfile-x86-glb.exe /norestartFor Microsoft Excel Viewer:xlview2007-kb2596842-fullfile-x86-glb.exe /norestartFor Microsoft Office Compatibility Pack:xlconv2007-kb2597162-fullfile-x86-glb.exe /norestartUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.File InformationFor Microsoft Excel 2007, see Microsoft Knowledge Base Article 2597161For Microsoft Office 2007, see Microsoft Knowledge Base Article 2597969For Microsoft Excel Viewer, see Microsoft Knowledge Base Article 2596842For Microsoft Office Compatibility Pack, see Microsoft Knowledge Base Article 2597162Registry Key VerificationNot applicable #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 3.1 or later version be installed on the system. To install the 3.1 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/? or /helpDisplays usage dialog./passiveSpecifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel./quietSpecifies quiet mode, or suppresses prompts, when files are being extracted./norestartSuppresses restarting the system if the update requires a restart./forcerestartAutomatically restarts the system after applying the update, regardless of whether the update requires the restart./extractExtracts the files without installing them. You are prompted for a target folder./extract:<path>Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./lang:<LCID>Forces the use of a specific language, when the update package supports that language./log:<log file>Enables logging, by both Vnox and Installer, during the update installation. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the 2007 Microsoft Office CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2010 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft Excel 2010 (32-bit editions):excel2010-kb2597166-fullfile-x86-glb.exe /passiveFor Microsoft Office 2010 (32-bit editions):graph2010-kb2553371-fullfile-x86-glb.exe /passiveFor Microsoft Excel 2010 (64-bit editions):excel2010-kb2597166-fullfile-x64-glb.exe /passiveFor Microsoft Office 2010 (64-bit editions):graph2010-kb2553371-fullfile-x64-glb.exe /passiveInstalling without restartingFor Microsoft Excel 2010 (32-bit editions):excel2010-kb2597166-fullfile-x86-glb.exe /norestartFor Microsoft Office 2010 (32-bit editions):graph2010-kb2553371-fullfile-x86-glb.exe /norestartFor Microsoft Excel 2010 (64-bit editions):excel2010-kb2597166-fullfile-x64-glb.exe /norestartFor Microsoft Office 2010 (64-bit editions):graph2010-kb2553371-fullfile-x64-glb.exe /norestartUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.File InformationSee Microsoft Knowledge Base Article 2597166 and Microsoft Knowledge Base Article 2553371Registry Key VerificationNot applicable #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 3.1 or later version be installed on the system. To install the 3.1 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/? or /helpDisplays usage dialog./passiveSpecifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel./quietSpecifies quiet mode, or suppresses prompts, when files are being extracted./norestartSuppresses restarting the system if the update requires a restart./forcerestartAutomatically restarts the system after applying the update, regardless of whether the update requires the restart./extractExtracts the files without installing them. You are prompted for a target folder./extract:<path>Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./lang:<LCID>Forces the use of a specific language, when the update package supports that language./log:<log file>Enables logging, by both Vnox and Installer, during the update installation. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the 2007 Microsoft Office CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2008 for Mac Deployment Information Prerequisites Mac OS X version 10.4.9 or later version on an Intel, PowerPC G5, or PowerPC G4 (500 MHz or faster) processorMac OS X user accounts must have administrator privileges to install this security update Installing the Update Download and install the appropriate language version of the Microsoft Office 2008 for Mac 12.3.3 Update from the Microsoft Download Center. Quit any applications that are running, including virus-protection applications, all Microsoft Office applications, Microsoft Messenger for Mac, and Office Notifications, because they might interfere with installation.Open the Microsoft Office 2008 for Mac 12.3.3 Update volume on your desktop. This step might have been performed for you.To start the update process, in the Microsoft Office 2008 for Mac 12.3.3 Update volume window, double-click the Microsoft Office 2008 for Mac 12.3.3 Update application, and follow the instructions on the screen.If the installation finishes successfully, you can remove the update installer from your hard disk. To verify that the installation finished successfully, see the following \"Verifying Update Installation\" heading. To remove the update installer, first drag the Microsoft Office 2008 for Mac 12.3.3 Update volume to the Trash, and then drag the file that you downloaded to the Trash. Verifying Update Installation To verify that a security update is installed on an affected system, follow these steps: In the Finder, navigate to the Application Folder (Microsoft Office 2008: Office).Select the file, Microsoft Component Plugin.On the File menu, click Get Info or Show Info. If the Version number is 12.3.3, the update has been successfully installed. Restart Requirement This update does not require you to restart your computer. Removing the Update This security update cannot be uninstalled. Additional Information If you have technical questions or problems downloading or using this update, visit Microsoft for Mac Support to learn about the support options that are available to you. Office for Mac 2011 Deployment Information Prerequisites Mac OS X version 10.5.8 or later version on an Intel processorMac OS X user accounts must have administrator privileges to install this security update Installing the Update Download and install the appropriate language version of the Microsoft Office for Mac 2011 14.2.2 Update from the Microsoft Download Center. Quit any applications that are running, including virus-protection applications and all Microsoft Office applications, because they might interfere with installation.Open the Microsoft Office for Mac 2011 14.2.2 Update volume on your desktop. This step might have been performed for you.To start the update process, in the Microsoft Office for Mac 2011 14.2.2 Update volume window, double-click the Microsoft Office for Mac 2011 14.2.2 Update application, and follow the instructions on the screen.When the installation finishes successfully, you can remove the update installer from your hard disk. To verify that the installation finished successfully, see the following \"Verifying Update Installation\" heading. To remove the update installer, first drag the Microsoft Office for Mac 2011 14.2.2 Update volume to the Trash, and then drag the file that you downloaded to the Trash. Verifying Update Installation To verify that a security update is installed on an affected system, follow these steps: In the Finder, navigate to the Application Folder (Microsoft Office 2011).Select Word, Excel, PowerPoint or Outlook and launch the application.On the Application menu, click About Application_Name (where Application_Name is Word, Excel, PowerPoint or Outlook). If the Latest Installed Update Version number is 14.2.2, the update has been successfully installed. Restart Requirement This update does not require you to restart your computer. Removing the Update This security update cannot be uninstalled. Additional Information If you have technical questions or problems downloading or using this update, visit Microsoft for Mac Support to learn about the support options that are available to you. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Omair for reporting the Excel File Format Memory Corruption Vulnerability (CVE-2012-0141)Omair for reporting the Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability (CVE-2012-0142)Omair, working with VeriSign iDefense Labs, for reporting the Excel SXLI Record Memory Corruption Vulnerability (CVE-2012-0184)Sean Larsson and Jun Mao, working with VeriSign iDefense Labs, for reporting the Excel MergeCells Record Heap Overflow Vulnerability (CVE-2012-0185)Sean Larsson and Jun Mao, working with VeriSign iDefense Labs, for reporting the Excel Series Record Parsing Type Mismatch Vulnerability (CVE-2012-1847)An anonymous researcher, working with TippingPoint'sZero Day Initiative, for reporting the Excel Series Record Parsing Type Mismatch Vulnerability (CVE-2012-1847) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections websites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support How to obtain help and support for this security update Help installing updates: Support for Microsoft UpdateSecurity solutions for IT professionals: TechNet Security Troubleshooting and SupportHelp protect your computer that is running Windows from viruses and malware: Virus Solution and Security CenterLocal support according to your country: International Support Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (May 8, 2012): Bulletin published.V1.1 (May 9, 2012): Removed erroneous reference to known issues from the Executive Summary and updated the title of CVE-2012-1847. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2012-0143": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-030",
        "title": "Vulnerabilities in Microsoft Office Could Allow Remote Code Execution (2663830)",
        "body": "",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Microsoft Office Microsoft Office Suite and Other SoftwareComponentMaximum Security ImpactAggregate Severity RatingUpdates ReplacedMicrosoft Office Suites and ComponentsMicrosoft Office 2003 Service Pack 3[Microsoft Excel 2003 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=162901b1-4c1d-476f-99e9-218780897f92) (KB2597086)Remote Code ExecutionImportantKB2596954 in [MS11-096](http://go.microsoft.com/fwlink/?linkid=232696) replaced by KB2597086Microsoft Office 2007 Service Pack 2[Microsoft Excel 2007 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=22b9b3a6-ad09-4397-892c-2190a86baf3e)[1](KB2597161)Remote Code ExecutionImportantKB2553073 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597161[Microsoft Office 2007 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=6ff6650c-eaf4-4c7d-986c-c4d9e5324dac) (KB2597969)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2007 Service Pack 3[Microsoft Excel 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=22b9b3a6-ad09-4397-892c-2190a86baf3e)[1](KB2597161)Remote Code ExecutionImportantNone[Microsoft Office 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=6ff6650c-eaf4-4c7d-986c-c4d9e5324dac) (KB2597969)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 (32-bit editions)[Microsoft Excel 2010 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=f537f6d0-be63-42af-8b39-fa6f38715f84) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=2e1060fa-c43d-42df-be5f-f536d9b39ba4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 Service Pack 1 (32-bit editions)[Microsoft Excel 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=f537f6d0-be63-42af-8b39-fa6f38715f84) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=2e1060fa-c43d-42df-be5f-f536d9b39ba4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 (64-bit editions)[Microsoft Excel 2010 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=123b96d9-de3f-4aab-bcf8-bf9089fef400) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=ec4371f6-644d-430d-880f-12425f1b36d4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 Service Pack 1 (64-bit editions)[Microsoft Excel 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=123b96d9-de3f-4aab-bcf8-bf9089fef400) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=ec4371f6-644d-430d-880f-12425f1b36d4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office for Mac[Microsoft Office 2008 for Mac](https://www.microsoft.com/download/details.aspx?familyid=8f85fc23-480e-4835-9ce5-0aa56702ef59) (KB2665346)Not applicableRemote Code ExecutionImportantKB2644354 in [MS11-094](http://go.microsoft.com/fwlink/?linkid=232493) replaced by KB2665346[Microsoft Office for Mac 2011](https://www.microsoft.com/download/details.aspx?familyid=5d88d3d4-89bd-44c3-9e5a-657998223e2f) (KB2665351)Not applicableRemote Code ExecutionImportantKB2644347 in [MS11-089](http://go.microsoft.com/fwlink/?linkid=225739) replaced by KB2665351Other Microsoft Office Software[Microsoft Excel Viewer](https://www.microsoft.com/download/details.aspx?familyid=9dedfb18-a651-49f7-b1fc-78f7b6cb234a)[2](KB2596842)Not applicableRemote Code ExecutionImportantKB2553075 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2596842[Microsoft Office Compatibility Pack Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=a8386ad9-635f-45a7-b33e-ac9a3ca55f82) (KB2597162)Not applicableRemote Code ExecutionImportantKB2553074 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597162[Microsoft Office Compatibility Pack Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=a8386ad9-635f-45a7-b33e-ac9a3ca55f82) (KB2597162)Not applicableRemote Code ExecutionImportantKB2553074 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597162 [1] For Microsoft Excel 2007, in addition to security update package KB2597161, customers also need to install the security update for the Microsoft Office Compatibility Pack (KB2597162) to be protected from the vulnerabilities described in this bulletin. [2]Microsoft Excel Viewer must be updated to a supported service pack level (Excel Viewer 2007 Service Pack 2 or Excel Viewer 2007 Service Pack 3) before installing this update. For information about supported Office viewers, see Microsoft Knowledge Base Article 979860. Non-Affected Software Office and Other SoftwareMicrosoft SharePoint Server 2010 and Microsoft SharePoint Server 2010 Service Pack 1Microsoft Office Web Application Companions (WAC)Open XML File Format Converter for MacMicrosoft Visio 2010 and Microsoft Visio 2010 Service Pack 1 (32-bit editions)Microsoft Visio 2010 and Microsoft Visio 2010 Service Pack 1 (64-bit editions)Microsoft Office Word ViewerMicrosoft Visio Viewer 2010 and Microsoft Visio Viewer 2010 Service Pack 1Microsoft Works 9 Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. How is this security update related to MS12-029?The security update packages for Microsoft Office 2008 for Mac (KB2665346) and Microsoft Office for Mac 2011 (KB2665351) offered in this bulletin also address the vulnerabilities described in the MS12-029 security bulletin. Why is this update only rated Important for all affected versions of Excel?Microsoft Excel 2002 and later versions have a built-in feature that prompts a user to Open, Save, or Cancel before opening a document. This mitigating factor reduces the vulnerabilities from Critical to Important because the vulnerabilities require more than a single user action to complete the exploit. The attack vector for the vulnerability is through Microsoft Excel. Why is this a Microsoft Office update?Although the attack vector for the vulnerabilities described in this bulletin is only through affected versions of Microsoft Excel, the vulnerable code is contained in a shared component of Microsoft Office. Other Microsoft Office software, including some supported releases of Microsoft Access, Microsoft Word, and Microsoft PowerPoint contain the vulnerable shared component of Microsoft Office, but because they do not access the vulnerable code, they are not affected by this vulnerability. However, since the vulnerable code is present, this update will be offered. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. Why are multiple package updates available for Microsoft Office 2007 Service Pack 2, Microsoft Office 2007 Service Pack 3, Microsoft Office 2010, and Microsoft Office 2010 Service Pack 1?The updates required to address the vulnerabilities described in this bulletin are offered across different package updates as indicated in the Affected Software table due to the componentized servicing model for Microsoft Office 2007 and Microsoft Office 2010. To be protected from the vulnerabilities, both updates are required, but they do not need to be installed in a particular order. What components of the Microsoft Office Compatibility Pack are updated by this bulletin?The update included with this security bulletin applies only to the Microsoft Excel component within the Microsoft Office Compatibility Pack. How areMicrosoft Office standalone programs affected by the vulnerabilities?A Microsoft Office standalone program is affected with the same severity rating as the corresponding component in a Microsoft Office Suite. For example, a standalone installation of Microsoft Excel is affected with the same severity rating as an installation of Microsoft Excel that was delivered with a Microsoft Office Suite. The Microsoft Office component discussed in this article is part of the Microsoft Office Suite that I have installed on my system; however, I did not choose to install this specific component. Will I be offered this update?Yes, if the component discussed in this bulletin was delivered with the version of the Microsoft Office Suite installed on your system, the system will be offered updates for it whether the component is installed or not. The detection logic used to scan for affected systems is designed to check for updates for all components that were delivered with the particular Microsoft Office Suite and to offer the updates to a system. Users who choose not to apply an update for a component that is not installed, but is delivered with their version of the Microsoft Office Suite, will not increase the security risk of that system. On the other hand, users who do choose to install the update will not have a negative impact on the security or performance of a system. Does the offer to update a non-vulnerable version of Microsoft Office constitute an issue in the Microsoft update mechanism?No, the update mechanism is functioning correctly in that it detects a lower version of the files on the system than in the update package and thus, offers the update. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle website. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Service Pack Lifecycle Support Policy. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information website, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the May bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcel File Format Memory Corruption Vulnerability - CVE-2012-0141Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847Aggregate Severity RatingMicrosoft Office Suites and ComponentsMicrosoft Excel 2003 Service Pack 3**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Microsoft Excel 2007 Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2007 Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2007 Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2007 Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 Service Pack 1 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 Service Pack 1 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 Service Pack 1 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 Service Pack 1 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office for MacMicrosoft Office 2008 for MacNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Microsoft Office for Mac 2011**Important** Remote Code ExecutionNot applicableNot applicable**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Other Microsoft Office SoftwareMicrosoft Excel Viewer**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office Compatibility Pack Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office Compatibility Pack Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important** Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0141. Mitigating Factors for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000 For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps: Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings. Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0142. Mitigating Factors for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office Software Registry Script Microsoft Excel 2003 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000001 Microsoft Excel 2007 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000001 For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office Software Registry Script Microsoft Excel 2003 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000000 Microsoft Excel 2007 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000000 For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0143. Mitigating Factors for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Impact of workaround. For Microsoft Office 2003, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions.How to undo the workaround.For Microsoft Office 2003, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number CVE-2012-0143. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0184. Mitigating Factors for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Set Office File Validation to disable the opening of files that fail validation in Excel 2003 and Excel 2007Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2003 and Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000000Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0185. Mitigating Factors for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Set Office File Validation to disable the opening of files that fail validation in Excel 2007Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000000Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-1847. Mitigating Factors for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Security Central Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security website provides additional information about security in Microsoft products. Security updates are available from Microsoft Update and Windows Update. Security updates are also available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" For customers of Microsoft Office for Mac, Microsoft AutoUpdate for Mac can help keep your Microsoft software up to date. For more information about using Microsoft AutoUpdate for Mac, see Check for software updates automatically. Finally, security updates can be downloaded from the Microsoft Update Catalog. The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the Microsoft Update Catalog FAQ. Detection and Deployment Guidance Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see Microsoft Knowledge Base Article 961747. Microsoft Baseline Security Analyzer Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit Microsoft Baseline Security Analyzer. The following table provides the MBSA detection summary for this security update. SoftwareMBSAMicrosoft Office 2003 Service Pack 3YesMicrosoft Office 2007 Service Pack 2 and Microsoft Excel 2007 Service Pack 3YesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (32-bit editions)YesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (64-bit editions)YesMicrosoft Office 2008 for MacNoMicrosoft Office for Mac 2011NoMicrosoft Excel ViewerYesMicrosoft Office Compatibility Pack Service Pack 2 and Microsoft Office Compatibility Pack Service Pack 3Yes Note For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit Microsoft Baseline Security Analyzer and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. Windows Server Update Services Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, Windows Server Update Services. Systems Management Server The following table provides the SMS detection and deployment summary for this security update. SoftwareSMS 2003 with ITMUConfiguration Manager 2007Microsoft Office 2003 Service Pack 3YesYesMicrosoft Office 2007 Service Pack 2 and Microsoft Excel 2007 Service Pack 3YesYesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (32-bit editions)YesYesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (64-bit editions)YesYesMicrosoft Office 2008 for MacNoNoMicrosoft Office for Mac 2011NoNoMicrosoft Excel ViewerYesYesMicrosoft Office Compatibility Pack Service Pack 2 and Microsoft Office Compatibility Pack Service Pack 3YesYes Note Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to System Center Configuration Manager 2007. For customers remaining on SMS 2003 Service Pack 3, the Inventory Tool for Microsoft Updates (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by Microsoft Update and that are supported by Windows Server Update Services. For more information about the SMS 2003 ITMU, see SMS 2003 Inventory Tool for Microsoft Updates. For more information about SMS scanning tools, see SMS 2003 Software Update Scanning Tools. See also Downloads for Systems Management Server 2003. System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit System Center Configuration Manager 2007. For more information about SMS, visit the SMS website. For more detailed information, see Microsoft Knowledge Base Article 910723: Summary list of monthly detection and deployment guidance articles. Note If you have used an Administrative Installation Point (AIP) for deploying Office XP or Office 2003, you may not be able to deploy the update using SMS if you have updated the AIP from the original baseline. For more information, see the Office Administrative Installation Point heading in this section. Office Administrative Installation Point If you installed your application from a server location, the server administrator must update the server location with the administrative update and deploy that update to your system. For supported versions of Microsoft Office XP, see Creating an Administrative Installation Point. For more information on how to change the source for a client system from an updated administrative installation point to an Office XP original baseline source, see Microsoft Knowledge Base Article 922665.Note If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article Updating Office XP Clients from a Patched Administrative Image.For supported versions of Microsoft Office 2003, see Creating an Administrative Installation Point. For more information on how to change the source for a client computer from an updated administrative installation point to an Office 2003 original baseline source or Service Pack 3 (SP3), see Microsoft Knowledge Base Article 902349.Note If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article, Distributing Office 2003 Product Updates.For creating a network installation point for supported versions of Microsoft Office, see Create a network installation point for Microsoft Office.Note If you plan to manage security updates centrally, use Windows Server Update Services. For more information about how to deploy security updates for Microsoft Office, visit the Windows Server Update Services website. Update Compatibility Evaluator and Application Compatibility Toolkit Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the Update Compatibility Evaluator components included with Application Compatibility Toolkit. The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Office 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the Deployment Information subsection below. Inclusion in Future Service PacksThere are no more service packs planned for this software. The update for this issue may be included in a future update rollup.DeploymentInstalling without user interventionOffice2003-kb2597086-fullfile-enu.exe /q:aInstalling without restartingOffice2003-kb2597086-fullfile-enu.exe /r:nUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance. For features you can selectively install, see the Office Features for Administrative Installations subsection in this section.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.Note When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771.File InformationSee Microsoft Knowledge Base Article 2597086Registry Key VerificationNot applicable #### Office Features The following table contains the list of feature names (case sensitive) that must be reinstalled for the update. To install all features, you can use **REINSTALL=ALL** or you can install the following features: | Product | Feature | |--------------------------------------------------------|---------| | STD11, BASIC11, PERS11, STDP11, PROI11, PRO11, PRO11SB | All | **Note** Administrators working in managed environments can find complete resources for deploying Office updates in an organization at the Office Admin Update Center. At that site, scroll down and look under the **Update Resources** section for the software version you are updating. The [Windows Installer Documentation](http://go.microsoft.com/fwlink/?linkid=21685) also provides more information about the parameters supported by Windows Installer. #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 2.0 or later version be installed on the system. All supported versions of Windows include Windows Installer 2.0 or a later version. To install the 2.0 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) - [Windows Installer 2.0 Redistributable for Microsoft Windows 2000 and Windows NT 4.0](http://go.microsoft.com/fwlink/?linkid=33338) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/qSpecifies quiet mode, or suppresses prompts, when files are being extracted./q:uSpecifies user-quiet mode, which presents some dialog boxes to the user./q:aSpecifies administrator-quiet mode, which does not present any dialog boxes to the user./t:pathSpecifies the target folder for extracting files./cExtracts the files without installing them. If /t:path is not specified, you are prompted for a target folder./c:pathOverrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./r:nNever restarts the system after installation./r:IPrompts the user to restart the system if a restart is required, except when used with /q:a./r:aAlways restarts the system after installation./r:sRestarts the system after installation without prompting the user./n:vNo version checking - Install the program over any earlier version. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2007 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft Excel 2007:excel2007-kb2597161-fullfile-x86-glb.exe /passiveFor Microsoft Office 2007:graph2007-kb2597969-fullfile-x86-glb.exe /passiveFor Microsoft Excel Viewer:xlview2007-kb2596842-fullfile-x86-glb.exe /passiveFor Microsoft Office Compatibility Pack:xlconv2007-kb2597162-fullfile-x86-glb.exe /passiveInstalling without restartingFor Microsoft Excel 2007:excel2007-kb2597161-fullfile-x86-glb.exe /norestartFor Microsoft Office 2007:graph2007-kb2597969-fullfile-x86-glb.exe /norestartFor Microsoft Excel Viewer:xlview2007-kb2596842-fullfile-x86-glb.exe /norestartFor Microsoft Office Compatibility Pack:xlconv2007-kb2597162-fullfile-x86-glb.exe /norestartUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.File InformationFor Microsoft Excel 2007, see Microsoft Knowledge Base Article 2597161For Microsoft Office 2007, see Microsoft Knowledge Base Article 2597969For Microsoft Excel Viewer, see Microsoft Knowledge Base Article 2596842For Microsoft Office Compatibility Pack, see Microsoft Knowledge Base Article 2597162Registry Key VerificationNot applicable #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 3.1 or later version be installed on the system. To install the 3.1 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/? or /helpDisplays usage dialog./passiveSpecifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel./quietSpecifies quiet mode, or suppresses prompts, when files are being extracted./norestartSuppresses restarting the system if the update requires a restart./forcerestartAutomatically restarts the system after applying the update, regardless of whether the update requires the restart./extractExtracts the files without installing them. You are prompted for a target folder./extract:<path>Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./lang:<LCID>Forces the use of a specific language, when the update package supports that language./log:<log file>Enables logging, by both Vnox and Installer, during the update installation. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the 2007 Microsoft Office CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2010 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft Excel 2010 (32-bit editions):excel2010-kb2597166-fullfile-x86-glb.exe /passiveFor Microsoft Office 2010 (32-bit editions):graph2010-kb2553371-fullfile-x86-glb.exe /passiveFor Microsoft Excel 2010 (64-bit editions):excel2010-kb2597166-fullfile-x64-glb.exe /passiveFor Microsoft Office 2010 (64-bit editions):graph2010-kb2553371-fullfile-x64-glb.exe /passiveInstalling without restartingFor Microsoft Excel 2010 (32-bit editions):excel2010-kb2597166-fullfile-x86-glb.exe /norestartFor Microsoft Office 2010 (32-bit editions):graph2010-kb2553371-fullfile-x86-glb.exe /norestartFor Microsoft Excel 2010 (64-bit editions):excel2010-kb2597166-fullfile-x64-glb.exe /norestartFor Microsoft Office 2010 (64-bit editions):graph2010-kb2553371-fullfile-x64-glb.exe /norestartUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.File InformationSee Microsoft Knowledge Base Article 2597166 and Microsoft Knowledge Base Article 2553371Registry Key VerificationNot applicable #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 3.1 or later version be installed on the system. To install the 3.1 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/? or /helpDisplays usage dialog./passiveSpecifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel./quietSpecifies quiet mode, or suppresses prompts, when files are being extracted./norestartSuppresses restarting the system if the update requires a restart./forcerestartAutomatically restarts the system after applying the update, regardless of whether the update requires the restart./extractExtracts the files without installing them. You are prompted for a target folder./extract:<path>Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./lang:<LCID>Forces the use of a specific language, when the update package supports that language./log:<log file>Enables logging, by both Vnox and Installer, during the update installation. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the 2007 Microsoft Office CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2008 for Mac Deployment Information Prerequisites Mac OS X version 10.4.9 or later version on an Intel, PowerPC G5, or PowerPC G4 (500 MHz or faster) processorMac OS X user accounts must have administrator privileges to install this security update Installing the Update Download and install the appropriate language version of the Microsoft Office 2008 for Mac 12.3.3 Update from the Microsoft Download Center. Quit any applications that are running, including virus-protection applications, all Microsoft Office applications, Microsoft Messenger for Mac, and Office Notifications, because they might interfere with installation.Open the Microsoft Office 2008 for Mac 12.3.3 Update volume on your desktop. This step might have been performed for you.To start the update process, in the Microsoft Office 2008 for Mac 12.3.3 Update volume window, double-click the Microsoft Office 2008 for Mac 12.3.3 Update application, and follow the instructions on the screen.If the installation finishes successfully, you can remove the update installer from your hard disk. To verify that the installation finished successfully, see the following \"Verifying Update Installation\" heading. To remove the update installer, first drag the Microsoft Office 2008 for Mac 12.3.3 Update volume to the Trash, and then drag the file that you downloaded to the Trash. Verifying Update Installation To verify that a security update is installed on an affected system, follow these steps: In the Finder, navigate to the Application Folder (Microsoft Office 2008: Office).Select the file, Microsoft Component Plugin.On the File menu, click Get Info or Show Info. If the Version number is 12.3.3, the update has been successfully installed. Restart Requirement This update does not require you to restart your computer. Removing the Update This security update cannot be uninstalled. Additional Information If you have technical questions or problems downloading or using this update, visit Microsoft for Mac Support to learn about the support options that are available to you. Office for Mac 2011 Deployment Information Prerequisites Mac OS X version 10.5.8 or later version on an Intel processorMac OS X user accounts must have administrator privileges to install this security update Installing the Update Download and install the appropriate language version of the Microsoft Office for Mac 2011 14.2.2 Update from the Microsoft Download Center. Quit any applications that are running, including virus-protection applications and all Microsoft Office applications, because they might interfere with installation.Open the Microsoft Office for Mac 2011 14.2.2 Update volume on your desktop. This step might have been performed for you.To start the update process, in the Microsoft Office for Mac 2011 14.2.2 Update volume window, double-click the Microsoft Office for Mac 2011 14.2.2 Update application, and follow the instructions on the screen.When the installation finishes successfully, you can remove the update installer from your hard disk. To verify that the installation finished successfully, see the following \"Verifying Update Installation\" heading. To remove the update installer, first drag the Microsoft Office for Mac 2011 14.2.2 Update volume to the Trash, and then drag the file that you downloaded to the Trash. Verifying Update Installation To verify that a security update is installed on an affected system, follow these steps: In the Finder, navigate to the Application Folder (Microsoft Office 2011).Select Word, Excel, PowerPoint or Outlook and launch the application.On the Application menu, click About Application_Name (where Application_Name is Word, Excel, PowerPoint or Outlook). If the Latest Installed Update Version number is 14.2.2, the update has been successfully installed. Restart Requirement This update does not require you to restart your computer. Removing the Update This security update cannot be uninstalled. Additional Information If you have technical questions or problems downloading or using this update, visit Microsoft for Mac Support to learn about the support options that are available to you. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Omair for reporting the Excel File Format Memory Corruption Vulnerability (CVE-2012-0141)Omair for reporting the Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability (CVE-2012-0142)Omair, working with VeriSign iDefense Labs, for reporting the Excel SXLI Record Memory Corruption Vulnerability (CVE-2012-0184)Sean Larsson and Jun Mao, working with VeriSign iDefense Labs, for reporting the Excel MergeCells Record Heap Overflow Vulnerability (CVE-2012-0185)Sean Larsson and Jun Mao, working with VeriSign iDefense Labs, for reporting the Excel Series Record Parsing Type Mismatch Vulnerability (CVE-2012-1847)An anonymous researcher, working with TippingPoint'sZero Day Initiative, for reporting the Excel Series Record Parsing Type Mismatch Vulnerability (CVE-2012-1847) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections websites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support How to obtain help and support for this security update Help installing updates: Support for Microsoft UpdateSecurity solutions for IT professionals: TechNet Security Troubleshooting and SupportHelp protect your computer that is running Windows from viruses and malware: Virus Solution and Security CenterLocal support according to your country: International Support Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (May 8, 2012): Bulletin published.V1.1 (May 9, 2012): Removed erroneous reference to known issues from the Executive Summary and updated the title of CVE-2012-1847. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2012-0184": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-030",
        "title": "Vulnerabilities in Microsoft Office Could Allow Remote Code Execution (2663830)",
        "body": "",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Microsoft Office Microsoft Office Suite and Other SoftwareComponentMaximum Security ImpactAggregate Severity RatingUpdates ReplacedMicrosoft Office Suites and ComponentsMicrosoft Office 2003 Service Pack 3[Microsoft Excel 2003 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=162901b1-4c1d-476f-99e9-218780897f92) (KB2597086)Remote Code ExecutionImportantKB2596954 in [MS11-096](http://go.microsoft.com/fwlink/?linkid=232696) replaced by KB2597086Microsoft Office 2007 Service Pack 2[Microsoft Excel 2007 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=22b9b3a6-ad09-4397-892c-2190a86baf3e)[1](KB2597161)Remote Code ExecutionImportantKB2553073 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597161[Microsoft Office 2007 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=6ff6650c-eaf4-4c7d-986c-c4d9e5324dac) (KB2597969)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2007 Service Pack 3[Microsoft Excel 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=22b9b3a6-ad09-4397-892c-2190a86baf3e)[1](KB2597161)Remote Code ExecutionImportantNone[Microsoft Office 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=6ff6650c-eaf4-4c7d-986c-c4d9e5324dac) (KB2597969)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 (32-bit editions)[Microsoft Excel 2010 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=f537f6d0-be63-42af-8b39-fa6f38715f84) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=2e1060fa-c43d-42df-be5f-f536d9b39ba4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 Service Pack 1 (32-bit editions)[Microsoft Excel 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=f537f6d0-be63-42af-8b39-fa6f38715f84) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=2e1060fa-c43d-42df-be5f-f536d9b39ba4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 (64-bit editions)[Microsoft Excel 2010 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=123b96d9-de3f-4aab-bcf8-bf9089fef400) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=ec4371f6-644d-430d-880f-12425f1b36d4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 Service Pack 1 (64-bit editions)[Microsoft Excel 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=123b96d9-de3f-4aab-bcf8-bf9089fef400) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=ec4371f6-644d-430d-880f-12425f1b36d4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office for Mac[Microsoft Office 2008 for Mac](https://www.microsoft.com/download/details.aspx?familyid=8f85fc23-480e-4835-9ce5-0aa56702ef59) (KB2665346)Not applicableRemote Code ExecutionImportantKB2644354 in [MS11-094](http://go.microsoft.com/fwlink/?linkid=232493) replaced by KB2665346[Microsoft Office for Mac 2011](https://www.microsoft.com/download/details.aspx?familyid=5d88d3d4-89bd-44c3-9e5a-657998223e2f) (KB2665351)Not applicableRemote Code ExecutionImportantKB2644347 in [MS11-089](http://go.microsoft.com/fwlink/?linkid=225739) replaced by KB2665351Other Microsoft Office Software[Microsoft Excel Viewer](https://www.microsoft.com/download/details.aspx?familyid=9dedfb18-a651-49f7-b1fc-78f7b6cb234a)[2](KB2596842)Not applicableRemote Code ExecutionImportantKB2553075 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2596842[Microsoft Office Compatibility Pack Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=a8386ad9-635f-45a7-b33e-ac9a3ca55f82) (KB2597162)Not applicableRemote Code ExecutionImportantKB2553074 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597162[Microsoft Office Compatibility Pack Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=a8386ad9-635f-45a7-b33e-ac9a3ca55f82) (KB2597162)Not applicableRemote Code ExecutionImportantKB2553074 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597162 [1] For Microsoft Excel 2007, in addition to security update package KB2597161, customers also need to install the security update for the Microsoft Office Compatibility Pack (KB2597162) to be protected from the vulnerabilities described in this bulletin. [2]Microsoft Excel Viewer must be updated to a supported service pack level (Excel Viewer 2007 Service Pack 2 or Excel Viewer 2007 Service Pack 3) before installing this update. For information about supported Office viewers, see Microsoft Knowledge Base Article 979860. Non-Affected Software Office and Other SoftwareMicrosoft SharePoint Server 2010 and Microsoft SharePoint Server 2010 Service Pack 1Microsoft Office Web Application Companions (WAC)Open XML File Format Converter for MacMicrosoft Visio 2010 and Microsoft Visio 2010 Service Pack 1 (32-bit editions)Microsoft Visio 2010 and Microsoft Visio 2010 Service Pack 1 (64-bit editions)Microsoft Office Word ViewerMicrosoft Visio Viewer 2010 and Microsoft Visio Viewer 2010 Service Pack 1Microsoft Works 9 Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. How is this security update related to MS12-029?The security update packages for Microsoft Office 2008 for Mac (KB2665346) and Microsoft Office for Mac 2011 (KB2665351) offered in this bulletin also address the vulnerabilities described in the MS12-029 security bulletin. Why is this update only rated Important for all affected versions of Excel?Microsoft Excel 2002 and later versions have a built-in feature that prompts a user to Open, Save, or Cancel before opening a document. This mitigating factor reduces the vulnerabilities from Critical to Important because the vulnerabilities require more than a single user action to complete the exploit. The attack vector for the vulnerability is through Microsoft Excel. Why is this a Microsoft Office update?Although the attack vector for the vulnerabilities described in this bulletin is only through affected versions of Microsoft Excel, the vulnerable code is contained in a shared component of Microsoft Office. Other Microsoft Office software, including some supported releases of Microsoft Access, Microsoft Word, and Microsoft PowerPoint contain the vulnerable shared component of Microsoft Office, but because they do not access the vulnerable code, they are not affected by this vulnerability. However, since the vulnerable code is present, this update will be offered. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. Why are multiple package updates available for Microsoft Office 2007 Service Pack 2, Microsoft Office 2007 Service Pack 3, Microsoft Office 2010, and Microsoft Office 2010 Service Pack 1?The updates required to address the vulnerabilities described in this bulletin are offered across different package updates as indicated in the Affected Software table due to the componentized servicing model for Microsoft Office 2007 and Microsoft Office 2010. To be protected from the vulnerabilities, both updates are required, but they do not need to be installed in a particular order. What components of the Microsoft Office Compatibility Pack are updated by this bulletin?The update included with this security bulletin applies only to the Microsoft Excel component within the Microsoft Office Compatibility Pack. How areMicrosoft Office standalone programs affected by the vulnerabilities?A Microsoft Office standalone program is affected with the same severity rating as the corresponding component in a Microsoft Office Suite. For example, a standalone installation of Microsoft Excel is affected with the same severity rating as an installation of Microsoft Excel that was delivered with a Microsoft Office Suite. The Microsoft Office component discussed in this article is part of the Microsoft Office Suite that I have installed on my system; however, I did not choose to install this specific component. Will I be offered this update?Yes, if the component discussed in this bulletin was delivered with the version of the Microsoft Office Suite installed on your system, the system will be offered updates for it whether the component is installed or not. The detection logic used to scan for affected systems is designed to check for updates for all components that were delivered with the particular Microsoft Office Suite and to offer the updates to a system. Users who choose not to apply an update for a component that is not installed, but is delivered with their version of the Microsoft Office Suite, will not increase the security risk of that system. On the other hand, users who do choose to install the update will not have a negative impact on the security or performance of a system. Does the offer to update a non-vulnerable version of Microsoft Office constitute an issue in the Microsoft update mechanism?No, the update mechanism is functioning correctly in that it detects a lower version of the files on the system than in the update package and thus, offers the update. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle website. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Service Pack Lifecycle Support Policy. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information website, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the May bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcel File Format Memory Corruption Vulnerability - CVE-2012-0141Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847Aggregate Severity RatingMicrosoft Office Suites and ComponentsMicrosoft Excel 2003 Service Pack 3**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Microsoft Excel 2007 Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2007 Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2007 Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2007 Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 Service Pack 1 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 Service Pack 1 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 Service Pack 1 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 Service Pack 1 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office for MacMicrosoft Office 2008 for MacNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Microsoft Office for Mac 2011**Important** Remote Code ExecutionNot applicableNot applicable**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Other Microsoft Office SoftwareMicrosoft Excel Viewer**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office Compatibility Pack Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office Compatibility Pack Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important** Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0141. Mitigating Factors for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000 For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps: Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings. Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0142. Mitigating Factors for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office Software Registry Script Microsoft Excel 2003 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000001 Microsoft Excel 2007 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000001 For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office Software Registry Script Microsoft Excel 2003 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000000 Microsoft Excel 2007 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000000 For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0143. Mitigating Factors for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Impact of workaround. For Microsoft Office 2003, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions.How to undo the workaround.For Microsoft Office 2003, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number CVE-2012-0143. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0184. Mitigating Factors for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Set Office File Validation to disable the opening of files that fail validation in Excel 2003 and Excel 2007Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2003 and Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000000Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0185. Mitigating Factors for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Set Office File Validation to disable the opening of files that fail validation in Excel 2007Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000000Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-1847. Mitigating Factors for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Security Central Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security website provides additional information about security in Microsoft products. Security updates are available from Microsoft Update and Windows Update. Security updates are also available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" For customers of Microsoft Office for Mac, Microsoft AutoUpdate for Mac can help keep your Microsoft software up to date. For more information about using Microsoft AutoUpdate for Mac, see Check for software updates automatically. Finally, security updates can be downloaded from the Microsoft Update Catalog. The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the Microsoft Update Catalog FAQ. Detection and Deployment Guidance Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see Microsoft Knowledge Base Article 961747. Microsoft Baseline Security Analyzer Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit Microsoft Baseline Security Analyzer. The following table provides the MBSA detection summary for this security update. SoftwareMBSAMicrosoft Office 2003 Service Pack 3YesMicrosoft Office 2007 Service Pack 2 and Microsoft Excel 2007 Service Pack 3YesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (32-bit editions)YesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (64-bit editions)YesMicrosoft Office 2008 for MacNoMicrosoft Office for Mac 2011NoMicrosoft Excel ViewerYesMicrosoft Office Compatibility Pack Service Pack 2 and Microsoft Office Compatibility Pack Service Pack 3Yes Note For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit Microsoft Baseline Security Analyzer and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. Windows Server Update Services Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, Windows Server Update Services. Systems Management Server The following table provides the SMS detection and deployment summary for this security update. SoftwareSMS 2003 with ITMUConfiguration Manager 2007Microsoft Office 2003 Service Pack 3YesYesMicrosoft Office 2007 Service Pack 2 and Microsoft Excel 2007 Service Pack 3YesYesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (32-bit editions)YesYesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (64-bit editions)YesYesMicrosoft Office 2008 for MacNoNoMicrosoft Office for Mac 2011NoNoMicrosoft Excel ViewerYesYesMicrosoft Office Compatibility Pack Service Pack 2 and Microsoft Office Compatibility Pack Service Pack 3YesYes Note Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to System Center Configuration Manager 2007. For customers remaining on SMS 2003 Service Pack 3, the Inventory Tool for Microsoft Updates (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by Microsoft Update and that are supported by Windows Server Update Services. For more information about the SMS 2003 ITMU, see SMS 2003 Inventory Tool for Microsoft Updates. For more information about SMS scanning tools, see SMS 2003 Software Update Scanning Tools. See also Downloads for Systems Management Server 2003. System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit System Center Configuration Manager 2007. For more information about SMS, visit the SMS website. For more detailed information, see Microsoft Knowledge Base Article 910723: Summary list of monthly detection and deployment guidance articles. Note If you have used an Administrative Installation Point (AIP) for deploying Office XP or Office 2003, you may not be able to deploy the update using SMS if you have updated the AIP from the original baseline. For more information, see the Office Administrative Installation Point heading in this section. Office Administrative Installation Point If you installed your application from a server location, the server administrator must update the server location with the administrative update and deploy that update to your system. For supported versions of Microsoft Office XP, see Creating an Administrative Installation Point. For more information on how to change the source for a client system from an updated administrative installation point to an Office XP original baseline source, see Microsoft Knowledge Base Article 922665.Note If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article Updating Office XP Clients from a Patched Administrative Image.For supported versions of Microsoft Office 2003, see Creating an Administrative Installation Point. For more information on how to change the source for a client computer from an updated administrative installation point to an Office 2003 original baseline source or Service Pack 3 (SP3), see Microsoft Knowledge Base Article 902349.Note If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article, Distributing Office 2003 Product Updates.For creating a network installation point for supported versions of Microsoft Office, see Create a network installation point for Microsoft Office.Note If you plan to manage security updates centrally, use Windows Server Update Services. For more information about how to deploy security updates for Microsoft Office, visit the Windows Server Update Services website. Update Compatibility Evaluator and Application Compatibility Toolkit Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the Update Compatibility Evaluator components included with Application Compatibility Toolkit. The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Office 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the Deployment Information subsection below. Inclusion in Future Service PacksThere are no more service packs planned for this software. The update for this issue may be included in a future update rollup.DeploymentInstalling without user interventionOffice2003-kb2597086-fullfile-enu.exe /q:aInstalling without restartingOffice2003-kb2597086-fullfile-enu.exe /r:nUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance. For features you can selectively install, see the Office Features for Administrative Installations subsection in this section.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.Note When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771.File InformationSee Microsoft Knowledge Base Article 2597086Registry Key VerificationNot applicable #### Office Features The following table contains the list of feature names (case sensitive) that must be reinstalled for the update. To install all features, you can use **REINSTALL=ALL** or you can install the following features: | Product | Feature | |--------------------------------------------------------|---------| | STD11, BASIC11, PERS11, STDP11, PROI11, PRO11, PRO11SB | All | **Note** Administrators working in managed environments can find complete resources for deploying Office updates in an organization at the Office Admin Update Center. At that site, scroll down and look under the **Update Resources** section for the software version you are updating. The [Windows Installer Documentation](http://go.microsoft.com/fwlink/?linkid=21685) also provides more information about the parameters supported by Windows Installer. #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 2.0 or later version be installed on the system. All supported versions of Windows include Windows Installer 2.0 or a later version. To install the 2.0 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) - [Windows Installer 2.0 Redistributable for Microsoft Windows 2000 and Windows NT 4.0](http://go.microsoft.com/fwlink/?linkid=33338) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/qSpecifies quiet mode, or suppresses prompts, when files are being extracted./q:uSpecifies user-quiet mode, which presents some dialog boxes to the user./q:aSpecifies administrator-quiet mode, which does not present any dialog boxes to the user./t:pathSpecifies the target folder for extracting files./cExtracts the files without installing them. If /t:path is not specified, you are prompted for a target folder./c:pathOverrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./r:nNever restarts the system after installation./r:IPrompts the user to restart the system if a restart is required, except when used with /q:a./r:aAlways restarts the system after installation./r:sRestarts the system after installation without prompting the user./n:vNo version checking - Install the program over any earlier version. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2007 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft Excel 2007:excel2007-kb2597161-fullfile-x86-glb.exe /passiveFor Microsoft Office 2007:graph2007-kb2597969-fullfile-x86-glb.exe /passiveFor Microsoft Excel Viewer:xlview2007-kb2596842-fullfile-x86-glb.exe /passiveFor Microsoft Office Compatibility Pack:xlconv2007-kb2597162-fullfile-x86-glb.exe /passiveInstalling without restartingFor Microsoft Excel 2007:excel2007-kb2597161-fullfile-x86-glb.exe /norestartFor Microsoft Office 2007:graph2007-kb2597969-fullfile-x86-glb.exe /norestartFor Microsoft Excel Viewer:xlview2007-kb2596842-fullfile-x86-glb.exe /norestartFor Microsoft Office Compatibility Pack:xlconv2007-kb2597162-fullfile-x86-glb.exe /norestartUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.File InformationFor Microsoft Excel 2007, see Microsoft Knowledge Base Article 2597161For Microsoft Office 2007, see Microsoft Knowledge Base Article 2597969For Microsoft Excel Viewer, see Microsoft Knowledge Base Article 2596842For Microsoft Office Compatibility Pack, see Microsoft Knowledge Base Article 2597162Registry Key VerificationNot applicable #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 3.1 or later version be installed on the system. To install the 3.1 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/? or /helpDisplays usage dialog./passiveSpecifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel./quietSpecifies quiet mode, or suppresses prompts, when files are being extracted./norestartSuppresses restarting the system if the update requires a restart./forcerestartAutomatically restarts the system after applying the update, regardless of whether the update requires the restart./extractExtracts the files without installing them. You are prompted for a target folder./extract:<path>Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./lang:<LCID>Forces the use of a specific language, when the update package supports that language./log:<log file>Enables logging, by both Vnox and Installer, during the update installation. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the 2007 Microsoft Office CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2010 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft Excel 2010 (32-bit editions):excel2010-kb2597166-fullfile-x86-glb.exe /passiveFor Microsoft Office 2010 (32-bit editions):graph2010-kb2553371-fullfile-x86-glb.exe /passiveFor Microsoft Excel 2010 (64-bit editions):excel2010-kb2597166-fullfile-x64-glb.exe /passiveFor Microsoft Office 2010 (64-bit editions):graph2010-kb2553371-fullfile-x64-glb.exe /passiveInstalling without restartingFor Microsoft Excel 2010 (32-bit editions):excel2010-kb2597166-fullfile-x86-glb.exe /norestartFor Microsoft Office 2010 (32-bit editions):graph2010-kb2553371-fullfile-x86-glb.exe /norestartFor Microsoft Excel 2010 (64-bit editions):excel2010-kb2597166-fullfile-x64-glb.exe /norestartFor Microsoft Office 2010 (64-bit editions):graph2010-kb2553371-fullfile-x64-glb.exe /norestartUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.File InformationSee Microsoft Knowledge Base Article 2597166 and Microsoft Knowledge Base Article 2553371Registry Key VerificationNot applicable #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 3.1 or later version be installed on the system. To install the 3.1 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/? or /helpDisplays usage dialog./passiveSpecifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel./quietSpecifies quiet mode, or suppresses prompts, when files are being extracted./norestartSuppresses restarting the system if the update requires a restart./forcerestartAutomatically restarts the system after applying the update, regardless of whether the update requires the restart./extractExtracts the files without installing them. You are prompted for a target folder./extract:<path>Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./lang:<LCID>Forces the use of a specific language, when the update package supports that language./log:<log file>Enables logging, by both Vnox and Installer, during the update installation. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the 2007 Microsoft Office CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2008 for Mac Deployment Information Prerequisites Mac OS X version 10.4.9 or later version on an Intel, PowerPC G5, or PowerPC G4 (500 MHz or faster) processorMac OS X user accounts must have administrator privileges to install this security update Installing the Update Download and install the appropriate language version of the Microsoft Office 2008 for Mac 12.3.3 Update from the Microsoft Download Center. Quit any applications that are running, including virus-protection applications, all Microsoft Office applications, Microsoft Messenger for Mac, and Office Notifications, because they might interfere with installation.Open the Microsoft Office 2008 for Mac 12.3.3 Update volume on your desktop. This step might have been performed for you.To start the update process, in the Microsoft Office 2008 for Mac 12.3.3 Update volume window, double-click the Microsoft Office 2008 for Mac 12.3.3 Update application, and follow the instructions on the screen.If the installation finishes successfully, you can remove the update installer from your hard disk. To verify that the installation finished successfully, see the following \"Verifying Update Installation\" heading. To remove the update installer, first drag the Microsoft Office 2008 for Mac 12.3.3 Update volume to the Trash, and then drag the file that you downloaded to the Trash. Verifying Update Installation To verify that a security update is installed on an affected system, follow these steps: In the Finder, navigate to the Application Folder (Microsoft Office 2008: Office).Select the file, Microsoft Component Plugin.On the File menu, click Get Info or Show Info. If the Version number is 12.3.3, the update has been successfully installed. Restart Requirement This update does not require you to restart your computer. Removing the Update This security update cannot be uninstalled. Additional Information If you have technical questions or problems downloading or using this update, visit Microsoft for Mac Support to learn about the support options that are available to you. Office for Mac 2011 Deployment Information Prerequisites Mac OS X version 10.5.8 or later version on an Intel processorMac OS X user accounts must have administrator privileges to install this security update Installing the Update Download and install the appropriate language version of the Microsoft Office for Mac 2011 14.2.2 Update from the Microsoft Download Center. Quit any applications that are running, including virus-protection applications and all Microsoft Office applications, because they might interfere with installation.Open the Microsoft Office for Mac 2011 14.2.2 Update volume on your desktop. This step might have been performed for you.To start the update process, in the Microsoft Office for Mac 2011 14.2.2 Update volume window, double-click the Microsoft Office for Mac 2011 14.2.2 Update application, and follow the instructions on the screen.When the installation finishes successfully, you can remove the update installer from your hard disk. To verify that the installation finished successfully, see the following \"Verifying Update Installation\" heading. To remove the update installer, first drag the Microsoft Office for Mac 2011 14.2.2 Update volume to the Trash, and then drag the file that you downloaded to the Trash. Verifying Update Installation To verify that a security update is installed on an affected system, follow these steps: In the Finder, navigate to the Application Folder (Microsoft Office 2011).Select Word, Excel, PowerPoint or Outlook and launch the application.On the Application menu, click About Application_Name (where Application_Name is Word, Excel, PowerPoint or Outlook). If the Latest Installed Update Version number is 14.2.2, the update has been successfully installed. Restart Requirement This update does not require you to restart your computer. Removing the Update This security update cannot be uninstalled. Additional Information If you have technical questions or problems downloading or using this update, visit Microsoft for Mac Support to learn about the support options that are available to you. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Omair for reporting the Excel File Format Memory Corruption Vulnerability (CVE-2012-0141)Omair for reporting the Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability (CVE-2012-0142)Omair, working with VeriSign iDefense Labs, for reporting the Excel SXLI Record Memory Corruption Vulnerability (CVE-2012-0184)Sean Larsson and Jun Mao, working with VeriSign iDefense Labs, for reporting the Excel MergeCells Record Heap Overflow Vulnerability (CVE-2012-0185)Sean Larsson and Jun Mao, working with VeriSign iDefense Labs, for reporting the Excel Series Record Parsing Type Mismatch Vulnerability (CVE-2012-1847)An anonymous researcher, working with TippingPoint'sZero Day Initiative, for reporting the Excel Series Record Parsing Type Mismatch Vulnerability (CVE-2012-1847) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections websites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support How to obtain help and support for this security update Help installing updates: Support for Microsoft UpdateSecurity solutions for IT professionals: TechNet Security Troubleshooting and SupportHelp protect your computer that is running Windows from viruses and malware: Virus Solution and Security CenterLocal support according to your country: International Support Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (May 8, 2012): Bulletin published.V1.1 (May 9, 2012): Removed erroneous reference to known issues from the Executive Summary and updated the title of CVE-2012-1847. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2012-0185": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-030",
        "title": "Vulnerabilities in Microsoft Office Could Allow Remote Code Execution (2663830)",
        "body": "",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Microsoft Office Microsoft Office Suite and Other SoftwareComponentMaximum Security ImpactAggregate Severity RatingUpdates ReplacedMicrosoft Office Suites and ComponentsMicrosoft Office 2003 Service Pack 3[Microsoft Excel 2003 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=162901b1-4c1d-476f-99e9-218780897f92) (KB2597086)Remote Code ExecutionImportantKB2596954 in [MS11-096](http://go.microsoft.com/fwlink/?linkid=232696) replaced by KB2597086Microsoft Office 2007 Service Pack 2[Microsoft Excel 2007 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=22b9b3a6-ad09-4397-892c-2190a86baf3e)[1](KB2597161)Remote Code ExecutionImportantKB2553073 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597161[Microsoft Office 2007 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=6ff6650c-eaf4-4c7d-986c-c4d9e5324dac) (KB2597969)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2007 Service Pack 3[Microsoft Excel 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=22b9b3a6-ad09-4397-892c-2190a86baf3e)[1](KB2597161)Remote Code ExecutionImportantNone[Microsoft Office 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=6ff6650c-eaf4-4c7d-986c-c4d9e5324dac) (KB2597969)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 (32-bit editions)[Microsoft Excel 2010 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=f537f6d0-be63-42af-8b39-fa6f38715f84) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=2e1060fa-c43d-42df-be5f-f536d9b39ba4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 Service Pack 1 (32-bit editions)[Microsoft Excel 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=f537f6d0-be63-42af-8b39-fa6f38715f84) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=2e1060fa-c43d-42df-be5f-f536d9b39ba4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 (64-bit editions)[Microsoft Excel 2010 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=123b96d9-de3f-4aab-bcf8-bf9089fef400) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=ec4371f6-644d-430d-880f-12425f1b36d4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 Service Pack 1 (64-bit editions)[Microsoft Excel 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=123b96d9-de3f-4aab-bcf8-bf9089fef400) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=ec4371f6-644d-430d-880f-12425f1b36d4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office for Mac[Microsoft Office 2008 for Mac](https://www.microsoft.com/download/details.aspx?familyid=8f85fc23-480e-4835-9ce5-0aa56702ef59) (KB2665346)Not applicableRemote Code ExecutionImportantKB2644354 in [MS11-094](http://go.microsoft.com/fwlink/?linkid=232493) replaced by KB2665346[Microsoft Office for Mac 2011](https://www.microsoft.com/download/details.aspx?familyid=5d88d3d4-89bd-44c3-9e5a-657998223e2f) (KB2665351)Not applicableRemote Code ExecutionImportantKB2644347 in [MS11-089](http://go.microsoft.com/fwlink/?linkid=225739) replaced by KB2665351Other Microsoft Office Software[Microsoft Excel Viewer](https://www.microsoft.com/download/details.aspx?familyid=9dedfb18-a651-49f7-b1fc-78f7b6cb234a)[2](KB2596842)Not applicableRemote Code ExecutionImportantKB2553075 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2596842[Microsoft Office Compatibility Pack Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=a8386ad9-635f-45a7-b33e-ac9a3ca55f82) (KB2597162)Not applicableRemote Code ExecutionImportantKB2553074 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597162[Microsoft Office Compatibility Pack Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=a8386ad9-635f-45a7-b33e-ac9a3ca55f82) (KB2597162)Not applicableRemote Code ExecutionImportantKB2553074 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597162 [1] For Microsoft Excel 2007, in addition to security update package KB2597161, customers also need to install the security update for the Microsoft Office Compatibility Pack (KB2597162) to be protected from the vulnerabilities described in this bulletin. [2]Microsoft Excel Viewer must be updated to a supported service pack level (Excel Viewer 2007 Service Pack 2 or Excel Viewer 2007 Service Pack 3) before installing this update. For information about supported Office viewers, see Microsoft Knowledge Base Article 979860. Non-Affected Software Office and Other SoftwareMicrosoft SharePoint Server 2010 and Microsoft SharePoint Server 2010 Service Pack 1Microsoft Office Web Application Companions (WAC)Open XML File Format Converter for MacMicrosoft Visio 2010 and Microsoft Visio 2010 Service Pack 1 (32-bit editions)Microsoft Visio 2010 and Microsoft Visio 2010 Service Pack 1 (64-bit editions)Microsoft Office Word ViewerMicrosoft Visio Viewer 2010 and Microsoft Visio Viewer 2010 Service Pack 1Microsoft Works 9 Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. How is this security update related to MS12-029?The security update packages for Microsoft Office 2008 for Mac (KB2665346) and Microsoft Office for Mac 2011 (KB2665351) offered in this bulletin also address the vulnerabilities described in the MS12-029 security bulletin. Why is this update only rated Important for all affected versions of Excel?Microsoft Excel 2002 and later versions have a built-in feature that prompts a user to Open, Save, or Cancel before opening a document. This mitigating factor reduces the vulnerabilities from Critical to Important because the vulnerabilities require more than a single user action to complete the exploit. The attack vector for the vulnerability is through Microsoft Excel. Why is this a Microsoft Office update?Although the attack vector for the vulnerabilities described in this bulletin is only through affected versions of Microsoft Excel, the vulnerable code is contained in a shared component of Microsoft Office. Other Microsoft Office software, including some supported releases of Microsoft Access, Microsoft Word, and Microsoft PowerPoint contain the vulnerable shared component of Microsoft Office, but because they do not access the vulnerable code, they are not affected by this vulnerability. However, since the vulnerable code is present, this update will be offered. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. Why are multiple package updates available for Microsoft Office 2007 Service Pack 2, Microsoft Office 2007 Service Pack 3, Microsoft Office 2010, and Microsoft Office 2010 Service Pack 1?The updates required to address the vulnerabilities described in this bulletin are offered across different package updates as indicated in the Affected Software table due to the componentized servicing model for Microsoft Office 2007 and Microsoft Office 2010. To be protected from the vulnerabilities, both updates are required, but they do not need to be installed in a particular order. What components of the Microsoft Office Compatibility Pack are updated by this bulletin?The update included with this security bulletin applies only to the Microsoft Excel component within the Microsoft Office Compatibility Pack. How areMicrosoft Office standalone programs affected by the vulnerabilities?A Microsoft Office standalone program is affected with the same severity rating as the corresponding component in a Microsoft Office Suite. For example, a standalone installation of Microsoft Excel is affected with the same severity rating as an installation of Microsoft Excel that was delivered with a Microsoft Office Suite. The Microsoft Office component discussed in this article is part of the Microsoft Office Suite that I have installed on my system; however, I did not choose to install this specific component. Will I be offered this update?Yes, if the component discussed in this bulletin was delivered with the version of the Microsoft Office Suite installed on your system, the system will be offered updates for it whether the component is installed or not. The detection logic used to scan for affected systems is designed to check for updates for all components that were delivered with the particular Microsoft Office Suite and to offer the updates to a system. Users who choose not to apply an update for a component that is not installed, but is delivered with their version of the Microsoft Office Suite, will not increase the security risk of that system. On the other hand, users who do choose to install the update will not have a negative impact on the security or performance of a system. Does the offer to update a non-vulnerable version of Microsoft Office constitute an issue in the Microsoft update mechanism?No, the update mechanism is functioning correctly in that it detects a lower version of the files on the system than in the update package and thus, offers the update. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle website. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Service Pack Lifecycle Support Policy. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information website, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the May bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcel File Format Memory Corruption Vulnerability - CVE-2012-0141Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847Aggregate Severity RatingMicrosoft Office Suites and ComponentsMicrosoft Excel 2003 Service Pack 3**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Microsoft Excel 2007 Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2007 Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2007 Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2007 Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 Service Pack 1 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 Service Pack 1 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 Service Pack 1 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 Service Pack 1 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office for MacMicrosoft Office 2008 for MacNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Microsoft Office for Mac 2011**Important** Remote Code ExecutionNot applicableNot applicable**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Other Microsoft Office SoftwareMicrosoft Excel Viewer**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office Compatibility Pack Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office Compatibility Pack Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important** Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0141. Mitigating Factors for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000 For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps: Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings. Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0142. Mitigating Factors for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office Software Registry Script Microsoft Excel 2003 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000001 Microsoft Excel 2007 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000001 For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office Software Registry Script Microsoft Excel 2003 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000000 Microsoft Excel 2007 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000000 For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0143. Mitigating Factors for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Impact of workaround. For Microsoft Office 2003, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions.How to undo the workaround.For Microsoft Office 2003, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number CVE-2012-0143. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0184. Mitigating Factors for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Set Office File Validation to disable the opening of files that fail validation in Excel 2003 and Excel 2007Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2003 and Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000000Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0185. Mitigating Factors for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Set Office File Validation to disable the opening of files that fail validation in Excel 2007Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000000Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-1847. Mitigating Factors for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Security Central Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security website provides additional information about security in Microsoft products. Security updates are available from Microsoft Update and Windows Update. Security updates are also available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" For customers of Microsoft Office for Mac, Microsoft AutoUpdate for Mac can help keep your Microsoft software up to date. For more information about using Microsoft AutoUpdate for Mac, see Check for software updates automatically. Finally, security updates can be downloaded from the Microsoft Update Catalog. The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the Microsoft Update Catalog FAQ. Detection and Deployment Guidance Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see Microsoft Knowledge Base Article 961747. Microsoft Baseline Security Analyzer Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit Microsoft Baseline Security Analyzer. The following table provides the MBSA detection summary for this security update. SoftwareMBSAMicrosoft Office 2003 Service Pack 3YesMicrosoft Office 2007 Service Pack 2 and Microsoft Excel 2007 Service Pack 3YesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (32-bit editions)YesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (64-bit editions)YesMicrosoft Office 2008 for MacNoMicrosoft Office for Mac 2011NoMicrosoft Excel ViewerYesMicrosoft Office Compatibility Pack Service Pack 2 and Microsoft Office Compatibility Pack Service Pack 3Yes Note For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit Microsoft Baseline Security Analyzer and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. Windows Server Update Services Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, Windows Server Update Services. Systems Management Server The following table provides the SMS detection and deployment summary for this security update. SoftwareSMS 2003 with ITMUConfiguration Manager 2007Microsoft Office 2003 Service Pack 3YesYesMicrosoft Office 2007 Service Pack 2 and Microsoft Excel 2007 Service Pack 3YesYesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (32-bit editions)YesYesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (64-bit editions)YesYesMicrosoft Office 2008 for MacNoNoMicrosoft Office for Mac 2011NoNoMicrosoft Excel ViewerYesYesMicrosoft Office Compatibility Pack Service Pack 2 and Microsoft Office Compatibility Pack Service Pack 3YesYes Note Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to System Center Configuration Manager 2007. For customers remaining on SMS 2003 Service Pack 3, the Inventory Tool for Microsoft Updates (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by Microsoft Update and that are supported by Windows Server Update Services. For more information about the SMS 2003 ITMU, see SMS 2003 Inventory Tool for Microsoft Updates. For more information about SMS scanning tools, see SMS 2003 Software Update Scanning Tools. See also Downloads for Systems Management Server 2003. System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit System Center Configuration Manager 2007. For more information about SMS, visit the SMS website. For more detailed information, see Microsoft Knowledge Base Article 910723: Summary list of monthly detection and deployment guidance articles. Note If you have used an Administrative Installation Point (AIP) for deploying Office XP or Office 2003, you may not be able to deploy the update using SMS if you have updated the AIP from the original baseline. For more information, see the Office Administrative Installation Point heading in this section. Office Administrative Installation Point If you installed your application from a server location, the server administrator must update the server location with the administrative update and deploy that update to your system. For supported versions of Microsoft Office XP, see Creating an Administrative Installation Point. For more information on how to change the source for a client system from an updated administrative installation point to an Office XP original baseline source, see Microsoft Knowledge Base Article 922665.Note If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article Updating Office XP Clients from a Patched Administrative Image.For supported versions of Microsoft Office 2003, see Creating an Administrative Installation Point. For more information on how to change the source for a client computer from an updated administrative installation point to an Office 2003 original baseline source or Service Pack 3 (SP3), see Microsoft Knowledge Base Article 902349.Note If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article, Distributing Office 2003 Product Updates.For creating a network installation point for supported versions of Microsoft Office, see Create a network installation point for Microsoft Office.Note If you plan to manage security updates centrally, use Windows Server Update Services. For more information about how to deploy security updates for Microsoft Office, visit the Windows Server Update Services website. Update Compatibility Evaluator and Application Compatibility Toolkit Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the Update Compatibility Evaluator components included with Application Compatibility Toolkit. The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Office 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the Deployment Information subsection below. Inclusion in Future Service PacksThere are no more service packs planned for this software. The update for this issue may be included in a future update rollup.DeploymentInstalling without user interventionOffice2003-kb2597086-fullfile-enu.exe /q:aInstalling without restartingOffice2003-kb2597086-fullfile-enu.exe /r:nUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance. For features you can selectively install, see the Office Features for Administrative Installations subsection in this section.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.Note When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771.File InformationSee Microsoft Knowledge Base Article 2597086Registry Key VerificationNot applicable #### Office Features The following table contains the list of feature names (case sensitive) that must be reinstalled for the update. To install all features, you can use **REINSTALL=ALL** or you can install the following features: | Product | Feature | |--------------------------------------------------------|---------| | STD11, BASIC11, PERS11, STDP11, PROI11, PRO11, PRO11SB | All | **Note** Administrators working in managed environments can find complete resources for deploying Office updates in an organization at the Office Admin Update Center. At that site, scroll down and look under the **Update Resources** section for the software version you are updating. The [Windows Installer Documentation](http://go.microsoft.com/fwlink/?linkid=21685) also provides more information about the parameters supported by Windows Installer. #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 2.0 or later version be installed on the system. All supported versions of Windows include Windows Installer 2.0 or a later version. To install the 2.0 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) - [Windows Installer 2.0 Redistributable for Microsoft Windows 2000 and Windows NT 4.0](http://go.microsoft.com/fwlink/?linkid=33338) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/qSpecifies quiet mode, or suppresses prompts, when files are being extracted./q:uSpecifies user-quiet mode, which presents some dialog boxes to the user./q:aSpecifies administrator-quiet mode, which does not present any dialog boxes to the user./t:pathSpecifies the target folder for extracting files./cExtracts the files without installing them. If /t:path is not specified, you are prompted for a target folder./c:pathOverrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./r:nNever restarts the system after installation./r:IPrompts the user to restart the system if a restart is required, except when used with /q:a./r:aAlways restarts the system after installation./r:sRestarts the system after installation without prompting the user./n:vNo version checking - Install the program over any earlier version. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2007 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft Excel 2007:excel2007-kb2597161-fullfile-x86-glb.exe /passiveFor Microsoft Office 2007:graph2007-kb2597969-fullfile-x86-glb.exe /passiveFor Microsoft Excel Viewer:xlview2007-kb2596842-fullfile-x86-glb.exe /passiveFor Microsoft Office Compatibility Pack:xlconv2007-kb2597162-fullfile-x86-glb.exe /passiveInstalling without restartingFor Microsoft Excel 2007:excel2007-kb2597161-fullfile-x86-glb.exe /norestartFor Microsoft Office 2007:graph2007-kb2597969-fullfile-x86-glb.exe /norestartFor Microsoft Excel Viewer:xlview2007-kb2596842-fullfile-x86-glb.exe /norestartFor Microsoft Office Compatibility Pack:xlconv2007-kb2597162-fullfile-x86-glb.exe /norestartUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.File InformationFor Microsoft Excel 2007, see Microsoft Knowledge Base Article 2597161For Microsoft Office 2007, see Microsoft Knowledge Base Article 2597969For Microsoft Excel Viewer, see Microsoft Knowledge Base Article 2596842For Microsoft Office Compatibility Pack, see Microsoft Knowledge Base Article 2597162Registry Key VerificationNot applicable #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 3.1 or later version be installed on the system. To install the 3.1 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/? or /helpDisplays usage dialog./passiveSpecifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel./quietSpecifies quiet mode, or suppresses prompts, when files are being extracted./norestartSuppresses restarting the system if the update requires a restart./forcerestartAutomatically restarts the system after applying the update, regardless of whether the update requires the restart./extractExtracts the files without installing them. You are prompted for a target folder./extract:<path>Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./lang:<LCID>Forces the use of a specific language, when the update package supports that language./log:<log file>Enables logging, by both Vnox and Installer, during the update installation. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the 2007 Microsoft Office CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2010 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft Excel 2010 (32-bit editions):excel2010-kb2597166-fullfile-x86-glb.exe /passiveFor Microsoft Office 2010 (32-bit editions):graph2010-kb2553371-fullfile-x86-glb.exe /passiveFor Microsoft Excel 2010 (64-bit editions):excel2010-kb2597166-fullfile-x64-glb.exe /passiveFor Microsoft Office 2010 (64-bit editions):graph2010-kb2553371-fullfile-x64-glb.exe /passiveInstalling without restartingFor Microsoft Excel 2010 (32-bit editions):excel2010-kb2597166-fullfile-x86-glb.exe /norestartFor Microsoft Office 2010 (32-bit editions):graph2010-kb2553371-fullfile-x86-glb.exe /norestartFor Microsoft Excel 2010 (64-bit editions):excel2010-kb2597166-fullfile-x64-glb.exe /norestartFor Microsoft Office 2010 (64-bit editions):graph2010-kb2553371-fullfile-x64-glb.exe /norestartUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.File InformationSee Microsoft Knowledge Base Article 2597166 and Microsoft Knowledge Base Article 2553371Registry Key VerificationNot applicable #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 3.1 or later version be installed on the system. To install the 3.1 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/? or /helpDisplays usage dialog./passiveSpecifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel./quietSpecifies quiet mode, or suppresses prompts, when files are being extracted./norestartSuppresses restarting the system if the update requires a restart./forcerestartAutomatically restarts the system after applying the update, regardless of whether the update requires the restart./extractExtracts the files without installing them. You are prompted for a target folder./extract:<path>Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./lang:<LCID>Forces the use of a specific language, when the update package supports that language./log:<log file>Enables logging, by both Vnox and Installer, during the update installation. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the 2007 Microsoft Office CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2008 for Mac Deployment Information Prerequisites Mac OS X version 10.4.9 or later version on an Intel, PowerPC G5, or PowerPC G4 (500 MHz or faster) processorMac OS X user accounts must have administrator privileges to install this security update Installing the Update Download and install the appropriate language version of the Microsoft Office 2008 for Mac 12.3.3 Update from the Microsoft Download Center. Quit any applications that are running, including virus-protection applications, all Microsoft Office applications, Microsoft Messenger for Mac, and Office Notifications, because they might interfere with installation.Open the Microsoft Office 2008 for Mac 12.3.3 Update volume on your desktop. This step might have been performed for you.To start the update process, in the Microsoft Office 2008 for Mac 12.3.3 Update volume window, double-click the Microsoft Office 2008 for Mac 12.3.3 Update application, and follow the instructions on the screen.If the installation finishes successfully, you can remove the update installer from your hard disk. To verify that the installation finished successfully, see the following \"Verifying Update Installation\" heading. To remove the update installer, first drag the Microsoft Office 2008 for Mac 12.3.3 Update volume to the Trash, and then drag the file that you downloaded to the Trash. Verifying Update Installation To verify that a security update is installed on an affected system, follow these steps: In the Finder, navigate to the Application Folder (Microsoft Office 2008: Office).Select the file, Microsoft Component Plugin.On the File menu, click Get Info or Show Info. If the Version number is 12.3.3, the update has been successfully installed. Restart Requirement This update does not require you to restart your computer. Removing the Update This security update cannot be uninstalled. Additional Information If you have technical questions or problems downloading or using this update, visit Microsoft for Mac Support to learn about the support options that are available to you. Office for Mac 2011 Deployment Information Prerequisites Mac OS X version 10.5.8 or later version on an Intel processorMac OS X user accounts must have administrator privileges to install this security update Installing the Update Download and install the appropriate language version of the Microsoft Office for Mac 2011 14.2.2 Update from the Microsoft Download Center. Quit any applications that are running, including virus-protection applications and all Microsoft Office applications, because they might interfere with installation.Open the Microsoft Office for Mac 2011 14.2.2 Update volume on your desktop. This step might have been performed for you.To start the update process, in the Microsoft Office for Mac 2011 14.2.2 Update volume window, double-click the Microsoft Office for Mac 2011 14.2.2 Update application, and follow the instructions on the screen.When the installation finishes successfully, you can remove the update installer from your hard disk. To verify that the installation finished successfully, see the following \"Verifying Update Installation\" heading. To remove the update installer, first drag the Microsoft Office for Mac 2011 14.2.2 Update volume to the Trash, and then drag the file that you downloaded to the Trash. Verifying Update Installation To verify that a security update is installed on an affected system, follow these steps: In the Finder, navigate to the Application Folder (Microsoft Office 2011).Select Word, Excel, PowerPoint or Outlook and launch the application.On the Application menu, click About Application_Name (where Application_Name is Word, Excel, PowerPoint or Outlook). If the Latest Installed Update Version number is 14.2.2, the update has been successfully installed. Restart Requirement This update does not require you to restart your computer. Removing the Update This security update cannot be uninstalled. Additional Information If you have technical questions or problems downloading or using this update, visit Microsoft for Mac Support to learn about the support options that are available to you. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Omair for reporting the Excel File Format Memory Corruption Vulnerability (CVE-2012-0141)Omair for reporting the Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability (CVE-2012-0142)Omair, working with VeriSign iDefense Labs, for reporting the Excel SXLI Record Memory Corruption Vulnerability (CVE-2012-0184)Sean Larsson and Jun Mao, working with VeriSign iDefense Labs, for reporting the Excel MergeCells Record Heap Overflow Vulnerability (CVE-2012-0185)Sean Larsson and Jun Mao, working with VeriSign iDefense Labs, for reporting the Excel Series Record Parsing Type Mismatch Vulnerability (CVE-2012-1847)An anonymous researcher, working with TippingPoint'sZero Day Initiative, for reporting the Excel Series Record Parsing Type Mismatch Vulnerability (CVE-2012-1847) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections websites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support How to obtain help and support for this security update Help installing updates: Support for Microsoft UpdateSecurity solutions for IT professionals: TechNet Security Troubleshooting and SupportHelp protect your computer that is running Windows from viruses and malware: Virus Solution and Security CenterLocal support according to your country: International Support Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (May 8, 2012): Bulletin published.V1.1 (May 9, 2012): Removed erroneous reference to known issues from the Executive Summary and updated the title of CVE-2012-1847. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ],
    "CVE-2012-1847": [
      {
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-030",
        "title": "Vulnerabilities in Microsoft Office Could Allow Remote Code Execution (2663830)",
        "body": "",
        "extra": "Affected and Non-Affected Software The following software have been tested to determine which versions or editions are affected. Other versions or editions are either past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, visit Microsoft Support Lifecycle. Affected Software Microsoft Office Microsoft Office Suite and Other SoftwareComponentMaximum Security ImpactAggregate Severity RatingUpdates ReplacedMicrosoft Office Suites and ComponentsMicrosoft Office 2003 Service Pack 3[Microsoft Excel 2003 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=162901b1-4c1d-476f-99e9-218780897f92) (KB2597086)Remote Code ExecutionImportantKB2596954 in [MS11-096](http://go.microsoft.com/fwlink/?linkid=232696) replaced by KB2597086Microsoft Office 2007 Service Pack 2[Microsoft Excel 2007 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=22b9b3a6-ad09-4397-892c-2190a86baf3e)[1](KB2597161)Remote Code ExecutionImportantKB2553073 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597161[Microsoft Office 2007 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=6ff6650c-eaf4-4c7d-986c-c4d9e5324dac) (KB2597969)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2007 Service Pack 3[Microsoft Excel 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=22b9b3a6-ad09-4397-892c-2190a86baf3e)[1](KB2597161)Remote Code ExecutionImportantNone[Microsoft Office 2007 Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=6ff6650c-eaf4-4c7d-986c-c4d9e5324dac) (KB2597969)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 (32-bit editions)[Microsoft Excel 2010 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=f537f6d0-be63-42af-8b39-fa6f38715f84) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=2e1060fa-c43d-42df-be5f-f536d9b39ba4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 Service Pack 1 (32-bit editions)[Microsoft Excel 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=f537f6d0-be63-42af-8b39-fa6f38715f84) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 Service Pack 1 (32-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=2e1060fa-c43d-42df-be5f-f536d9b39ba4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 (64-bit editions)[Microsoft Excel 2010 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=123b96d9-de3f-4aab-bcf8-bf9089fef400) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=ec4371f6-644d-430d-880f-12425f1b36d4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office 2010 Service Pack 1 (64-bit editions)[Microsoft Excel 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=123b96d9-de3f-4aab-bcf8-bf9089fef400) (KB2597166)Remote Code ExecutionImportantKB2553070 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597166[Microsoft Office 2010 Service Pack 1 (64-bit editions)](https://www.microsoft.com/download/details.aspx?familyid=ec4371f6-644d-430d-880f-12425f1b36d4) (KB2553371)Not applicableRemote Code ExecutionImportantNoneMicrosoft Office for Mac[Microsoft Office 2008 for Mac](https://www.microsoft.com/download/details.aspx?familyid=8f85fc23-480e-4835-9ce5-0aa56702ef59) (KB2665346)Not applicableRemote Code ExecutionImportantKB2644354 in [MS11-094](http://go.microsoft.com/fwlink/?linkid=232493) replaced by KB2665346[Microsoft Office for Mac 2011](https://www.microsoft.com/download/details.aspx?familyid=5d88d3d4-89bd-44c3-9e5a-657998223e2f) (KB2665351)Not applicableRemote Code ExecutionImportantKB2644347 in [MS11-089](http://go.microsoft.com/fwlink/?linkid=225739) replaced by KB2665351Other Microsoft Office Software[Microsoft Excel Viewer](https://www.microsoft.com/download/details.aspx?familyid=9dedfb18-a651-49f7-b1fc-78f7b6cb234a)[2](KB2596842)Not applicableRemote Code ExecutionImportantKB2553075 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2596842[Microsoft Office Compatibility Pack Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=a8386ad9-635f-45a7-b33e-ac9a3ca55f82) (KB2597162)Not applicableRemote Code ExecutionImportantKB2553074 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597162[Microsoft Office Compatibility Pack Service Pack 3](https://www.microsoft.com/download/details.aspx?familyid=a8386ad9-635f-45a7-b33e-ac9a3ca55f82) (KB2597162)Not applicableRemote Code ExecutionImportantKB2553074 in [MS11-072](http://go.microsoft.com/fwlink/?linkid=225047) replaced by KB2597162 [1] For Microsoft Excel 2007, in addition to security update package KB2597161, customers also need to install the security update for the Microsoft Office Compatibility Pack (KB2597162) to be protected from the vulnerabilities described in this bulletin. [2]Microsoft Excel Viewer must be updated to a supported service pack level (Excel Viewer 2007 Service Pack 2 or Excel Viewer 2007 Service Pack 3) before installing this update. For information about supported Office viewers, see Microsoft Knowledge Base Article 979860. Non-Affected Software Office and Other SoftwareMicrosoft SharePoint Server 2010 and Microsoft SharePoint Server 2010 Service Pack 1Microsoft Office Web Application Companions (WAC)Open XML File Format Converter for MacMicrosoft Visio 2010 and Microsoft Visio 2010 Service Pack 1 (32-bit editions)Microsoft Visio 2010 and Microsoft Visio 2010 Service Pack 1 (64-bit editions)Microsoft Office Word ViewerMicrosoft Visio Viewer 2010 and Microsoft Visio Viewer 2010 Service Pack 1Microsoft Works 9 Frequently Asked Questions (FAQ) Related to This Security Update Where are the file information details?Refer to the reference tables in the Security Update Deployment section for the location of the file information details. How is this security update related to MS12-029?The security update packages for Microsoft Office 2008 for Mac (KB2665346) and Microsoft Office for Mac 2011 (KB2665351) offered in this bulletin also address the vulnerabilities described in the MS12-029 security bulletin. Why is this update only rated Important for all affected versions of Excel?Microsoft Excel 2002 and later versions have a built-in feature that prompts a user to Open, Save, or Cancel before opening a document. This mitigating factor reduces the vulnerabilities from Critical to Important because the vulnerabilities require more than a single user action to complete the exploit. The attack vector for the vulnerability is through Microsoft Excel. Why is this a Microsoft Office update?Although the attack vector for the vulnerabilities described in this bulletin is only through affected versions of Microsoft Excel, the vulnerable code is contained in a shared component of Microsoft Office. Other Microsoft Office software, including some supported releases of Microsoft Access, Microsoft Word, and Microsoft PowerPoint contain the vulnerable shared component of Microsoft Office, but because they do not access the vulnerable code, they are not affected by this vulnerability. However, since the vulnerable code is present, this update will be offered. Why does this update address several reported security vulnerabilities?This update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that are almost the same, customers need to install this update only. Why are multiple package updates available for Microsoft Office 2007 Service Pack 2, Microsoft Office 2007 Service Pack 3, Microsoft Office 2010, and Microsoft Office 2010 Service Pack 1?The updates required to address the vulnerabilities described in this bulletin are offered across different package updates as indicated in the Affected Software table due to the componentized servicing model for Microsoft Office 2007 and Microsoft Office 2010. To be protected from the vulnerabilities, both updates are required, but they do not need to be installed in a particular order. What components of the Microsoft Office Compatibility Pack are updated by this bulletin?The update included with this security bulletin applies only to the Microsoft Excel component within the Microsoft Office Compatibility Pack. How areMicrosoft Office standalone programs affected by the vulnerabilities?A Microsoft Office standalone program is affected with the same severity rating as the corresponding component in a Microsoft Office Suite. For example, a standalone installation of Microsoft Excel is affected with the same severity rating as an installation of Microsoft Excel that was delivered with a Microsoft Office Suite. The Microsoft Office component discussed in this article is part of the Microsoft Office Suite that I have installed on my system; however, I did not choose to install this specific component. Will I be offered this update?Yes, if the component discussed in this bulletin was delivered with the version of the Microsoft Office Suite installed on your system, the system will be offered updates for it whether the component is installed or not. The detection logic used to scan for affected systems is designed to check for updates for all components that were delivered with the particular Microsoft Office Suite and to offer the updates to a system. Users who choose not to apply an update for a component that is not installed, but is delivered with their version of the Microsoft Office Suite, will not increase the security risk of that system. On the other hand, users who do choose to install the update will not have a negative impact on the security or performance of a system. Does the offer to update a non-vulnerable version of Microsoft Office constitute an issue in the Microsoft update mechanism?No, the update mechanism is functioning correctly in that it detects a lower version of the files on the system than in the update package and thus, offers the update. I am using an older release of the software discussed in this security bulletin. What should I do?The affected software listed in this bulletin have been tested to determine which releases are affected. Other releases are past their support life cycle. For more information about the product lifecycle, visit the Microsoft Support Lifecycle website. It should be a priority for customers who have older releases of the software to migrate to supported releases to prevent potential exposure to vulnerabilities. To determine the support lifecycle for your software release, see Select a Product for Lifecycle Information. For more information about service packs for these software releases, see Service Pack Lifecycle Support Policy. Customers who require custom support for older software must contact their Microsoft account team representative, their Technical Account Manager, or the appropriate Microsoft partner representative for custom support options. Customers without an Alliance, Premier, or Authorized Contract can contact their local Microsoft sales office. For contact information, visit the Microsoft Worldwide Information website, select the country in the Contact Information list, and then click Go to see a list of telephone numbers. When you call, ask to speak with the local Premier Support sales manager. For more information, see the Microsoft Support Lifecycle Policy FAQ. Vulnerability Information Severity Ratings and Vulnerability Identifiers The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the May bulletin summary. For more information, see Microsoft Exploitability Index. Vulnerability Severity Rating and Maximum Security Impact by Affected SoftwareAffected SoftwareExcel File Format Memory Corruption Vulnerability - CVE-2012-0141Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847Aggregate Severity RatingMicrosoft Office Suites and ComponentsMicrosoft Excel 2003 Service Pack 3**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Microsoft Excel 2007 Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2007 Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2007 Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2007 Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 Service Pack 1 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 Service Pack 1 (32-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Excel 2010 Service Pack 1 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office 2010 Service Pack 1 (64-bit editions)**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office for MacMicrosoft Office 2008 for MacNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Microsoft Office for Mac 2011**Important** Remote Code ExecutionNot applicableNot applicable**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important**Other Microsoft Office SoftwareMicrosoft Excel Viewer**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office Compatibility Pack Service Pack 2**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important**Microsoft Office Compatibility Pack Service Pack 3**Important** Remote Code Execution**Important** Remote Code ExecutionNot applicable**Important** Remote Code Execution**Important** Remote Code Execution**Important** Remote Code Execution**Important** Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0141. Mitigating Factors for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied.Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000 For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps: Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings. Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel File Format Memory Corruption Vulnerability - CVE-2012-0141 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0142. Mitigating Factors for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office Software Registry Script Microsoft Excel 2003 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000001 Microsoft Excel 2007 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000001 For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office Software Registry Script Microsoft Excel 2003 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000000 Microsoft Excel 2007 Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock] \"BinaryFiles\"=dword:00000000 For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability - CVE-2012-0142 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0143. Mitigating Factors for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Impact of workaround. For Microsoft Office 2003, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions.How to undo the workaround.For Microsoft Office 2003, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel Memory Corruption Using Various Modified Bytes Vulnerability - CVE-2012-0143 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?Yes. This vulnerability has been publicly disclosed. It has been assigned Common Vulnerability and Exposure number CVE-2012-0143. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0184. Mitigating Factors for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Set Office File Validation to disable the opening of files that fail validation in Excel 2003 and Excel 2007Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2003 and Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000000Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel SXLI Record Memory Corruption Vulnerability - CVE-2012-0184 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-0185. Mitigating Factors for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Set Office File Validation to disable the opening of files that fail validation in Excel 2007Note Before applying this workaround, Office File Validation must be enabled for your version of Microsoft Office. For information on how to enable Office File Validation in Microsoft Office 2007, see the TechNet article, Office File Validation for Office 2003 and Office 2007.The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the opening of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\FileValidation]\"InvalidFileUIOptions\"=dword:00000000Set Office File Validation to disable the edit in Protected View of files that fail validation in Excel 2010The following registry scripts can be saved in registry entry (.reg) files and used to disable editing of files that fail file validation. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note See Microsoft Knowledge Base Article 2501584 to use the automated Microsoft Fix it solution to enable or disable this workaround in the appropriate Office software.Note Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.Use the registry script that is appropriate for your Office software. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000001Impact of workaround. Office File Validation will no longer allow the editing of suspicious files.How to undo the workaround.Use the appropriate registry script for your software to undo the settings set by this workaround. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2010Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\FileValidation]\"DisableEditFromPV\"=dword:00000000Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel MergeCells Record Heap Overflow Vulnerability - CVE-2012-0185 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 A remote code execution vulnerability exists in the way that Microsoft Excel handles specially crafted Excel files. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. To view this vulnerability as a standard entry in the Common Vulnerabilities and Exposures list, see CVE-2012-1847. Mitigating Factors for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: In a web-based attack scenario, an attacker could host a website that contains an Excel file that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit these websites. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website, and then convince them to open the specially crafted Excel file.An attacker who successfully exploited this vulnerability could gain the same user rights as the logged-on user. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights.The vulnerability cannot be exploited automatically through email. For an attack to be successful a user must open an attachment that is sent in an email message. Workarounds for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 Workaround refers to a setting or configuration change that does not correct the underlying vulnerability but would help block known attack vectors before you apply the update. Microsoft has tested the following workarounds and states in the discussion whether a workaround reduces functionality: Use Microsoft Office File Block policy to block the opening of Office 2003 and earlier documents from unknown or untrusted sources and locationsMicrosoft Office File Block policy can be used to block specific file format types from opening in Microsoft Word, Microsoft Excel, and Microsoft PowerPoint.For Microsoft Office 2003 and Microsoft Office 2007The following registry scripts can be saved in registry entry (.reg) files and used to set the File Block policy. For more information on how to use registry scripts, see Microsoft Knowledge Base Article 310516.Note In order to use 'FileOpenBlock' with Microsoft Office 2003, all of the latest security updates for Microsoft Office 2003 must be applied. In order to use 'FileOpenBlock' with Microsoft Office 2007, all of the latest security updates for Office 2007 must be applied. Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000001For Microsoft Office 2010 Open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Ensure the Open check box is selected for the following file types:In Microsoft Excel 2010:Excel 2007 and later Binary WorkbooksExcel 97-2003 Add-in FilesExcel 97-2003 Workbooks and TemplatesExcel 95-97 Workbooks and TemplatesExcel 95 WorkbooksExcel 4 WorkbooksExcel 4 WorksheetsExcel 3 WorksheetsExcel 2 WorksheetsUnder Open behavior for selected file types, select Do not open selected file types or select Open selected file types in Protected View. Either choice will block the attack vector to the vulnerable code.Click OK to apply the File Block Settings.Alternatively, file block can be applied using Group Policy. For more information, see the TechNet article, Plan file block settings for Office 2010.Impact of workaround. For Microsoft Office 2003 and Microsoft Office 2007, users who have configured the File Block policy and have not configured a special exempt directory or have not moved files to a trusted location will be unable to open Office 2003 files or earlier versions. For Microsoft Office 2010, Office 2003 files or earlier versions will either be blocked from opening or will be opened in protected mode depending on the open behavior that was selected. For more information about the impact of file block setting in Microsoft Office software, see Microsoft Knowledge Base Article 922850.How to undo the workaround.For Microsoft Office 2003 and Microsoft Office 2007, use the following registry scripts to undo the settings used to set the File Block policy: Microsoft Office SoftwareRegistry ScriptMicrosoft Excel 2003Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000Microsoft Excel 2007Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Office\\12.0\\Excel\\Security\\FileOpenBlock]\"BinaryFiles\"=dword:00000000For Microsoft Office 2010, open Microsoft Excel 2010 and perform the following steps:Click the File tab.Under Help, click Options.Click Trust Center, and then click Trust Center Settings.In the Trust Center, click File Block Settings.Clear the Open check box for the file types that you previously selected.Click OK to apply the File Block settings.Use the Microsoft Office Isolated Conversion Environment (MOICE) when opening files from unknown or untrusted sourcesNote Modifying the Registry incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from incorrect modification of the Registry can be solved. Modify the Registry at your own risk.The Microsoft Office Isolated Conversion Environment (MOICE) helps protect Office 2003 installations by more securely opening Word, Excel, and PowerPoint binary format files.To install MOICE, you must have Office 2003 or Office 2007 installed.To install MOICE, you must also have the Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats. The compatibility pack is available as a free download from the Microsoft Download Center.MOICE requires all updates that are recommended for all Office programs. Visit Microsoft Update to install all recommended updates.Enable MOICENote See Microsoft Knowledge Base Article 935865 to use the automated Microsoft Fix it solution to enable or disable this workaround.To manually enable MOICE, run the commands as specified in the following table. Running the commands will associate the Office application extensions with MOICE. Command to enable MOICE to be the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=oice.word.documentFor Excel, run the following commands from a command prompt:ASSOC .XLS=oice.excel.sheetASSOC .XLT=oice.excel.templateASSOC .XLA=oice.excel.addinFor PowerPoint, run the following commands from a command prompt:ASSOC .PPT=oice.powerpoint.showASSOC .POT=oice.powerpoint.templateASSOC .PPS=oice.powerpoint.slideshowNote On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.For more information on MOICE, see Microsoft Knowledge Base Article 935865.Impact of workaround. Office 2003 and earlier formatted documents that are converted to the Microsoft Office 2007 Open XML format by MOICE will not retain macro functionality. Additionally, documents with passwords or that are protected with Digital Rights Management cannot be converted.How to undo the workaround. Run the commands to disable MOICE as specified in the table below. Command to disable MOICE as the registered handlerFor Word, run the following command from a command prompt:ASSOC .doc=Word.Document.8For Excel, run the following commands from a command prompt:ASSOC .xls=Excel.Sheet.8ASSOC .xlt=Excel.TemplateASSOC .xla=Excel.AddinFor PowerPoint, run the following commands from a command prompt:ASSOC .ppt=PowerPoint.Show.8ASSOC .pot=PowerPoint.Template.8ASSOC .pps=PowerPoint.SlideShow.8Note On Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2, run the above commands from an elevated command prompt.Do not open Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sourcesDo not open or save Microsoft Office files that you receive from untrusted sources or that you receive unexpectedly from trusted sources. This vulnerability could be exploited when a user opens a specially crafted file. FAQ for Excel Series Record Parsing Type Mismatch Vulnerability - CVE-2012-1847 What is the scope of the vulnerability?This is a remote code execution vulnerability. An attacker who successfully exploited this vulnerability could take complete control of an affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. What causes the vulnerability?The vulnerability exists in the way that Microsoft Excel handles memory when opening specially crafted Excel files. What might an attacker use the vulnerability to do?An attacker who successfully exploited this vulnerability could run arbitrary code as the logged-on user. If a user is logged on with administrative user rights, an attacker could take complete control of the affected system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Users whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. How could an attacker exploit the vulnerability?This vulnerability requires that a user open a specially crafted Excel file with an affected version of Microsoft Excel. In an email attack scenario, an attacker could exploit the vulnerability by sending a specially crafted Excel file to the user and by convincing the user to open the file. In a web-based attack scenario, an attacker would have to host a website that contains a specially crafted Excel file that is used to attempt to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content could contain specially crafted content that could exploit this vulnerability. An attacker would have no way to force users to visit a specially crafted website. Instead, an attacker would have to convince users to visit the website, typically by getting them to click a link that takes them to the attacker's site, and then convince them to open the specially crafted Excel file. What systems are primarily at risk from the vulnerability?Systems where Microsoft Excel is used, including workstations and terminal servers, are primarily at risk. Servers could be at more risk if administrators allow users to log on to servers and to run programs. However, best practices strongly discourage allowing this. What does the update do?The update addresses the vulnerability by correcting the way that Microsoft Excel validates data when opening specially crafted Excel files. When this security bulletin was issued, had this vulnerability been publicly disclosed?No. Microsoft received information about this vulnerability through coordinated vulnerability disclosure. When this security bulletin was issued, had Microsoft received any reports that this vulnerability was being exploited?No. Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers when this security bulletin was originally issued. Update Information Detection and Deployment Tools and Guidance Security Central Manage the software and security updates you need to deploy to the servers, desktop, and mobile systems in your organization. For more information see the TechNet Update Management Center. The Microsoft TechNet Security website provides additional information about security in Microsoft products. Security updates are available from Microsoft Update and Windows Update. Security updates are also available from the Microsoft Download Center. You can find them most easily by doing a keyword search for \"security update.\" For customers of Microsoft Office for Mac, Microsoft AutoUpdate for Mac can help keep your Microsoft software up to date. For more information about using Microsoft AutoUpdate for Mac, see Check for software updates automatically. Finally, security updates can be downloaded from the Microsoft Update Catalog. The Microsoft Update Catalog provides a searchable catalog of content made available through Windows Update and Microsoft Update, including security updates, drivers and service packs. By searching using the security bulletin number (such as, \"MS07-036\"), you can add all of the applicable updates to your basket (including different languages for an update), and download to the folder of your choosing. For more information about the Microsoft Update Catalog, see the Microsoft Update Catalog FAQ. Detection and Deployment Guidance Microsoft provides detection and deployment guidance for security updates. This guidance contains recommendations and information that can help IT professionals understand how to use various tools for detection and deployment of security updates. For more information, see Microsoft Knowledge Base Article 961747. Microsoft Baseline Security Analyzer Microsoft Baseline Security Analyzer (MBSA) allows administrators to scan local and remote systems for missing security updates as well as common security misconfigurations. For more information about MBSA, visit Microsoft Baseline Security Analyzer. The following table provides the MBSA detection summary for this security update. SoftwareMBSAMicrosoft Office 2003 Service Pack 3YesMicrosoft Office 2007 Service Pack 2 and Microsoft Excel 2007 Service Pack 3YesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (32-bit editions)YesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (64-bit editions)YesMicrosoft Office 2008 for MacNoMicrosoft Office for Mac 2011NoMicrosoft Excel ViewerYesMicrosoft Office Compatibility Pack Service Pack 2 and Microsoft Office Compatibility Pack Service Pack 3Yes Note For customers using legacy software not supported by the latest release of MBSA, Microsoft Update, and Windows Server Update Services, please visit Microsoft Baseline Security Analyzer and reference the Legacy Product Support section on how to create comprehensive security update detection with legacy tools. Windows Server Update Services Windows Server Update Services (WSUS) enables information technology administrators to deploy the latest Microsoft product updates to computers that are running the Windows operating system. For more information about how to deploy security updates using Windows Server Update Services, see the TechNet article, Windows Server Update Services. Systems Management Server The following table provides the SMS detection and deployment summary for this security update. SoftwareSMS 2003 with ITMUConfiguration Manager 2007Microsoft Office 2003 Service Pack 3YesYesMicrosoft Office 2007 Service Pack 2 and Microsoft Excel 2007 Service Pack 3YesYesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (32-bit editions)YesYesMicrosoft Office 2010 and Microsoft Excel 2010 Service Pack 1 (64-bit editions)YesYesMicrosoft Office 2008 for MacNoNoMicrosoft Office for Mac 2011NoNoMicrosoft Excel ViewerYesYesMicrosoft Office Compatibility Pack Service Pack 2 and Microsoft Office Compatibility Pack Service Pack 3YesYes Note Microsoft discontinued support for SMS 2.0 on April 12, 2011. For SMS 2003, Microsoft also discontinued support for the Security Update Inventory Tool (SUIT) on April 12, 2011. Customers are encouraged to upgrade to System Center Configuration Manager 2007. For customers remaining on SMS 2003 Service Pack 3, the Inventory Tool for Microsoft Updates (ITMU) is also an option. For SMS 2003, the SMS 2003 Inventory Tool for Microsoft Updates (ITMU) can be used by SMS to detect security updates that are offered by Microsoft Update and that are supported by Windows Server Update Services. For more information about the SMS 2003 ITMU, see SMS 2003 Inventory Tool for Microsoft Updates. For more information about SMS scanning tools, see SMS 2003 Software Update Scanning Tools. See also Downloads for Systems Management Server 2003. System Center Configuration Manager 2007 uses WSUS 3.0 for detection of updates. For more information about Configuration Manager 2007 Software Update Management, visit System Center Configuration Manager 2007. For more information about SMS, visit the SMS website. For more detailed information, see Microsoft Knowledge Base Article 910723: Summary list of monthly detection and deployment guidance articles. Note If you have used an Administrative Installation Point (AIP) for deploying Office XP or Office 2003, you may not be able to deploy the update using SMS if you have updated the AIP from the original baseline. For more information, see the Office Administrative Installation Point heading in this section. Office Administrative Installation Point If you installed your application from a server location, the server administrator must update the server location with the administrative update and deploy that update to your system. For supported versions of Microsoft Office XP, see Creating an Administrative Installation Point. For more information on how to change the source for a client system from an updated administrative installation point to an Office XP original baseline source, see Microsoft Knowledge Base Article 922665.Note If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article Updating Office XP Clients from a Patched Administrative Image.For supported versions of Microsoft Office 2003, see Creating an Administrative Installation Point. For more information on how to change the source for a client computer from an updated administrative installation point to an Office 2003 original baseline source or Service Pack 3 (SP3), see Microsoft Knowledge Base Article 902349.Note If you plan to manage software updates centrally from an updated administrative image, you can find more information in the article, Distributing Office 2003 Product Updates.For creating a network installation point for supported versions of Microsoft Office, see Create a network installation point for Microsoft Office.Note If you plan to manage security updates centrally, use Windows Server Update Services. For more information about how to deploy security updates for Microsoft Office, visit the Windows Server Update Services website. Update Compatibility Evaluator and Application Compatibility Toolkit Updates often write to the same files and registry settings required for your applications to run. This can trigger incompatibilities and increase the time it takes to deploy security updates. You can streamline testing and validating Windows updates against installed applications with the Update Compatibility Evaluator components included with Application Compatibility Toolkit. The Application Compatibility Toolkit (ACT) contains the necessary tools and documentation to evaluate and mitigate application compatibility issues before deploying Windows Vista, a Windows Update, a Microsoft Security Update, or a new version of Windows Internet Explorer in your environment. Security Update Deployment Affected Software For information about the specific security update for your affected software, click the appropriate link: Office 2003 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the Deployment Information subsection below. Inclusion in Future Service PacksThere are no more service packs planned for this software. The update for this issue may be included in a future update rollup.DeploymentInstalling without user interventionOffice2003-kb2597086-fullfile-enu.exe /q:aInstalling without restartingOffice2003-kb2597086-fullfile-enu.exe /r:nUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance. For features you can selectively install, see the Office Features for Administrative Installations subsection in this section.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.Note When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771.File InformationSee Microsoft Knowledge Base Article 2597086Registry Key VerificationNot applicable #### Office Features The following table contains the list of feature names (case sensitive) that must be reinstalled for the update. To install all features, you can use **REINSTALL=ALL** or you can install the following features: | Product | Feature | |--------------------------------------------------------|---------| | STD11, BASIC11, PERS11, STDP11, PROI11, PRO11, PRO11SB | All | **Note** Administrators working in managed environments can find complete resources for deploying Office updates in an organization at the Office Admin Update Center. At that site, scroll down and look under the **Update Resources** section for the software version you are updating. The [Windows Installer Documentation](http://go.microsoft.com/fwlink/?linkid=21685) also provides more information about the parameters supported by Windows Installer. #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 2.0 or later version be installed on the system. All supported versions of Windows include Windows Installer 2.0 or a later version. To install the 2.0 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) - [Windows Installer 2.0 Redistributable for Microsoft Windows 2000 and Windows NT 4.0](http://go.microsoft.com/fwlink/?linkid=33338) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/qSpecifies quiet mode, or suppresses prompts, when files are being extracted./q:uSpecifies user-quiet mode, which presents some dialog boxes to the user./q:aSpecifies administrator-quiet mode, which does not present any dialog boxes to the user./t:pathSpecifies the target folder for extracting files./cExtracts the files without installing them. If /t:path is not specified, you are prompted for a target folder./c:pathOverrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./r:nNever restarts the system after installation./r:IPrompts the user to restart the system if a restart is required, except when used with /q:a./r:aAlways restarts the system after installation./r:sRestarts the system after installation without prompting the user./n:vNo version checking - Install the program over any earlier version. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the Microsoft Office 2003 CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2007 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft Excel 2007:excel2007-kb2597161-fullfile-x86-glb.exe /passiveFor Microsoft Office 2007:graph2007-kb2597969-fullfile-x86-glb.exe /passiveFor Microsoft Excel Viewer:xlview2007-kb2596842-fullfile-x86-glb.exe /passiveFor Microsoft Office Compatibility Pack:xlconv2007-kb2597162-fullfile-x86-glb.exe /passiveInstalling without restartingFor Microsoft Excel 2007:excel2007-kb2597161-fullfile-x86-glb.exe /norestartFor Microsoft Office 2007:graph2007-kb2597969-fullfile-x86-glb.exe /norestartFor Microsoft Excel Viewer:xlview2007-kb2596842-fullfile-x86-glb.exe /norestartFor Microsoft Office Compatibility Pack:xlconv2007-kb2597162-fullfile-x86-glb.exe /norestartUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.File InformationFor Microsoft Excel 2007, see Microsoft Knowledge Base Article 2597161For Microsoft Office 2007, see Microsoft Knowledge Base Article 2597969For Microsoft Excel Viewer, see Microsoft Knowledge Base Article 2596842For Microsoft Office Compatibility Pack, see Microsoft Knowledge Base Article 2597162Registry Key VerificationNot applicable #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 3.1 or later version be installed on the system. To install the 3.1 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/? or /helpDisplays usage dialog./passiveSpecifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel./quietSpecifies quiet mode, or suppresses prompts, when files are being extracted./norestartSuppresses restarting the system if the update requires a restart./forcerestartAutomatically restarts the system after applying the update, regardless of whether the update requires the restart./extractExtracts the files without installing them. You are prompted for a target folder./extract:<path>Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./lang:<LCID>Forces the use of a specific language, when the update package supports that language./log:<log file>Enables logging, by both Vnox and Installer, during the update installation. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the 2007 Microsoft Office CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2010 (all editions) Reference Table The following table contains the security update information for this software. You can find additional information in the subsection, Deployment Information, in this section. Inclusion in Future Service PacksThe update for this issue will be included in a future service pack or update rollupDeploymentInstalling without user interventionFor Microsoft Excel 2010 (32-bit editions):excel2010-kb2597166-fullfile-x86-glb.exe /passiveFor Microsoft Office 2010 (32-bit editions):graph2010-kb2553371-fullfile-x86-glb.exe /passiveFor Microsoft Excel 2010 (64-bit editions):excel2010-kb2597166-fullfile-x64-glb.exe /passiveFor Microsoft Office 2010 (64-bit editions):graph2010-kb2553371-fullfile-x64-glb.exe /passiveInstalling without restartingFor Microsoft Excel 2010 (32-bit editions):excel2010-kb2597166-fullfile-x86-glb.exe /norestartFor Microsoft Office 2010 (32-bit editions):graph2010-kb2553371-fullfile-x86-glb.exe /norestartFor Microsoft Excel 2010 (64-bit editions):excel2010-kb2597166-fullfile-x64-glb.exe /norestartFor Microsoft Office 2010 (64-bit editions):graph2010-kb2553371-fullfile-x64-glb.exe /norestartUpdate log fileNot applicableFurther informationFor detection and deployment, see the earlier section, Detection and Deployment Tools and Guidance.Restart RequirementRestart required?In some cases, this update does not require a restart. If the required files are being used, this update will require a restart. If this behavior occurs, a message appears that advises you to restart.To help reduce the chance that a restart will be required, stop all affected services and close all applications that may use the affected files prior to installing the security update. For more information about the reasons why you may be prompted to restart, see Microsoft Knowledge Base Article 887012.HotPatchingNot applicableRemoval InformationUse Add or Remove Programs item in Control Panel.File InformationSee Microsoft Knowledge Base Article 2597166 and Microsoft Knowledge Base Article 2553371Registry Key VerificationNot applicable #### Deployment Information **Installing the Update** You can install the update from the appropriate download link in the Affected and Non-Affected Software section. If you installed your application from a server location, the server administrator must instead update the server location with the administrative update and deploy that update to your system. For more information about Administrative Installation Points, refer to the **Office Administrative Installation Point** information in the **Detection and deployment Tools and Guidance** subsection. This security update requires that Windows Installer 3.1 or later version be installed on the system. To install the 3.1 or later version of Windows Installer, visit one of the following Microsoft websites: - [Windows Installer 4.5 Redistributable for Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP](https://www.microsoft.com/download/details.aspx?familyid=5a58b56f-60b6-4412-95b9-54d056d6f9f4&displaylang=en) - [Windows Installer 3.1 Redistributable for Windows Server 2003, Windows XP, and Microsoft Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c&displaylang=en) For more information about the terminology that appears in this bulletin, such as hotfix, see [Microsoft Knowledge Base Article 824684](http://support.microsoft.com/kb/824684). This security update supports the following setup switches. Supported Security Update Installation Switches SwitchDescription/? or /helpDisplays usage dialog./passiveSpecifies passive mode. Requires no user interaction; users see basic progress dialogs but cannot cancel./quietSpecifies quiet mode, or suppresses prompts, when files are being extracted./norestartSuppresses restarting the system if the update requires a restart./forcerestartAutomatically restarts the system after applying the update, regardless of whether the update requires the restart./extractExtracts the files without installing them. You are prompted for a target folder./extract:<path>Overrides the install command that is defined by author. Specifies the path and name of the Setup.inf or .exe file./lang:<LCID>Forces the use of a specific language, when the update package supports that language./log:<log file>Enables logging, by both Vnox and Installer, during the update installation. Note You can combine these switches into one command. For backward compatibility, the security update also supports many of the setup switches that the earlier version of the Setup program uses. For more information about the supported installation switches, see Microsoft Knowledge Base Article 262841. Removing the Update To remove this security update, use the Add or Remove Programs item in Control Panel. Note When you remove this update, you may be prompted to insert the 2007 Microsoft Office CD in the CD drive. Additionally, you may not have the option to uninstall the update from the Add or Remove Programs item in Control Panel. There are several possible causes for this issue. For more information about the removal, see Microsoft Knowledge Base Article 903771. Verifying that the Update Has Been Applied Microsoft Baseline Security AnalyzerTo verify that a security update has been applied to an affected system, you may be able to use the Microsoft Baseline Security Analyzer (MBSA) tool. See the section, Detection and Deployment Tools and Guidance, earlier in this bulletin for more information.File Version VerificationBecause there are several editions of Microsoft Windows, the following steps may be different on your system. If they are, see your product documentation to complete these steps.Click Start and then enter an update file name in the Start Search box.When the file appears under Programs, right-click the file name and click Properties.On the General tab, compare the file size with the file information tables provided in the bulletin KB article.Note Depending on the edition of the operating system, or the programs that are installed on your system, some files that are listed in the file information table may not be installed.You can also click the Details tab and compare information, such as file version and date modified, with the file information tables provided in the bulletin KB article.Note Attributes other than the file version may change during installation. Comparing other file attributes to the information in the file information table is not a supported method of verifying that the update has been applied. Also, in certain cases, files may be renamed during installation. If the file or version information is not present, use one of the other available methods to verify update installation.Finally, you can also click the Previous Versions tab and compare file information for the previous version of the file with the file information for the new, or updated, version of the file. Office 2008 for Mac Deployment Information Prerequisites Mac OS X version 10.4.9 or later version on an Intel, PowerPC G5, or PowerPC G4 (500 MHz or faster) processorMac OS X user accounts must have administrator privileges to install this security update Installing the Update Download and install the appropriate language version of the Microsoft Office 2008 for Mac 12.3.3 Update from the Microsoft Download Center. Quit any applications that are running, including virus-protection applications, all Microsoft Office applications, Microsoft Messenger for Mac, and Office Notifications, because they might interfere with installation.Open the Microsoft Office 2008 for Mac 12.3.3 Update volume on your desktop. This step might have been performed for you.To start the update process, in the Microsoft Office 2008 for Mac 12.3.3 Update volume window, double-click the Microsoft Office 2008 for Mac 12.3.3 Update application, and follow the instructions on the screen.If the installation finishes successfully, you can remove the update installer from your hard disk. To verify that the installation finished successfully, see the following \"Verifying Update Installation\" heading. To remove the update installer, first drag the Microsoft Office 2008 for Mac 12.3.3 Update volume to the Trash, and then drag the file that you downloaded to the Trash. Verifying Update Installation To verify that a security update is installed on an affected system, follow these steps: In the Finder, navigate to the Application Folder (Microsoft Office 2008: Office).Select the file, Microsoft Component Plugin.On the File menu, click Get Info or Show Info. If the Version number is 12.3.3, the update has been successfully installed. Restart Requirement This update does not require you to restart your computer. Removing the Update This security update cannot be uninstalled. Additional Information If you have technical questions or problems downloading or using this update, visit Microsoft for Mac Support to learn about the support options that are available to you. Office for Mac 2011 Deployment Information Prerequisites Mac OS X version 10.5.8 or later version on an Intel processorMac OS X user accounts must have administrator privileges to install this security update Installing the Update Download and install the appropriate language version of the Microsoft Office for Mac 2011 14.2.2 Update from the Microsoft Download Center. Quit any applications that are running, including virus-protection applications and all Microsoft Office applications, because they might interfere with installation.Open the Microsoft Office for Mac 2011 14.2.2 Update volume on your desktop. This step might have been performed for you.To start the update process, in the Microsoft Office for Mac 2011 14.2.2 Update volume window, double-click the Microsoft Office for Mac 2011 14.2.2 Update application, and follow the instructions on the screen.When the installation finishes successfully, you can remove the update installer from your hard disk. To verify that the installation finished successfully, see the following \"Verifying Update Installation\" heading. To remove the update installer, first drag the Microsoft Office for Mac 2011 14.2.2 Update volume to the Trash, and then drag the file that you downloaded to the Trash. Verifying Update Installation To verify that a security update is installed on an affected system, follow these steps: In the Finder, navigate to the Application Folder (Microsoft Office 2011).Select Word, Excel, PowerPoint or Outlook and launch the application.On the Application menu, click About Application_Name (where Application_Name is Word, Excel, PowerPoint or Outlook). If the Latest Installed Update Version number is 14.2.2, the update has been successfully installed. Restart Requirement This update does not require you to restart your computer. Removing the Update This security update cannot be uninstalled. Additional Information If you have technical questions or problems downloading or using this update, visit Microsoft for Mac Support to learn about the support options that are available to you. Other Information Acknowledgments Microsoft thanks the following for working with us to help protect customers: Omair for reporting the Excel File Format Memory Corruption Vulnerability (CVE-2012-0141)Omair for reporting the Excel File Format Memory Corruption in OBJECTLINK Record Vulnerability (CVE-2012-0142)Omair, working with VeriSign iDefense Labs, for reporting the Excel SXLI Record Memory Corruption Vulnerability (CVE-2012-0184)Sean Larsson and Jun Mao, working with VeriSign iDefense Labs, for reporting the Excel MergeCells Record Heap Overflow Vulnerability (CVE-2012-0185)Sean Larsson and Jun Mao, working with VeriSign iDefense Labs, for reporting the Excel Series Record Parsing Type Mismatch Vulnerability (CVE-2012-1847)An anonymous researcher, working with TippingPoint'sZero Day Initiative, for reporting the Excel Series Record Parsing Type Mismatch Vulnerability (CVE-2012-1847) Microsoft Active Protections Program (MAPP) To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections websites provided by program partners, listed in Microsoft Active Protections Program (MAPP) Partners. Support How to obtain help and support for this security update Help installing updates: Support for Microsoft UpdateSecurity solutions for IT professionals: TechNet Security Troubleshooting and SupportHelp protect your computer that is running Windows from viruses and malware: Virus Solution and Security CenterLocal support according to your country: International Support Disclaimer The information provided in the Microsoft Knowledge Base is provided \"as is\" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply. Revisions V1.0 (May 8, 2012): Bulletin published.V1.1 (May 9, 2012): Removed erroneous reference to known issues from the Executive Summary and updated the title of CVE-2012-1847. Built at 2014-04-18T13:49:36Z-07:00 </content>"
      }
    ]
  }
}